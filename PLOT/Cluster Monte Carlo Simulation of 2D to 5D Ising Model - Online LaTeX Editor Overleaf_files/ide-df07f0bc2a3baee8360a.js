/*! For license information please see ide-df07f0bc2a3baee8360a.js.LICENSE */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ide=t():(e.Frontend=e.Frontend||{},e.Frontend.ide=t())}(window,(function(){return function(e){function t(t){for(var r,s,a=t[0],l=t[1],c=t[2],h=0,d=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&d.push(i[s][0]),i[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==i[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},i={2:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=r);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+"js/"+({1:"vendors~publish-modal~rich-text",7:"publish-modal",8:"rich-text",11:"vendors~publish-modal",12:"vendors~rich-text"}[e]||e)+"-"+{1:"d5147e203adcb174404e",7:"5d6e12adc9e0af6529cc",8:"d978b081f686d112c5a1",11:"aef5fcb782b79d8f5775",12:"03ab923dd293e6a3f9be"}[e]+".js"}(e);var l=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,n[1](l)}i[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var u=l;return o.push([146,0]),n()}([function(e,t,n){var r,i;function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){return null!=e?t(e):void 0}r=[n(15),n(55),n(56),n(57),n(26),n(27),n(16),n(28),n(29)],void 0===(i=function(){var e=angular.module("SharelatexApp",["ui.bootstrap","autocomplete","RecursionHelper","ng-context-menu","underscore","ngSanitize","ipCookie","ErrorCatcher","localStorage","sessionStorage","ngTagsInput","ui.select"]).config(["$qProvider","$httpProvider","uiSelectConfig",function(e,t,n){return e.errorOnUnhandledRejections(!1),n.spinnerClass="fa fa-refresh ui-select-spin",s("undefined"!=typeof MathJax&&null!==MathJax?MathJax.Hub:void 0,(function(e){return e.Config({messageStyle:"none",imageFont:null,"HTML-CSS":{availableFonts:["TeX"],scale:110,matchFontHeight:!1},TeX:{equationNumbers:{autoNumber:"AMS"},useLabelIDs:!1},skipStartupTypeset:!0,tex2jax:{processEscapes:!0,inlineMath:[["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]]}})}))}]);e.run(["$templateCache",function(e){return e.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="fa fa-times" aria-hidden="true"></i></a></span></div>')}]);var t=null!=s(null!=window.location?window.location.search:void 0,(function(e){return e.match(/debug=true/)})),n=null;return window.sl_debugging=t,window.sl_console={log:function(){if(t){var e;n=null;for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=console).log.apply(e,o(Array.from(i||[])))}},logOnce:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var s;if(t&&r[0]!==n)return n=r[0],(s=console).log.apply(s,o(Array.from(r||[])))}},e}.apply(t,r))||(e.exports=i)},,,,function(e,t,n){(function(e){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var e=function(){return this}();e||"undefined"==typeof window||(e=window);var t=function e(t,n,r){"string"==typeof t?(2==arguments.length&&(r=n),e.modules[t]||(e.payloads[t]=r,e.modules[t]=null)):e.original?e.original.apply(this,arguments):(console.error("dropping module because define wasn't a string."),console.trace())};t.modules={},t.payloads={};var n,r,i=function(e,t,n){if("string"==typeof t){var r=s(e,t);if(null!=r)return n&&n(),r}else if("[object Array]"===Object.prototype.toString.call(t)){for(var i=[],a=0,l=t.length;a<l;++a){var c=s(e,t[a]);if(null==c&&o.original)return;i.push(c)}return n&&n.apply(null,i)||!0}},o=function e(t,n){var r=i("",t,n);return null==r&&e.original?e.original.apply(this,arguments):r},s=function(e,n){n=function e(t,n){if(-1!==n.indexOf("!")){var r=n.split("!");return e(t,r[0])+"!"+e(t,r[1])}if("."==n.charAt(0))for(n=t.split("/").slice(0,-1).join("/")+"/"+n;-1!==n.indexOf(".")&&i!=n;){var i=n;n=n.replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}return n}(e,n);var r=t.modules[n];if(!r){if("function"==typeof(r=t.payloads[n])){var o={},s={id:n,uri:"",exports:o,packaged:!0};o=r((function(e,t){return i(n,e,t)}),o,s)||s.exports,t.modules[n]=o,delete t.payloads[n]}r=t.modules[n]=o||r}return r};r=e,(n="ace")&&(e[n]||(e[n]={}),r=e[n]),r.define&&r.define.packaged||(t.original=r.define,r.define=t,r.define.packaged=!0),r.require&&r.require.packaged||(o.original=r.require,r.require=o,r.require.packaged=!0)}(),ace.define("ace/lib/regexp",[],(function(e,t,n){"use strict";var r,i={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},o=void 0===i.exec.call(/()??/,"")[1],s=(r=/^/g,i.test.call(r,""),!r.lastIndex);function a(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}function l(e,t,n){if(Array.prototype.indexOf)return e.indexOf(t,n);for(var r=n||0;r<e.length;r++)if(e[r]===t)return r;return-1}s&&o||(RegExp.prototype.exec=function(e){var t,n,r=i.exec.apply(this,arguments);if("string"==typeof e&&r){if(!o&&r.length>1&&l(r,"")>-1&&(n=RegExp(this.source,i.replace.call(a(this),"g","")),i.replace.call(e.slice(r.index),n,(function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(r[e]=void 0)}))),this._xregexp&&this._xregexp.captureNames)for(var c=1;c<r.length;c++)(t=this._xregexp.captureNames[c-1])&&(r[t]=r[c]);!s&&this.global&&!r[0].length&&this.lastIndex>r.index&&this.lastIndex--}return r},s||(RegExp.prototype.test=function(e){var t=i.exec.call(this,e);return t&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--,!!t}))})),ace.define("ace/lib/es5-shim",[],(function(e,t,n){function i(){}Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError("Function.prototype.bind called on incompatible "+t);var n=f.call(arguments,1),r=function r(){if(this instanceof r){var i=t.apply(this,n.concat(f.call(arguments)));return Object(i)===i?i:this}return t.apply(e,n.concat(f.call(arguments)))};return t.prototype&&(i.prototype=t.prototype,r.prototype=new i,i.prototype=null),r});var o,s,a,l,c,u=Function.prototype.call,h=Array.prototype,d=Object.prototype,f=h.slice,p=u.bind(d.toString),g=u.bind(d.hasOwnProperty);if((c=g(d,"__defineGetter__"))&&(o=u.bind(d.__defineGetter__),s=u.bind(d.__defineSetter__),a=u.bind(d.__lookupGetter__),l=u.bind(d.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t,n=[];if(n.splice.apply(n,e(20)),n.splice.apply(n,e(26)),t=n.length,n.splice(5,0,"XXX"),n.length,t+1==n.length)return!0}()){var m=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?m.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(f.call(arguments,2))):[]}}else Array.prototype.splice=function(e,t){var n=this.length;e>0?e>n&&(e=n):null==e?e=0:e<0&&(e=Math.max(n+e,0)),e+t<n||(t=n-e);var r=this.slice(e,e+t),i=f.call(arguments,2),o=i.length;if(e===n)o&&this.push.apply(this,i);else{var s=Math.min(t,n-e),a=e+s,l=a+o-s,c=n-a,u=n-s;if(l<a)for(var h=0;h<c;++h)this[l+h]=this[a+h];else if(l>a)for(h=c;h--;)this[l+h]=this[a+h];if(o&&e===u)this.length=u,this.push.apply(this,i);else for(this.length=u+o,h=0;h<o;++h)this[e+h]=i[h]}return r};Array.isArray||(Array.isArray=function(e){return"[object Array]"==p(e)});var v,y,b=Object("a"),w="a"!=b[0]||!(0 in b);if(Array.prototype.forEach||(Array.prototype.forEach=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=arguments[1],i=-1,o=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError;for(;++i<o;)i in n&&e.call(r,n[i],i,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0,i=Array(r),o=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var s=0;s<r;s++)s in n&&(i[s]=e.call(o,n[s],s,t));return i}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,n=P(this),r=w&&"[object String]"==p(this)?this.split(""):n,i=r.length>>>0,o=[],s=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var a=0;a<i;a++)a in r&&(t=r[a],e.call(s,t,a,n)&&o.push(t));return o}),Array.prototype.every||(Array.prototype.every=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0,i=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var o=0;o<r;o++)if(o in n&&!e.call(i,n[o],o,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0,i=arguments[1];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var o=0;o<r;o++)if(o in n&&e.call(i,n[o],o,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,o=0;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in n){i=n[o++];break}if(++o>=r)throw new TypeError("reduce of empty array with no initial value")}for(;o<r;o++)o in n&&(i=e.call(void 0,i,n[o],o,t));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=P(this),n=w&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i,o=r-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(o in n){i=n[o--];break}if(--o<0)throw new TypeError("reduceRight of empty array with no initial value")}do{o in this&&(i=e.call(void 0,i,n[o],o,t))}while(o--);return i}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var t=w&&"[object String]"==p(this)?this.split(""):P(this),n=t.length>>>0;if(!n)return-1;var r=0;for(arguments.length>1&&(r=L(arguments[1])),r=r>=0?r:Math.max(0,n+r);r<n;r++)if(r in t&&t[r]===e)return r;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var t=w&&"[object String]"==p(this)?this.split(""):P(this),n=t.length>>>0;if(!n)return-1;var r=n-1;for(arguments.length>1&&(r=Math.min(r,L(arguments[1]))),r=r>=0?r:n-Math.abs(r);r>=0;r--)if(r in t&&e===t[r])return r;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:d)}),!Object.getOwnPropertyDescriptor){Object.getOwnPropertyDescriptor=function(e,t){if("object"!=r(e)&&"function"!=typeof e||null===e)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+e);if(g(e,t)){var n;if(n={enumerable:!0,configurable:!0},c){var i=e.__proto__;e.__proto__=d;var o=a(e,t),s=l(e,t);if(e.__proto__=i,o||s)return o&&(n.get=o),s&&(n.set=s),n}return n.value=e[t],n}}}(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),Object.create)||(v=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(e,t){var n;if(null===e)n=v();else{if("object"!=r(e))throw new TypeError("typeof prototype["+r(e)+"] != 'object'");var i=function(){};i.prototype=e,(n=new i).__proto__=e}return void 0!==t&&Object.defineProperties(n,t),n});function _(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(e){}}if(Object.defineProperty){var C=_({}),S="undefined"==typeof document||_(document.createElement("div"));if(!C||!S)var k=Object.defineProperty}if(!Object.defineProperty||k){Object.defineProperty=function(e,t,n){if("object"!=r(e)&&"function"!=typeof e||null===e)throw new TypeError("Object.defineProperty called on non-object: "+e);if("object"!=r(n)&&"function"!=typeof n||null===n)throw new TypeError("Property description must be an object: "+n);if(k)try{return k.call(Object,e,t,n)}catch(e){}if(g(n,"value"))if(c&&(a(e,t)||l(e,t))){var i=e.__proto__;e.__proto__=d,delete e[t],e[t]=n.value,e.__proto__=i}else e[t]=n.value;else{if(!c)throw new TypeError("getters & setters can not be defined on this javascript engine");g(n,"get")&&o(e,t,n.get),g(n,"set")&&s(e,t,n.set)}return e}}Object.defineProperties||(Object.defineProperties=function(e,t){for(var n in t)g(t,n)&&Object.defineProperty(e,n,t[n]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze((function(){}))}catch(e){Object.freeze=(y=Object.freeze,function(e){return"function"==typeof e?e:y(e)})}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)===e)throw new TypeError;for(var t="";g(e,t);)t+="?";e[t]=!0;var n=g(e,t);return delete e[t],n}),!Object.keys){var A=!0,x=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$=x.length;for(var T in{toString:null})A=!1;Object.keys=function(e){if("object"!=r(e)&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var t=[];for(var n in e)g(e,n)&&t.push(n);if(A)for(var i=0,o=$;i<o;i++){var s=x[i];g(e,s)&&t.push(s)}return t}}Date.now||(Date.now=function(){return(new Date).getTime()});var E="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||E.trim()){E="["+E+"]";var R=new RegExp("^"+E+E+"*"),M=new RegExp(E+E+"*$");String.prototype.trim=function(){return String(this).replace(R,"").replace(M,"")}}function L(e){return(e=+e)!=e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}var P=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}})),ace.define("ace/lib/fixoldbrowsers",[],(function(e,t,n){"use strict";e("./regexp"),e("./es5-shim"),"undefined"==typeof Element||Element.prototype.remove||Object.defineProperty(Element.prototype,"remove",{enumerable:!1,writable:!0,configurable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),ace.define("ace/lib/useragent",[],(function(e,t,n){"use strict";t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS};var i="object"==("undefined"==typeof navigator?"undefined":r(navigator))?navigator:{},o=(/mac|win|linux/i.exec(i.platform)||["other"])[0].toLowerCase(),s=i.userAgent||"",a=i.appName||"";t.isWin="win"==o,t.isMac="mac"==o,t.isLinux="linux"==o,t.isIE="Microsoft Internet Explorer"==a||a.indexOf("MSAppHost")>=0?parseFloat((s.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((s.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=s.match(/ Gecko\/\d+/),t.isOpera="object"==("undefined"==typeof opera?"undefined":r(opera))&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(s.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(s.split(" Chrome/")[1])||void 0,t.isEdge=parseFloat(s.split(" Edge/")[1])||void 0,t.isAIR=s.indexOf("AdobeAIR")>=0,t.isIPad=s.indexOf("iPad")>=0,t.isAndroid=s.indexOf("Android")>=0,t.isChromeOS=s.indexOf(" CrOS ")>=0,t.isIOS=/iPad|iPhone|iPod/.test(s)&&!window.MSStream,t.isIOS&&(t.isMac=!0),t.isMobile=t.isIPad||t.isAndroid})),ace.define("ace/lib/dom",[],(function(e,t,n){"use strict";var i=e("./useragent");if(t.buildDom=function e(t,n,i){if("string"==typeof t&&t){var o=document.createTextNode(t);return n&&n.appendChild(o),o}if(!Array.isArray(t))return t;if("string"!=typeof t[0]||!t[0]){for(var s=[],a=0;a<t.length;a++){var l=e(t[a],n,i);l&&s.push(l)}return s}var c=document.createElement(t[0]),u=t[1],h=1;u&&"object"==r(u)&&!Array.isArray(u)&&(h=2);for(a=h;a<t.length;a++)e(t[a],c,i);return 2==h&&Object.keys(u).forEach((function(e){var t=u[e];"class"===e?c.className=Array.isArray(t)?t.join(" "):t:"function"==typeof t||"value"==e?c[e]=t:"ref"===e?i&&(i[t]=c):null!=t&&c.setAttribute(e,t)})),n&&n.appendChild(c),c},t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||"http://www.w3.org/1999/xhtml",e):document.createElement(e)},t.removeChildren=function(e){e.innerHTML=""},t.createTextNode=function(e,t){return(t?t.ownerDocument:document).createTextNode(e)},t.createFragment=function(e){return(e?e.ownerDocument:document).createDocumentFragment()},t.hasCssClass=function(e,t){return-1!==(e.className+"").split(/\s+/g).indexOf(t)},t.addCssClass=function(e,n){t.hasCssClass(e,n)||(e.className+=" "+n)},t.removeCssClass=function(e,t){for(var n=e.className.split(/\s+/g);;){var r=n.indexOf(t);if(-1==r)break;n.splice(r,1)}e.className=n.join(" ")},t.toggleCssClass=function(e,t){for(var n=e.className.split(/\s+/g),r=!0;;){var i=n.indexOf(t);if(-1==i)break;r=!1,n.splice(i,1)}return r&&n.push(t),e.className=n.join(" "),r},t.setCssClass=function(e,n,r){r?t.addCssClass(e,n):t.removeCssClass(e,n)},t.hasCssString=function(e,t){var n,r=0;if(n=(t=t||document).querySelectorAll("style"))for(;r<n.length;)if(n[r++].id===e)return!0},t.importCssString=function(e,n,r){var i=r;r&&r.getRootNode&&(i=r.getRootNode())&&i!=r||(i=document);var o=i.ownerDocument||i;if(n&&t.hasCssString(n,i))return null;n&&(e+="\n/*# sourceURL=ace/css/"+n+" */");var s=t.createElement("style");s.appendChild(o.createTextNode(e)),n&&(s.id=n),i==o&&(i=t.getDocumentHead(o)),i.insertBefore(s,i.firstChild)},t.importCssStylsheet=function(e,n){t.buildDom(["link",{rel:"stylesheet",href:e}],t.getDocumentHead(n))},t.scrollbarWidth=function(e){var n=t.createElement("ace_inner");n.style.width="100%",n.style.minWidth="0px",n.style.height="200px",n.style.display="block";var r=t.createElement("ace_outer"),i=r.style;i.position="absolute",i.left="-10000px",i.overflow="hidden",i.width="200px",i.minWidth="0px",i.height="150px",i.display="block",r.appendChild(n);var o=e.documentElement;o.appendChild(r);var s=n.offsetWidth;i.overflow="scroll";var a=n.offsetWidth;return s==a&&(a=r.clientWidth),o.removeChild(r),s-a},"undefined"==typeof document&&(t.importCssString=function(){}),t.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},t.setStyle=function(e,t,n){e[t]!==n&&(e[t]=n)},t.HAS_CSS_ANIMATION=!1,t.HAS_CSS_TRANSFORMS=!1,t.HI_DPI=!i.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,"undefined"!=typeof document){var o=document.createElement("div");t.HI_DPI&&void 0!==o.style.transform&&(t.HAS_CSS_TRANSFORMS=!0),i.isEdge||void 0===o.style.animationName||(t.HAS_CSS_ANIMATION=!0),o=null}t.HAS_CSS_TRANSFORMS?t.translate=function(e,t,n){e.style.transform="translate("+Math.round(t)+"px, "+Math.round(n)+"px)"}:t.translate=function(e,t,n){e.style.top=Math.round(n)+"px",e.style.left=Math.round(t)+"px"}})),ace.define("ace/lib/oop",[],(function(e,t,n){"use strict";t.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},t.mixin=function(e,t){for(var n in t)e[n]=t[n];return e},t.implement=function(e,n){t.mixin(e,n)}})),ace.define("ace/lib/keys",[],(function(e,t,n){"use strict";var r=e("./oop"),i=function(){var e,t,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(t in n.FUNCTION_KEYS)e=n.FUNCTION_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);for(t in n.PRINTABLE_KEYS)e=n.PRINTABLE_KEYS[t].toLowerCase(),n[e]=parseInt(t,10);return r.mixin(n,n.MODIFIER_KEYS),r.mixin(n,n.PRINTABLE_KEYS),r.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,n[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)n.KEY_MODS[t]=e.filter((function(e){return t&n.KEY_MODS[e]})).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();r.mixin(t,i),t.keyCodeToString=function(e){var t=i[e];return"string"!=typeof t&&(t=String.fromCharCode(e)),t.toLowerCase()}})),ace.define("ace/lib/event",[],(function(e,t,n){"use strict";var i=e("./keys"),o=e("./useragent"),s=null,a=0;t.addListener=function(e,t,n){if(e.addEventListener)return e.addEventListener(t,n,!1);if(e.attachEvent){var r=function(){n.call(e,window.event)};n._wrapper=r,e.attachEvent("on"+t,r)}},t.removeListener=function(e,t,n){if(e.removeEventListener)return e.removeEventListener(t,n,!1);e.detachEvent&&e.detachEvent("on"+t,n._wrapper||n)},t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||o.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},t.capture=function(e,n,r){function i(e){n&&n(e),r&&r(e),t.removeListener(document,"mousemove",n,!0),t.removeListener(document,"mouseup",i,!0),t.removeListener(document,"dragstart",i,!0)}return t.addListener(document,"mousemove",n,!0),t.addListener(document,"mouseup",i,!0),t.addListener(document,"dragstart",i,!0),i},t.addMouseWheelListener=function(e,n){"onmousewheel"in e?t.addListener(e,"mousewheel",(function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),n(e)})):"onwheel"in e?t.addListener(e,"wheel",(function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}n(e)})):t.addListener(e,"DOMMouseScroll",(function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),n(e)}))},t.addMultiMouseDownListener=function(e,n,r,i){var s,a,l,c=0,u={2:"dblclick",3:"tripleclick",4:"quadclick"};function h(e){if(0!==t.getButton(e)?c=0:e.detail>1?++c>4&&(c=1):c=1,o.isIE){var h=Math.abs(e.clientX-s)>5||Math.abs(e.clientY-a)>5;l&&!h||(c=1),l&&clearTimeout(l),l=setTimeout((function(){l=null}),n[c-1]||600),1==c&&(s=e.clientX,a=e.clientY)}if(e._clicks=c,r[i]("mousedown",e),c>4)c=0;else if(c>1)return r[i](u[c],e)}function d(e){c=2,l&&clearTimeout(l),l=setTimeout((function(){l=null}),n[c-1]||600),r[i]("mousedown",e),r[i](u[c],e)}Array.isArray(e)||(e=[e]),e.forEach((function(e){t.addListener(e,"mousedown",h),o.isOldIE&&t.addListener(e,"dblclick",d)}))};var l=!o.isMac||!o.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};function c(e,t,n){var r=l(t);if(!o.isMac&&s){if(t.getModifierState&&(t.getModifierState("OS")||t.getModifierState("Win"))&&(r|=8),s.altGr){if(3==(3&r))return;s.altGr=0}if(18===n||17===n){var c="location"in t?t.location:t.keyLocation;if(17===n&&1===c)1==s[n]&&(a=t.timeStamp);else if(18===n&&3===r&&2===c){t.timeStamp-a<50&&(s.altGr=!0)}}}if((n in i.MODIFIER_KEYS&&(n=-1),8&r&&n>=91&&n<=93&&(n=-1),!r&&13===n)&&(3===(c="location"in t?t.location:t.keyLocation)&&(e(t,r,-n),t.defaultPrevented)))return;if(o.isChromeOS&&8&r){if(e(t,r,n),t.defaultPrevented)return;r&=-9}return!!(r||n in i.FUNCTION_KEYS||n in i.PRINTABLE_KEYS)&&e(t,r,n)}function u(){s=Object.create(null)}if(t.getModifierString=function(e){return i.KEY_MODS[l(e)]},t.addCommandKeyListener=function(e,n){var r=t.addListener;if(o.isOldGecko||o.isOpera&&!("KeyboardEvent"in window)){var i=null;r(e,"keydown",(function(e){i=e.keyCode})),r(e,"keypress",(function(e){return c(n,e,i)}))}else{var a=null;r(e,"keydown",(function(e){s[e.keyCode]=(s[e.keyCode]||0)+1;var t=c(n,e,e.keyCode);return a=e.defaultPrevented,t})),r(e,"keypress",(function(e){a&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),a=null)})),r(e,"keyup",(function(e){s[e.keyCode]=null})),s||(u(),r(window,"focus",u))}},"object"==("undefined"==typeof window?"undefined":r(window))&&window.postMessage&&!o.isOldIE){var h=1;t.nextTick=function(e,n){n=n||window;var r="zero-timeout-message-"+h++;t.addListener(n,"message",(function i(o){o.data==r&&(t.stopPropagation(o),t.removeListener(n,"message",i),e())})),n.postMessage(r,"*")}}t.$idleBlocked=!1,t.onIdle=function(e,n){return setTimeout((function n(){t.$idleBlocked?setTimeout(n,100):e()}),n)},t.$idleBlockId=null,t.blockIdle=function(e){t.$idleBlockId&&clearTimeout(t.$idleBlockId),t.$idleBlocked=!0,t.$idleBlockId=setTimeout((function(){t.$idleBlocked=!1}),e||100)},t.nextFrame="object"==("undefined"==typeof window?"undefined":r(window))&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}})),ace.define("ace/range",[],(function(e,t,n){"use strict";var i=function(e,t,n,r){this.start={row:e,column:t},this.end={row:n,column:r}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,n=e.end,r=e.start;return 1==(t=this.compare(n.row,n.column))?1==(t=this.compare(r.row,r.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(r.row,r.column))?-1:1==t?42:0},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==r(e)?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==r(e)?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},this.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},this.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var n={row:t+1,column:0};else if(this.end.row<e)n={row:e,column:0};if(this.start.row>t)var r={row:t+1,column:0};else if(this.start.row<e)r={row:e,column:0};return i.fromPoints(r||this.start,n||this.end)},this.extend=function(e,t){var n=this.compare(e,t);if(0==n)return this;if(-1==n)var r={row:e,column:t};else var o={row:e,column:t};return i.fromPoints(r||this.start,o||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return i.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),n=e.documentToScreenPosition(this.end);return new i(t.row,t.column,n.row,n.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(i.prototype),i.fromPoints=function(e,t){return new i(e.row,e.column,t.row,t.column)},i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},i.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=i})),ace.define("ace/lib/lang",[],(function(e,t,n){"use strict";t.last=function(e){return e[e.length-1]},t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>=1)&&(e+=e);return n};var i=/^\s\s*/,o=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(i,"")},t.stringTrimRight=function(e){return e.replace(o,"")},t.copyObject=function(e){var t={};for(var n in e)t[n]=e[n];return t},t.copyArray=function(e){for(var t=[],n=0,i=e.length;n<i;n++)e[n]&&"object"==r(e[n])?t[n]=this.copyObject(e[n]):t[n]=e[n];return t},t.deepCopy=function e(t){if("object"!==r(t)||!t)return t;var n;if(Array.isArray(t)){n=[];for(var i=0;i<t.length;i++)n[i]=e(t[i]);return n}if("[object Object]"!==Object.prototype.toString.call(t))return t;for(var i in n={},t)n[i]=e(t[i]);return n},t.arrayToMap=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var n in e)t[n]=e[n];return t},t.arrayRemove=function(e,t){for(var n=0;n<=e.length;n++)t===e[n]&&e.splice(n,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return(""+e).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var n=[];return e.replace(t,(function(e){n.push({offset:arguments[arguments.length-2],length:e.length})})),n},t.deferredCall=function(e){var t=null,n=function(){t=null,e()},r=function e(r){return e.cancel(),t=setTimeout(n,r||0),e};return r.schedule=r,r.call=function(){return this.cancel(),e(),r},r.cancel=function(){return clearTimeout(t),t=null,r},r.isPending=function(){return t},r},t.delayedCall=function(e,t){var n=null,r=function(){n=null,e()},i=function(e){null==n&&(n=setTimeout(r,e||t))};return i.delay=function(e){n&&clearTimeout(n),n=setTimeout(r,e||t)},i.schedule=i,i.call=function(){this.cancel(),e()},i.cancel=function(){n&&clearTimeout(n),n=null},i.isPending=function(){return n},i}})),ace.define("ace/keyboard/textinput",[],(function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),o=e("../lib/dom"),s=e("../lib/lang"),a=i.isChrome<18,l=i.isIE,c=i.isChrome>63,u=e("../lib/keys"),h=u.KEY_MODS,d=i.isIOS,f=d?/\s/:/\n/;t.TextInput=function(e,t){var n=o.createElement("textarea");n.className="ace_text-input",n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck",!1),n.style.opacity="0",e.insertBefore(n,e.firstChild);var p=!1,g=!1,m=!1,v=!1,y="";i.isMobile||(n.style.fontSize="1px");var b=!1,w=!1,_="",C=0,S=0;try{var k=document.activeElement===n}catch(e){}r.addListener(n,"blur",(function(e){w||(t.onBlur(e),k=!1)})),r.addListener(n,"focus",(function(e){if(!w){if(k=!0,i.isEdge)try{if(!document.hasFocus())return}catch(e){}t.onFocus(e),i.isEdge?setTimeout(A):A()}})),this.$focusScroll=!1,this.focus=function(){if(y||c||"browser"==this.$focusScroll)return n.focus({preventScroll:!0});var e=n.style.top;n.style.position="fixed",n.style.top="0px";try{var t=0!=n.getBoundingClientRect().top}catch(e){return}var r=[];if(t)for(var i=n.parentElement;i&&1==i.nodeType;)r.push(i),i.setAttribute("ace_nocontext",!0),i=!i.parentElement&&i.getRootNode?i.getRootNode().host:i.parentElement;n.focus({preventScroll:!0}),t&&r.forEach((function(e){e.removeAttribute("ace_nocontext")})),setTimeout((function(){n.style.position="","0px"==n.style.top&&(n.style.top=e)}),0)},this.blur=function(){n.blur()},this.isFocused=function(){return k},t.on("beforeEndOperation",(function(){t.curOp&&"insertstring"==t.curOp.command.name||(m&&(_=n.value="",I()),A())}));var A=d?function(e){if(k&&(!p||e)&&!v){e||(e="");var r="\n ab"+e+"cde fg\n";r!=n.value&&(n.value=_=r);var i=4+(e.length||(t.selection.isEmpty()?0:1));4==C&&S==i||n.setSelectionRange(4,i),C=4,S=i}}:function(){if(!m&&!v&&(k||$)){m=!0;var e=t.selection,r=e.getRange(),i=e.cursor.row,o=r.start.column,s=r.end.column,a=t.session.getLine(i);if(r.start.row!=i){var l=t.session.getLine(i-1);o=r.start.row<i-1?0:o,s+=l.length+1,a=l+"\n"+a}else if(r.end.row!=i){var c=t.session.getLine(i+1);s=r.end.row>i+1?c.length:s,s+=a.length+1,a=a+"\n"+c}a.length>400&&(o<400&&s<400?a=a.slice(0,400):(a="\n",o=0,s=1));var u=a+"\n\n";if(u!=_&&(n.value=_=u,C=S=u.length),$&&(C=n.selectionStart,S=n.selectionEnd),S!=s||C!=o||n.selectionEnd!=S)try{n.setSelectionRange(o,s),C=o,S=s}catch(e){}m=!1}};k&&t.onFocus();var x=null;this.setInputHandler=function(e){x=e},this.getInputHandler=function(){return x};var $=!1,T=function(e,r){if($&&($=!1),g)return A(),e&&t.onPaste(e),g=!1,"";for(var i=n.selectionStart,o=n.selectionEnd,s=C,a=_.length-S,l=e,c=e.length-i,u=e.length-o,h=0;s>0&&_[h]==e[h];)h++,s--;for(l=l.slice(h),h=1;a>0&&_.length-h>C-1&&_[_.length-h]==e[e.length-h];)h++,a--;return c-=h-1,u-=h-1,l=l.slice(0,l.length-h+1),r||c!=l.length||s||a||u?(v=!0,l&&!s&&!a&&!c&&!u||b?t.onTextInput(l):t.onTextInput(l,{extendLeft:s,extendRight:a,restoreStart:c,restoreEnd:u}),v=!1,_=e,C=i,S=o,l):""},E=function(e){if(m)return D();var t=n.value,r=T(t,!0);(t.length>500||f.test(r))&&A()},R=function e(t,n,r){var i=t.clipboardData||window.clipboardData;if(i&&!a){var o=l||r?"Text":"text/plain";try{return n?!1!==i.setData(o,n):i.getData(o)}catch(t){if(!r)return e(t,n,!0)}}},M=function(e,i){var o=t.getCopyText();if(!o)return r.preventDefault(e);R(e,o)?(d&&(A(o),p=o,setTimeout((function(){p=!1}),10)),i?t.onCut():t.onCopy(),r.preventDefault(e)):(p=!0,n.value=o,n.select(),setTimeout((function(){p=!1,A(),i?t.onCut():t.onCopy()})))},L=function(e){M(e,!0)},P=function(e){M(e,!1)},O=function(e){var o=R(e);"string"==typeof o?(o&&t.onPaste(o,e),i.isIE&&setTimeout(A),r.preventDefault(e)):(n.value="",g=!0)};r.addCommandKeyListener(n,t.onCommandKey.bind(t)),r.addListener(n,"select",(function(e){m||(p?p=!1:function(e){return 0===e.selectionStart&&e.selectionEnd>=_.length&&e.value===_&&_&&e.selectionEnd!==S}(n)&&(t.selectAll(),A()))})),r.addListener(n,"input",E),r.addListener(n,"cut",L),r.addListener(n,"copy",P),r.addListener(n,"paste",O),"oncut"in n&&"oncopy"in n&&"onpaste"in n||r.addListener(e,"keydown",(function(e){if((!i.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:P(e);break;case 86:O(e);break;case 88:L(e)}}));var D=function(){if(m&&t.onCompositionUpdate&&!t.$readOnly){if(b)return F();if(m.useTextareaForIME)t.onCompositionUpdate(n.value);else{var e=n.value;T(e),m.markerRange&&(m.context&&(m.markerRange.start.column=m.selectionStart=m.context.compositionStartOffset),m.markerRange.end.column=m.markerRange.start.column+S-m.selectionStart)}}},I=function(e){t.onCompositionEnd&&!t.$readOnly&&(m=!1,t.onCompositionEnd(),t.off("mousedown",F),e&&E())};function F(){w=!0,n.blur(),n.focus(),w=!1}var j,N=s.delayedCall(D,50).schedule.bind(null,null);function B(){clearTimeout(j),j=setTimeout((function(){y&&(n.style.cssText=y,y=""),t.renderer.$isMousePressed=!1,t.renderer.$keepTextAreaAtCursor&&t.renderer.$moveTextAreaToCursor()}),0)}r.addListener(n,"compositionstart",(function(e){if(!m&&t.onCompositionStart&&!t.$readOnly&&(m={},!b)){setTimeout(D,0),t.on("mousedown",F);var r=t.getSelectionRange();r.end.row=r.start.row,r.end.column=r.start.column,m.markerRange=r,m.selectionStart=C,t.onCompositionStart(m),m.useTextareaForIME?(n.value="",_="",C=0,S=0):(n.msGetInputContext&&(m.context=n.msGetInputContext()),n.getInputContext&&(m.context=n.getInputContext()))}})),r.addListener(n,"compositionupdate",D),r.addListener(n,"keyup",(function(e){27==e.keyCode&&n.value.length<n.selectionStart&&(m||(_=n.value),C=S=-1,A()),N()})),r.addListener(n,"keydown",N),r.addListener(n,"compositionend",I),this.getElement=function(){return n},this.setCommandMode=function(e){b=e,n.readOnly=!1},this.setReadOnly=function(e){b||(n.readOnly=e)},this.setCopyWithEmptySelection=function(e){e},this.onContextMenu=function(e){$=!0,A(),t._emit("nativecontextmenu",{target:t,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(e,s){y||(y=n.style.cssText),n.style.cssText=(s?"z-index:100000;":"")+(i.isIE?"opacity:0.1;":"")+"text-indent: -"+(C+S)*t.renderer.characterWidth*.5+"px;";var a=t.container.getBoundingClientRect(),l=o.computedStyle(t.container),c=a.top+(parseInt(l.borderTopWidth)||0),u=a.left+(parseInt(a.borderLeftWidth)||0),h=a.bottom-c-n.clientHeight-2,d=function(e){o.translate(n,e.clientX-u-2,Math.min(e.clientY-c-2,h))};d(e),"mousedown"==e.type&&(t.renderer.$isMousePressed=!0,clearTimeout(j),i.isWin&&r.capture(t.container,d,B))},this.onContextMenuClose=B;var H=function(e){t.textInput.onContextMenu(e),B()};r.addListener(n,"mouseup",H),r.addListener(n,"mousedown",(function(e){e.preventDefault(),B()})),r.addListener(t.renderer.scroller,"contextmenu",H),r.addListener(n,"contextmenu",H),d&&function(e,t,n){var r=null,i=!1;n.addEventListener("keydown",(function(e){r&&clearTimeout(r),i=!0}),!0),n.addEventListener("keyup",(function(e){r=setTimeout((function(){i=!1}),100)}),!0);var o=function(e){if(document.activeElement===n&&!(i||m||t.$mouseHandler.isMousePressed||p)){var r=n.selectionStart,o=n.selectionEnd,s=null,a=0;console.log(r,o),0==r?s=u.up:1==r?s=u.home:o>S&&"\n"==_[o]?s=u.end:r<C&&" "==_[r-1]?(s=u.left,a=h.option):r<C||r==C&&S!=C&&r==o?s=u.left:o>S&&_.slice(0,o).split("\n").length>2?s=u.down:o>S&&" "==_[o-1]?(s=u.right,a=h.option):(o>S||o==S&&S!=C&&r==o)&&(s=u.right),r!==o&&(a|=h.shift),s&&(t.onCommandKey(null,a,s),C=r,S=o,A(""))}};document.addEventListener("selectionchange",o),t.on("destroy",(function(){document.removeEventListener("selectionchange",o)}))}(0,t,n)}})),ace.define("ace/mouse/default_handlers",[],(function(e,t,n){"use strict";var r=e("../lib/useragent");function i(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach((function(t){e[t]=this[t]}),this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function o(e,t){if(e.start.row==e.end.row)var n=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)n=2*t.row-e.start.row-e.end.row;else var n=t.column-4;return n<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}(function(){this.onMouseDown=function(e){var t=e.inSelection(),n=e.getDocumentPosition();this.mousedownEvent=e;var i=this.editor,o=e.getButton();return 0!==o?((i.getSelectionRange().isEmpty()||1==o)&&i.selection.moveToPosition(n),void(2==o&&(i.textInput.onContextMenu(e.domEvent),r.isMozilla||e.preventDefault()))):(this.mousedownEvent.time=Date.now(),!t||i.isFocused()||(i.focus(),!this.$focusTimeout||this.$clickSelection||i.inMultiSelectMode)?(this.captureMouse(e),this.startSelect(n,e.domEvent._clicks>1),e.preventDefault()):(this.setState("focusWait"),void this.captureMouse(e)))},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var n=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?n.selection.selectToPosition(e):t||n.selection.moveToPosition(e),t||this.select(),n.renderer.scroller.setCapture&&n.renderer.scroller.setCapture(),n.setStyle("ace_selecting"),this.setState("select"))},this.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(n);if(-1==r)e=this.$clickSelection.end;else if(1==r)e=this.$clickSelection.start;else{var i=o(this.$clickSelection,n);n=i.cursor,e=i.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,n=this.editor,r=n.renderer.screenToTextCoordinates(this.x,this.y),i=n.selection[e](r.row,r.column);if(this.$clickSelection){var s=this.$clickSelection.comparePoint(i.start),a=this.$clickSelection.comparePoint(i.end);if(-1==s&&a<=0)t=this.$clickSelection.end,i.end.row==r.row&&i.end.column==r.column||(r=i.start);else if(1==a&&s>=0)t=this.$clickSelection.start,i.start.row==r.row&&i.start.column==r.column||(r=i.end);else if(-1==s&&1==a)r=i.end,t=i.start;else{var l=o(this.$clickSelection,r);r=l.cursor,t=l.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(r),n.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e,t,n,r,i=(e=this.mousedownEvent.x,t=this.mousedownEvent.y,n=this.x,r=this.y,Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))),o=Date.now();(i>0||o-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),n=this.editor,r=n.session.getBracketRange(t);r?(r.isEmpty()&&(r.start.column--,r.end.column++),this.setState("select")):(r=n.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=r,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),n=this.editor;this.setState("selectByLines");var r=n.getSelectionRange();r.isMultiLine()&&r.contains(t.row,t.column)?(this.$clickSelection=n.selection.getLineRange(r.start.row),this.$clickSelection.end=n.selection.getLineRange(r.end.row).end):this.$clickSelection=n.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var n=this.$lastScroll,r=e.domEvent.timeStamp,i=r-n.t,o=i?e.wheelX/i:n.vx,s=i?e.wheelY/i:n.vy;i<550&&(o=(o+n.vx)/2,s=(s+n.vy)/2);var a=Math.abs(o/s),l=!1;if(a>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(l=!0),a<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(l=!0),l)n.allowed=r;else if(r-n.allowed<550){Math.abs(o)<=1.5*Math.abs(n.vx)&&Math.abs(s)<=1.5*Math.abs(n.vy)?(l=!0,n.allowed=r):n.allowed=0}return n.t=r,n.vx=o,n.vy=s,l?(t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(i.prototype),t.DefaultHandlers=i})),ace.define("ace/tooltip",[],(function(e,t,n){"use strict";e("./lib/oop");var r=e("./lib/dom");function i(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}(function(){this.$init=function(){return this.$element=r.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){this.getElement().textContent=e},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(e){r.addCssClass(this.getElement(),e)},this.show=function(e,t,n){null!=e&&this.setText(e),null!=t&&null!=n&&this.setPosition(t,n),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(i.prototype),t.Tooltip=i})),ace.define("ace/mouse/default_gutter_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/oop"),o=e("../lib/event"),s=e("../tooltip").Tooltip;function a(e){s.call(this,e)}i.inherits(a,s),function(){this.setPosition=function(e,t){var n=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,i=this.getWidth(),o=this.getHeight();(e+=15)+i>n&&(e-=e+i-n),(t+=15)+o>r&&(t-=20+o),s.prototype.setPosition.call(this,e,t)}}.call(a.prototype),t.GutterHandler=function(e){var t,n,i,s=e.editor,l=s.renderer.$gutterLayer,c=new a(s.container);function u(){t&&(t=clearTimeout(t)),i&&(c.hide(),i=null,s._signal("hideGutterTooltip",c),s.removeEventListener("mousewheel",u))}function h(e){c.setPosition(e.x,e.y)}e.editor.setDefaultHandler("guttermousedown",(function(t){if(s.isFocused()&&0==t.getButton()&&"foldWidgets"!=l.getRegion(t)){var n=t.getDocumentPosition().row,r=s.session.selection;if(t.getShiftKey())r.selectTo(n,0);else{if(2==t.domEvent.detail)return s.selectAll(),t.preventDefault();e.$clickSelection=s.selection.getLineRange(n)}return e.setState("selectByLines"),e.captureMouse(t),t.preventDefault()}})),e.editor.setDefaultHandler("guttermousemove",(function(o){var a=o.domEvent.target||o.domEvent.srcElement;if(r.hasCssClass(a,"ace_fold-widget"))return u();i&&e.$tooltipFollowsMouse&&h(o),n=o,t||(t=setTimeout((function(){t=null,n&&!e.isMousePressed?function(){var t=n.getDocumentPosition().row,r=l.$annotations[t];if(!r)return u();if(t==s.session.getLength()){var o=s.renderer.pixelToScreenCoordinates(0,n.y).row,a=n.$pos;if(o>s.session.documentToScreenRow(a.row,a.column))return u()}if(i!=r)if(i=r.text.join("<br/>"),c.setHtml(i),c.show(),s._signal("showGutterTooltip",c),s.on("mousewheel",u),e.$tooltipFollowsMouse)h(n);else{var d=n.domEvent.target.getBoundingClientRect(),f=c.getElement().style;f.left=d.right+"px",f.top=d.bottom+"px"}}():u()}),50))})),o.addListener(s.renderer.$gutter,"mouseout",(function(e){n=null,i&&!t&&(t=setTimeout((function(){t=null,u()}),50))})),s.on("changeSession",u)}})),ace.define("ace/mouse/mouse_event",[],(function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),o=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){r.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){r.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor.getSelectionRange();if(e.isEmpty())this.$inSelection=!1;else{var t=this.getDocumentPosition();this.$inSelection=e.contains(t.row,t.column)}return this.$inSelection},this.getButton=function(){return r.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=i.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(o.prototype)})),ace.define("ace/mouse/dragdrop_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/event"),o=e("../lib/useragent"),s=200,a=200,l=5;function c(e){var t=e.editor,n=r.createElement("img");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",o.isOpera&&(n.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach((function(t){e[t]=this[t]}),this),t.addEventListener("mousedown",this.onMouseDown.bind(e));var c,h,d,f,p,g,m,v,y,b,w,_=t.container,C=0;function S(){var e=g;(function(e,n){var r=Date.now(),i=!n||e.row!=n.row,o=!n||e.column!=n.column;!b||i||o?(t.moveCursorToPosition(e),b=r,w={x:h,y:d}):u(w.x,w.y,h,d)>l?b=null:r-b>=a&&(t.renderer.scrollCursorIntoView(),b=null)})(g=t.renderer.screenToTextCoordinates(h,d),e),function(e,n){var r=Date.now(),i=t.renderer.layerConfig.lineHeight,o=t.renderer.layerConfig.characterWidth,a=t.renderer.scroller.getBoundingClientRect(),l={x:{left:h-a.left,right:a.right-h},y:{top:d-a.top,bottom:a.bottom-d}},c=Math.min(l.x.left,l.x.right),u=Math.min(l.y.top,l.y.bottom),f={row:e.row,column:e.column};c/o<=2&&(f.column+=l.x.left<l.x.right?-3:2),u/i<=1&&(f.row+=l.y.top<l.y.bottom?-1:1);var p=e.row!=f.row,g=e.column!=f.column,m=!n||e.row!=n.row;p||g&&!m?y?r-y>=s&&t.renderer.scrollCursorIntoView(f):y=r:y=null}(g,e)}function k(){p=t.selection.toOrientedRange(),c=t.session.addMarker(p,"ace_selection",t.getSelectionStyle()),t.clearSelection(),t.isFocused()&&t.renderer.$cursorLayer.setBlinking(!1),clearInterval(f),S(),f=setInterval(S,20),C=0,i.addListener(document,"mousemove",$)}function A(){clearInterval(f),t.session.removeMarker(c),c=null,t.selection.fromOrientedRange(p),t.isFocused()&&!v&&t.$resetCursorStyle(),p=null,g=null,C=0,y=null,b=null,i.removeListener(document,"mousemove",$)}this.onDragStart=function(e){if(this.cancelDrag||!_.draggable){var r=this;return setTimeout((function(){r.startSelect(),r.captureMouse(e)}),0),e.preventDefault()}p=t.getSelectionRange();var i=e.dataTransfer;i.effectAllowed=t.getReadOnly()?"copy":"copyMove",o.isOpera&&(t.container.appendChild(n),n.scrollTop=0),i.setDragImage&&i.setDragImage(n,0,0),o.isOpera&&t.container.removeChild(n),i.clearData(),i.setData("Text",t.session.getTextRange()),v=!0,this.setState("drag")},this.onDragEnd=function(e){if(_.draggable=!1,v=!1,this.setState(null),!t.getReadOnly()){var n=e.dataTransfer.dropEffect;m||"move"!=n||t.session.remove(t.getSelectionRange()),t.$resetCursorStyle()}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!t.getReadOnly()&&T(e.dataTransfer))return h=e.clientX,d=e.clientY,c||k(),C++,e.dataTransfer.dropEffect=m=E(e),i.preventDefault(e)},this.onDragOver=function(e){if(!t.getReadOnly()&&T(e.dataTransfer))return h=e.clientX,d=e.clientY,c||(k(),C++),null!==x&&(x=null),e.dataTransfer.dropEffect=m=E(e),i.preventDefault(e)},this.onDragLeave=function(e){if(--C<=0&&c)return A(),m=null,i.preventDefault(e)},this.onDrop=function(e){if(g){var n=e.dataTransfer;if(v)switch(m){case"move":p=p.contains(g.row,g.column)?{start:g,end:g}:t.moveText(p,g);break;case"copy":p=t.moveText(p,g,!0)}else{var r=n.getData("Text");p={start:g,end:t.session.insert(g,r)},t.focus(),m=null}return A(),i.preventDefault(e)}},i.addListener(_,"dragstart",this.onDragStart.bind(e)),i.addListener(_,"dragend",this.onDragEnd.bind(e)),i.addListener(_,"dragenter",this.onDragEnter.bind(e)),i.addListener(_,"dragover",this.onDragOver.bind(e)),i.addListener(_,"dragleave",this.onDragLeave.bind(e)),i.addListener(_,"drop",this.onDrop.bind(e));var x=null;function $(){null==x&&(x=setTimeout((function(){null!=x&&c&&A()}),20))}function T(e){var t=e.types;return!t||Array.prototype.some.call(t,(function(e){return"text/plain"==e||"Text"==e}))}function E(e){var t=["copy","copymove","all","uninitialized"],n=o.isMac?e.altKey:e.ctrlKey,r="uninitialized";try{r=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var i="none";return n&&t.indexOf(r)>=0?i="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(r)>=0?i="move":t.indexOf(r)>=0&&(i="copy"),i}}function u(e,t,n,r){return Math.sqrt(Math.pow(n-e,2)+Math.pow(r-t,2))}(function(){this.dragWait=function(){Date.now()-this.mousedownEvent.time>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){this.editor.container.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.$resetCursorStyle(),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor;e.container.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var t=o.isWin?"default":"move";e.renderer.setCursorStyle(t),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;o.isIE&&"dragReady"==this.state&&(u(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>3&&t.dragDrop());"dragWait"===this.state&&(u(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y)>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition())))},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),r=e.getButton();if(1===(e.domEvent.detail||1)&&0===r&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var i=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in i&&(i.unselectable="on"),t.getDragDelay()){if(o.isWebKit)this.cancelDrag=!0,t.container.draggable=!0;this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(c.prototype),t.DragdropHandler=c})),ace.define("ace/mouse/touch_handler",[],(function(e,t,n){"use strict";var r=e("./mouse_event").MouseEvent;t.addTouchListeners=function(e,t){var n,i,o,s,a,l,c,u,h="scroll",d=0,f=0,p=0,g=0;function m(){a=null,clearTimeout(a),t.selection.isEmpty()&&t.selection.moveToPosition(c),h="wait"}e.addEventListener("contextmenu",(function(e){u&&t.textInput.getElement().focus()})),e.addEventListener("touchstart",(function(e){var l=e.touches;if(a||l.length>1)return clearTimeout(a),a=null,void(h="zoom");u=t.$mouseHandler.isMousePressed=!0;var v=l[0];n=v.clientX,i=v.clientY,p=g=0,e.clientX=v.clientX,e.clientY=v.clientY;var y=e.timeStamp;s=y;var b=new r(e,t);if(c=b.getDocumentPosition(),y-o<500&&1==l.length&&!d)f++,e.preventDefault(),e.button=0,function(){a=null,clearTimeout(a),t.selection.moveToPosition(c);var e=f>=2?t.selection.getLineRange(c.row):t.session.getBracketRange(c);e&&!e.isEmpty()?t.selection.setRange(e):t.selection.selectWord(),h="wait"}();else{f=0,a=setTimeout(m,450);var w=t.selection.cursor,_=t.selection.isEmpty()?w:t.selection.anchor,C=t.renderer.$cursorLayer.getPixelPosition(w,!0),S=t.renderer.$cursorLayer.getPixelPosition(_,!0),k=t.renderer.scroller.getBoundingClientRect(),A=t.renderer.layerConfig.lineHeight,x=t.renderer.layerConfig.lineHeight,$=function(e,t){return(e/=x)*e+(t=t/A-.75)*t},T=$(e.clientX-k.left-C.left,e.clientY-k.top-C.top),E=$(e.clientX-k.left-S.left,e.clientY-k.top-S.top);T<3.5&&E<3.5&&(h=T>E?"cursor":"anchor"),h=E<3.5?"anchor":T<3.5?"cursor":"scroll"}o=y})),e.addEventListener("touchend",(function(e){u=t.$mouseHandler.isMousePressed=!1,l&&clearInterval(l),"zoom"==h?(h="",d=0):a?(t.selection.moveToPosition(c),d=0):"scroll"==h&&(d+=60,l=setInterval((function(){d--<=0&&(clearInterval(l),l=null),Math.abs(p)<.01&&(p=0),Math.abs(g)<.01&&(g=0),d<20&&(p*=.9),d<20&&(g*=.9),t.renderer.scrollBy(10*p,10*g)}),10),e.preventDefault()),clearTimeout(a),a=null})),e.addEventListener("touchmove",(function(e){a&&(clearTimeout(a),a=null);var o=e.touches;if(!(o.length>1||"zoom"==h)){var l=o[0],c=n-l.clientX,u=i-l.clientY;if("wait"==h){if(!(c*c+u*u>4))return e.preventDefault();h="cursor"}n=l.clientX,i=l.clientY,e.clientX=l.clientX,e.clientY=l.clientY;var d=e.timeStamp,f=d-s;if(s=d,"scroll"==h){var m=new r(e,t);m.speed=1,m.wheelX=c,m.wheelY=u,10*Math.abs(c)<Math.abs(u)&&(c=0),10*Math.abs(u)<Math.abs(c)&&(u=0),0!=f&&(p=c/f,g=u/f),t._emit("mousewheel",m),m.propagationStopped||(p=g=0)}else{var v=new r(e,t).getDocumentPosition();"cursor"==h?t.selection.moveCursorToPosition(v):"anchor"==h&&t.selection.setSelectionAnchor(v.row,v.column),t.renderer.scrollCursorIntoView(v),e.preventDefault()}}}))}})),ace.define("ace/lib/net",[],(function(e,t,n){"use strict";var r=e("./dom");t.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.onreadystatechange=function(){4===n.readyState&&t(n.responseText)},n.send(null)},t.loadScript=function(e,t){var n=r.getDocumentHead(),i=document.createElement("script");i.src=e,n.appendChild(i),i.onload=i.onreadystatechange=function(e,n){!n&&i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(i=i.onload=i.onreadystatechange=null,n||t())}},t.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}})),ace.define("ace/lib/event_emitter",[],(function(e,t,n){"use strict";var i={},o=function(){this.propagationStopped=!0},s=function(){this.defaultPrevented=!0};i._emit=i._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var n=this._eventRegistry[e]||[],i=this._defaultHandlers[e];if(n.length||i){"object"==r(t)&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=o),t.preventDefault||(t.preventDefault=s),n=n.slice();for(var a=0;a<n.length&&(n[a](t,this),!t.propagationStopped);a++);return i&&!t.defaultPrevented?i(t,this):void 0}},i._signal=function(e,t){var n=(this._eventRegistry||{})[e];if(n){n=n.slice();for(var r=0;r<n.length;r++)n[r](t,this)}},i.once=function(e,t){var n=this;if(this.addEventListener(e,(function r(){n.removeEventListener(e,r),t.apply(null,arguments)})),!t)return new Promise((function(e){t=e}))},i.setDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n||(n=this._defaultHandlers={_disabled_:{}}),n[e]){var r=n[e],i=n._disabled_[e];i||(n._disabled_[e]=i=[]),i.push(r);var o=i.indexOf(t);-1!=o&&i.splice(o,1)}n[e]=t},i.removeDefaultHandler=function(e,t){var n=this._defaultHandlers;if(n){var r=n._disabled_[e];if(n[e]==t)r&&this.setDefaultHandler(e,r.pop());else if(r){var i=r.indexOf(t);-1!=i&&r.splice(i,1)}}},i.on=i.addEventListener=function(e,t,n){this._eventRegistry=this._eventRegistry||{};var r=this._eventRegistry[e];return r||(r=this._eventRegistry[e]=[]),-1==r.indexOf(t)&&r[n?"unshift":"push"](t),t},i.off=i.removeListener=i.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},i.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=i})),ace.define("ace/lib/app_config",[],(function(e,t,n){var i=e("./oop"),o=e("./event_emitter").EventEmitter,s={setOptions:function(e){Object.keys(e).forEach((function(t){this.setOption(t,e[t])}),this)},getOptions:function(e){var t={};if(e)Array.isArray(e)||(t=e,e=Object.keys(t));else{var n=this.$options;e=Object.keys(n).filter((function(e){return!n[e].hidden}))}return e.forEach((function(e){t[e]=this.getOption(e)}),this),t},setOption:function(e,t){if(this["$"+e]!==t){var n=this.$options[e];if(!n)return a('misspelled option "'+e+'"');if(n.forwardTo)return this[n.forwardTo]&&this[n.forwardTo].setOption(e,t);n.handlesSet||(this["$"+e]=t),n&&n.set&&n.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:a('misspelled option "'+e+'"')}};function a(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function l(e,t){var n=new Error(e);n.data=t,"object"==("undefined"==typeof console?"undefined":r(console))&&console.error&&console.error(n),setTimeout((function(){throw n}))}var c=function(){this.$defaultOptions={}};(function(){i.implement(this,o),this.defineOptions=function(e,t,n){return e.$options||(this.$defaultOptions[t]=e.$options={}),Object.keys(n).forEach((function(t){var r=n[t];"string"==typeof r&&(r={forwardTo:r}),r.name||(r.name=t),e.$options[r.name]=r,"initialValue"in r&&(e["$"+r.name]=r.initialValue)})),i.implement(e,s),this},this.resetOptions=function(e){Object.keys(e.$options).forEach((function(t){var n=e.$options[t];"value"in n&&e.setOption(t,n.value)}))},this.setDefaultValue=function(e,t,n){if(!e){for(e in this.$defaultOptions)if(this.$defaultOptions[e][t])break;if(!this.$defaultOptions[e][t])return!1}var r=this.$defaultOptions[e]||(this.$defaultOptions[e]={});r[t]&&(r.forwardTo?this.setDefaultValue(r.forwardTo,t,n):r[t].value=n)},this.setDefaultValues=function(e,t){Object.keys(t).forEach((function(n){this.setDefaultValue(e,n,t[n])}),this)},this.warn=a,this.reportError=l}).call(c.prototype),t.AppConfig=c})),ace.define("ace/config",[],(function(e,t,r){var i=e("./lib/lang"),o=(e("./lib/oop"),e("./lib/net")),s=e("./lib/app_config").AppConfig;r.exports=t=new s;var a=function(){return this||"undefined"!=typeof window&&window}(),l={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0,sharedPopups:!1};t.get=function(e){if(!l.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return l[e]},t.set=function(e,t){if(l.hasOwnProperty(e))l[e]=t;else if(0==this.setDefaultValue("",e,t))throw new Error("Unknown config key: "+e)},t.all=function(){return i.copyObject(l)},t.$modes={},t.moduleUrl=function(e,t){if(l.$moduleUrls[e])return l.$moduleUrls[e];var n=e.split("/"),r="snippets"==(t=t||n[n.length-2]||"")?"/":"-",i=n[n.length-1];if("worker"==t&&"-"==r){var o=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");i=i.replace(o,"")}(!i||i==t)&&n.length>1&&(i=n[n.length-2]);var s=l[t+"Path"];return null==s?s=l.basePath:"/"==r&&(t=r=""),s&&"/"!=s.slice(-1)&&(s+="/"),s+t+r+i+this.get("suffix")},t.setModuleUrl=function(e,t){return l.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(n,r){var i,s;Array.isArray(n)&&(s=n[0],n=n[1]);try{i=e(n)}catch(e){}if(i&&!t.$loading[n])return r&&r(i);if(t.$loading[n]||(t.$loading[n]=[]),t.$loading[n].push(r),!(t.$loading[n].length>1)){var a=function(){e([n],(function(e){t._emit("load.module",{name:n,module:e});var r=t.$loading[n];t.$loading[n]=null,r.forEach((function(t){t&&t(e)}))}))};if(!t.get("packaged"))return a();o.loadScript(t.moduleUrl(n,s),a),c()}};var c=function(){l.basePath||l.workerPath||l.modePath||l.themePath||Object.keys(l.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),c=function(){})};function u(i){if(a&&a.document){l.packaged=i||e.packaged||r.packaged||a.define&&n(23).packaged;for(var o,s={},c="",u=document.currentScript||document._currentScript,h=(u&&u.ownerDocument||document).getElementsByTagName("script"),d=0;d<h.length;d++){var f=h[d],p=f.src||f.getAttribute("src");if(p){for(var g=f.attributes,m=0,v=g.length;m<v;m++){var y=g[m];0===y.name.indexOf("data-ace-")&&(s[(o=y.name.replace(/^data-ace-/,""),o.replace(/-(.)/g,(function(e,t){return t.toUpperCase()})))]=y.value)}var b=p.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);b&&(c=b[1])}}for(var w in c&&(s.base=s.base||c,s.packaged=!0),s.basePath=s.base,s.workerPath=s.workerPath||s.base,s.modePath=s.modePath||s.base,s.themePath=s.themePath||s.base,delete s.base,s)void 0!==s[w]&&t.set(w,s[w])}}u(!0),t.init=u,t.version="1.4.5"})),ace.define("ace/mouse/mouse_handler",[],(function(e,t,n){"use strict";var r=e("../lib/event"),i=e("../lib/useragent"),o=e("./default_handlers").DefaultHandlers,s=e("./default_gutter_handler").GutterHandler,a=e("./mouse_event").MouseEvent,l=e("./dragdrop_handler").DragdropHandler,c=e("./touch_handler").addTouchListeners,u=e("../config"),h=function(e){var t=this;this.editor=e,new o(this),new s(this),new l(this);var n=function(t){(!document.hasFocus||!document.hasFocus()||!e.isFocused()&&document.activeElement==(e.textInput&&e.textInput.getElement()))&&window.focus(),e.focus()},a=e.renderer.getMouseEventTarget();r.addListener(a,"click",this.onMouseEvent.bind(this,"click")),r.addListener(a,"mousemove",this.onMouseMove.bind(this,"mousemove")),r.addMultiMouseDownListener([a,e.renderer.scrollBarV&&e.renderer.scrollBarV.inner,e.renderer.scrollBarH&&e.renderer.scrollBarH.inner,e.textInput&&e.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),r.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel")),c(e.container,e);var u=e.renderer.$gutter;r.addListener(u,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),r.addListener(u,"click",this.onMouseEvent.bind(this,"gutterclick")),r.addListener(u,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),r.addListener(u,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),r.addListener(a,"mousedown",n),r.addListener(u,"mousedown",n),i.isIE&&e.renderer.scrollBarV&&(r.addListener(e.renderer.scrollBarV.element,"mousedown",n),r.addListener(e.renderer.scrollBarH.element,"mousedown",n)),e.on("mousemove",(function(n){if(!t.state&&!t.$dragDelay&&t.$dragEnabled){var r=e.renderer.screenToTextCoordinates(n.x,n.y),i=e.session.selection.getRange(),o=e.renderer;!i.isEmpty()&&i.insideStart(r.row,r.column)?o.setCursorStyle("default"):o.setCursorStyle("")}}))};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new a(t,this.editor))},this.onMouseMove=function(e,t){var n=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;n&&n.length&&this.editor._emit(e,new a(t,this.editor))},this.onMouseWheel=function(e,t){var n=new a(t,this.editor);n.speed=2*this.$scrollSpeed,n.wheelX=t.wheelX,n.wheelY=t.wheelY,this.editor._emit(e,n)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){this.x=e.x,this.y=e.y,this.isMousePressed=!0;var n=this.editor,o=this.editor.renderer;o.$isMousePressed=!0;var s=this,l=function(e){if(e){if(i.isWebKit&&!e.which&&s.releaseMouse)return s.releaseMouse();s.x=e.clientX,s.y=e.clientY,t&&t(e),s.mouseEvent=new a(e,s.editor),s.$mouseMoved=!0}},c=function(e){n.off("beforeEndOperation",h),clearInterval(d),u(),s[s.state+"End"]&&s[s.state+"End"](e),s.state="",s.isMousePressed=o.$isMousePressed=!1,o.$keepTextAreaAtCursor&&o.$moveTextAreaToCursor(),s.$onCaptureMouseMove=s.releaseMouse=null,e&&s.onMouseEvent("mouseup",e),n.endOperation()},u=function(){s[s.state]&&s[s.state](),s.$mouseMoved=!1};if(i.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout((function(){c(e)}));var h=function(e){s.releaseMouse&&n.curOp.command.name&&n.curOp.selectionChanged&&(s[s.state+"End"]&&s[s.state+"End"](),s.state="",s.releaseMouse())};n.on("beforeEndOperation",h),n.startOperation({command:{name:"mouse"}}),s.$onCaptureMouseMove=l,s.releaseMouse=r.capture(this.editor.container,l,c);var d=setInterval(u,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var e=function(t){t&&t.domEvent&&"contextmenu"!=t.domEvent.type||(this.editor.off("nativecontextmenu",e),t&&t.domEvent&&r.stopEvent(t.domEvent))}.bind(this);setTimeout(e,10),this.editor.on("nativecontextmenu",e)}}).call(h.prototype),u.defineOptions(h.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:i.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),t.MouseHandler=h})),ace.define("ace/mouse/fold_handler",[],(function(e,t,n){"use strict";var r=e("../lib/dom");t.FoldHandler=function(e){e.on("click",(function(t){var n=t.getDocumentPosition(),i=e.session,o=i.getFoldAt(n.row,n.column,1);o&&(t.getAccelKey()?i.removeFold(o):i.expandFold(o),t.stop());var s=t.domEvent&&t.domEvent.target;s&&r.hasCssClass(s,"ace_inline_button")&&r.hasCssClass(s,"ace_toggle_wrap")&&(i.setOption("wrap",!i.getUseWrapMode()),e.renderer.scrollCursorIntoView())})),e.on("gutterclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,r=e.session;r.foldWidgets&&r.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}})),e.on("gutterdblclick",(function(t){if("foldWidgets"==e.renderer.$gutterLayer.getRegion(t)){var n=t.getDocumentPosition().row,r=e.session,i=r.getParentFoldRangeData(n,!0),o=i.range||i.firstRange;if(o){n=o.start.row;var s=r.getFoldAt(n,r.getLine(n).length,1);s?r.removeFold(s):(r.addFold("...",o),e.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}t.stop()}}))}})),ace.define("ace/keyboard/keybinding",[],(function(e,t,n){"use strict";var r=e("../lib/keys"),i=e("../lib/event"),o=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var n=this.$handlers.indexOf(e);-1!=n&&this.$handlers.splice(n,1),null==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==n&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map((function(n){return n.getStatusText&&n.getStatusText(t,e)||""})).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,t,n,r){for(var o,s=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((o=this.$handlers[l].handleKeyboard(this.$data,e,t,n,r))&&o.command&&((s="null"==o.command||a.exec(o.command,this.$editor,o.args,r))&&r&&-1!=e&&1!=o.passEvent&&1!=o.command.passEvent&&i.stopEvent(r),s)););return s||-1!=e||(o={command:"insertstring"},s=a.exec("insertstring",this.$editor,t)),s&&this.$editor._signal&&this.$editor._signal("keyboardActivity",o),s},this.onCommandKey=function(e,t,n){var i=r.keyCodeToString(n);this.$callKeyboardHandlers(t,i,n,e)},this.onTextInput=function(e){this.$callKeyboardHandlers(-1,e)}}).call(o.prototype),t.KeyBinding=o})),ace.define("ace/lib/bidiutil",[],(function(e,t,n){"use strict";var r=0,i=0,o=!1,s=!1,a=!1,l=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],c=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],u=1,h=0,d=1,f=2,p=3,g=4,m=5,v=6,y=7,b=8,w=9,_=10,C=11,S=12,k=13,A=14,x=15,$=16,T=17,E=18,R=[E,E,E,E,E,E,E,E,E,v,m,v,b,m,E,E,E,E,E,E,E,E,E,E,E,E,E,E,m,m,m,v,b,g,g,C,C,C,g,g,g,g,g,_,w,_,w,w,f,f,f,f,f,f,f,f,f,f,w,g,g,g,g,g,g,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,g,g,g,g,g,g,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,g,g,g,g,E,E,E,E,E,E,m,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,w,g,C,C,C,C,g,g,g,g,h,g,g,E,g,g,C,C,f,f,g,h,g,g,g,f,h,g,g,g,g,g],M=[b,b,b,b,b,b,b,b,b,b,b,E,E,E,h,d,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,b,m,k,A,x,$,T,w,C,C,C,C,C,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,w,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,b];function L(e,t,n){if(!(i<e))if(1!=e||r!=u||s)for(var o,a,l,c,h=n.length,d=0;d<h;){if(t[d]>=e){for(o=d+1;o<h&&t[o]>=e;)o++;for(a=d,l=o-1;a<l;a++,l--)c=n[a],n[a]=n[l],n[l]=c;d=o}d++}else n.reverse()}function P(e,t,n,i){var l,c,u,R,M=t[i];switch(M){case h:case d:o=!1;case g:case p:return M;case f:return o?p:f;case y:return o=!0,!0,d;case b:return g;case w:return i<1||i+1>=t.length||(l=n[i-1])!=f&&l!=p||(c=t[i+1])!=f&&c!=p?g:(o&&(c=p),c==l?c:g);case _:return(l=i>0?n[i-1]:m)==f&&i+1<t.length&&t[i+1]==f?f:g;case C:if(i>0&&n[i-1]==f)return f;if(o)return g;for(R=i+1,u=t.length;R<u&&t[R]==C;)R++;return R<u&&t[R]==f?f:g;case S:for(u=t.length,R=i+1;R<u&&t[R]==S;)R++;if(R<u){var L=e[i],P=L>=1425&&L<=2303||64286==L;if(l=t[R],P&&(l==d||l==y))return d}return i<1||(l=t[i-1])==m?g:n[i-1];case m:return o=!1,s=!0,r;case v:return a=!0,g;case k:case A:case $:case T:case x:o=!1;case E:return g}}function O(e){var t=e.charCodeAt(0),n=t>>8;return 0==n?t>191?h:R[t]:5==n?/[\u0591-\u05f4]/.test(e)?d:h:6==n?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?S:/[\u0660-\u0669\u066b-\u066c]/.test(e)?p:1642==t?C:/[\u06f0-\u06f9]/.test(e)?f:y:32==n&&t<=8287?M[255&t]:254==n&&t>=65136?y:g}t.L=h,t.R=d,t.EN=f,t.ON_R=3,t.AN=4,t.R_H=5,t.B=6,t.RLE=7,t.DOT="·",t.doBidiReorder=function(e,n,h){if(e.length<2)return{};var f=e.split(""),w=new Array(f.length),_=new Array(f.length),C=[];r=h?u:0,function(e,t,n,u){var h=r?c:l,d=null,f=null,p=null,g=0,y=null,w=-1,_=null,C=null,S=[];if(!u)for(_=0,u=[];_<n;_++)u[_]=O(e[_]);for(i=r,o=!1,!1,s=!1,a=!1,C=0;C<n;C++){if(d=g,S[C]=f=P(e,u,S,C),y=240&(g=h[d][f]),g&=15,t[C]=p=h[g][5],y>0)if(16==y){for(_=w;_<C;_++)t[_]=1;w=-1}else w=-1;if(h[g][6])-1==w&&(w=C);else if(w>-1){for(_=w;_<C;_++)t[_]=p;w=-1}u[C]==m&&(t[C]=0),i|=p}if(a)for(_=0;_<n;_++)if(u[_]==v){t[_]=r;for(var k=_-1;k>=0&&u[k]==b;k--)t[k]=r}}(f,C,f.length,n);for(var S=0;S<w.length;w[S]=S,S++);L(2,C,w),L(1,C,w);for(S=0;S<w.length-1;S++)n[S]===p?C[S]=t.AN:C[S]===d&&(n[S]>y&&n[S]<k||n[S]===g||n[S]===E)?C[S]=t.ON_R:S>0&&"ل"===f[S-1]&&/\u0622|\u0623|\u0625|\u0627/.test(f[S])&&(C[S-1]=C[S]=t.R_H,S++);f[f.length-1]===t.DOT&&(C[f.length-1]=t.B),"‫"===f[0]&&(C[0]=t.RLE);for(S=0;S<w.length;S++)_[S]=C[w[S]];return{logicalFromVisual:w,bidiLevels:_}},t.hasBidiCharacters=function(e,t){for(var n=!1,r=0;r<e.length;r++)t[r]=O(e.charAt(r)),n||t[r]!=d&&t[r]!=y&&t[r]!=p||(n=!0);return n},t.getVisualFromLogicalIdx=function(e,t){for(var n=0;n<t.logicalFromVisual.length;n++)if(t.logicalFromVisual[n]==e)return n;return 0}})),ace.define("ace/bidihandler",[],(function(e,t,n){"use strict";var r=e("./lib/bidiutil"),i=e("./lib/lang"),o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,s=function(e){this.session=e,this.bidiMap={},this.currentRow=null,this.bidiUtil=r,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=o.test(e.getValue())};(function(){this.isBidiRow=function(e,t,n){return!!this.seenBidi&&(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,n),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(e){this.seenBidi?this.currentRow=null:"insert"==e.action&&o.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var n=this.session.$getRowCacheIndex(t,this.currentRow);n>=0&&(e=this.session.$docRowCache[n])}return e},this.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length)for(var n,r=this.session.$getRowCacheIndex(t,this.currentRow);this.currentRow-e>0&&(n=this.session.$getRowCacheIndex(t,this.currentRow-e-1))===r;)r=n,e++;else e=this.currentRow;return e},this.updateRowLine=function(e,t){void 0===e&&(e=this.getDocumentRow());var n=e===this.session.getLength()-1?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(e),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var o=this.session.$wrapData[e];o&&(void 0===t&&(t=this.getSplitIndex()),t>0&&o.length?(this.wrapIndent=o.indent,this.wrapOffset=this.wrapIndent*this.charWidths[r.L],this.line=t<o.length?this.line.substring(o[t-1],o[t]):this.line.substring(o[o.length-1])):this.line=this.line.substring(0,o[t])),t==o.length&&(this.line+=this.showInvisibles?n:r.DOT)}else this.line+=this.showInvisibles?n:r.DOT;var s,a=this.session,l=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,(function(e,t){return"\t"===e||a.isFullWidth(e.charCodeAt(0))?(s="\t"===e?a.getScreenTabSize(t+l):2,l+=s-1,i.stringRepeat(r.DOT,s)):e})),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==r.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},this.updateBidiMap=function(){var e=[];r.hasBidiCharacters(this.line,e)||this.isRtlDir?this.bidiMap=r.doBidiReorder(this.line,e,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(e){if(this.characterWidth!==e.$characterSize.width){this.fontMetrics=e;var t=this.characterWidth=e.$characterSize.width,n=e.$measureCharWidth("ה");this.charWidths[r.L]=this.charWidths[r.EN]=this.charWidths[r.ON_R]=t,this.charWidths[r.R]=this.charWidths[r.AN]=n,this.charWidths[r.R_H]=.45*n,this.charWidths[r.B]=this.charWidths[r.RLE]=0,this.currentRow=null}},this.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},this.setEolChar=function(e){this.EOL=e},this.setContentWidth=function(e){this.contentWidth=e},this.isRtlLine=function(e){return!!this.$isRtl||(null!=e?this.session.getLine(e).charAt(0)==this.RLE:this.isRtlDir)},this.setRtlDirection=function(e,t){for(var n=e.getCursorPosition(),r=e.selection.getSelectionAnchor().row;r<=n.row;r++)t||e.session.getLine(r).charAt(0)!==e.session.$bidiHandler.RLE?t&&e.session.getLine(r).charAt(0)!==e.session.$bidiHandler.RLE&&e.session.doc.insert({column:0,row:r},e.session.$bidiHandler.RLE):e.session.doc.removeInLine(r,0,1)},this.getPosLeft=function(e){e-=this.wrapIndent;var t=this.line.charAt(0)===this.RLE?1:0,n=e>t?this.session.getOverwrite()?e:e-1:t,i=r.getVisualFromLogicalIdx(n,this.bidiMap),o=this.bidiMap.bidiLevels,s=0;!this.session.getOverwrite()&&e<=t&&o[i]%2!=0&&i++;for(var a=0;a<i;a++)s+=this.charWidths[o[a]];return!this.session.getOverwrite()&&e>t&&o[i]%2==0&&(s+=this.charWidths[o[i]]),this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(s+=this.rtlLineOffset),s},this.getSelections=function(e,t){var n,r=this.bidiMap,i=r.bidiLevels,o=[],s=0,a=Math.min(e,t)-this.wrapIndent,l=Math.max(e,t)-this.wrapIndent,c=!1,u=!1,h=0;this.wrapIndent&&(s+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var d,f=0;f<i.length;f++)d=r.logicalFromVisual[f],n=i[f],(c=d>=a&&d<l)&&!u?h=s:!c&&u&&o.push({left:h,width:s-h}),s+=this.charWidths[n],u=c;if(c&&f===i.length&&o.push({left:h,width:s-h}),this.isRtlDir)for(var p=0;p<o.length;p++)o[p].left+=this.rtlLineOffset;return o},this.offsetToCol=function(e){this.isRtlDir&&(e-=this.rtlLineOffset);var t=0,n=(e=Math.max(e,0),0),r=0,i=this.bidiMap.bidiLevels,o=this.charWidths[i[r]];for(this.wrapIndent&&(e-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);e>n+o/2;){if(n+=o,r===i.length-1){o=0;break}o=this.charWidths[i[++r]]}return r>0&&i[r-1]%2!=0&&i[r]%2==0?(e<n&&r--,t=this.bidiMap.logicalFromVisual[r]):r>0&&i[r-1]%2==0&&i[r]%2!=0?t=1+(e>n?this.bidiMap.logicalFromVisual[r]:this.bidiMap.logicalFromVisual[r-1]):this.isRtlDir&&r===i.length-1&&0===o&&i[r-1]%2==0||!this.isRtlDir&&0===r&&i[r]%2!=0?t=1+this.bidiMap.logicalFromVisual[r]:(r>0&&i[r-1]%2!=0&&0!==o&&r--,t=this.bidiMap.logicalFromVisual[r]),0===t&&this.isRtlDir&&t++,t+this.wrapIndent}}).call(s.prototype),t.BidiHandler=s})),ace.define("ace/selection",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/lang"),o=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",(function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),t.$isEmpty||t.$silent||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)})),this.anchor.on("change",(function(){t.$anchorChanged=!0,t.$isEmpty||t.$silent||t._emit("changeSelection")}))};(function(){r.implement(this,o),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?s.fromPoints(t,t):this.isBackwards()?s.fromPoints(t,e):s.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(e,t){var n=t?e.end:e.start,r=t?e.start:e.end;this.$setSelection(n.row,n.column,r.row,r.column)},this.$setSelection=function(e,t,n,r){var i=this.$isEmpty,o=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(n,r),this.$isEmpty=!s.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||i!=this.$isEmpty||o)&&this._emit("changeSelection")},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection((function(){this.moveCursorTo(e,t)}))},this.selectToPosition=function(e){this.$moveSelection((function(){this.moveCursorToPosition(e)}))},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(void 0===t){var n=e||this.lead;e=n.row,t=n.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var n,r="number"==typeof e?e:this.lead.row,i=this.session.getFoldLine(r);return i?(r=i.start.row,n=i.end.row):n=r,!0===t?new s(r,0,n,this.session.getLine(n).length):new s(r,0,n+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(e,t,n){var r=e.column,i=e.column+t;return n<0&&(r=e.column-t,i=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(r,i).split(" ").length-1==t},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var n=this.session.getTabSize();this.wouldMoveIntoSoftTab(t,n,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-n):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var n=this.session.getTabSize();t=this.lead;this.wouldMoveIntoSoftTab(t,n,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,n):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,n=this.session.documentToScreenRow(e,t),r=this.session.screenToDocumentPosition(n,0),i=this.session.getDisplayLine(e,null,r.row,r.column).match(/^\s*/);i[0].length==t||this.session.$useEmacsStyleLineStart||(r.column+=i[0].length),this.moveCursorToPosition(r)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var n=this.session.getLine(t.row);if(t.column==n.length){var r=n.search(/\s+$/);r>0&&(t.column=r)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var i=this.session.getFoldAt(e,t,1);if(i)this.moveCursorTo(i.end.row,i.end.column);else{if(this.session.nonTokenRe.exec(r)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,r=n.substring(t)),t>=n.length)return this.moveCursorTo(e,n.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(r)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))this.moveCursorTo(e.start.row,e.start.column);else{var r=this.session.getFoldStringAt(t,n,-1);null==r&&(r=this.doc.getLine(t).substring(0,n));var o=i.stringReverse(r);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(o)&&(n-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),n<=0)return this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(o)&&(n-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(t,n)}},this.$shortWordEndIndex=function(e){var t,n=0,r=/\s/,i=this.session.tokenRe;if(i.lastIndex=0,this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(t=e[n])&&r.test(t);)n++;if(n<1)for(i.lastIndex=0;(t=e[n])&&!i.test(t);)if(i.lastIndex=0,n++,r.test(t)){if(n>2){n--;break}for(;(t=e[n])&&r.test(t);)n++;if(n>2)break}}return i.lastIndex=0,n},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,n=this.doc.getLine(e),r=n.substring(t),i=this.session.getFoldAt(e,t,1);if(i)return this.moveCursorTo(i.end.row,i.end.column);if(t==n.length){var o=this.doc.getLength();do{e++,r=this.doc.getLine(e)}while(e<o&&/^\s*$/.test(r));/^\s+/.test(r)||(r=""),t=0}var s=this.$shortWordEndIndex(r);this.moveCursorTo(e,t+s)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(t,n,-1))return this.moveCursorTo(e.start.row,e.start.column);var r=this.session.getLine(t).substring(0,n);if(0===n){do{t--,r=this.doc.getLine(t)}while(t>0&&/^\s*$/.test(r));n=r.length,/\s+$/.test(r)||(r="")}var o=i.stringReverse(r),s=this.$shortWordEndIndex(o);return this.moveCursorTo(t,n-s)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var n,r=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===t&&(0!==e&&(this.session.$bidiHandler.isBidiRow(r.row,this.lead.row)?(n=this.session.$bidiHandler.getPosLeft(r.column),r.column=Math.round(n/this.session.$bidiHandler.charWidths[0])):n=r.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?r.column=this.$desiredColumn:this.$desiredColumn=r.column);var i=this.session.screenToDocumentPosition(r.row+e,r.column,n);0!==e&&0===t&&i.row===this.lead.row&&i.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[i.row]&&(i.row>0||e>0)&&i.row++,this.moveCursorTo(i.row,i.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,n){var r=this.session.getFoldAt(e,t,1);r&&(e=r.start.row,t=r.start.column),this.$keepDesiredColumnOnChange=!0;var i=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(i.charAt(t))&&i.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,n||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,n){var r=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(r.row,r.column,n)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var n=this.getCursor();return s.fromPoints(t,n)}catch(e){return s.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map((function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t}));else(e=this.getRange()).isBackwards=this.isBackwards();return e},this.fromJSON=function(e){if(null==e.start){if(this.rangeList&&e.length>1){this.toSingleRange(e[0]);for(var t=e.length;t--;){var n=s.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(n.cursor=n.start),this.addRange(n,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(a.prototype),t.Selection=a})),ace.define("ace/tokenizer",[],(function(e,t,n){"use strict";var r=e("./config"),i=2e3,o=function(e){for(var t in this.states=e,this.regExps={},this.matchMappings={},this.states){for(var n=this.states[t],r=[],i=0,o=this.matchMappings[t]={defaultToken:"text"},s="g",a=[],l=0;l<n.length;l++){var c=n[l];if(c.defaultToken&&(o.defaultToken=c.defaultToken),c.caseInsensitive&&(s="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,h=new RegExp("(?:("+u+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==h?c.token=c.token[0]:h-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:h-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=h>1?this.$applyToken:c.token),h>1&&(/\\\d/.test(c.regex)?u=c.regex.replace(/\\([0-9]+)/g,(function(e,t){return"\\"+(parseInt(t,10)+i+1)})):(h=1,u=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),o[i]=l,i+=h,r.push(u),c.onMatch||(c.onMatch=null)}}r.length||(o[0]=0,r.push("$")),a.forEach((function(e){e.splitRegex=this.createSplitterRegexp(e.regex,s)}),this),this.regExps[t]=new RegExp("("+r.join(")|(")+")|($)",s)}};(function(){this.$setMaxTokenCount=function(e){i=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),n=this.token.apply(this,t);if("string"==typeof n)return[{type:n,value:e}];for(var r=[],i=0,o=n.length;i<o;i++)t[i]&&(r[r.length]={type:n[i],value:t[i]});return r},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var n=[],r=this.tokenArray,i=0,o=r.length;i<o;i++)t[i+1]&&(n[n.length]={type:r[i],value:t[i+1]});return n},this.removeCapturingGroups=function(e){return e.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,(function(e,t){return t?"(?:":e}))},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var n=0,r=!1,i={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,(function(e,t,o,s,a,l){return r?r="]"!=a:a?r=!0:s?(n==i.stack&&(i.end=l+1,i.stack=-1),n--):o&&(n++,1!=o.length&&(i.stack=n,i.start=l)),e})),null!=i.end&&/^\)*$/.test(e.substr(i.end))&&(e=e.substring(0,i.start)+e.substr(i.end))}return"^"!=e.charAt(0)&&(e="^"+e),"$"!=e.charAt(e.length-1)&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var n=t.slice(0);"#tmp"===(t=n[0])&&(n.shift(),t=n.shift())}else n=[];var r=t||"start",o=this.states[r];o||(r="start",o=this.states[r]);var s=this.matchMappings[r],a=this.regExps[r];a.lastIndex=0;for(var l,c=[],u=0,h=0,d={type:null,value:""};l=a.exec(e);){var f=s.defaultToken,p=null,g=l[0],m=a.lastIndex;if(m-g.length>u){var v=e.substring(u,m-g.length);d.type==f?d.value+=v:(d.type&&c.push(d),d={type:f,value:v})}for(var y=0;y<l.length-2;y++)if(void 0!==l[y+1]){f=(p=o[s[y]]).onMatch?p.onMatch(g,r,n,e):p.token,p.next&&(r="string"==typeof p.next?p.next:p.next(r,n),(o=this.states[r])||(this.reportError("state doesn't exist",r),r="start",o=this.states[r]),s=this.matchMappings[r],u=m,(a=this.regExps[r]).lastIndex=m),p.consumeLineEnd&&(u=m);break}if(g)if("string"==typeof f)p&&!1===p.merge||d.type!==f?(d.type&&c.push(d),d={type:f,value:g}):d.value+=g;else if(f){d.type&&c.push(d),d={type:null,value:""};for(y=0;y<f.length;y++)c.push(f[y])}if(u==e.length)break;if(u=m,h++>i){for(h>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:t,line:e});u<e.length;)d.type&&c.push(d),d={value:e.substring(u,u+=500),type:"overflow"};r="start",n=[];break}}return d.type&&c.push(d),n.length>1&&n[0]!==r&&n.unshift("#tmp",r),{tokens:c,state:n.length?n:r}},this.reportError=r.reportError}).call(o.prototype),t.Tokenizer=o})),ace.define("ace/mode/text_highlight_rules",[],(function(e,t,n){"use strict";var r=e("../lib/lang"),i=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var n in e){for(var r=e[n],i=0;i<r.length;i++){var o=r[i];(o.next||o.onMatch)&&("string"==typeof o.next&&0!==o.next.indexOf(t)&&(o.next=t+o.next),o.nextState&&0!==o.nextState.indexOf(t)&&(o.nextState=t+o.nextState))}this.$rules[t+n]=r}else for(var n in e)this.$rules[n]=e[n]},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,n,i,o){var s="function"==typeof e?(new e).getRules():e;if(i)for(var a=0;a<i.length;a++)i[a]=t+i[a];else for(var l in i=[],s)i.push(t+l);if(this.addRules(s,t),n){var c=Array.prototype[o?"push":"unshift"];for(a=0;a<i.length;a++)c.apply(this.$rules[i[a]],r.deepCopy(n))}this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var n=0,r=this.$rules;Object.keys(r).forEach((function i(o){var s=r[o];s.processed=!0;for(var a=0;a<s.length;a++){var l=s[a],c=null;Array.isArray(l)&&(c=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var u=l.next||l.push;if(u&&Array.isArray(u)){var h=l.stateName;h||("string"!=typeof(h=l.token)&&(h=h[0]||""),r[h]&&(h+=n++)),r[h]=u,l.next=h,i(h)}else"pop"==u&&(l.next=t);if(l.push&&(l.nextState=l.next||l.push,l.next=e,delete l.push),l.rules)for(var d in l.rules)r[d]?r[d].push&&r[d].push.apply(r[d],l.rules[d]):r[d]=l.rules[d];var f="string"==typeof l?l:l.include;if(f&&(c=Array.isArray(f)?f.map((function(e){return r[e]})):r[f]),c){var p=[a,1].concat(c);l.noEscape&&(p=p.filter((function(e){return!e.next}))),s.splice.apply(s,p),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}),this)},this.createKeywordMapper=function(e,t,n,r){var i=Object.create(null);return Object.keys(e).forEach((function(t){var o=e[t];n&&(o=o.toLowerCase());for(var s=o.split(r||"|"),a=s.length;a--;)i[s[a]]=t})),Object.getPrototypeOf(i)&&(i.__proto__=null),this.$keywordList=Object.keys(i),e=null,n?function(e){return i[e.toLowerCase()]||t}:function(e){return i[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(i.prototype),t.TextHighlightRules=i})),ace.define("ace/mode/behaviour",[],(function(e,t,n){"use strict";var r=function(){this.$behaviours={}};(function(){this.add=function(e,t,n){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=n},this.addBehaviours=function(e){for(var t in e)for(var n in e[t])this.add(t,n,e[t][n])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var n=(new e).getBehaviours(t);else n=e.getBehaviours(t);this.addBehaviours(n)},this.getBehaviours=function(e){if(e){for(var t={},n=0;n<e.length;n++)this.$behaviours[e[n]]&&(t[e[n]]=this.$behaviours[e[n]]);return t}return this.$behaviours}}).call(r.prototype),t.Behaviour=r})),ace.define("ace/token_iterator",[],(function(e,t,n){"use strict";var r=e("./range").Range,i=function(e,t,n){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var r=e.getTokenAt(t,n);this.$tokenIndex=r?r.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,n=e[t].start;if(void 0!==n)return n;for(n=0;t>0;)n+=e[t-=1].value.length;return n},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var e=this.$rowTokens[this.$tokenIndex],t=this.getCurrentTokenColumn();return new r(this.$row,t,this.$row,t+e.value.length)}}).call(i.prototype),t.TokenIterator=i})),ace.define("ace/mode/behaviour/cstyle",[],(function(e,t,n){"use strict";var r,i=e("../../lib/oop"),o=e("../behaviour").Behaviour,s=e("../../token_iterator").TokenIterator,a=e("../../lib/lang"),l=["text","paren.rparen","punctuation.operator"],c=["text","paren.rparen","punctuation.operator","comment"],u={},h={'"':'"',"'":"'"},d=function(e){var t=-1;if(e.multiSelect&&(t=e.selection.index,u.rangeCount!=e.multiSelect.rangeCount&&(u={rangeCount:e.multiSelect.rangeCount})),u[t])return r=u[t];r=u[t]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},f=function(e,t,n,r){var i=e.end.row-e.start.row;return{text:n+t+r,selection:[0,e.start.column+1,i,e.end.column+(i?0:1)]}},p=function e(t){this.add("braces","insertion",(function(n,i,o,s,l){var c=o.getCursorPosition(),u=s.doc.getLine(c.row);if("{"==l){d(o);var h=o.getSelectionRange(),p=s.doc.getTextRange(h);if(""!==p&&"{"!==p&&o.getWrapBehavioursEnabled())return f(h,p,"{","}");if(e.isSaneInsertion(o,s))return/[\]\}\)]/.test(u[c.column])||o.inMultiSelectMode||t&&t.braces?(e.recordAutoInsert(o,s,"}"),{text:"{}",selection:[1,1]}):(e.recordMaybeInsert(o,s,"{"),{text:"{",selection:[1,1]})}else if("}"==l){if(d(o),"}"==u.substring(c.column,c.column+1))if(null!==s.$findOpeningBracket("}",{column:c.column+1,row:c.row})&&e.isAutoInsertedClosing(c,u,l))return e.popAutoInsertedClosing(),{text:"",selection:[1,1]}}else{if("\n"==l||"\r\n"==l){d(o);var g="";if(e.isMaybeInsertedClosing(c,u)&&(g=a.stringRepeat("}",r.maybeInsertedBrackets),e.clearMaybeInsertedClosing()),"}"===u.substring(c.column,c.column+1)){var m=s.findMatchingBracket({row:c.row,column:c.column+1},"}");if(!m)return null;var v=this.$getIndent(s.getLine(m.row))}else{if(!g)return void e.clearMaybeInsertedClosing();v=this.$getIndent(u)}var y=v+s.getTabString();return{text:"\n"+y+"\n"+v+g,selection:[1,y.length,1,y.length]}}e.clearMaybeInsertedClosing()}})),this.add("braces","deletion",(function(e,t,n,i,o){var s=i.doc.getTextRange(o);if(!o.isMultiLine()&&"{"==s){if(d(n),"}"==i.doc.getLine(o.start.row).substring(o.end.column,o.end.column+1))return o.end.column++,o;r.maybeInsertedBrackets--}})),this.add("parens","insertion",(function(t,n,r,i,o){if("("==o){d(r);var s=r.getSelectionRange(),a=i.doc.getTextRange(s);if(""!==a&&r.getWrapBehavioursEnabled())return f(s,a,"(",")");if(e.isSaneInsertion(r,i))return e.recordAutoInsert(r,i,")"),{text:"()",selection:[1,1]}}else if(")"==o){d(r);var l=r.getCursorPosition(),c=i.doc.getLine(l.row);if(")"==c.substring(l.column,l.column+1))if(null!==i.$findOpeningBracket(")",{column:l.column+1,row:l.row})&&e.isAutoInsertedClosing(l,c,o))return e.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("parens","deletion",(function(e,t,n,r,i){var o=r.doc.getTextRange(i);if(!i.isMultiLine()&&"("==o&&(d(n),")"==r.doc.getLine(i.start.row).substring(i.start.column+1,i.start.column+2)))return i.end.column++,i})),this.add("brackets","insertion",(function(t,n,r,i,o){if("["==o){d(r);var s=r.getSelectionRange(),a=i.doc.getTextRange(s);if(""!==a&&r.getWrapBehavioursEnabled())return f(s,a,"[","]");if(e.isSaneInsertion(r,i))return e.recordAutoInsert(r,i,"]"),{text:"[]",selection:[1,1]}}else if("]"==o){d(r);var l=r.getCursorPosition(),c=i.doc.getLine(l.row);if("]"==c.substring(l.column,l.column+1))if(null!==i.$findOpeningBracket("]",{column:l.column+1,row:l.row})&&e.isAutoInsertedClosing(l,c,o))return e.popAutoInsertedClosing(),{text:"",selection:[1,1]}}})),this.add("brackets","deletion",(function(e,t,n,r,i){var o=r.doc.getTextRange(i);if(!i.isMultiLine()&&"["==o&&(d(n),"]"==r.doc.getLine(i.start.row).substring(i.start.column+1,i.start.column+2)))return i.end.column++,i})),this.add("string_dquotes","insertion",(function(e,t,n,r,i){var o=r.$mode.$quotes||h;if(1==i.length&&o[i]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(i))return;d(n);var s=i,a=n.getSelectionRange(),l=r.doc.getTextRange(a);if(!(""===l||1==l.length&&o[l])&&n.getWrapBehavioursEnabled())return f(a,l,s,s);if(!l){var c=n.getCursorPosition(),u=r.doc.getLine(c.row),p=u.substring(c.column-1,c.column),g=u.substring(c.column,c.column+1),m=r.getTokenAt(c.row,c.column),v=r.getTokenAt(c.row,c.column+1);if("\\"==p&&m&&/escape/.test(m.type))return null;var y,b=m&&/string|escape/.test(m.type),w=!v||/string|escape/.test(v.type);if(g==s)(y=b!==w)&&/string\.end/.test(v.type)&&(y=!1);else{if(b&&!w)return null;if(b&&w)return null;var _=r.$mode.tokenRe;_.lastIndex=0;var C=_.test(p);_.lastIndex=0;var S=_.test(p);if(C||S)return null;if(g&&!/[\s;,.})\]\\]/.test(g))return null;var k=u[c.column-2];if(p==s&&(k==s||_.test(k)))return null;y=!0}return{text:y?s+s:"",selection:[1,1]}}}})),this.add("string_dquotes","deletion",(function(e,t,n,r,i){var o=r.$mode.$quotes||h,s=r.doc.getTextRange(i);if(!i.isMultiLine()&&o.hasOwnProperty(s)&&(d(n),r.doc.getLine(i.start.row).substring(i.start.column+1,i.start.column+2)==s))return i.end.column++,i}))};p.isSaneInsertion=function(e,t){var n=e.getCursorPosition(),r=new s(t,n.row,n.column);if(!this.$matchTokenType(r.getCurrentToken()||"text",l)){var i=new s(t,n.row,n.column+1);if(!this.$matchTokenType(i.getCurrentToken()||"text",l))return!1}return r.stepForward(),r.getCurrentTokenRow()!==n.row||this.$matchTokenType(r.getCurrentToken()||"text",c)},p.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},p.recordAutoInsert=function(e,t,n){var i=e.getCursorPosition(),o=t.doc.getLine(i.row);this.isAutoInsertedClosing(i,o,r.autoInsertedLineEnd[0])||(r.autoInsertedBrackets=0),r.autoInsertedRow=i.row,r.autoInsertedLineEnd=n+o.substr(i.column),r.autoInsertedBrackets++},p.recordMaybeInsert=function(e,t,n){var i=e.getCursorPosition(),o=t.doc.getLine(i.row);this.isMaybeInsertedClosing(i,o)||(r.maybeInsertedBrackets=0),r.maybeInsertedRow=i.row,r.maybeInsertedLineStart=o.substr(0,i.column)+n,r.maybeInsertedLineEnd=o.substr(i.column),r.maybeInsertedBrackets++},p.isAutoInsertedClosing=function(e,t,n){return r.autoInsertedBrackets>0&&e.row===r.autoInsertedRow&&n===r.autoInsertedLineEnd[0]&&t.substr(e.column)===r.autoInsertedLineEnd},p.isMaybeInsertedClosing=function(e,t){return r.maybeInsertedBrackets>0&&e.row===r.maybeInsertedRow&&t.substr(e.column)===r.maybeInsertedLineEnd&&t.substr(0,e.column)==r.maybeInsertedLineStart},p.popAutoInsertedClosing=function(){r.autoInsertedLineEnd=r.autoInsertedLineEnd.substr(1),r.autoInsertedBrackets--},p.clearMaybeInsertedClosing=function(){r&&(r.maybeInsertedBrackets=0,r.maybeInsertedRow=-1)},i.inherits(p,o),t.CstyleBehaviour=p})),ace.define("ace/unicode",[],(function(e,t,n){"use strict";for(var r=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],i=0,o=[],s=0;s<r.length;s+=2)o.push(i+=r[s]),r[s+1]&&o.push(45,i+=r[s+1]);t.wordChars=String.fromCharCode.apply(null,o)})),ace.define("ace/mode/text",[],(function(e,t,n){"use strict";var i=e("../config"),o=e("../tokenizer").Tokenizer,s=e("./text_highlight_rules").TextHighlightRules,a=e("./behaviour/cstyle").CstyleBehaviour,l=e("../unicode"),c=e("../lib/lang"),u=e("../token_iterator").TokenIterator,h=e("../range").Range,d=function(){this.HighlightRules=s};(function(){this.$defaultBehaviour=new a,this.tokenRe=new RegExp("^["+l.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+l.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new o(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,n,r){var i=t.doc,o=!0,s=!0,a=1/0,l=t.getTabSize(),u=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))g=this.lineCommentStart.map(c.escapeRegExp).join("|"),f=this.lineCommentStart[0];else g=c.escapeRegExp(this.lineCommentStart),f=this.lineCommentStart;g=new RegExp("^(\\s*)(?:"+g+") ?"),u=t.getUseSoftTabs();y=function(e,t){var n=e.match(g);if(n){var r=n[1].length,o=n[0].length;d(e,r,o)||" "!=n[0][o-1]||o--,i.removeInLine(t,r,o)}};var h=f+" ",d=(v=function(e,t){o&&!/\S/.test(e)||(d(e,a,a)?i.insertInLine({row:t,column:a},h):i.insertInLine({row:t,column:a},f))},b=function(e,t){return g.test(e)},function(e,t,n){for(var r=0;t--&&" "==e.charAt(t);)r++;if(r%l!=0)return!1;for(r=0;" "==e.charAt(n++);)r++;return l>2?r%l!=l-1:r%l==0})}else{if(!this.blockComment)return!1;var f=this.blockComment.start,p=this.blockComment.end,g=new RegExp("^(\\s*)(?:"+c.escapeRegExp(f)+")"),m=new RegExp("(?:"+c.escapeRegExp(p)+")\\s*$"),v=function(e,t){b(e,t)||o&&!/\S/.test(e)||(i.insertInLine({row:t,column:e.length},p),i.insertInLine({row:t,column:a},f))},y=function(e,t){var n;(n=e.match(m))&&i.removeInLine(t,e.length-n[0].length,e.length),(n=e.match(g))&&i.removeInLine(t,n[1].length,n[0].length)},b=function(e,n){if(g.test(e))return!0;for(var r=t.getTokens(n),i=0;i<r.length;i++)if("comment"===r[i].type)return!0}}function w(e){for(var t=n;t<=r;t++)e(i.getLine(t),t)}var _=1/0;w((function(e,t){var n=e.search(/\S/);-1!==n?(n<a&&(a=n),s&&!b(e,t)&&(s=!1)):_>e.length&&(_=e.length)})),a==1/0&&(a=_,o=!1,s=!1),u&&a%l!=0&&(a=Math.floor(a/l)*l),w(s?y:v)},this.toggleBlockComment=function(e,t,n,r){var i=this.blockComment;if(i){!i.start&&i[0]&&(i=i[0]);var o,s,a=(g=new u(t,r.row,r.column)).getCurrentToken(),l=(t.selection,t.selection.toOrientedRange());if(a&&/comment/.test(a.type)){for(var c,d;a&&/comment/.test(a.type);){if(-1!=(m=a.value.indexOf(i.start))){var f=g.getCurrentTokenRow(),p=g.getCurrentTokenColumn()+m;c=new h(f,p,f,p+i.start.length);break}a=g.stepBackward()}var g;for(a=(g=new u(t,r.row,r.column)).getCurrentToken();a&&/comment/.test(a.type);){var m;if(-1!=(m=a.value.indexOf(i.end))){f=g.getCurrentTokenRow(),p=g.getCurrentTokenColumn()+m;d=new h(f,p,f,p+i.end.length);break}a=g.stepForward()}d&&t.remove(d),c&&(t.remove(c),o=c.start.row,s=-i.start.length)}else s=i.start.length,o=n.start.row,t.insert(n.end,i.end),t.insert(n.start,i.start);l.start.row==o&&(l.start.column+=s),l.end.row==o&&(l.end.column+=s),t.selection.fromOrientedRange(l)}},this.getNextLineIndent=function(e,t,n){return this.$getIndent(t)},this.checkOutdent=function(e,t,n){return!1},this.autoOutdent=function(e,t,n){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){for(var t in this.$embeds=[],this.$modes={},e)if(e[t]){var n=e[t],r=n.prototype.$id,o=i.$modes[r];o||(i.$modes[r]=o=new n),i.$modes[t]||(i.$modes[t]=o),this.$embeds.push(t),this.$modes[t]=o}var s=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"];for(t=0;t<s.length;t++)!function(e){var n=s[t],r=e[n];e[s[t]]=function(){return this.$delegator(n,arguments,r)}}(this)},this.$delegator=function(e,t,n){var r=t[0]||"start";if("string"!=typeof r){if(Array.isArray(r[2])){var i=r[2][r[2].length-1];if(s=this.$modes[i])return s[e].apply(s,[r[1]].concat([].slice.call(t,1)))}r=r[0]||"start"}for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var s,a=r.split(this.$embeds[o]);if(!a[0]&&a[1])return t[0]=a[1],(s=this.$modes[this.$embeds[o]])[e].apply(s,t)}var l=n.apply(this,t);return n?l:void 0},this.transformAction=function(e,t,n,r,i){if(this.$behaviour){var o=this.$behaviour.getBehaviours();for(var s in o)if(o[s][t]){var a=o[s][t].apply(this,arguments);if(a)return a}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,n=[];for(var i in t)for(var o=t[i],s=0,a=o.length;s<a;s++)if("string"==typeof o[s].token)/keyword|support|storage/.test(o[s].token)&&n.push(o[s].regex);else if("object"===r(o[s].token))for(var l=0,c=o[s].token.length;l<c;l++)if(/keyword|support|storage/.test(o[s].token[l])){i=o[s].regex.match(/\(.+?\)/g)[l];n.push(i.substr(1,i.length-2))}this.completionKeywords=n}return e?n.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,n,r){return(this.$keywordList||this.$createKeywordList()).map((function(e){return{name:e,value:e,score:0,meta:"keyword"}}))},this.$id="ace/mode/text"}).call(d.prototype),t.Mode=d})),ace.define("ace/apply_delta",[],(function(e,t,n){"use strict";t.applyDelta=function(e,t,n){var r=t.start.row,i=t.start.column,o=e[r]||"";switch(t.action){case"insert":if(1===t.lines.length)e[r]=o.substring(0,i)+t.lines[0]+o.substring(i);else{var s=[r,1].concat(t.lines);e.splice.apply(e,s),e[r]=o.substring(0,i)+e[r],e[r+t.lines.length-1]+=o.substring(i)}break;case"remove":var a=t.end.column,l=t.end.row;r===l?e[r]=o.substring(0,i)+o.substring(a):e.splice(r,l-r+1,o.substring(0,i)+e[l].substring(a))}}})),ace.define("ace/anchor",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/event_emitter").EventEmitter,o=t.Anchor=function(e,t,n){this.$onChange=this.onChange.bind(this),this.attach(e),void 0===n?this.setPosition(t.row,t.column):this.setPosition(t,n)};(function(){function e(e,t,n){var r=n?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&r}r.implement(this,i),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(t){if(!(t.start.row==t.end.row&&t.start.row!=this.row||t.start.row>this.row)){var n=function(t,n,r){var i="insert"==t.action,o=(i?1:-1)*(t.end.row-t.start.row),s=(i?1:-1)*(t.end.column-t.start.column),a=t.start,l=i?a:t.end;if(e(n,a,r))return{row:n.row,column:n.column};if(e(l,n,!r))return{row:n.row+o,column:n.column+(n.row==l.row?s:0)};return{row:a.row,column:a.column}}(t,{row:this.row,column:this.column},this.$insertRight);this.setPosition(n.row,n.column,!0)}},this.setPosition=function(e,t,n){var r;if(r=n?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=r.row||this.column!=r.column){var i={row:this.row,column:this.column};this.row=r.row,this.column=r.column,this._signal("change",{old:i,value:r})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var n={};return e>=this.document.getLength()?(n.row=Math.max(0,this.document.getLength()-1),n.column=this.document.getLine(n.row).length):e<0?(n.row=0,n.column=0):(n.row=e,n.column=Math.min(this.document.getLine(n.row).length,Math.max(0,t))),t<0&&(n.column=0),n}}).call(o.prototype)})),ace.define("ace/document",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./apply_delta").applyDelta,o=e("./lib/event_emitter").EventEmitter,s=e("./range").Range,a=e("./anchor").Anchor,l=function(e){this.$lines=[""],0===e.length?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)};(function(){r.implement(this,o),this.setValue=function(e){var t=this.getLength()-1;this.remove(new s(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new a(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},this.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{(t=this.getLines(e.start.row,e.end.row))[0]=(t[0]||"").substring(e.start.column);var n=t.length-1;e.end.row-e.start.row==n&&(t[n]=t[n].substring(0,e.end.column))}return t},this.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},this.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},this.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},this.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},this.insertInLine=function(e,t){var n=this.clippedPos(e.row,e.column),r=this.pos(e.row,e.column+t.length);return this.applyDelta({start:n,end:r,action:"insert",lines:[t]},!0),this.clonePos(r)},this.clippedPos=function(e,t){var n=this.getLength();void 0===e?e=n:e<0?e=0:e>=n&&(e=n-1,t=void 0);var r=this.getLine(e);return null==t&&(t=r.length),{row:e,column:t=Math.min(Math.max(t,0),r.length)}},this.clonePos=function(e){return{row:e.row,column:e.column}},this.pos=function(e,t){return{row:e,column:t}},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},this.insertFullLines=function(e,t){var n=0;(e=Math.min(Math.max(e,0),this.getLength()))<this.getLength()?(t=t.concat([""]),n=0):(t=[""].concat(t),e--,n=this.$lines[e].length),this.insertMergedLines({row:e,column:n},t)},this.insertMergedLines=function(e,t){var n=this.clippedPos(e.row,e.column),r={row:n.row+t.length-1,column:(1==t.length?n.column:0)+t[t.length-1].length};return this.applyDelta({start:n,end:r,action:"insert",lines:t}),this.clonePos(r)},this.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),n=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:n,action:"remove",lines:this.getLinesForRange({start:t,end:n})}),this.clonePos(t)},this.removeInLine=function(e,t,n){var r=this.clippedPos(e,t),i=this.clippedPos(e,n);return this.applyDelta({start:r,end:i,action:"remove",lines:this.getLinesForRange({start:r,end:i})},!0),this.clonePos(r)},this.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1);var n=(t=Math.min(Math.max(0,t),this.getLength()-1))==this.getLength()-1&&e>0,r=t<this.getLength()-1,i=n?e-1:e,o=n?this.getLine(i).length:0,a=r?t+1:t,l=r?0:this.getLine(a).length,c=new s(i,o,a,l),u=this.$lines.slice(e,t+1);return this.applyDelta({start:c.start,end:c.end,action:"remove",lines:this.getLinesForRange(c)}),u},this.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},this.replace=function(e,t){return e instanceof s||(e=s.fromPoints(e.start,e.end)),0===t.length&&e.isEmpty()?e.start:t==this.getTextRange(e)?e.end:(this.remove(e),t?this.insert(e.start,t):e.start)},this.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,t){var n="insert"==e.action;(n?e.lines.length<=1&&!e.lines[0]:!s.comparePoints(e.start,e.end))||(n&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(i(this.$lines,e,t),this._signal("change",e)))},this.$splitAndapplyLargeDelta=function(e,t){for(var n=e.lines,r=n.length-t+1,i=e.start.row,o=e.start.column,s=0,a=0;s<r;s=a){a+=t-1;var l=n.slice(s,a);l.push(""),this.applyDelta({start:this.pos(i+s,o),end:this.pos(i+a,o=0),action:e.action,lines:l},!0)}e.lines=n.slice(s),e.start.row=i+s,e.start.column=o,this.applyDelta(e,!0)},this.revertDelta=function(e){this.applyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:"insert"==e.action?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){for(var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,i=t||0,o=n.length;i<o;i++)if((e-=n[i].length+r)<0)return{row:i,column:e+n[i].length+r};return{row:o-1,column:e+n[o-1].length+r}},this.positionToIndex=function(e,t){for(var n=this.$lines||this.getAllLines(),r=this.getNewLineCharacter().length,i=0,o=Math.min(e.row,n.length),s=t||0;s<o;++s)i+=n[s].length+r;return i+e.column}}).call(l.prototype),t.Document=l})),ace.define("ace/background_tokenizer",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/event_emitter").EventEmitter,o=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var n=this;this.$worker=function(){if(n.running){for(var e=new Date,t=n.currentLine,r=-1,i=n.doc,o=t;n.lines[t];)t++;var s=i.getLength(),a=0;for(n.running=!1;t<s;){n.$tokenizeRow(t),r=t;do{t++}while(n.lines[t]);if(++a%5==0&&new Date-e>20){n.running=setTimeout(n.$worker,20);break}}n.currentLine=t,-1==r&&(r=t),o<=r&&n.fireUpdateEvent(o,r)}}};(function(){r.implement(this,i),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var n={first:e,last:t};this._signal("update",{data:n})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.lines[t]=null;else if("remove"==e.action)this.lines.splice(t,n+1,null),this.states.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.lines.splice.apply(this.lines,r),this.states.splice.apply(this.states,r)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),n=this.states[e-1],r=this.tokenizer.getLineTokens(t,n,e);return this.states[e]+""!=r.state+""?(this.states[e]=r.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=r.tokens}}).call(o.prototype),t.BackgroundTokenizer=o})),ace.define("ace/search_highlight",[],(function(e,t,n){"use strict";var r=e("./lib/lang"),i=(e("./lib/oop"),e("./range").Range),o=function(e,t,n){this.setRegexp(e),this.clazz=t,this.type=n||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,n,o){if(this.regExp)for(var s=o.firstRow,a=o.lastRow,l=s;l<=a;l++){var c=this.cache[l];null==c&&((c=r.getMatchOffsets(n.getLine(l),this.regExp)).length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map((function(e){return new i(l,e.offset,l,e.offset+e.length)})),this.cache[l]=c.length?c:"");for(var u=c.length;u--;)t.drawSingleLineMarker(e,c[u].toScreenRange(n),this.clazz,o)}}}).call(o.prototype),t.SearchHighlight=o})),ace.define("ace/edit_session/fold_line",[],(function(e,t,n){"use strict";var r=e("../range").Range;function i(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var n=t[t.length-1];this.range=new r(t[0].start.row,t[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach((function(e){e.setFoldLine(this)}),this)}(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach((function(t){t.start.row+=e,t.end.row+=e}))},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort((function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)})),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,n){var r,i,o=0,s=this.folds,a=!0;null==t&&(t=this.end.row,n=this.end.column);for(var l=0;l<s.length;l++){if(-1==(i=(r=s[l]).range.compareStart(t,n)))return void e(null,t,n,o,a);if(!e(null,r.start.row,r.start.column,o,a)&&e(r.placeholder,r.start.row,r.start.column,o)||0===i)return;a=!r.sameRow,o=r.end.column}e(null,t,n,o,a)},this.getNextFoldTo=function(e,t){for(var n,r,i=0;i<this.folds.length;i++){if(-1==(r=(n=this.folds[i]).range.compareEnd(e,t)))return{fold:n,kind:"after"};if(0===r)return{fold:n,kind:"inside"}}return null},this.addRemoveChars=function(e,t,n){var r,i,o=this.getNextFoldTo(e,t);if(o)if(r=o.fold,"inside"==o.kind&&r.start.column!=t&&r.start.row!=e)window.console&&window.console.log(e,t,r);else if(r.start.row==e){var s=(i=this.folds).indexOf(r);for(0===s&&(this.start.column+=n);s<i.length;s++){if((r=i[s]).start.column+=n,!r.sameRow)return;r.end.column+=n}this.end.column+=n}},this.split=function(e,t){var n=this.getNextFoldTo(e,t);if(!n||"inside"==n.kind)return null;var r=n.fold,o=this.folds,s=this.foldData,a=o.indexOf(r),l=o[a-1];this.end.row=l.end.row,this.end.column=l.end.column;var c=new i(s,o=o.splice(a,o.length-a));return s.splice(s.indexOf(this)+1,0,c),c},this.merge=function(e){for(var t=e.folds,n=0;n<t.length;n++)this.addFold(t[n]);var r=this.foldData;r.splice(r.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach((function(t){e.push("  "+t.toString())})),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t=0,n=0;n<this.folds.length;n++){var r=this.folds[n];if((e-=r.start.column-t)<0)return{row:r.start.row,column:r.start.column+e};if((e-=r.placeholder.length)<0)return r.start;t=r.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(i.prototype),t.FoldLine=i})),ace.define("ace/range_list",[],(function(e,t,n){"use strict";var r=e("./range").Range.comparePoints,i=function(){this.ranges=[]};(function(){this.comparePoints=r,this.pointIndex=function(e,t,n){for(var i=this.ranges,o=n||0;o<i.length;o++){var s=i[o],a=r(e,s.end);if(!(a>0)){var l=r(e,s.start);return 0===a?t&&0!==l?-o-2:o:l>0||0===l&&!t?o:-o-1}}return-o-1},this.add=function(e){var t=!e.isEmpty(),n=this.pointIndex(e.start,t);n<0&&(n=-n-1);var r=this.pointIndex(e.end,t,n);return r<0?r=-r-1:r++,this.ranges.splice(n,r-n,e)},this.addList=function(e){for(var t=[],n=e.length;n--;)t.push.apply(t,this.add(e[n]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){for(var e,t=[],n=this.ranges,i=(n=n.sort((function(e,t){return r(e.start,t.start)})))[0],o=1;o<n.length;o++){e=i,i=n[o];var s=r(e.end,i.start);s<0||(0!=s||e.isEmpty()||i.isEmpty())&&(r(e.end,i.end)<0&&(e.end.row=i.end.row,e.end.column=i.end.column),n.splice(o,1),t.push(i),i=e,o--)}return this.ranges=n,t},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},this.clipRows=function(e,t){var n=this.ranges;if(n[0].start.row>t||n[n.length-1].start.row<e)return[];var r=this.pointIndex({row:e,column:0});r<0&&(r=-r-1);var i=this.pointIndex({row:t,column:0},r);i<0&&(i=-i-1);for(var o=[],s=r;s<i;s++)o.push(n[s]);return o},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){for(var t=e.start,n=e.end,r=t.row,i=n.row,o=this.ranges,s=0,a=o.length;s<a;s++){if((u=o[s]).end.row>=r)break}if("insert"==e.action)for(var l=i-r,c=-t.column+n.column;s<a;s++){if((u=o[s]).start.row>r)break;if(u.start.row==r&&u.start.column>=t.column&&(u.start.column==t.column&&this.$insertRight||(u.start.column+=c,u.start.row+=l)),u.end.row==r&&u.end.column>=t.column){if(u.end.column==t.column&&this.$insertRight)continue;u.end.column==t.column&&c>0&&s<a-1&&u.end.column>u.start.column&&u.end.column==o[s+1].start.column&&(u.end.column-=c),u.end.column+=c,u.end.row+=l}}else for(l=r-i,c=t.column-n.column;s<a;s++){if((u=o[s]).start.row>i)break;u.end.row<i&&(r<u.end.row||r==u.end.row&&t.column<u.end.column)?(u.end.row=r,u.end.column=t.column):u.end.row==i?u.end.column<=n.column?(l||u.end.column>t.column)&&(u.end.column=t.column,u.end.row=t.row):(u.end.column+=c,u.end.row+=l):u.end.row>i&&(u.end.row+=l),u.start.row<i&&(r<u.start.row||r==u.start.row&&t.column<u.start.column)?(u.start.row=r,u.start.column=t.column):u.start.row==i?u.start.column<=n.column?(l||u.start.column>t.column)&&(u.start.column=t.column,u.start.row=t.row):(u.start.column+=c,u.start.row+=l):u.start.row>i&&(u.start.row+=l)}if(0!=l&&s<a)for(;s<a;s++){var u;(u=o[s]).start.row+=l,u.end.row+=l}}}).call(i.prototype),t.RangeList=i})),ace.define("ace/edit_session/fold",[],(function(e,t,n){"use strict";var r=e("../range_list").RangeList,i=e("../lib/oop"),o=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};function s(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function a(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}i.inherits(o,r),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach((function(t){t.setFoldLine(e)}))},this.clone=function(){var e=this.range.clone(),t=new o(e,this.placeholder);return this.subFolds.forEach((function(e){t.subFolds.push(e.clone())})),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){var t,n;t=e,n=this.start,s(t.start,n),s(t.end,n);for(var r=e.start.row,i=e.start.column,o=0,a=-1;o<this.subFolds.length&&1==(a=this.subFolds[o].range.compare(r,i));o++);var l=this.subFolds[o],c=0;if(0==a){if(l.range.containsRange(e))return l.addSubFold(e);c=1}r=e.range.end.row,i=e.range.end.column;var u=o;for(a=-1;u<this.subFolds.length&&1==(a=this.subFolds[u].range.compare(r,i));u++);0==a&&u++;for(var h=this.subFolds.splice(o,u-o,e),d=0==a?h.length-1:h.length,f=c;f<d;f++)e.addSubFold(h[f]);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return function(e,t){a(e.start,t),a(e.end,t)}(e,this.start)}}.call(o.prototype)})),ace.define("ace/edit_session/folding",[],(function(e,t,n){"use strict";var r=e("../range").Range,i=e("./fold_line").FoldLine,o=e("./fold").Fold,s=e("../token_iterator").TokenIterator;t.Folding=function(){this.getFoldAt=function(e,t,n){var r=this.getFoldLine(e);if(!r)return null;for(var i=r.folds,o=0;o<i.length;o++){var s=i[o].range;if(s.contains(e,t)){if(1==n&&s.isEnd(e,t)&&!s.isEmpty())continue;if(-1==n&&s.isStart(e,t)&&!s.isEmpty())continue;return i[o]}}},this.getFoldsInRange=function(e){var t=e.start,n=e.end,r=this.$foldData,i=[];t.column+=1,n.column-=1;for(var o=0;o<r.length;o++){var s=r[o].range.compareRange(e);if(2!=s){if(-2==s)break;for(var a=r[o].folds,l=0;l<a.length;l++){var c=a[l];if(-2==(s=c.range.compareRange(e)))break;if(2!=s){if(42==s)break;i.push(c)}}}}return t.column-=1,n.column+=1,i},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach((function(e){t=t.concat(this.getFoldsInRange(e))}),this)}else t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,n=0;n<t.length;n++)for(var r=0;r<t[n].folds.length;r++)e.push(t[n].folds[r]);return e},this.getFoldStringAt=function(e,t,n,r){if(!(r=r||this.getFoldLine(e)))return null;for(var i,o,s={end:{column:0}},a=0;a<r.folds.length;a++){var l=(o=r.folds[a]).range.compareEnd(e,t);if(-1==l){i=this.getLine(o.start.row).substring(s.end.column,o.start.column);break}if(0===l)return null;s=o}return i||(i=this.getLine(o.start.row).substring(s.end.column)),-1==n?i.substring(0,t-s.end.column):1==n?i.substring(t-s.end.column):i},this.getFoldLine=function(e,t){var n=this.$foldData,r=0;for(t&&(r=n.indexOf(t)),-1==r&&(r=0);r<n.length;r++){var i=n[r];if(i.start.row<=e&&i.end.row>=e)return i;if(i.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var n=this.$foldData,r=0;for(t&&(r=n.indexOf(t)),-1==r&&(r=0);r<n.length;r++){var i=n[r];if(i.end.row>=e)return i}return null},this.getFoldedRowCount=function(e,t){for(var n=this.$foldData,r=t-e+1,i=0;i<n.length;i++){var o=n[i],s=o.end.row,a=o.start.row;if(s>=t){a<t&&(a>=e?r-=t-a:r=0);break}s>=e&&(r-=a>=e?s-a:s-e+1)}return r},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort((function(e,t){return e.start.row-t.start.row})),e},this.addFold=function(e,t){var n,r=this.$foldData,s=!1;e instanceof o?n=e:(n=new o(t,e)).collapseChildren=t.collapseChildren,this.$clipRangeToDocument(n.range);var a=n.start.row,l=n.start.column,c=n.end.row,u=n.end.column,h=this.getFoldAt(a,l,1),d=this.getFoldAt(c,u,-1);if(h&&d==h)return h.addSubFold(n);h&&!h.range.isStart(a,l)&&this.removeFold(h),d&&!d.range.isEnd(c,u)&&this.removeFold(d);var f=this.getFoldsInRange(n.range);f.length>0&&(this.removeFolds(f),f.forEach((function(e){n.addSubFold(e)})));for(var p=0;p<r.length;p++){var g=r[p];if(c==g.start.row){g.addFold(n),s=!0;break}if(a==g.end.row){if(g.addFold(n),s=!0,!n.sameRow){var m=r[p+1];if(m&&m.start.row==c){g.merge(m);break}}break}if(c<=g.start.row)break}return s||(g=this.$addFoldLine(new i(this.$foldData,n))),this.$useWrapMode?this.$updateWrapData(g.start.row,g.start.row):this.$updateRowLengthCache(g.start.row,g.start.row),this.$modified=!0,this._signal("changeFold",{data:n,action:"add"}),n},this.addFolds=function(e){e.forEach((function(e){this.addFold(e)}),this)},this.removeFold=function(e){var t=e.foldLine,n=t.start.row,r=t.end.row,i=this.$foldData,o=t.folds;if(1==o.length)i.splice(i.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))o.pop(),t.end.row=o[o.length-1].end.row,t.end.column=o[o.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))o.shift(),t.start.row=o[0].start.row,t.start.column=o[0].start.column;else if(e.sameRow)o.splice(o.indexOf(e),1);else{var s=t.split(e.start.row,e.start.column);(o=s.folds).shift(),s.start.row=o[0].start.row,s.start.column=o[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(n,r):this.$updateRowLengthCache(n,r)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);t.forEach((function(e){this.removeFold(e)}),this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach((function(t){e.restoreRange(t),this.addFold(t)}),this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach((function(e){this.expandFold(e)}),this)},this.unfold=function(e,t){var n,i;if(null==e?(n=new r(0,0,this.getLength(),0),t=!0):n="number"==typeof e?new r(e,0,e,this.getLine(e).length):"row"in e?r.fromPoints(e,e):e,i=this.getFoldsInRangeList(n),t)this.removeFolds(i);else for(var o=i;o.length;)this.expandFolds(o),o=this.getFoldsInRangeList(n);if(i.length)return i},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var n=this.getFoldLine(e,t);return n?n.end.row:e},this.getRowFoldStart=function(e,t){var n=this.getFoldLine(e,t);return n?n.start.row:e},this.getFoldDisplayLine=function(e,t,n,r,i){null==r&&(r=e.start.row),null==i&&(i=0),null==t&&(t=e.end.row),null==n&&(n=this.getLine(t).length);var o=this.doc,s="";return e.walk((function(e,t,n,a){if(!(t<r)){if(t==r){if(n<i)return;a=Math.max(i,a)}s+=null!=e?e:o.getLine(t).substring(a,n)}}),t,n),s},this.getDisplayLine=function(e,t,n,r){var i,o=this.getFoldLine(e);return o?this.getFoldDisplayLine(o,e,t,n,r):(i=this.doc.getLine(e)).substring(r||0,t||i.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map((function(t){var n=t.folds.map((function(e){return e.clone()}));return new i(e,n)}))},this.toggleFold=function(e){var t,n,r=this.selection.getRange();if(r.isEmpty()){var i=r.start;if(t=this.getFoldAt(i.row,i.column))return void this.expandFold(t);(n=this.findMatchingBracket(i))?1==r.comparePoint(n)?r.end=n:(r.start=n,r.start.column++,r.end.column--):(n=this.findMatchingBracket({row:i.row,column:i.column+1}))?(1==r.comparePoint(n)?r.end=n:r.start=n,r.start.column++):r=this.getCommentFoldRange(i.row,i.column)||r}else{var o=this.getFoldsInRange(r);if(e&&o.length)return void this.expandFolds(o);1==o.length&&(t=o[0])}if(t||(t=this.getFoldAt(r.start.row,r.start.column)),t&&t.range.toString()==r.toString())this.expandFold(t);else{var s="...";if(!r.isMultiLine()){if((s=this.getTextRange(r)).length<4)return;s=s.trim().substring(0,2)+".."}this.addFold(s,r)}},this.getCommentFoldRange=function(e,t,n){var i=new s(this,e,t),o=i.getCurrentToken(),a=o.type;if(o&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start");var l=new RegExp(a),c=new r;if(1!=n){do{o=i.stepBackward()}while(o&&l.test(o.type));i.stepForward()}if(c.start.row=i.getCurrentTokenRow(),c.start.column=i.getCurrentTokenColumn()+2,i=new s(this,e,t),-1!=n){var u=-1;do{if(o=i.stepForward(),-1==u){var h=this.getState(i.$row);l.test(h)||(u=i.$row)}else if(i.$row>u)break}while(o&&l.test(o.type));o=i.stepBackward()}else o=i.getCurrentToken();return c.end.row=i.getCurrentTokenRow(),c.end.column=i.getCurrentTokenColumn()+o.value.length-2,c}},this.foldAll=function(e,t,n){null==n&&(n=1e5);var r=this.foldWidgets;if(r){t=t||this.getLength();for(var i=e=e||0;i<t;i++)if(null==r[i]&&(r[i]=this.getFoldWidget(i)),"start"==r[i]){var o=this.getFoldWidgetRange(i);if(o&&o.isMultiLine()&&o.end.row<=t&&o.start.row>=e){i=o.end.row;try{var s=this.addFold("...",o);s&&(s.collapseChildren=n)}catch(e){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var n=this.foldWidgets;if(!n||t&&n[e])return{};for(var r,i=e-1;i>=0;){var o=n[i];if(null==o&&(o=n[i]=this.getFoldWidget(i)),"start"==o){var s=this.getFoldWidgetRange(i);if(r||(r=s),s&&s.end.row>=e)break}i--}return{range:-1!==i&&s,firstRange:r}},this.onFoldWidgetClick=function(e,t){var n={children:(t=t.domEvent).shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey};if(!this.$toggleFoldWidget(e,n)){var r=t.target||t.srcElement;r&&/ace_fold-widget/.test(r.className)&&(r.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var n=this.getFoldWidget(e),r=this.getLine(e),i="end"===n?-1:1,o=this.getFoldAt(e,-1===i?0:r.length,i);if(o)return t.children||t.all?this.removeFold(o):this.expandFold(o),o;var s=this.getFoldWidgetRange(e,!0);if(s&&!s.isMultiLine()&&(o=this.getFoldAt(s.start.row,s.start.column,1))&&s.isEqual(o.range))return this.removeFold(o),o;if(t.siblings){var a=this.getParentFoldRangeData(e);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=s?s.end.row:this.getLength(),this.foldAll(e+1,c,t.all?1e4:0)):s&&(t.all&&(s.collapseChildren=1e4),this.addFold("...",s));return s}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var n=this.$toggleFoldWidget(t,{});if(!n){var r=this.getParentFoldRangeData(t,!0);if(n=r.range||r.firstRange){t=n.start.row;var i=this.getFoldAt(t,this.getLine(t).length,1);i?this.removeFold(i):this.addFold("...",n)}}},this.updateFoldWidgets=function(e){var t=e.start.row,n=e.end.row-t;if(0===n)this.foldWidgets[t]=null;else if("remove"==e.action)this.foldWidgets.splice(t,n+1,null);else{var r=Array(n+1);r.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,r)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}})),ace.define("ace/edit_session/bracket_match",[],(function(e,t,n){"use strict";var r=e("../token_iterator").TokenIterator,i=e("../range").Range;t.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var n=t||this.getLine(e.row).charAt(e.column-1);if(""==n)return null;var r=n.match(/([\(\[\{])|([\)\]\}])/);return r?r[1]?this.$findClosingBracket(r[1],e):this.$findOpeningBracket(r[2],e):null},this.getBracketRange=function(e){var t,n=this.getLine(e.row),r=!0,o=n.charAt(e.column-1),s=o&&o.match(/([\(\[\{])|([\)\]\}])/);if(s||(o=n.charAt(e.column),e={row:e.row,column:e.column+1},s=o&&o.match(/([\(\[\{])|([\)\]\}])/),r=!1),!s)return null;if(s[1]){if(!(a=this.$findClosingBracket(s[1],e)))return null;t=i.fromPoints(e,a),r||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a;if(!(a=this.$findOpeningBracket(s[2],e)))return null;t=i.fromPoints(a,e),r||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(e,t,n){var i=this.$brackets[e],o=1,s=new r(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var l=t.column-s.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var u=c.charAt(l);if(u==i){if(0==(o-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else u==e&&(o+=1);l-=1}do{a=s.stepBackward()}while(a&&!n.test(a.type));if(null==a)break;l=(c=a.value).length-1}return null}},this.$findClosingBracket=function(e,t,n){var i=this.$brackets[e],o=1,s=new r(this,t.row,t.column),a=s.getCurrentToken();if(a||(a=s.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var l=t.column-s.getCurrentTokenColumn();;){for(var c=a.value,u=c.length;l<u;){var h=c.charAt(l);if(h==i){if(0==(o-=1))return{row:s.getCurrentTokenRow(),column:l+s.getCurrentTokenColumn()}}else h==e&&(o+=1);l+=1}do{a=s.stepForward()}while(a&&!n.test(a.type));if(null==a)break;l=0}return null}}}})),ace.define("ace/edit_session",[],(function(e,t,n){"use strict";var i=e("./lib/oop"),o=e("./lib/lang"),s=e("./bidihandler").BidiHandler,a=e("./config"),l=e("./lib/event_emitter").EventEmitter,c=e("./selection").Selection,u=e("./mode/text").Mode,h=e("./range").Range,d=e("./document").Document,f=e("./background_tokenizer").BackgroundTokenizer,p=e("./search_highlight").SearchHighlight,g=function e(t,n){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++e.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==r(t)&&t.getLine||(t=new d(t)),this.setDocument(t),this.selection=new c(this),this.$bidiHandler=new s(this),a.resetOptions(this),this.setMode(n),a._signal("session",this)};g.$uid=0,function(){i.implement(this,l),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,n=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>n&&(this.$docRowCache.splice(n,t),this.$screenRowCache.splice(n,t))},this.$getRowCacheIndex=function(e,t){for(var n=0,r=e.length-1;n<=r;){var i=n+r>>1,o=e[i];if(t>o)n=i+1;else{if(!(t<o))return i;r=i-1}}return n-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var n,r=this.bgTokenizer.getTokens(e),i=0;if(null==t){var o=r.length-1;i=this.getLine(e).length}else for(o=0;o<r.length&&!((i+=r[o].value.length)>=t);o++);return(n=r[o])?(n.index=o,n.start=i-n.value.length,n):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;e.addSession(this),this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.mergeUndoDeltas=!1},this.$informUndoManager=o.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?o.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,n,r){var i=this.$markerId++,o={range:e,type:n||"line",renderer:"function"==typeof n?n:null,clazz:t,inFront:!!r,id:i};return r?(this.$frontMarkers[i]=o,this._signal("changeFrontMarker")):(this.$backMarkers[i]=o,this._signal("changeBackMarker")),i},this.addDynamicMarker=function(e,t){if(e.update){var n=this.$markerId++;return e.id=n,e.inFront=!!t,t?(this.$frontMarkers[n]=e,this._signal("changeFrontMarker")):(this.$backMarkers[n]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];t&&(delete(t.inFront?this.$frontMarkers:this.$backMarkers)[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker"))},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new p(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,n,r){"number"!=typeof t&&(n=t,t=e),n||(n="ace_step");var i=new h(e,0,t,1/0);return i.id=this.addMarker(i,n,"fullLine",r),i},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getWordRange=function(e,t){var n=this.getLine(e),r=!1;if(t>0&&(r=!!n.charAt(t-1).match(this.tokenRe)),r||(r=!!n.charAt(t).match(this.tokenRe)),r)var i=this.tokenRe;else if(/^\s+$/.test(n.slice(t-1,t+1)))i=/\s/;else i=this.nonTokenRe;var o=t;if(o>0){do{o--}while(o>=0&&n.charAt(o).match(i));o++}for(var s=t;s<n.length&&n.charAt(s).match(i);)s++;return new h(e,o,e,s)},this.getAWordRange=function(e,t){for(var n=this.getWordRange(e,t),r=this.getLine(n.end.row);r.charAt(n.end.column).match(/[ \t]/);)n.end.column+=1;return n},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes=a.$modes,this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"===r(e)){if(e.getTokenizer)return this.$onChangeMode(e);var n=e,i=n.path}else i=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new u),this.$modes[i]&&!n)return this.$onChangeMode(this.$modes[i]),void(t&&t());this.$modeId=i,a.loadModule(["mode",i],function(e){if(this.$modeId!==i)return t&&t();this.$modes[i]&&!n?this.$onChangeMode(this.$modes[i]):e&&e.Mode&&(e=new e.Mode(n),n||(this.$modes[i]=e,e.$id=i),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var n=e.getTokenizer();if(void 0!==n.addEventListener){var r=this.onReloadTokenizer.bind(this);n.addEventListener("update",r)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(n);else{this.bgTokenizer=new f(n);var i=this;this.bgTokenizer.addEventListener("update",(function(e){i._signal("tokenizerUpdate",e)}))}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){a.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach((function(t){t&&t.screenWidth>e&&(e=t.screenWidth)})),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),n=this.$rowLengthCache,r=0,i=0,o=this.$foldData[i],s=o?o.start.row:1/0,a=t.length,l=0;l<a;l++){if(l>s){if((l=o.end.row+1)>=a)break;s=(o=this.$foldData[i++])?o.start.row:1/0}null==n[l]&&(n[l]=this.$getStringScreenWidth(t[l])[0]),n[l]>r&&(r=n[l])}this.screenWidth=r}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=e.length-1;-1!=n;n--){var r=e[n];"insert"==r.action||"remove"==r.action?this.doc.revertDelta(r):r.folds&&this.addFolds(r.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var n=0;n<e.length;n++){var r=e[n];"insert"!=r.action&&"remove"!=r.action||this.doc.applyDelta(r)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t){function n(e){return t?"insert"!==e.action:"insert"===e.action}for(var r,i,o=0;o<e.length;o++){var s=e[o];s.start&&(r?n(s)?(i=s.start,-1==r.compare(i.row,i.column)&&r.setStart(i),i=s.end,1==r.compare(i.row,i.column)&&r.setEnd(i),!0):(i=s.start,-1==r.compare(i.row,i.column)&&(r=h.fromPoints(s.start,s.start)),!1):n(s)?(r=h.fromPoints(s.start,s.end),!0):(r=h.fromPoints(s.start,s.start),!1))}return r},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,n){var r=this.getTextRange(e),i=this.getFoldsInRange(e),o=h.fromPoints(t,t);if(!n){this.remove(e);var s=e.start.row-e.end.row;(c=s?-e.end.column:e.start.column-e.end.column)&&(o.start.row==e.end.row&&o.start.column>e.end.column&&(o.start.column+=c),o.end.row==e.end.row&&o.end.column>e.end.column&&(o.end.column+=c)),s&&o.start.row>=e.end.row&&(o.start.row+=s,o.end.row+=s)}if(o.end=this.insert(o.start,r),i.length){var a=e.start,l=o.start,c=(s=l.row-a.row,l.column-a.column);this.addFolds(i.map((function(e){return(e=e.clone()).start.row==a.row&&(e.start.column+=c),e.end.row==a.row&&(e.end.column+=c),e.start.row+=s,e.end.row+=s,e})))}return o},this.indentRows=function(e,t,n){n=n.replace(/\t/g,this.getTabString());for(var r=e;r<=t;r++)this.doc.insertInLine({row:r,column:0},n)},this.outdentRows=function(e){for(var t=e.collapseRows(),n=new h(0,0,0,0),r=this.getTabSize(),i=t.start.row;i<=t.end.row;++i){var o=this.getLine(i);n.start.row=i,n.end.row=i;for(var s=0;s<r&&" "==o.charAt(s);++s);s<r&&"\t"==o.charAt(s)?(n.start.column=s,n.end.column=s+1):(n.start.column=0,n.end.column=s),this.remove(n)}},this.$moveLines=function(e,t,n){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),n<0){if((i=this.getRowFoldStart(e+n))<0)return 0;var r=i-e}else if(n>0){var i;if((i=this.getRowFoldEnd(t+n))>this.doc.getLength()-1)return 0;r=i-t}else{e=this.$clipRowToDocument(e);r=(t=this.$clipRowToDocument(t))-e+1}var o=new h(e,0,t,Number.MAX_VALUE),s=this.getFoldsInRange(o).map((function(e){return(e=e.clone()).start.row+=r,e.end.row+=r,e})),a=0==n?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+r,a),s.length&&this.addFolds(s),r},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)e=0,t=0;else{var n=this.doc.getLength();e>=n?(e=n-1,t=this.doc.getLine(n-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var n=this.$wrapLimitRange;n.max<0&&(n={min:t,max:t});var r=this.$constrainWrapLimit(e,n.min,n.max);return r!=this.$wrapLimit&&r>1&&(this.$wrapLimit=r,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(e,t,n){return t&&(e=Math.max(t,e)),n&&(e=Math.min(n,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,n=e.action,r=e.start,i=e.end,o=r.row,s=i.row,a=s-o,l=null;if(this.$updating=!0,0!=a)if("remove"===n){this[t?"$wrapData":"$rowLengthCache"].splice(o,a);var c=this.$foldData;l=this.getFoldsInRange(e),this.removeFolds(l);var u=0;if(g=this.getFoldLine(i.row)){g.addRemoveChars(i.row,i.column,r.column-i.column),g.shiftRow(-a);var h=this.getFoldLine(o);h&&h!==g&&(h.merge(g),g=h),u=c.indexOf(g)+1}for(;u<c.length;u++){(g=c[u]).start.row>=i.row&&g.shiftRow(-a)}s=o}else{var d=Array(a);d.unshift(o,0);var f=t?this.$wrapData:this.$rowLengthCache;f.splice.apply(f,d);c=this.$foldData,u=0;if(g=this.getFoldLine(o)){var p=g.range.compareInside(r.row,r.column);0==p?(g=g.split(r.row,r.column))&&(g.shiftRow(a),g.addRemoveChars(s,0,i.column-r.column)):-1==p&&(g.addRemoveChars(o,0,i.column-r.column),g.shiftRow(a)),u=c.indexOf(g)+1}for(;u<c.length;u++){var g;(g=c[u]).start.row>=o&&g.shiftRow(a)}}else a=Math.abs(e.start.column-e.end.column),"remove"===n&&(l=this.getFoldsInRange(e),this.removeFolds(l),a=-a),(g=this.getFoldLine(o))&&g.addRemoveChars(o,r.column,a);return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(o,s):this.$updateRowLengthCache(o,s),l},this.$updateRowLengthCache=function(e,t,n){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(n,r){var i,o,s=this.doc.getAllLines(),a=this.getTabSize(),l=this.$wrapData,c=this.$wrapLimit,u=n;for(r=Math.min(r,s.length-1);u<=r;)(o=this.getFoldLine(u,o))?(i=[],o.walk(function(n,r,o,a){var l;if(null!=n){(l=this.$getDisplayTokens(n,i.length))[0]=e;for(var c=1;c<l.length;c++)l[c]=t}else l=this.$getDisplayTokens(s[r].substring(a,o),i.length);i=i.concat(l)}.bind(this),o.end.row,s[o.end.row].length+1),l[o.start.row]=this.$computeWrapSplits(i,c,a),u=o.end.row+1):(i=this.$getDisplayTokens(s[u]),l[u]=this.$computeWrapSplits(i,c,a),u++)};var e=3,t=4,n=10,s=11,c=12;function d(e){return!(e<4352)&&(e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510)}this.$computeWrapSplits=function(r,i,o){if(0==r.length)return[];var a=[],l=r.length,u=0,h=0,d=this.$wrapAsCode,f=this.$indentedSoftWrap,p=i<=Math.max(2*o,8)||!1===f?0:Math.floor(i/2);function g(e){for(var t=e-u,i=u;i<e;i++){var l=r[i];12!==l&&2!==l||(t-=1)}a.length||(m=function(){var e=0;if(0===p)return e;if(f)for(var t=0;t<r.length;t++){var i=r[t];if(i==n)e+=1;else{if(i!=s){if(i==c)continue;break}e+=o}}return d&&!1!==f&&(e+=o),Math.min(e,p)}(),a.indent=m),h+=t,a.push(h),u=e}for(var m=0;l-u>i-m;){var v=u+i-m;if(r[v-1]>=n&&r[v]>=n)g(v);else if(r[v]!=e&&r[v]!=t){for(var y=Math.max(v-(i-(i>>2)),u-1);v>y&&r[v]<e;)v--;if(d){for(;v>y&&r[v]<e;)v--;for(;v>y&&9==r[v];)v--}else for(;v>y&&r[v]<n;)v--;v>y?g(++v):(2==r[v=u+i]&&v--,g(v-m))}else{for(;v!=u-1&&r[v]!=e;v--);if(v>u){g(v);continue}for(v=u+i;v<r.length&&r[v]==t;v++);if(v==r.length)break;g(v)}}return a},this.$getDisplayTokens=function(e,t){var r,i=[];t=t||0;for(var o=0;o<e.length;o++){var a=e.charCodeAt(o);if(9==a){r=this.getScreenTabSize(i.length+t),i.push(s);for(var l=1;l<r;l++)i.push(c)}else 32==a?i.push(n):a>39&&a<48||a>57&&a<64?i.push(9):a>=4352&&d(a)?i.push(1,2):i.push(1)}return i},this.$getStringScreenWidth=function(e,t,n){if(0==t)return[0,0];var r,i;for(null==t&&(t=1/0),n=n||0,i=0;i<e.length&&(9==(r=e.charCodeAt(i))?n+=this.getScreenTabSize(n):r>=4352&&d(r)?n+=2:n+=1,!(n>t));i++);return[n,i]},this.lineWidgets=null,this.getRowLength=function(e){if(this.lineWidgets)var t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0;else t=0;return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),n=this.$wrapData[t.row];return n.length&&n[0]<t.column?n.indent:0}return 0},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var n=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(n)},this.getDocumentLastRowColumnPosition=function(e,t){var n=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(n,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-(e%this.$tabSize|0)},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t,n){if(e<0)return{row:0,column:0};var r,i,o=0,s=0,a=0,l=0,c=this.$screenRowCache,u=this.$getRowCacheIndex(c,e),h=c.length;if(h&&u>=0){a=c[u],o=this.$docRowCache[u];var d=e>c[h-1]}else d=!h;for(var f=this.getLength()-1,p=this.getNextFoldLine(o),g=p?p.start.row:1/0;a<=e&&!(a+(l=this.getRowLength(o))>e||o>=f);)a+=l,++o>g&&(o=p.end.row+1,g=(p=this.getNextFoldLine(o,p))?p.start.row:1/0),d&&(this.$docRowCache.push(o),this.$screenRowCache.push(a));if(p&&p.start.row<=o)r=this.getFoldDisplayLine(p),o=p.start.row;else{if(a+l<=e||o>f)return{row:f,column:this.getLine(f).length};r=this.getLine(o),p=null}var m=0,v=Math.floor(e-a);if(this.$useWrapMode){var y=this.$wrapData[o];y&&(i=y[v],v>0&&y.length&&(m=y.indent,s=y[v-1]||y[y.length-1],r=r.substring(s)))}return void 0!==n&&this.$bidiHandler.isBidiRow(a+v,o,v)&&(t=this.$bidiHandler.offsetToCol(n)),s+=this.$getStringScreenWidth(r,t-m)[1],this.$useWrapMode&&s>=i&&(s=i-1),p?p.idxToPosition(s):{row:o,column:s}},this.documentToScreenPosition=function(e,t){if(void 0===t)var n=this.$clipPositionToDocument(e.row,e.column);else n=this.$clipPositionToDocument(e,t);e=n.row,t=n.column;var r,i=0,o=null;(r=this.getFoldAt(e,t,1))&&(e=r.start.row,t=r.start.column);var s,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0){a=l[c],i=this.$screenRowCache[c];var h=e>l[u-1]}else h=!u;for(var d=this.getNextFoldLine(a),f=d?d.start.row:1/0;a<e;){if(a>=f){if((s=d.end.row+1)>e)break;f=(d=this.getNextFoldLine(s,d))?d.start.row:1/0}else s=a+1;i+=this.getRowLength(a),a=s,h&&(this.$docRowCache.push(a),this.$screenRowCache.push(i))}var p="";d&&a>=f?(p=this.getFoldDisplayLine(d,e,t),o=d.start.row):(p=this.getLine(e).substring(0,t),o=e);var g=0;if(this.$useWrapMode){var m=this.$wrapData[o];if(m){for(var v=0;p.length>=m[v];)i++,v++;p=p.substring(m[v-1]||0,p.length),g=v>0?m.indent:0}}return{row:i,column:g+this.$getStringScreenWidth(p)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var n=this.$wrapData.length,r=0,i=(a=0,(t=this.$foldData[a++])?t.start.row:1/0);r<n;){var o=this.$wrapData[r];e+=o?o.length+1:1,++r>i&&(r=t.end.row+1,i=(t=this.$foldData[a++])?t.start.row:1/0)}else{e=this.getLength();for(var s=this.$foldData,a=0;a<s.length;a++)e-=(t=s[a]).end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){this.$enableVarChar&&(this.$getStringScreenWidth=function(t,n,r){if(0===n)return[0,0];var i,o;for(n||(n=1/0),r=r||0,o=0;o<t.length&&!((r+="\t"===(i=t.charAt(o))?this.getScreenTabSize(r):e.getCharacterWidth(i))>n);o++);return[r,o]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=d}.call(g.prototype),e("./edit_session/folding").Folding.call(g.prototype),e("./edit_session/bracket_match").BracketMatch.call(g.prototype),a.defineOptions(g.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e)if(this.$wrap=e,e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){(e=parseInt(e))>0&&this.$tabSize!==e&&(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),t.EditSession=g})),ace.define("ace/search",[],(function(e,t,n){"use strict";var r=e("./lib/lang"),i=e("./lib/oop"),o=e("./range").Range,s=function(){this.$options={}};(function(){this.set=function(e){return i.mixin(this.$options,e),this},this.getOptions=function(){return r.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var r=null;return n.forEach((function(e,n,i,s){return r=new o(e,n,i,s),!(n==s&&t.start&&t.start.start&&0!=t.skipCurrent&&r.isEqual(t.start))||(r=null,!1)})),r},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var n=t.range,i=n?e.getLines(n.start.row,n.end.row):e.doc.getAllLines(),s=[],a=t.re;if(t.$isMultiLine){var l,c=a.length,u=i.length-c;e:for(var h=a.offset||0;h<=u;h++){for(var d=0;d<c;d++)if(-1==i[h+d].search(a[d]))continue e;var f=i[h],p=i[h+c-1],g=f.length-f.match(a[0])[0].length,m=p.match(a[c-1])[0].length;l&&l.end.row===h&&l.end.column>g||(s.push(l=new o(h,g,h+c-1,m)),c>2&&(h=h+c-2))}}else for(var v=0;v<i.length;v++){var y=r.getMatchOffsets(i[v],a);for(d=0;d<y.length;d++){var b=y[d];s.push(new o(v,b.offset,v,b.offset+b.length))}}if(n){var w=n.start.column,_=n.start.column;for(v=0,d=s.length-1;v<d&&s[v].start.column<w&&s[v].start.row==n.start.row;)v++;for(;v<d&&s[d].end.column>_&&s[d].end.row==n.end.row;)d--;for(s=s.slice(v,d+1),v=0,d=s.length;v<d;v++)s[v].start.row+=n.start.row,s[v].end.row+=n.start.row}return s},this.replace=function(e,t){var n=this.$options,r=this.$assembleRegExp(n);if(n.$isMultiLine)return t;if(r){var i=r.exec(e);if(!i||i[0].length!=e.length)return null;if(t=e.replace(r,t),n.preserveCase){t=t.split("");for(var o=Math.min(e.length,e.length);o--;){var s=e[o];s&&s.toLowerCase()!=s?t[o]=t[o].toUpperCase():t[o]=t[o].toLowerCase()}t=t.join("")}return t}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var n=e.needle;if(!e.needle)return e.re=!1;e.regExp||(n=r.escapeRegExp(n)),e.wholeWord&&(n=function(e,t){function n(e){return/\w/.test(e)||t.regExp?"\\b":""}return n(e[0])+e+n(e[e.length-1])}(n,e));var i=e.caseSensitive?"gm":"gmi";if(e.$isMultiLine=!t&&/[\n\r]/.test(n),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(n,i);try{var o=new RegExp(n,i)}catch(e){o=!1}return e.re=o},this.$assembleMultilineRegExp=function(e,t){for(var n=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),r=[],i=0;i<n.length;i++)try{r.push(new RegExp(n[i],t))}catch(e){return!1}return r},this.$matchIterator=function(e,t){var n=this.$assembleRegExp(t);if(!n)return!1;var r=1==t.backwards,i=0!=t.skipCurrent,o=t.range,s=t.start;s||(s=o?o[r?"end":"start"]:e.selection.getRange()),s.start&&(s=s[i!=r?"end":"start"]);var a=o?o.start.row:0,l=o?o.end.row:e.getLength()-1;if(r)var c=function(e){var n=s.row;if(!h(n,s.column,e)){for(n--;n>=a;n--)if(h(n,Number.MAX_VALUE,e))return;if(0!=t.wrap)for(n=l,a=s.row;n>=a;n--)if(h(n,Number.MAX_VALUE,e))return}};else c=function(e){var n=s.row;if(!h(n,s.column,e)){for(n+=1;n<=l;n++)if(h(n,0,e))return;if(0!=t.wrap)for(n=a,l=s.row;n<=l;n++)if(h(n,0,e))return}};if(t.$isMultiLine)var u=n.length,h=function(t,i,o){var s=r?t-u+1:t;if(!(s<0)){var a=e.getLine(s),l=a.search(n[0]);if(!(!r&&l<i||-1===l)){for(var c=1;c<u;c++)if(-1==(a=e.getLine(s+c)).search(n[c]))return;var h=a.match(n[u-1])[0].length;if(!(r&&h>i))return!!o(s,l,s+u-1,h)||void 0}}};else if(r)h=function(t,r,i){var o,s=e.getLine(t),a=[],l=0;for(n.lastIndex=0;o=n.exec(s);){var c=o[0].length;if(l=o.index,!c){if(l>=s.length)break;n.lastIndex=l+=1}if(o.index+c>r)break;a.push(o.index,c)}for(var u=a.length-1;u>=0;u-=2){var h=a[u-1];if(i(t,h,t,h+(c=a[u])))return!0}};else h=function(t,r,i){var o,s,a=e.getLine(t);for(n.lastIndex=r;s=n.exec(a);){var l=s[0].length;if(i(t,o=s.index,t,o+l))return!0;if(!l&&(n.lastIndex=o+=1,o>=a.length))return!1}};return{forEach:c}}}).call(s.prototype),t.Search=s})),ace.define("ace/keyboard/hash_handler",[],(function(e,t,n){"use strict";var i=e("../lib/keys"),o=e("../lib/useragent"),s=i.KEY_MODS;function a(e,t){this.platform=t||(o.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function l(e,t){a.call(this,e,t),this.$singleCommand=!1}l.prototype=a.prototype,function(){function e(e){return"object"==r(e)&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var n=e&&("string"==typeof e?e:e.name);e=this.commands[n],t||delete this.commands[n];var r=this.commandKeyBinding;for(var i in r){var o=r[i];if(o==e)delete r[i];else if(Array.isArray(o)){var s=o.indexOf(e);-1!=s&&(o.splice(s,1),1==o.length&&(r[i]=o[0]))}}},this.bindKey=function(e,t,n){if("object"==r(e)&&e&&(null==n&&(n=e.position),e=e[this.platform]),e)return"function"==typeof t?this.addCommand({exec:t,bindKey:e,name:t.name||e}):void e.split("|").forEach((function(e){var r="";if(-1!=e.indexOf(" ")){var i=e.split(/\s+/);e=i.pop(),i.forEach((function(e){var t=this.parseKeys(e),n=s[t.hashId]+t.key;r+=(r?" ":"")+n,this._addCommandToBinding(r,"chainKeys")}),this),r+=" "}var o=this.parseKeys(e),a=s[o.hashId]+o.key;this._addCommandToBinding(r+a,t,n)}),this)},this._addCommandToBinding=function(t,n,r){var i,o=this.commandKeyBinding;if(n)if(!o[t]||this.$singleCommand)o[t]=n;else{Array.isArray(o[t])?-1!=(i=o[t].indexOf(n))&&o[t].splice(i,1):o[t]=[o[t]],"number"!=typeof r&&(r=e(n));var s=o[t];for(i=0;i<s.length;i++){if(e(s[i])>r)break}s.splice(i,0,n)}else delete o[t]},this.addCommands=function(e){e&&Object.keys(e).forEach((function(t){var n=e[t];if(n){if("string"==typeof n)return this.bindKey(n,t);"function"==typeof n&&(n={exec:n}),"object"===r(n)&&(n.name||(n.name=t),this.addCommand(n))}}),this)},this.removeCommands=function(e){Object.keys(e).forEach((function(t){this.removeCommand(e[t])}),this)},this.bindKeys=function(e){Object.keys(e).forEach((function(t){this.bindKey(t,e[t])}),this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(e){var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter((function(e){return e})),n=t.pop(),r=i[n];if(i.FUNCTION_KEYS[r])n=i.FUNCTION_KEYS[r].toLowerCase();else{if(!t.length)return{key:n,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:n.toUpperCase(),hashId:-1}}for(var o=0,s=t.length;s--;){var a=i.KEY_MODS[t[s]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[s]+" in "+e),!1;o|=a}return{key:n,hashId:o}},this.findKeyCommand=function(e,t){var n=s[e]+t;return this.commandKeyBinding[n]},this.handleKeyboard=function(e,t,n,r){if(!(r<0)){var i=s[t]+n,o=this.commandKeyBinding[i];return e.$keyChain&&(e.$keyChain+=" "+i,o=this.commandKeyBinding[e.$keyChain]||o),!o||"chainKeys"!=o&&"chainKeys"!=o[o.length-1]?(e.$keyChain&&(t&&4!=t||1!=n.length?(-1==t||r>0)&&(e.$keyChain=""):e.$keyChain=e.$keyChain.slice(0,-i.length-1)),{command:o}):(e.$keyChain=e.$keyChain||i,{command:"null"})}},this.getStatusText=function(e,t){return t.$keyChain||""}}.call(a.prototype),t.HashHandler=a,t.MultiHashHandler=l})),ace.define("ace/commands/command_manager",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../keyboard/hash_handler").MultiHashHandler,o=e("../lib/event_emitter").EventEmitter,s=function(e,t){i.call(this,t,e),this.byName=this.commands,this.setDefaultHandler("exec",(function(e){return e.command.exec(e.editor,e.args||{})}))};r.inherits(s,i),function(){r.implement(this,o),this.exec=function(e,t,n){if(Array.isArray(e)){for(var r=e.length;r--;)if(this.exec(e[r],t,n))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(0!=this.$checkCommandState&&e.isAvailable&&!e.isAvailable(t))return!1;var i={editor:t,command:e,args:n};return i.returnValue=this._emit("exec",i),this._signal("afterExec",i),!1!==i.returnValue},this.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach((function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])}),this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map((function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e}))}}.call(s.prototype),t.CommandManager=s})),ace.define("ace/commands/default_commands",[],(function(e,t,n){"use strict";var r=e("../lib/lang"),i=e("../config"),o=e("../range").Range;function s(e,t){return{win:e,mac:t}}t.commands=[{name:"showSettingsMenu",bindKey:s("Ctrl-,","Command-,"),exec:function(e){i.loadModule("ace/ext/settings_menu",(function(t){t.init(e),e.showSettingsMenu()}))},readOnly:!0},{name:"goToNextError",bindKey:s("Alt-E","F4"),exec:function(e){i.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,1)}))},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:s("Alt-Shift-E","Shift-F4"),exec:function(e){i.loadModule("./ext/error_marker",(function(t){t.showErrorMarker(e,-1)}))},scrollIntoView:"animate",readOnly:!0},{name:"selectall",description:"Select all",bindKey:s("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",description:"Center selection",bindKey:s(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",description:"Go to line...",bindKey:s("Ctrl-L","Command-L"),exec:function(e,t){"number"!=typeof t||isNaN(t)||e.gotoLine(t),e.prompt({$type:"gotoLine"})},readOnly:!0},{name:"fold",bindKey:s("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:s("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:s("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:s("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",description:"Fold all",bindKey:s(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",description:"Fold other",bindKey:s("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",description:"Unfold all",bindKey:s("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",description:"Find next",bindKey:s("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",description:"Find previous",bindKey:s("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",description:"Select or find next",bindKey:s("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",description:"Select or find previous",bindKey:s("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",description:"Find",bindKey:s("Ctrl-F","Command-F"),exec:function(e){i.loadModule("ace/ext/searchbox",(function(t){t.Search(e)}))},readOnly:!0},{name:"overwrite",description:"Overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",description:"Select to start",bindKey:s("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",description:"Go to start",bindKey:s("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",description:"Select up",bindKey:s("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",description:"Go line up",bindKey:s("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",description:"Select to end",bindKey:s("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",description:"Go to end",bindKey:s("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",description:"Select down",bindKey:s("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",description:"Go line down",bindKey:s("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",description:"Select word left",bindKey:s("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",description:"Go to word left",bindKey:s("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",description:"Select to line start",bindKey:s("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",description:"Go to line start",bindKey:s("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",description:"Select left",bindKey:s("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",description:"Go to left",bindKey:s("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",description:"Select word right",bindKey:s("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",description:"Go to word right",bindKey:s("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",description:"Select to line end",bindKey:s("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",description:"Go to line end",bindKey:s("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",description:"Select right",bindKey:s("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",description:"Go to right",bindKey:s("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",description:"Select page down",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",description:"Page down",bindKey:s(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",description:"Go to page down",bindKey:s("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",description:"Select page up",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",description:"Page up",bindKey:s(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",description:"Go to page up",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",description:"Scroll up",bindKey:s("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",description:"Scroll down",bindKey:s("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",description:"Select line start",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",description:"Select line end",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",description:"Toggle recording",bindKey:s("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",description:"Replay macro",bindKey:s("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",description:"Jump to matching",bindKey:s("Ctrl-P","Ctrl-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",description:"Select to matching",bindKey:s("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",description:"Expand to matching",bindKey:s("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",description:"Pass keys to browser",bindKey:s(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",description:"Copy",exec:function(e){},readOnly:!0},{name:"cut",description:"Cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty()?e.selection.getLineRange():e.selection.getRange();e._emit("cut",t),t.isEmpty()||e.session.remove(t),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",description:"Paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",description:"Remove line",bindKey:s("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",description:"Duplicate selection",bindKey:s("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",description:"Sort lines",bindKey:s("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",description:"Toggle comment",bindKey:s("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",description:"Toggle block comment",bindKey:s("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",description:"Modify number up",bindKey:s("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",description:"Modify number down",bindKey:s("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",description:"Replace",bindKey:s("Ctrl-H","Command-Option-F"),exec:function(e){i.loadModule("ace/ext/searchbox",(function(t){t.Search(e,!0)}))}},{name:"undo",description:"Undo",bindKey:s("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",description:"Redo",bindKey:s("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",description:"Copy lines up",bindKey:s("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",description:"Move lines up",bindKey:s("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",description:"Copy lines down",bindKey:s("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",description:"Move lines down",bindKey:s("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",description:"Delete",bindKey:s("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",description:"Backspace",bindKey:s("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",description:"Cut or delete",bindKey:s("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",description:"Remove to line start",bindKey:s("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",description:"Remove to line end",bindKey:s("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",description:"Remove to line start hard",bindKey:s("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",description:"Remove to line end hard",bindKey:s("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",description:"Remove word left",bindKey:s("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",description:"Remove word right",bindKey:s("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",description:"Outdent",bindKey:s("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",description:"Indent",bindKey:s("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",description:"Block outdent",bindKey:s("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",description:"Block indent",bindKey:s("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",description:"Insert string",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",description:"Insert text",exec:function(e,t){e.insert(r.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",description:"Split line",bindKey:s(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",description:"Transpose letters",bindKey:s("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",description:"To uppercase",bindKey:s("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",description:"To lowercase",bindKey:s("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",description:"Expand to line",bindKey:s("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",description:"Join lines",bindKey:s(null,null),exec:function(e){for(var t=e.selection.isBackwards(),n=t?e.selection.getSelectionLead():e.selection.getSelectionAnchor(),i=t?e.selection.getSelectionAnchor():e.selection.getSelectionLead(),s=e.session.doc.getLine(n.row).length,a=e.session.doc.getTextRange(e.selection.getRange()).replace(/\n\s*/," ").length,l=e.session.doc.getLine(n.row),c=n.row+1;c<=i.row+1;c++){var u=r.stringTrimLeft(r.stringTrimRight(e.session.doc.getLine(c)));0!==u.length&&(u=" "+u),l+=u}i.row+1<e.session.doc.getLength()-1&&(l+=e.session.doc.getNewLineCharacter()),e.clearSelection(),e.session.doc.replace(new o(n.row,0,i.row+2,0),l),a>0?(e.selection.moveCursorTo(n.row,n.column),e.selection.selectTo(n.row,n.column+a)):(s=e.session.doc.getLine(n.row).length>s?s+1:s,e.selection.moveCursorTo(n.row,s))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",description:"Invert selection",bindKey:s(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,r=e.selection.rangeList.ranges,i=[];r.length<1&&(r=[e.selection.getRange()]);for(var s=0;s<r.length;s++)s==r.length-1&&(r[s].end.row===t&&r[s].end.column===n||i.push(new o(r[s].end.row,r[s].end.column,t,n))),0===s?0===r[s].start.row&&0===r[s].start.column||i.push(new o(0,0,r[s].start.row,r[s].start.column)):i.push(new o(r[s-1].end.row,r[s-1].end.column,r[s].start.row,r[s].start.column));e.exitMultiSelectMode(),e.clearSelection();for(s=0;s<i.length;s++)e.selection.addRange(i[s],!1)},readOnly:!0,scrollIntoView:"none"},{name:"openCommandPallete",description:"Open command pallete",bindKey:s("F1","F1"),exec:function(e){e.prompt({$type:"commands"})},readOnly:!0},{name:"modeSelect",description:"Change language mode...",bindKey:s(null,null),exec:function(e){e.prompt({$type:"modes"})},readOnly:!0}]})),ace.define("ace/clipboard",[],(function(e,t,n){"use strict";n.exports={lineMode:!1}})),ace.define("ace/editor",[],(function(e,t,n){"use strict";e("./lib/fixoldbrowsers");var i=e("./lib/oop"),o=e("./lib/dom"),s=e("./lib/lang"),a=e("./lib/useragent"),l=e("./keyboard/textinput").TextInput,c=e("./mouse/mouse_handler").MouseHandler,u=e("./mouse/fold_handler").FoldHandler,h=e("./keyboard/keybinding").KeyBinding,d=e("./edit_session").EditSession,f=e("./search").Search,p=e("./range").Range,g=e("./lib/event_emitter").EventEmitter,m=e("./commands/command_manager").CommandManager,v=e("./commands/default_commands").commands,y=e("./config"),b=e("./token_iterator").TokenIterator,w=e("./clipboard"),_=function e(t,n,i){var o=t.getContainerElement();this.container=o,this.renderer=t,this.id="editor"+ ++e.$uid,this.commands=new m(a.isMac?"mac":"win",v),"object"==("undefined"==typeof document?"undefined":r(document))&&(this.textInput=new l(t.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new c(this),new u(this)),this.keyBinding=new h(this),this.$search=(new f).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=s.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",(function(e,t){t._$emitInputEvent.schedule(31)})),this.setSession(n||i&&i.session||new d("")),y.resetOptions(this),i&&this.setOptions(i),y._signal("editor",this)};_.$uid=0,function(){i.implement(this,g),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=s.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(e){if(this.curOp){if(e&&!1===e.returnValue)return this.curOp=null;if(1==e&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var t=this.curOp.command,n=t&&t.scrollIntoView;if(n){switch(n){case"center-animate":n="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var r=this.selection.getRange(),i=this.renderer.layerConfig;(r.start.row>=i.lastRow||r.end.row<=i.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==n&&this.renderer.animateScrolling(this.curOp.scrollTop)}var o=this.selection.toJSON();this.curOp.selectionAfter=o,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(o),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,n=this.$mergeableCommands,r=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var i=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),r=r&&this.mergeNextCommand&&(!/\s/.test(i)||/\s/.test(t.args)),this.mergeNextCommand=!0}else r=r&&-1!==n.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(r=!1),r?this.session.mergeUndoDeltas=!0:-1!==n.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(e,t){if(e&&"string"==typeof e&&"ace"!=e){this.$keybindingId=e;var n=this;y.loadModule(["keybinding",e],(function(r){n.$keybindingId==e&&n.keyBinding.setKeyboardHandler(r&&r.handler),t&&t()}))}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var n=this.session.getSelection();n.off("changeCursor",this.$onCursorChange),n.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||o.computedStyle(this.container).fontSize},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout((function(){e.$highlightPending=!1;var t=e.session;if(t&&t.bgTokenizer){var n=t.findMatchingBracket(e.getCursorPosition());if(n)var r=new p(n.row,n.column,n.row,n.column+1);else if(t.$mode.getMatching)r=t.$mode.getMatching(e.session);r&&(t.$bracketHighlight=t.addMarker(r,"ace_bracket","text"))}}),50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var e=this;this.$highlightTagPending=!0,setTimeout((function(){e.$highlightTagPending=!1;var t=e.session;if(t&&t.bgTokenizer){var n=e.getCursorPosition(),r=new b(e.session,n.row,n.column),i=r.getCurrentToken();if(!i||!/\b(?:tag-open|tag-name)/.test(i.type))return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);if(-1==i.type.indexOf("tag-open")||(i=r.stepForward())){var o=i.value,s=0,a=r.stepBackward();if("<"==a.value)do{a=i,(i=r.stepForward())&&i.value===o&&-1!==i.type.indexOf("tag-name")&&("<"===a.value?s++:"</"===a.value&&s--)}while(i&&s>=0);else{do{i=a,a=r.stepBackward(),i&&i.value===o&&-1!==i.type.indexOf("tag-name")&&("<"===a.value?s++:"</"===a.value&&s--)}while(a&&s<=0);r.stepForward()}if(!i)return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);var l=r.getCurrentTokenRow(),c=r.getCurrentTokenColumn(),u=new p(l,c,l,c+i.value.length),h=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&null!=h&&0!==u.compareRange(h.range)&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),t.$tagHighlight||(t.$tagHighlight=t.addMarker(u,"ace_bracket","text"))}}}),50)}},this.focus=function(){var e=this;setTimeout((function(){e.isFocused()||e.textInput.focus()})),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,n=e.start.row==e.end.row?e.end.row:1/0;this.renderer.updateLines(e.start.row,n,t),this._signal("change",e),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(e=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var n=new p(e.row,e.column,e.row,1/0);n.id=t.addMarker(n,"ace_active-line","screenLine"),t.$highlightLineMarker=n}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var n=this.selection.getRange(),r=this.getSelectionStyle();t.$selectionMarker=t.addMarker(n,"ace_selection",r)}var i=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(i),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var n=t.start.column,r=t.end.column,i=e.getLine(t.start.row),o=i.substring(n,r);if(!(o.length>5e3)&&/[\w\d]/.test(o)){var s=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:o}),a=i.substring(n-1,r+1);if(s.test(a))return s}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),n=!1;if(!e&&this.$copyWithEmptySelection){n=!0;for(var r=this.selection.getAllRanges(),i=0;i<r.length;i++){var o=r[i];i&&r[i-1].start.row==o.start.row||(e+=this.session.getLine(o.start.row)+t)}}var s={text:e};return this._signal("copy",s),w.lineMode=n?s.text:"",s.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e,t){var n={text:e,event:t};this.commands.exec("paste",this,n)},this.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var t=e.text,n=t==w.lineMode,r=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)n?r.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(n)this.selection.rangeList.ranges.forEach((function(e){r.insert({row:e.start.row,column:0},t)}));else{var i=t.split(/\r\n|\r|\n/),o=this.selection.rangeList.ranges;if(i.length>o.length||i.length<2||!i[1])return this.commands.exec("insertstring",this,t);for(var s=o.length;s--;){var a=o[s];a.isEmpty()||r.remove(a),r.insert(a.start,i[s])}}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var n=this.session,r=n.getMode(),i=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var o=r.transformAction(n.getState(i.row),"insertion",this,n,e);o&&(e!==o.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=o.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==e.indexOf("\n")){(s=new p.fromPoints(i,i)).end.column+=e.length,this.session.remove(s)}}else{var s=this.getSelectionRange();i=this.session.remove(s),this.clearSelection()}if("\n"==e||"\r\n"==e){var a=n.getLine(i.row);if(i.column>a.search(/\S|$/)){var l=a.substr(i.column).search(/\S|$/);n.doc.removeInLine(i.row,i.column,i.column+l)}}this.clearSelection();var c=i.column,u=n.getState(i.row),h=(a=n.getLine(i.row),r.checkOutdent(u,a,e));n.insert(i,e);if(o&&o.selection&&(2==o.selection.length?this.selection.setSelectionRange(new p(i.row,c+o.selection[0],i.row,c+o.selection[1])):this.selection.setSelectionRange(new p(i.row+o.selection[0],o.selection[1],i.row+o.selection[2],o.selection[3]))),n.getDocument().isNewLine(e)){var d=r.getNextLineIndent(u,a.slice(0,i.column),n.getTabString());n.insert({row:i.row+1,column:0},d)}h&&r.autoOutdent(u,n,i.row)},this.onTextInput=function(e,t){if(!t)return this.keyBinding.onTextInput(e);this.startOperation({command:{name:"insertstring"}});var n=this.applyComposition.bind(this,e,t);this.selection.rangeCount?this.forEachSelection(n):n(),this.endOperation()},this.applyComposition=function(e,t){var n;(t.extendLeft||t.extendRight)&&((n=this.selection.getRange()).start.column-=t.extendLeft,n.end.column+=t.extendRight,this.selection.setRange(n),e||n.isEmpty()||this.remove());(!e&&this.selection.isEmpty()||this.insert(e,!0),t.restoreStart||t.restoreEnd)&&((n=this.selection.getRange()).start.column-=t.restoreStart,n.end.column-=t.restoreEnd,this.selection.setRange(n))},this.onCommandKey=function(e,t,n){this.keyBinding.onCommandKey(e,t,n)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var n=this.session,r=n.getState(t.start.row),i=n.getMode().transformAction(r,"deletion",this,n,t);if(0===t.end.column){var o=n.getTextRange(t);if("\n"==o[o.length-1]){var s=n.getLine(t.end.row);/^\s+$/.test(s)&&(t.end.column=s.length)}}i&&(t=i)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var n,r,i=this.session.getLine(e.row);t<i.length?(n=i.charAt(t)+i.charAt(t-1),r=new p(e.row,t-1,e.row,t+1)):(n=i.charAt(t-1)+i.charAt(t-2),r=new p(e.row,t-2,e.row,t)),this.session.replace(r,n),this.session.selection.moveToPosition(r.end)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),n=this.session.getTextRange(t);this.session.replace(t,n.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){u=this.$getSelectedRows();return void e.indentRows(u.first,u.last,"\t")}}var r=e.getLine(t.start.row),i=t.start,o=e.getTabSize(),a=e.documentToScreenColumn(i.row,i.column);if(this.session.getUseSoftTabs())var l=o-a%o,c=s.stringRepeat(" ",l);else{for(l=a%o;" "==r[t.start.column-1]&&l;)t.start.column--,l--;this.selection.setSelectionRange(t),c="\t"}return this.insert(c)}var u=this.$getSelectedRows();e.indentRows(u.first,u.last,"\t")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){for(var e=this.$getSelectedRows(),t=this.session,n=[],r=e.first;r<=e.last;r++)n.push(t.getLine(r));n.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}));var i=new p(0,0,0,0);for(r=e.first;r<=e.last;r++){var o=t.getLine(r);i.start.row=r,i.end.row=r,i.end.column=o.length,t.replace(i,n[r-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),n=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,n,e)},this.getNumberAt=function(e,t){var n=/[\-]?[0-9]+(?:\.[0-9]+)?/g;n.lastIndex=0;for(var r=this.session.getLine(e);n.lastIndex<t;){var i=n.exec(r);if(i.index<=t&&i.index+i[0].length>=t)return{value:i[0],start:i.index,end:i.index+i[0].length}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,n=this.selection.getCursor().column,r=new p(t,n-1,t,n),i=this.session.getTextRange(r);if(!isNaN(parseFloat(i))&&isFinite(i)){var o=this.getNumberAt(t,n);if(o){var s=o.value.indexOf(".")>=0?o.start+o.value.indexOf(".")+1:o.end,a=o.start+o.value.length-s,l=parseFloat(o.value);l*=Math.pow(10,a),s!==o.end&&n<s?e*=Math.pow(10,o.end-n-1):e*=Math.pow(10,o.end-n),l+=e;var c=(l/=Math.pow(10,a)).toFixed(a),u=new p(t,o.start,t,o.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(o.start+1,n+c.length-o.value.length))}}else this.toggleWord()},this.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],this.toggleWord=function(){var e=this.selection.getCursor().row,t=this.selection.getCursor().column;this.selection.selectWord();var n=this.getSelectedText(),r=this.selection.getWordRange().start.column,i=n.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),o=t-r-1;o<0&&(o=0);var a=0,l=0,c=this;n.match(/[A-Za-z0-9_]+/)&&i.forEach((function(t,i){l=a+t.length,o>=a&&o<=l&&(n=t,c.selection.clearSelection(),c.moveCursorTo(e,a+r),c.selection.selectTo(e,l+r)),a=l}));for(var u,h=this.$toggleWordPairs,d=0;d<h.length;d++)for(var f=h[d],p=0;p<=1;p++){var g=+!p,m=n.match(new RegExp("^\\s?_?("+s.escapeRegExp(f[p])+")\\s?$","i"));if(m)n.match(new RegExp("([_]|^|\\s)("+s.escapeRegExp(m[1])+")($|\\s)","g"))&&(u=n.replace(new RegExp(s.escapeRegExp(f[p]),"i"),(function(e){var t=f[g];return e.toUpperCase()==e?t=t.toUpperCase():e.charAt(0).toUpperCase()==e.charAt(0)&&(t=t.substr(0,0)+f[g].charAt(0).toUpperCase()+t.substr(1)),t})),this.insert(u),u="")}},this.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,n=e.getRange(),r=e.isBackwards();if(n.isEmpty()){var i=n.start.row;t.duplicateLines(i,i)}else{var o=r?n.start:n.end,s=t.insert(o,t.getTextRange(n),!1);n.start=o,n.end=s,e.setSelectionRange(n,r)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,n){return this.session.moveText(e,t,n)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var n,r,i=this.selection;if(!i.inMultiSelectMode||this.inVirtualSelectionMode){var o=i.toOrientedRange();n=this.$getSelectedRows(o),r=this.session.$moveLines(n.first,n.last,t?0:e),t&&-1==e&&(r=0),o.moveBy(r,0),i.fromOrientedRange(o)}else{var s=i.rangeList.ranges;i.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,c=s.length,u=0;u<c;u++){var h=u;s[u].moveBy(a,0);for(var d=(n=this.$getSelectedRows(s[u])).first,f=n.last;++u<c;){l&&s[u].moveBy(l,0);var p=this.$getSelectedRows(s[u]);if(t&&p.first!=f)break;if(!t&&p.first>f+1)break;f=p.last}for(u--,a=this.session.$moveLines(d,f,t?0:e),t&&-1==e&&(h=u+1);h<=u;)s[h].moveBy(a,0),h++;t||(a=0),l+=a}i.fromOrientedRange(i.ranges[0]),i.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(e)},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var n=this.renderer,r=this.renderer.layerConfig,i=e*Math.floor(r.height/r.lineHeight);!0===t?this.selection.$moveSelection((function(){this.moveCursorBy(i,0)})):!1===t&&(this.selection.moveCursorBy(i,0),this.selection.clearSelection());var o=n.scrollTop;n.scrollBy(0,i*r.lineHeight),null!=t&&n.scrollCursorIntoView(null,.5),n.animateScrolling(o)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,n,r){this.renderer.scrollToLine(e,t,n,r)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var n=this.getCursorPosition(),r=new b(this.session,n.row,n.column),i=r.getCurrentToken(),o=i||r.stepForward();if(o){var s,a,l=!1,c={},u=n.column-o.start,h={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(o.value.match(/[{}()\[\]]/g)){for(;u<o.value.length&&!l;u++)if(h[o.value[u]])switch(a=h[o.value[u]]+"."+o.type.replace("rparen","lparen"),isNaN(c[a])&&(c[a]=0),o.value[u]){case"(":case"[":case"{":c[a]++;break;case")":case"]":case"}":c[a]--,-1===c[a]&&(s="bracket",l=!0)}}else-1!==o.type.indexOf("tag-name")&&(isNaN(c[o.value])&&(c[o.value]=0),"<"===i.value?c[o.value]++:"</"===i.value&&c[o.value]--,-1===c[o.value]&&(s="tag",l=!0));l||(i=o,o=r.stepForward(),u=0)}while(o&&!l);if(s){var d,f;if("bracket"===s)(d=this.session.getBracketRange(n))||(f=(d=new p(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+u-1,r.getCurrentTokenRow(),r.getCurrentTokenColumn()+u-1)).start,(t||f.row===n.row&&Math.abs(f.column-n.column)<2)&&(d=this.session.getBracketRange(f)));else if("tag"===s){if(!o||-1===o.type.indexOf("tag-name"))return;var g=o.value;if(0===(d=new p(r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2,r.getCurrentTokenRow(),r.getCurrentTokenColumn()-2)).compare(n.row,n.column)){l=!1;do{o=i,(i=r.stepBackward())&&(-1!==i.type.indexOf("tag-close")&&d.setEnd(r.getCurrentTokenRow(),r.getCurrentTokenColumn()+1),o.value===g&&-1!==o.type.indexOf("tag-name")&&("<"===i.value?c[g]++:"</"===i.value&&c[g]--,0===c[g]&&(l=!0)))}while(i&&!l)}o&&o.type.indexOf("tag-name")&&(f=d.start).row==n.row&&Math.abs(f.column-n.column)<2&&(f=d.end)}(f=d&&d.cursor||f)&&(e?d&&t?this.selection.setRange(d):d&&d.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(f.row,f.column):this.selection.moveTo(f.row,f.column))}}},this.gotoLine=function(e,t,n){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,n)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var n=this.$search.find(this.session),r=0;return n?(this.$tryReplace(n,e)&&(r=1),this.selection.setSelectionRange(n),this.renderer.scrollSelectionIntoView(n.start,n.end),r):r},this.replaceAll=function(e,t){t&&this.$search.set(t);var n=this.$search.findAll(this.session),r=0;if(!n.length)return r;var i=this.getSelectionRange();this.selection.moveTo(0,0);for(var o=n.length-1;o>=0;--o)this.$tryReplace(n[o],e)&&r++;return this.selection.setSelectionRange(i),r},this.$tryReplace=function(e,t){var n=this.session.getTextRange(e);return null!==(t=this.$search.replace(n,t))?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,n){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==r(e)&&i.mixin(t,e);var o=this.selection.getRange();null==t.needle&&((e=this.session.getTextRange(o)||this.$search.$options.needle)||(o=this.session.getWordRange(o.start.row,o.start.column),e=this.session.getTextRange(o)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:o});var s=this.$search.find(this.session);return t.preventScroll?s:s?(this.revealRange(s,n),s):(t.backwards?o.start=o.end:o.end=o.start,void this.selection.setRange(o))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var n=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(n)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(e){if(e){var t,n=this,r=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var i=this.$scrollAnchor;i.style.cssText="position:absolute",this.container.insertBefore(i,this.container.firstChild);var o=this.on("changeSelection",(function(){r=!0})),s=this.renderer.on("beforeRender",(function(){r&&(t=n.renderer.container.getBoundingClientRect())})),a=this.renderer.on("afterRender",(function(){if(r&&t&&(n.isFocused()||n.searchBox&&n.searchBox.isFocused())){var e=n.renderer,o=e.$cursorLayer.$pixelPos,s=e.layerConfig,a=o.top-s.offset;null!=(r=o.top>=0&&a+t.top<0||!(o.top<s.height&&o.top+t.top+s.lineHeight>window.innerHeight)&&null)&&(i.style.top=a+"px",i.style.left=o.left+"px",i.style.height=s.lineHeight+"px",i.scrollIntoView(r)),r=t=null}}));this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",o),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",s))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking(/smooth/.test(e)),t.isBlinking=!this.$readOnly&&"wide"!=e,o.setCssClass(t.element,"ace_slim-cursors",/slim/.test(e)))},this.prompt=function(e,t,n){var r=this;y.loadModule("./ext/prompt",(function(i){i.prompt(r,e,t,n)}))}}.call(_.prototype),y.defineOptions(_.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(e){this.renderer.$gutterLayer.setShowLineNumbers(e),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),e&&this.$relativeLineNumbers?C.attach(this):C.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(e){this.$showLineNumbers&&e?C.attach(this):C.detach(this)}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var C={getText:function(e,t){return(Math.abs(e.selection.lead.row-t)||t+1+(t<9?"·":""))+""},getWidth:function(e,t,n){return Math.max(t.toString().length,(n.lastRow+1).toString().length,2)*n.characterWidth},update:function(e,t){t.renderer.$loop.schedule(t.renderer.CHANGE_GUTTER)},attach:function(e){e.renderer.$gutterLayer.$renderer=this,e.on("changeSelection",this.update),this.update(null,e)},detach:function(e){e.renderer.$gutterLayer.$renderer==this&&(e.renderer.$gutterLayer.$renderer=null),e.off("changeSelection",this.update),this.update(null,e)}};t.Editor=_})),ace.define("ace/undomanager",[],(function(e,t,n){"use strict";var r=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(e){this.$session=e},this.add=function(e,t,n){this.$fromUndo||e!=this.$lastDelta&&(!1!==t&&this.lastDeltas||(this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev),"remove"!=e.action&&"insert"!=e.action||(this.$lastDelta=e),this.lastDeltas.push(e))},this.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,r=n.length;r--;){var i=n[r][0];if(i.id<=e)break;i.id<t&&(i.ignore=!0)}this.lastDeltas=null},this.getSelection=function(e,t){for(var n=this.selections,r=n.length;r--;){var i=n[r];if(i.rev<e)return t&&(i=n[r+1]),i}},this.getRevision=function(){return this.$rev},this.getDeltas=function(e,t){null==t&&(t=this.$rev+1);for(var n=this.$undoStack,r=null,i=0,o=n.length;o--;){var s=n[o][0];if(s.id<t&&!r&&(r=o+1),s.id<=e){i=o+1;break}}return n.slice(i,r)},this.getChangedRanges=function(e,t){null==t&&(t=this.$rev+1)},this.getChangedLines=function(e,t){null==t&&(t=this.$rev+1)},this.undo=function(e,t){this.lastDeltas=null;var n=this.$undoStack;if(function(e,t){for(var n=t;n--;){var r=e[n];if(r&&!r[0].ignore){for(;n<t-1;){var i=u(e[n],e[n+1]);e[n]=i[0],e[n+1]=i[1],n++}return!0}}}(n,n.length)){e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var r=n.pop(),i=null;return r&&r.length&&(i=e.undoChanges(r,t),this.$redoStack.push(r),this.$syncRev()),this.$fromUndo=!1,i}},this.redo=function(e,t){if(this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var n=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(e,t){for(var n=0;n<t.length;n++)for(var r=t[n],i=0;i<r.length;i++)g(e,r[i])}(this.$redoStack,n),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach((function(e){e[0].id=++this.$maxRev}),this)}var r=this.$redoStack.pop(),i=null;return r&&(i=e.redoChanges(r,t),this.$undoStack.push(r),this.$syncRev()),this.$fromUndo=!1,i},this.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],n=t&&t[0].id||0;this.$redoStackBaseRev=n,this.$rev=n},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(e){null==e&&(e=this.$rev),this.mark=e},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(e){return e?a(e):a(this.$undoStack)+"\n---\n"+a(this.$redoStack)}}).call(r.prototype);var i=e("./range").Range,o=i.comparePoints;i.comparePoints;function s(e){return{row:e.row,column:e.column}}function a(e){if(e=e||this,Array.isArray(e))return e.map(a).join("\n");var t="";return e.action?(t="insert"==e.action?"+":"-",t+="["+e.lines+"]"):e.value&&(t=Array.isArray(e.value)?e.value.map(l).join("\n"):l(e.value)),e.start&&(t+=l(e)),(e.id||e.rev)&&(t+="\t("+(e.id||e.rev)+")"),t}function l(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function c(e,t){var n="insert"==e.action,r="insert"==t.action;if(n&&r)if(o(t.start,e.end)>=0)d(t,e,-1);else{if(!(o(t.start,e.start)<=0))return null;d(e,t,1)}else if(n&&!r)if(o(t.start,e.end)>=0)d(t,e,-1);else{if(!(o(t.end,e.start)<=0))return null;d(e,t,-1)}else if(!n&&r)if(o(t.start,e.start)>=0)d(t,e,1);else{if(!(o(t.start,e.start)<=0))return null;d(e,t,1)}else if(!n&&!r)if(o(t.start,e.start)>=0)d(t,e,1);else{if(!(o(t.end,e.start)<=0))return null;d(e,t,-1)}return[t,e]}function u(e,t){for(var n=e.length;n--;)for(var r=0;r<t.length;r++)if(!c(e[n],t[r])){for(;n<e.length;){for(;r--;)c(t[r],e[n]);r=t.length,n++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function h(e,t){var n="insert"==e.action,r="insert"==t.action;if(n&&r)o(e.start,t.start)<0?d(t,e,1):d(e,t,1);else if(n&&!r)o(e.start,t.end)>=0?d(e,t,-1):o(e.start,t.start)<=0?d(t,e,1):(d(e,i.fromPoints(t.start,e.start),-1),d(t,e,1));else if(!n&&r)o(t.start,e.end)>=0?d(t,e,-1):o(t.start,e.start)<=0?d(e,t,1):(d(t,i.fromPoints(e.start,t.start),-1),d(e,t,1));else if(!n&&!r)if(o(t.start,e.end)>=0)d(t,e,-1);else{var s,a;if(!(o(t.end,e.start)<=0))return o(e.start,t.start)<0&&(s=e,e=p(e,t.start)),o(e.end,t.end)>0&&(a=p(e,t.end)),f(t.end,e.start,e.end,-1),a&&!s&&(e.lines=a.lines,e.start=a.start,e.end=a.end,a=e),[t,s,a].filter(Boolean);d(e,t,-1)}return[t,e]}function d(e,t,n){f(e.start,t.start,t.end,n),f(e.end,t.start,t.end,n)}function f(e,t,n,r){e.row==(1==r?t:n).row&&(e.column+=r*(n.column-t.column)),e.row+=r*(n.row-t.row)}function p(e,t){var n=e.lines,r=e.end;e.end=s(t);var i=e.end.row-e.start.row,o=n.splice(i,n.length),a=i?t.column:t.column-e.start.column;return n.push(o[0].substring(0,a)),o[0]=o[0].substr(a),{start:s(t),end:r,lines:o,action:e.action}}function g(e,t){t=function(e){return{start:s(e.start),end:s(e.end),action:e.action,lines:e.lines.slice()}}(t);for(var n=e.length;n--;){for(var r=e[n],i=0;i<r.length;i++){var o=h(r[i],t);t=o[0],2!=o.length&&(o[2]?(r.splice(i+1,1,o[1],o[2]),i++):o[1]||(r.splice(i,1),i--))}r.length||e.splice(n,1)}return e}t.UndoManager=r})),ace.define("ace/layer/lines",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=function(e,t){this.element=e,this.canvasHeight=t||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0};(function(){this.moveContainer=function(e){r.translate(this.element,0,-e.firstRowScreen*e.lineHeight%this.canvasHeight-e.offset*this.$offsetCoefficient)},this.pageChanged=function(e,t){return Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)!==Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)},this.computeLineTop=function(e,t,n){var r=t.firstRowScreen*t.lineHeight,i=Math.floor(r/this.canvasHeight);return n.documentToScreenRow(e,0)*t.lineHeight-i*this.canvasHeight},this.computeLineHeight=function(e,t,n){return t.lineHeight*n.getRowLength(e)},this.getLength=function(){return this.cells.length},this.get=function(e){return this.cells[e]},this.shift=function(){this.$cacheCell(this.cells.shift())},this.pop=function(){this.$cacheCell(this.cells.pop())},this.push=function(e){if(Array.isArray(e)){this.cells.push.apply(this.cells,e);for(var t=r.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.appendChild(t)}else this.cells.push(e),this.element.appendChild(e.element)},this.unshift=function(e){if(Array.isArray(e)){this.cells.unshift.apply(this.cells,e);for(var t=r.createFragment(this.element),n=0;n<e.length;n++)t.appendChild(e[n].element);this.element.firstChild?this.element.insertBefore(t,this.element.firstChild):this.element.appendChild(t)}else this.cells.unshift(e),this.element.insertAdjacentElement("afterbegin",e.element)},this.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},this.$cacheCell=function(e){e&&(e.element.remove(),this.cellCache.push(e))},this.createCell=function(e,t,n,i){var o=this.cellCache.pop();if(!o){var s=r.createElement("div");i&&i(s),this.element.appendChild(s),o={element:s,text:"",row:e}}return o.row=e,o}}).call(i.prototype),t.Lines=i})),ace.define("ace/layer/gutter",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/oop"),o=e("../lib/lang"),s=e("../lib/event_emitter").EventEmitter,a=e("./lines").Lines,l=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new a(this.element),this.$lines.$offsetCoefficient=1};function c(e){var t=document.createTextNode("");e.appendChild(t);var n=r.createElement("span");return e.appendChild(n),e}(function(){i.implement(this,s),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],r=n.row,i=this.$annotations[r];i||(i=this.$annotations[r]={text:[]});var s=n.text;s=s?o.escapeHTML(s):n.html||"",-1===i.text.indexOf(s)&&i.text.push(s);var a=n.type;"error"==a?i.className=" ace_error":"warning"==a&&" ace_error"!=i.className?i.className=" ace_warning":"info"!=a||i.className||(i.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.start.row,n=e.end.row-t;if(0===n);else if("remove"==e.action)this.$annotations.splice(t,n+1,null);else{var r=new Array(n+1);r.unshift(t,1),this.$annotations.splice.apply(this.$annotations,r)}}},this.update=function(e){this.config=e;var t=this.session,n=e.firstRow,r=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1);this.oldLastRow=r,this.config=e,this.$lines.moveContainer(e),this.$updateCursorRow();for(var i=t.getNextFoldLine(n),o=i?i.start.row:1/0,s=null,a=-1,l=n;;){if(l>o&&(l=i.end.row+1,o=(i=t.getNextFoldLine(l,i))?i.start.row:1/0),l>r){for(;this.$lines.getLength()>a+1;)this.$lines.pop();break}(s=this.$lines.get(++a))?s.row=l:(s=this.$lines.createCell(l,e,this.session,c),this.$lines.push(s)),this.$renderCell(s,e,i,l),l++}this._signal("afterRender"),this.$updateGutterWidth(e)},this.$updateGutterWidth=function(e){var t=this.session,n=t.gutterRenderer||this.$renderer,r=t.$firstLineNumber,i=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||t.$useWrapMode)&&(i=t.getLength()+r-1);var o=n?n.getWidth(t,i,e):i.toString().length*e.characterWidth,s=this.$padding||this.$computePadding();(o+=s.left+s.right)===this.gutterWidth||isNaN(o)||(this.gutterWidth=o,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",o))},this.$updateCursorRow=function(){if(this.$highlightGutterLine){var e=this.session.selection.getCursor();this.$cursorRow!==e.row&&(this.$cursorRow=e.row)}},this.updateLineHighlight=function(){if(this.$highlightGutterLine){var e=this.session.selection.cursor.row;if(this.$cursorRow=e,!this.$cursorCell||this.$cursorCell.row!=e){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var t=this.$lines.cells;this.$cursorCell=null;for(var n=0;n<t.length;n++){var r=t[n];if(r.row>=this.$cursorRow){if(r.row>this.$cursorRow){var i=this.session.getFoldLine(this.$cursorRow);if(!(n>0&&i&&i.start.row==t[n-1].row))break;r=t[n-1]}r.element.className="ace_gutter-active-line "+r.element.className,this.$cursorCell=r;break}}}}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$updateCursorRow(),this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=Math.min(e.lastRow+e.gutterOffset,this.session.getLength()-1),r=this.oldLastRow;if(this.oldLastRow=n,!t||r<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var i=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);i>0;i--)this.$lines.shift();if(r>n)for(i=this.session.getFoldedRowCount(n+1,r);i>0;i--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLines(e,e.firstRow,t.firstRow-1)),n>r&&this.$lines.push(this.$renderLines(e,r+1,n)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(e)},this.$renderLines=function(e,t,n){for(var r=[],i=t,o=this.session.getNextFoldLine(i),s=o?o.start.row:1/0;i>s&&(i=o.end.row+1,s=(o=this.session.getNextFoldLine(i,o))?o.start.row:1/0),!(i>n);){var a=this.$lines.createCell(i,e,this.session,c);this.$renderCell(a,e,o,i),r.push(a),i++}return r},this.$renderCell=function(e,t,n,i){var o=e.element,s=this.session,a=o.childNodes[0],l=o.childNodes[1],c=s.$firstLineNumber,u=s.$breakpoints,h=s.$decorations,d=s.gutterRenderer||this.$renderer,f=this.$showFoldWidgets&&s.foldWidgets,p=n?n.start.row:Number.MAX_VALUE,g="ace_gutter-cell ";if(this.$highlightGutterLine&&(i==this.$cursorRow||n&&i<this.$cursorRow&&i>=p&&this.$cursorRow<=n.end.row)&&(g+="ace_gutter-active-line ",this.$cursorCell!=e&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=e)),u[i]&&(g+=u[i]),h[i]&&(g+=h[i]),this.$annotations[i]&&(g+=this.$annotations[i].className),o.className!=g&&(o.className=g),f){var m=f[i];null==m&&(m=f[i]=s.getFoldWidget(i))}if(m){g="ace_fold-widget ace_"+m;"start"==m&&i==p&&i<n.end.row?g+=" ace_closed":g+=" ace_open",l.className!=g&&(l.className=g);var v=t.lineHeight+"px";r.setStyle(l.style,"height",v),r.setStyle(l.style,"display","inline-block")}else l&&r.setStyle(l.style,"display","none");var y=(d?d.getText(s,i):i+c).toString();return y!==a.data&&(a.data=y),r.setStyle(e.element.style,"height",this.$lines.computeLineHeight(i,t,s)+"px"),r.setStyle(e.element.style,"top",this.$lines.computeLineTop(i,t,s)+"px"),e.text=y,e},this.$fixedWidth=!1,this.$highlightGutterLine=!0,this.$renderer="",this.setHighlightGutterLine=function(e){this.$highlightGutterLine=e},this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return 0},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?r.addCssClass(this.element,"ace_folding-enabled"):r.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=r.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(e.borderLeftWidth)||0)+(parseInt(e.paddingLeft)||0)+1,this.$padding.right=(parseInt(e.borderRightWidth)||0)+(parseInt(e.paddingRight)||0),this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),n=this.element.getBoundingClientRect();return e.x<t.left+n.left?"markers":this.$showFoldWidgets&&e.x>n.right-t.right?"foldWidgets":void 0}}).call(l.prototype),t.Gutter=l})),ace.define("ace/layer/marker",[],(function(e,t,n){"use strict";var r=e("../range").Range,i=e("../lib/dom"),o=function(e){this.element=i.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.elt=function(e,t){var n=-1!=this.i&&this.element.childNodes[this.i];n?this.i++:(n=document.createElement("div"),this.element.appendChild(n),this.i=-1),n.style.cssText=t,n.className=e},this.update=function(e){if(e){var t;for(var n in this.config=e,this.i=0,this.markers){var r=this.markers[n];if(r.range){var i=r.range.clipRows(e.firstRow,e.lastRow);if(!i.isEmpty())if(i=i.toScreenRange(this.session),r.renderer){var o=this.$getTop(i.start.row,e),s=this.$padding+i.start.column*e.characterWidth;r.renderer(t,i,s,o,e)}else"fullLine"==r.type?this.drawFullLineMarker(t,i,r.clazz,e):"screenLine"==r.type?this.drawScreenLineMarker(t,i,r.clazz,e):i.isMultiLine()?"text"==r.type?this.drawTextMarker(t,i,r.clazz,e):this.drawMultiLineMarker(t,i,r.clazz,e):this.drawSingleLineMarker(t,i,r.clazz+" ace_start ace_br15",e)}else r.update(t,this,this.session,e)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,n,i,o){for(var s=this.session,a=t.start.row,l=t.end.row,c=a,u=0,h=0,d=s.getScreenLastRowColumn(c),f=new r(c,t.start.column,c,h);c<=l;c++)f.start.row=f.end.row=c,f.start.column=c==a?t.start.column:s.getRowWrapIndent(c),f.end.column=d,u=h,h=d,d=c+1<l?s.getScreenLastRowColumn(c+1):c==l?0:t.end.column,this.drawSingleLineMarker(e,f,n+(c==a?" ace_start":"")+" ace_br"+((c==a||c==a+1&&t.start.column?1:0)|(u<h?2:0)|(h>d?4:0)|(c==l?8:0)),i,c==l?0:1,o)},this.drawMultiLineMarker=function(e,t,n,r,i){var o=this.$padding,s=r.lineHeight,a=this.$getTop(t.start.row,r),l=o+t.start.column*r.characterWidth;(i=i||"",this.session.$bidiHandler.isBidiRow(t.start.row))?((c=t.clone()).end.row=c.start.row,c.end.column=this.session.getLine(c.start.row).length,this.drawBidiSingleLineMarker(e,c,n+" ace_br1 ace_start",r,null,i)):this.elt(n+" ace_br1 ace_start","height:"+s+"px;right:0;top:"+a+"px;left:"+l+"px;"+(i||""));if(this.session.$bidiHandler.isBidiRow(t.end.row)){var c;(c=t.clone()).start.row=c.end.row,c.start.column=0,this.drawBidiSingleLineMarker(e,c,n+" ace_br12",r,null,i)}else{a=this.$getTop(t.end.row,r);var u=t.end.column*r.characterWidth;this.elt(n+" ace_br12","height:"+s+"px;width:"+u+"px;top:"+a+"px;left:"+o+"px;"+(i||""))}if(!((s=(t.end.row-t.start.row-1)*r.lineHeight)<=0)){a=this.$getTop(t.start.row+1,r);var h=(t.start.column?1:0)|(t.end.column?0:8);this.elt(n+(h?" ace_br"+h:""),"height:"+s+"px;right:0;top:"+a+"px;left:"+o+"px;"+(i||""))}},this.drawSingleLineMarker=function(e,t,n,r,i,o){if(this.session.$bidiHandler.isBidiRow(t.start.row))return this.drawBidiSingleLineMarker(e,t,n,r,i,o);var s=r.lineHeight,a=(t.end.column+(i||0)-t.start.column)*r.characterWidth,l=this.$getTop(t.start.row,r),c=this.$padding+t.start.column*r.characterWidth;this.elt(n,"height:"+s+"px;width:"+a+"px;top:"+l+"px;left:"+c+"px;"+(o||""))},this.drawBidiSingleLineMarker=function(e,t,n,r,i,o){var s=r.lineHeight,a=this.$getTop(t.start.row,r),l=this.$padding;this.session.$bidiHandler.getSelections(t.start.column,t.end.column).forEach((function(e){this.elt(n,"height:"+s+"px;width:"+e.width+(i||0)+"px;top:"+a+"px;left:"+(l+e.left)+"px;"+(o||""))}),this)},this.drawFullLineMarker=function(e,t,n,r,i){var o=this.$getTop(t.start.row,r),s=r.lineHeight;t.start.row!=t.end.row&&(s+=this.$getTop(t.end.row,r)-o),this.elt(n,"height:"+s+"px;top:"+o+"px;left:0;right:0;"+(i||""))},this.drawScreenLineMarker=function(e,t,n,r,i){var o=this.$getTop(t.start.row,r),s=r.lineHeight;this.elt(n,"height:"+s+"px;top:"+o+"px;left:0;right:0;"+(i||""))}}).call(o.prototype),t.Marker=o})),ace.define("ace/layer/text",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../lib/dom"),o=e("../lib/lang"),s=e("./lines").Lines,a=e("../lib/event_emitter").EventEmitter,l=function(e){this.dom=i,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new s(this.element)};(function(){r.implement(this,a),this.EOF_CHAR="¶",this.EOL_CHAR_LF="¬",this.EOL_CHAR_CRLF="¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="—",this.SPACE_CHAR="·",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var e=this.session.doc,t="\n"==e.getNewLineCharacter()&&"windows"!=e.getNewLineMode()?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=t)return this.EOL_CHAR=t,!0},this.setPadding=function(e){this.$padding=e,this.element.style.margin="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,e&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],n=1;n<e+1;n++){if(this.showInvisibles)(r=this.dom.createElement("span")).className="ace_invisible ace_invisible_tab",r.textContent=o.stringRepeat(this.TAB_CHAR,n),t.push(r);else t.push(this.dom.createTextNode(o.stringRepeat(" ",n),this.element))}if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var r,i="ace_indent-guide",s="",a="";if(this.showInvisibles){i+=" ace_invisible",s=" ace_invisible_space",a=" ace_invisible_tab";var l=o.stringRepeat(this.SPACE_CHAR,this.tabSize),c=o.stringRepeat(this.TAB_CHAR,this.tabSize)}else c=l=o.stringRepeat(" ",this.tabSize);(r=this.dom.createElement("span")).className=i+s,r.textContent=l,this.$tabStrings[" "]=r,(r=this.dom.createElement("span")).className=i+a,r.textContent=c,this.$tabStrings["\t"]=r}},this.updateLines=function(e,t,n){if(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)return this.update(e);this.config=e;for(var r=Math.max(t,e.firstRow),i=Math.min(n,e.lastRow),o=this.element.childNodes,s=0,a=e.firstRow;a<r;a++){if(l=this.session.getFoldLine(a)){if(l.containsRow(r)){r=l.start.row;break}a=l.end.row}s++}for(var l,c=!1,u=(a=r,(l=this.session.getNextFoldLine(a))?l.start.row:1/0);a>u&&(a=l.end.row+1,u=(l=this.session.getNextFoldLine(a,l))?l.start.row:1/0),!(a>i);){var h=o[s++];if(h){this.dom.removeChildren(h),this.$renderLine(h,a,a==u&&l);var d=e.lineHeight*this.session.getRowLength(a)+"px";h.style.height!=d&&(c=!0,h.style.height=d)}a++}if(c)for(;s<this.$lines.cells.length;){var f=this.$lines.cells[s++];f.element.style.top=this.$lines.computeLineTop(f.row,e,this.session)+"px"}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var n=e.lastRow,r=t?t.lastRow:-1;if(!t||r<e.firstRow)return this.update(e);if(n<t.firstRow)return this.update(e);if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var i=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);i>0;i--)this.$lines.shift();if(t.lastRow>e.lastRow)for(i=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);i>0;i--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLinesFragment(e,e.firstRow,t.firstRow-1)),e.lastRow>t.lastRow&&this.$lines.push(this.$renderLinesFragment(e,t.lastRow+1,e.lastRow))},this.$renderLinesFragment=function(e,t,n){for(var r=[],o=t,s=this.session.getNextFoldLine(o),a=s?s.start.row:1/0;o>a&&(o=s.end.row+1,a=(s=this.session.getNextFoldLine(o,s))?s.start.row:1/0),!(o>n);){var l=this.$lines.createCell(o,e,this.session),c=l.element;this.dom.removeChildren(c),i.setStyle(c.style,"height",this.$lines.computeLineHeight(o,e,this.session)+"px"),i.setStyle(c.style,"top",this.$lines.computeLineTop(o,e,this.session)+"px"),this.$renderLine(c,o,o==a&&s),this.$useLineGroups()?c.className="ace_line_group":c.className="ace_line",r.push(l),o++}return r},this.update=function(e){this.$lines.moveContainer(e),this.config=e;for(var t=e.firstRow,n=e.lastRow,r=this.$lines;r.getLength();)r.pop();r.push(this.$renderLinesFragment(e,t,n))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,n,r){for(var i,s=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,a=this.dom.createFragment(this.element),l=0;i=s.exec(r);){var c=i[1],u=i[2],h=i[3],d=i[4],f=i[5];if(this.showInvisibles||!u){var p=l!=i.index?r.slice(l,i.index):"";if(l=i.index+i[0].length,p&&a.appendChild(this.dom.createTextNode(p,this.element)),c){var g=this.session.getScreenTabSize(t+i.index);a.appendChild(this.$tabStrings[g].cloneNode(!0)),t+=g-1}else if(u){if(this.showInvisibles)(v=this.dom.createElement("span")).className="ace_invisible ace_invisible_space",v.textContent=o.stringRepeat(this.SPACE_CHAR,u.length),a.appendChild(v);else a.appendChild(this.com.createTextNode(u,this.element))}else if(h){(v=this.dom.createElement("span")).className="ace_invisible ace_invisible_space ace_invalid",v.textContent=o.stringRepeat(this.SPACE_CHAR,h.length),a.appendChild(v)}else if(d){this.showInvisibles&&this.SPACE_CHAR;t+=1,(v=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",v.className=this.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",v.textContent=this.showInvisibles?this.SPACE_CHAR:"",a.appendChild(v)}else if(f){t+=1,(v=this.dom.createElement("span")).style.width=2*this.config.characterWidth+"px",v.className="ace_cjk",v.textContent=f,a.appendChild(v)}}}if(a.appendChild(this.dom.createTextNode(l?r.slice(l):r,this.element)),this.$textToken[n.type])e.appendChild(a);else{var m="ace_"+n.type.replace(/\./g," ace_"),v=this.dom.createElement("span");"fold"==n.type&&(v.style.width=n.value.length*this.config.characterWidth+"px"),v.className=m,v.appendChild(a),e.appendChild(v)}return t+r.length},this.renderIndentGuide=function(e,t,n){var r=t.search(this.$indentGuideRe);if(r<=0||r>=n)return t;if(" "==t[0]){for(var i=(r-=r%this.tabSize)/this.tabSize,o=0;o<i;o++)e.appendChild(this.$tabStrings[" "].cloneNode(!0));return t.substr(r)}if("\t"==t[0]){for(o=0;o<r;o++)e.appendChild(this.$tabStrings["\t"].cloneNode(!0));return t.substr(r)}return t},this.$createLineElement=function(e){var t=this.dom.createElement("div");return t.className="ace_line",t.style.height=this.config.lineHeight+"px",t},this.$renderWrappedLine=function(e,t,n){var r=0,i=0,s=n[0],a=0,l=this.$createLineElement();e.appendChild(l);for(var c=0;c<t.length;c++){var u=t[c],h=u.value;if(0==c&&this.displayIndentGuides){if(r=h.length,!(h=this.renderIndentGuide(l,h,s)))continue;r-=h.length}if(r+h.length<s)a=this.$renderToken(l,a,u,h),r+=h.length;else{for(;r+h.length>=s;)a=this.$renderToken(l,a,u,h.substring(0,s-r)),h=h.substring(s-r),r=s,l=this.$createLineElement(),e.appendChild(l),l.appendChild(this.dom.createTextNode(o.stringRepeat(" ",n.indent),this.element)),a=0,s=n[++i]||Number.MAX_VALUE;0!=h.length&&(r+=h.length,a=this.$renderToken(l,a,u,h))}}n[n.length-1]>this.MAX_LINE_LENGTH&&this.$renderOverflowMessage(l,a,null,"",!0)},this.$renderSimpleLine=function(e,t){var n=0,r=t[0],i=r.value;this.displayIndentGuides&&(i=this.renderIndentGuide(e,i)),i&&(n=this.$renderToken(e,n,r,i));for(var o=1;o<t.length;o++){if(n+(i=(r=t[o]).value).length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,n,r,i);n=this.$renderToken(e,n,r,i)}},this.$renderOverflowMessage=function(e,t,n,r,i){n&&this.$renderToken(e,t,n,r.slice(0,this.MAX_LINE_LENGTH-t));var o=this.dom.createElement("span");o.className="ace_inline_button ace_keyword ace_toggle_wrap",o.textContent=i?"<hide>":"<click to see more...>",e.appendChild(o)},this.$renderLine=function(e,t,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var r=this.$getFoldLineTokens(t,n);else r=this.session.getTokens(t);var i=e;if(r.length){var o=this.session.getRowSplitData(t);if(o&&o.length){this.$renderWrappedLine(e,r,o);i=e.lastChild}else{i=e;this.$useLineGroups()&&(i=this.$createLineElement(),e.appendChild(i)),this.$renderSimpleLine(i,r)}}else this.$useLineGroups()&&(i=this.$createLineElement(),e.appendChild(i));if(this.showInvisibles&&i){n&&(t=n.end.row);var s=this.dom.createElement("span");s.className="ace_invisible ace_invisible_eol",s.textContent=t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,i.appendChild(s)}},this.$getFoldLineTokens=function(e,t){var n=this.session,r=[];var i=n.getTokens(e);return t.walk((function(e,t,o,s,a){null!=e?r.push({type:"fold",value:e}):(a&&(i=n.getTokens(t)),i.length&&function(e,t,n){for(var i=0,o=0;o+e[i].value.length<t;)if(o+=e[i].value.length,++i==e.length)return;for(o!=t&&((s=e[i].value.substring(t-o)).length>n-t&&(s=s.substring(0,n-t)),r.push({type:e[i].type,value:s}),o=t+s.length,i+=1);o<n&&i<e.length;){var s;(s=e[i].value).length+o>n?r.push({type:e[i].type,value:s.substring(0,n-o)}):r.push(e[i]),o+=s.length,i+=1}}(i,s,o))}),t.end.row,this.session.getLine(t.end.row).length),r},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){}}).call(l.prototype),t.Text=l})),ace.define("ace/layer/cursor",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=function(e){this.element=r.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),r.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)};(function(){this.$updateOpacity=function(e){for(var t=this.cursors,n=t.length;n--;)r.setStyle(t[n].style,"opacity",e?"":"0")},this.$startCssAnimation=function(){for(var e=this.cursors,t=e.length;t--;)e[t].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){r.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){r.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e!=this.smoothBlinking&&(this.smoothBlinking=e,r.setCssClass(this.element,"ace_smooth-blinking",e),this.$updateCursors(!0),this.restartTimer())},this.addCursor=function(){var e=r.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,r.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,r.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var e=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&r.removeCssClass(this.element,"ace_smooth-blinking"),e(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&setTimeout(function(){r.addCssClass(this.element,"ace_smooth-blinking")}.bind(this)),r.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var t=function(){this.timeoutId=setTimeout((function(){e(!1)}),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval((function(){e(!0),t()}),this.blinkInterval),t()}else this.$stopCssAnimation()},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var n=this.session.documentToScreenPosition(e);return{left:this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e.row)?this.session.$bidiHandler.getPosLeft(n.column):n.column*this.config.characterWidth),top:(n.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight}},this.isCursorInView=function(e,t){return e.top>=0&&e.top<t.maxHeight},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,n=0,i=0;void 0!==t&&0!==t.length||(t=[{cursor:null}]);n=0;for(var o=t.length;n<o;n++){var s=this.getPixelPosition(t[n].cursor,!0);if(!((s.top>e.height+e.offset||s.top<0)&&n>1)){var a=this.cursors[i++]||this.addCursor(),l=a.style;this.drawCursor?this.drawCursor(a,s,e,t[n],this.session):this.isCursorInView(s,e)?(r.setStyle(l,"display","block"),r.translate(a,s.left,s.top),r.setStyle(l,"width",Math.round(e.characterWidth)+"px"),r.setStyle(l,"height",e.lineHeight+"px")):r.setStyle(l,"display","none")}}for(;this.cursors.length>i;)this.removeCursor();var c=this.session.getOverwrite();this.$setOverwrite(c),this.$pixelPos=s,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?r.addCssClass(this.element,"ace_overwrite-cursors"):r.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(i.prototype),t.Cursor=i})),ace.define("ace/scrollbar",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),o=e("./lib/event"),s=e("./lib/event_emitter").EventEmitter,a=function(e){this.element=i.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=i.createElement("div"),this.inner.className="ace_scrollbar-inner",this.inner.textContent=" ",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,o.addListener(this.element,"scroll",this.onScroll.bind(this)),o.addListener(this.element,"mousedown",o.preventDefault)};(function(){r.implement(this,s),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1}}).call(a.prototype);var l=function(e,t){a.call(this,e),this.scrollTop=0,this.scrollHeight=0,t.$scrollbarWidth=this.width=i.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};r.inherits(l,a),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=this.setScrollHeight=function(e){this.scrollHeight=e,e>32768?(this.coeff=32768/e,e=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)}}.call(l.prototype);var c=function(e,t){a.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};r.inherits(c,a),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(c.prototype),t.ScrollBar=l,t.ScrollBarV=l,t.ScrollBarH=c,t.VScrollBar=l,t.HScrollBar=c})),ace.define("ace/renderloop",[],(function(e,t,n){"use strict";var r=e("./lib/event"),i=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=t||window;var n=this;this._flush=function(e){n.pending=!1;var t=n.changes;if(t&&(r.blockIdle(100),n.changes=0,n.onRender(t)),n.changes){if(n.$recursionLimit--<0)return;n.schedule()}else n.$recursionLimit=2}};(function(){this.schedule=function(e){this.changes=this.changes|e,this.changes&&!this.pending&&(r.nextFrame(this._flush),this.pending=!0)},this.clear=function(e){var t=this.changes;return this.changes=0,t}}).call(i.prototype),t.RenderLoop=i})),ace.define("ace/layer/font_metrics",[],(function(e,t,n){var r=e("../lib/oop"),i=e("../lib/dom"),o=e("../lib/lang"),s=e("../lib/event"),a=e("../lib/useragent"),l=e("../lib/event_emitter").EventEmitter,c="function"==typeof ResizeObserver,u=200,h=t.FontMetrics=function(e){this.el=i.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=i.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=i.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.innerHTML=o.stringRepeat("X",256),this.$characterSize={width:0,height:0},c?this.$addObserver():this.checkForSizeChanges()};(function(){r.implement(this,l),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",a.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(e){if(void 0===e&&(e=this.$measureSizes()),e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver((function(t){var n=t[0].contentRect;e.checkForSizeChanges({height:n.height,width:n.width/256})})),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=s.onIdle((function t(){e.checkForSizeChanges(),s.onIdle(t,500)}),500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/256};return 0===t.width||0===t.height?null:t},this.$measureCharWidth=function(e){return this.$main.innerHTML=o.stringRepeat(e,256),this.$main.getBoundingClientRect().width/256},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(t){return t?(window.getComputedStyle(t).zoom||1)*e(t.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=i.buildDom([e(0,0),e(u,0),e(0,u),e(u,u)],this.el)},this.transformCoordinates=function(e,t){e&&(e=o(1/this.$getZoom(this.el),e));function n(e,t,n){var r=e[1]*t[0]-e[0]*t[1];return[(-t[1]*n[0]+t[0]*n[1])/r,(+e[1]*n[0]-e[0]*n[1])/r]}function r(e,t){return[e[0]-t[0],e[1]-t[1]]}function i(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e*t[0],e*t[1]]}function s(e){var t=e.getBoundingClientRect();return[t.left,t.top]}this.els||this.$initTransformMeasureNodes();var a=s(this.els[0]),l=s(this.els[1]),c=s(this.els[2]),h=s(this.els[3]),d=n(r(h,l),r(h,c),r(i(l,c),i(h,a))),f=o(1+d[0],r(l,a)),p=o(1+d[1],r(c,a));if(t){var g=t,m=d[0]*g[0]/u+d[1]*g[1]/u+1,v=i(o(g[0],f),o(g[1],p));return i(o(1/m/u,v),a)}var y=r(e,a),b=n(r(f,o(d[0],y)),r(p,o(d[1],y)),y);return o(u,b)}}).call(h.prototype)})),ace.define("ace/virtual_renderer",[],(function(e,t,n){"use strict";var r=e("./lib/oop"),i=e("./lib/dom"),o=e("./config"),s=e("./layer/gutter").Gutter,a=e("./layer/marker").Marker,l=e("./layer/text").Text,c=e("./layer/cursor").Cursor,u=e("./scrollbar").HScrollBar,h=e("./scrollbar").VScrollBar,d=e("./renderloop").RenderLoop,f=e("./layer/font_metrics").FontMetrics,p=e("./lib/event_emitter").EventEmitter,g='.ace_br1 {border-top-left-radius    : 3px;}.ace_br2 {border-top-right-radius   : 3px;}.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}.ace_br4 {border-bottom-right-radius: 3px;}.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}.ace_br8 {border-bottom-left-radius : 3px;}.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}.ace_editor {position: relative;overflow: hidden;font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;direction: ltr;text-align: left;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);}.ace_scroller {position: absolute;overflow: hidden;top: 0;bottom: 0;background-color: inherit;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;cursor: text;}.ace_content {position: absolute;box-sizing: border-box;min-width: 100%;contain: style size layout;}.ace_dragging .ace_scroller:before{position: absolute;top: 0;left: 0;right: 0;bottom: 0;content: \'\';background: rgba(250, 250, 250, 0.01);z-index: 1000;}.ace_dragging.ace_dark .ace_scroller:before{background: rgba(0, 0, 0, 0.01);}.ace_selecting, .ace_selecting * {cursor: text !important;}.ace_gutter {position: absolute;overflow : hidden;width: auto;top: 0;bottom: 0;left: 0;cursor: default;z-index: 4;-ms-user-select: none;-moz-user-select: none;-webkit-user-select: none;user-select: none;contain: style size layout;}.ace_gutter-active-line {position: absolute;left: 0;right: 0;}.ace_scroller.ace_scroll-left {box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;}.ace_gutter-cell {position: absolute;top: 0;left: 0;right: 0;padding-left: 19px;padding-right: 6px;background-repeat: no-repeat;}.ace_gutter-cell.ace_error {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: 2px center;}.ace_gutter-cell.ace_warning {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");background-position: 2px center;}.ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");background-position: 2px center;}.ace_dark .ace_gutter-cell.ace_info {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");}.ace_scrollbar {contain: strict;position: absolute;right: 0;bottom: 0;z-index: 6;}.ace_scrollbar-inner {position: absolute;cursor: text;left: 0;top: 0;}.ace_scrollbar-v{overflow-x: hidden;overflow-y: scroll;top: 0;}.ace_scrollbar-h {overflow-x: scroll;overflow-y: hidden;left: 0;}.ace_print-margin {position: absolute;height: 100%;}.ace_text-input {position: absolute;z-index: 0;width: 0.5em;height: 1em;opacity: 0;background: transparent;-moz-appearance: none;appearance: none;border: none;resize: none;outline: none;overflow: hidden;font: inherit;padding: 0 1px;margin: 0 -1px;contain: strict;-ms-user-select: text;-moz-user-select: text;-webkit-user-select: text;user-select: text;white-space: pre!important;}.ace_text-input.ace_composition {background: transparent;color: inherit;z-index: 1000;opacity: 1;}.ace_composition_placeholder { color: transparent }.ace_composition_marker { border-bottom: 1px solid;position: absolute;border-radius: 0;margin-top: 1px;}[ace_nocontext=true] {transform: none!important;filter: none!important;perspective: none!important;clip-path: none!important;mask : none!important;contain: none!important;perspective: none!important;mix-blend-mode: initial!important;z-index: auto;}.ace_layer {z-index: 1;position: absolute;overflow: hidden;word-wrap: normal;white-space: pre;height: 100%;width: 100%;box-sizing: border-box;pointer-events: none;}.ace_gutter-layer {position: relative;width: auto;text-align: right;pointer-events: auto;height: 1000000px;contain: style size layout;}.ace_text-layer {font: inherit !important;position: absolute;height: 1000000px;width: 1000000px;contain: style size layout;}.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {contain: style size layout;position: absolute;top: 0;left: 0;right: 0;}.ace_hidpi .ace_text-layer,.ace_hidpi .ace_gutter-layer,.ace_hidpi .ace_content,.ace_hidpi .ace_gutter {contain: strict;will-change: transform;}.ace_hidpi .ace_text-layer > .ace_line, .ace_hidpi .ace_text-layer > .ace_line_group {contain: strict;}.ace_cjk {display: inline-block;text-align: center;}.ace_cursor-layer {z-index: 4;}.ace_cursor {z-index: 4;position: absolute;box-sizing: border-box;border-left: 2px solid;transform: translatez(0);}.ace_multiselect .ace_cursor {border-left-width: 1px;}.ace_slim-cursors .ace_cursor {border-left-width: 1px;}.ace_overwrite-cursors .ace_cursor {border-left-width: 0;border-bottom: 1px solid;}.ace_hidden-cursors .ace_cursor {opacity: 0.2;}.ace_smooth-blinking .ace_cursor {transition: opacity 0.18s;}.ace_animate-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: step-end;animation-name: blink-ace-animate;animation-iteration-count: infinite;}.ace_animate-blinking.ace_smooth-blinking .ace_cursor {animation-duration: 1000ms;animation-timing-function: ease-in-out;animation-name: blink-ace-animate-smooth;}@keyframes blink-ace-animate {from, to { opacity: 1; }60% { opacity: 0; }}@keyframes blink-ace-animate-smooth {from, to { opacity: 1; }45% { opacity: 1; }60% { opacity: 0; }85% { opacity: 0; }}.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {position: absolute;z-index: 3;}.ace_marker-layer .ace_selection {position: absolute;z-index: 5;}.ace_marker-layer .ace_bracket {position: absolute;z-index: 6;}.ace_marker-layer .ace_active-line {position: absolute;z-index: 2;}.ace_marker-layer .ace_selected-word {position: absolute;z-index: 4;box-sizing: border-box;}.ace_line .ace_fold {box-sizing: border-box;display: inline-block;height: 11px;margin-top: -2px;vertical-align: middle;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");background-repeat: no-repeat, repeat-x;background-position: center center, top left;color: transparent;border: 1px solid black;border-radius: 2px;cursor: pointer;pointer-events: auto;}.ace_dark .ace_fold {}.ace_fold:hover{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");}.ace_tooltip {background-color: #FFF;background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));border: 1px solid gray;border-radius: 1px;box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);color: black;max-width: 100%;padding: 3px 4px;position: fixed;z-index: 999999;box-sizing: border-box;cursor: default;white-space: pre;word-wrap: break-word;line-height: normal;font-style: normal;font-weight: normal;letter-spacing: normal;pointer-events: none;}.ace_folding-enabled > .ace_gutter-cell {padding-right: 13px;}.ace_fold-widget {box-sizing: border-box;margin: 0 -12px 0 1px;display: none;width: 11px;vertical-align: top;background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");background-repeat: no-repeat;background-position: center;border-radius: 3px;border: 1px solid transparent;cursor: pointer;}.ace_folding-enabled .ace_fold-widget {display: inline-block;   }.ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");}.ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");}.ace_fold-widget:hover {border: 1px solid rgba(0, 0, 0, 0.3);background-color: rgba(255, 255, 255, 0.2);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);}.ace_fold-widget:active {border: 1px solid rgba(0, 0, 0, 0.4);background-color: rgba(0, 0, 0, 0.05);box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);}.ace_dark .ace_fold-widget {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");}.ace_dark .ace_fold-widget.ace_end {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget.ace_closed {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");}.ace_dark .ace_fold-widget:hover {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);background-color: rgba(255, 255, 255, 0.1);}.ace_dark .ace_fold-widget:active {box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);}.ace_inline_button {border: 1px solid lightgray;display: inline-block;margin: -1px 8px;padding: 0 5px;pointer-events: auto;cursor: pointer;}.ace_inline_button:hover {border-color: gray;background: rgba(200,200,200,0.2);display: inline-block;pointer-events: auto;}.ace_fold-widget.ace_invalid {background-color: #FFB4B4;border-color: #DE5555;}.ace_fade-fold-widgets .ace_fold-widget {transition: opacity 0.4s ease 0.05s;opacity: 0;}.ace_fade-fold-widgets:hover .ace_fold-widget {transition: opacity 0.05s ease 0.05s;opacity:1;}.ace_underline {text-decoration: underline;}.ace_bold {font-weight: bold;}.ace_nobold .ace_bold {font-weight: normal;}.ace_italic {font-style: italic;}.ace_error-marker {background-color: rgba(255, 0, 0,0.2);position: absolute;z-index: 9;}.ace_highlight-marker {background-color: rgba(255, 255, 0,0.2);position: absolute;z-index: 8;}',m=e("./lib/useragent"),v=m.isIE;i.importCssString(g,"ace_editor.css");var y=function(e,t){var n=this;this.container=e||i.createElement("div"),i.addCssClass(this.container,"ace_editor"),i.HI_DPI&&i.addCssClass(this.container,"ace_hidpi"),this.setTheme(t),this.$gutter=i.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=i.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=i.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new s(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new a(this.content);var r=this.$textLayer=new l(this.content);this.canvas=r.element,this.$markerFront=new a(this.content),this.$cursorLayer=new c(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new h(this.container,this),this.scrollBarH=new u(this.container,this),this.scrollBarV.addEventListener("scroll",(function(e){n.$scrollAnimation||n.session.setScrollTop(e.data-n.scrollMargin.top)})),this.scrollBarH.addEventListener("scroll",(function(e){n.$scrollAnimation||n.session.setScrollLeft(e.data-n.scrollMargin.left)})),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new f(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",(function(e){n.updateCharacterSize(),n.onResize(!0,n.gutterWidth,n.$size.width,n.$size.height),n._signal("changeCharacterSize",e)})),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!m.isIOS,this.$loop=new d(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),o.resetOptions(this),o._signal("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,r.implement(this,p),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t,n){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!n)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,n,r){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var i=this.container;r||(r=i.clientHeight||i.scrollHeight),n||(n=i.clientWidth||i.scrollWidth);var o=this.$updateCachedSize(e,t,n,r);if(!this.$size.scrollerHeight||!n&&!r)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(o|this.$changes,!0):this.$loop.schedule(o|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(e,t,n,r){r-=this.$extraHeight||0;var o=0,s=this.$size,a={width:s.width,height:s.height,scrollerHeight:s.scrollerHeight,scrollerWidth:s.scrollerWidth};if(r&&(e||s.height!=r)&&(s.height=r,o|=this.CHANGE_SIZE,s.scrollerHeight=s.height,this.$horizScroll&&(s.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",o|=this.CHANGE_SCROLL),n&&(e||s.width!=n)){o|=this.CHANGE_SIZE,s.width=n,null==t&&(t=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=t,i.setStyle(this.scrollBarH.element.style,"left",t+"px"),i.setStyle(this.scroller.style,"left",t+this.margin.left+"px"),s.scrollerWidth=Math.max(0,n-t-this.scrollBarV.getWidth()-this.margin.h),i.setStyle(this.$gutter.style,"left",this.margin.left+"px");var l=this.scrollBarV.getWidth()+"px";i.setStyle(this.scrollBarH.element.style,"right",l),i.setStyle(this.scroller.style,"right",l),i.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(o|=this.CHANGE_FULL)}return s.$dirty=!n||!r,o&&this._signal("resize",a),o},this.onGutterResize=function(e){var t=this.$showGutter?e:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=i.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=i.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(!this.$isMousePressed){var e=this.textarea.style,t=this.$composition;if(this.$keepTextAreaAtCursor||t){var n=this.$cursorLayer.$pixelPos;if(n){t&&t.markerRange&&(n=this.$cursorLayer.getPixelPosition(t.markerRange.start,!0));var r=this.layerConfig,o=n.top,s=n.left;o-=r.offset;var a=t&&t.useTextareaForIME?this.lineHeight:v?0:1;if(o<0||o>r.height-a)i.translate(this.textarea,0,0);else{var l=1;if(t)if(t.useTextareaForIME){var c=this.textarea.value;l=this.characterWidth*this.session.$getStringScreenWidth(c)[0],a+=2}else o+=this.lineHeight+2;else o+=this.lineHeight;(s-=this.scrollLeft)>this.$size.scrollerWidth-l&&(s=this.$size.scrollerWidth-l),s+=this.gutterWidth+this.margin.left,i.setStyle(e,"height",a+"px"),i.setStyle(e,"width",l+"px"),i.translate(this.textarea,Math.min(s,this.$size.scrollerWidth-l),Math.min(o,this.$size.height-a))}}}else i.translate(this.textarea,-100,0)}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow;return this.session.documentToScreenRow(t,0)*e.lineHeight-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,n,r){var i=this.scrollMargin;i.top=0|e,i.bottom=0|t,i.right=0|r,i.left=0|n,i.v=i.top+i.bottom,i.h=i.left+i.right,i.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-i.top),this.updateFull()},this.setMargin=function(e,t,n,r){var i=this.margin;i.top=0|e,i.bottom=0|t,i.right=0|r,i.left=0|n,i.v=i.top+i.bottom,i.h=i.left+i.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,t){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||t)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig()|this.$loop.clear(),n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var r=this.scrollTop+(n.firstRow-this.layerConfig.firstRow)*this.lineHeight;r>0&&(this.scrollTop=r,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig()|this.$loop.clear())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),i.translate(this.content,-this.scrollLeft,-n.offset);var o=n.width+2*this.$padding+"px",s=n.minHeight+"px";i.setStyle(this.content.style,"width",o),i.setStyle(this.content.style,"height",s)}if(e&this.CHANGE_H_SCROLL&&(i.translate(this.content,-this.scrollLeft,-n.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL)return this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender");if(e&this.CHANGE_SCROLL)return e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&(e&this.CHANGE_GUTTER||e&this.CHANGE_LINES?this.$gutterLayer.update(n):this.$gutterLayer.scrollLines(n)),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender");e&this.CHANGE_TEXT?(this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n):e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER?this.$showGutter&&this.$gutterLayer.update(n):e&this.CHANGE_CURSOR&&this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(n),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender")}else this.$changes|=e},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,n=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(n+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&n>this.$maxPixelHeight&&(n=this.$maxPixelHeight);var r=!(n<=2*this.lineHeight)&&e>t;if(n!=this.desiredHeight||this.$size.height!=this.desiredHeight||r!=this.$vScroll){r!=this.$vScroll&&(this.$vScroll=r,this.scrollBarV.setVisible(r));var i=this.container.clientWidth;this.container.style.height=n+"px",this.$updateCachedSize(!0,this.$gutterWidth,i,n),this.desiredHeight=n,this._signal("autosize")}},this.$computeLayerConfig=function(){var e=this.session,t=this.$size,n=t.height<=2*this.lineHeight,r=this.session.getScreenLength()*this.lineHeight,i=this.$getLongestLine(),o=!n&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-i-2*this.$padding<0),s=this.$horizScroll!==o;s&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var a=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var l=t.scrollerHeight+this.lineHeight,c=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;r+=c;var u=this.scrollMargin;this.session.setScrollTop(Math.max(-u.top,Math.min(this.scrollTop,r-t.scrollerHeight+u.bottom))),this.session.setScrollLeft(Math.max(-u.left,Math.min(this.scrollLeft,i+2*this.$padding-t.scrollerWidth+u.right)));var h=!n&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-r+c<0||this.scrollTop>u.top),d=a!==h;d&&(this.$vScroll=h,this.scrollBarV.setVisible(h));var f,p,g=this.scrollTop%this.lineHeight,m=Math.ceil(l/this.lineHeight)-1,v=Math.max(0,Math.round((this.scrollTop-g)/this.lineHeight)),y=v+m,b=this.lineHeight;v=e.screenToDocumentRow(v,0);var w=e.getFoldLine(v);w&&(v=w.start.row),f=e.documentToScreenRow(v,0),p=e.getRowLength(v)*b,y=Math.min(e.screenToDocumentRow(y,0),e.getLength()-1),l=t.scrollerHeight+e.getRowLength(y)*b+p,g=this.scrollTop-f*b;var _=0;return(this.layerConfig.width!=i||s)&&(_=this.CHANGE_H_SCROLL),(s||d)&&(_|=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),d&&(i=this.$getLongestLine())),this.layerConfig={width:i,padding:this.$padding,firstRow:v,firstRowScreen:f,lastRow:y,lineHeight:b,characterWidth:this.characterWidth,minHeight:l,maxHeight:r,offset:g,gutterOffset:b?Math.max(0,Math.ceil((g+t.height-t.scrollerHeight)/b)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(i-this.$padding),_},this.$updateLines=function(){if(this.$changedLines){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var n=this.layerConfig;if(!(e>n.lastRow+1||t<n.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(n),void this.$textLayer.update(n)):(this.$textLayer.updateLines(n,e,t),!0)}},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,n){this.scrollCursorIntoView(e,n),this.scrollCursorIntoView(t,n)},this.scrollCursorIntoView=function(e,t,n){if(0!==this.$size.scrollerHeight){var r=this.$cursorLayer.getPixelPosition(e),i=r.left,o=r.top,s=n&&n.top||0,a=n&&n.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+s>o?(t&&l+s>o+this.lineHeight&&(o-=t*this.$size.scrollerHeight),0===o&&(o=-this.scrollMargin.top),this.session.setScrollTop(o)):l+this.$size.scrollerHeight-a<o+this.lineHeight&&(t&&l+this.$size.scrollerHeight-a<o-this.lineHeight&&(o+=t*this.$size.scrollerHeight),this.session.setScrollTop(o+this.lineHeight+a-this.$size.scrollerHeight));var c=this.scrollLeft;c>i?(i<this.$padding+2*this.layerConfig.characterWidth&&(i=-this.scrollMargin.left),this.session.setScrollLeft(i)):c+this.$size.scrollerWidth<i+this.characterWidth?this.session.setScrollLeft(Math.round(i+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&i-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var n=this.$cursorLayer.getPixelPosition(e),r=this.$size.scrollerHeight-this.lineHeight,i=n.top-r*(t||0);return this.session.setScrollTop(i),i},this.STEPS=8,this.$calcSteps=function(e,t){var n,r,i=0,o=this.STEPS,s=[];for(i=0;i<o;++i)s.push((n=i/this.STEPS,r=e,(t-e)*(Math.pow(n-1,3)+1)+r));return s},this.scrollToLine=function(e,t,n,r){var i=this.$cursorLayer.getPixelPosition({row:e,column:0}).top;t&&(i-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(i),!1!==n&&this.animateScrolling(o,r)},this.animateScrolling=function(e,t){var n=this.scrollTop;if(this.$animatedScroll){var r=this;if(e!=n){if(this.$scrollAnimation){var i=this.$scrollAnimation.steps;if(i.length&&(e=i[0])==n)return}var o=r.$calcSteps(e,n);this.$scrollAnimation={from:e,to:n,steps:o},clearInterval(this.$timer),r.session.setScrollTop(o.shift()),r.session.$scrollTop=n,this.$timer=setInterval((function(){o.length?(r.session.setScrollTop(o.shift()),r.session.$scrollTop=n):null!=n?(r.session.$scrollTop=-1,r.session.setScrollTop(n),n=null):(r.$timer=clearInterval(r.$timer),r.$scrollAnimation=null,t&&t())}),10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth-this.margin.left,t=r[0]}else n=this.scroller.getBoundingClientRect();var i=e+this.scrollLeft-n.left-this.$padding,o=i/this.characterWidth,s=Math.floor((t+this.scrollTop-n.top)/this.lineHeight),a=this.$blockCursor?Math.floor(o):Math.round(o);return{row:s,column:a,side:o-a>0?1:-1,offsetX:i}},this.screenToTextCoordinates=function(e,t){var n;if(this.$hasCssTransforms){n={top:0,left:0};var r=this.$fontMetrics.transformCoordinates([e,t]);e=r[1]-this.gutterWidth-this.margin.left,t=r[0]}else n=this.scroller.getBoundingClientRect();var i=e+this.scrollLeft-n.left-this.$padding,o=i/this.characterWidth,s=this.$blockCursor?Math.floor(o):Math.round(o),a=Math.floor((t+this.scrollTop-n.top)/this.lineHeight);return this.session.screenToDocumentPosition(a,Math.max(s,0),i)},this.textToScreenCoordinates=function(e,t){var n=this.scroller.getBoundingClientRect(),r=this.session.documentToScreenPosition(e,t),i=this.$padding+(this.session.$bidiHandler.isBidiRow(r.row,e)?this.session.$bidiHandler.getPosLeft(r.column):Math.round(r.column*this.characterWidth)),o=r.row*this.lineHeight;return{pageX:n.left+i-this.scrollLeft,pageY:n.top+o-this.scrollTop}},this.visualizeFocus=function(){i.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){i.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition=e,e.cssText||(e.cssText=this.textarea.style.cssText),e.useTextareaForIME=this.$useTextareaForIME,this.$useTextareaForIME?(i.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):e.markerId=this.session.addMarker(e.markerRange,"ace_composition_marker","text")},this.setCompositionText=function(e){var t=this.session.selection.cursor;this.addToken(e,"composition_placeholder",t.row,t.column),this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),i.removeCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText=this.$composition.cssText,this.$composition=null,this.$cursorLayer.element.style.display="")},this.addToken=function(e,t,n,r){var i=this.session;i.bgTokenizer.lines[n]=null;var o={type:t,value:e},s=i.getTokens(n);if(null==r)s.push(o);else for(var a=0,l=0;l<s.length;l++){var c=s[l];if(r<=(a+=c.value.length)){var u=c.value.length-(a-r),h=c.value.slice(0,u),d=c.value.slice(u);s.splice(l,1,{type:c.type,value:h},o,{type:c.type,value:d});break}}this.updateLines(n,n)},this.setTheme=function(e,t){var n=this;if(this.$themeId=e,n._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)s(e);else{var r=e||this.$options.theme.initialValue;o.loadModule(["theme",r],s)}function s(r){if(n.$themeId!=e)return t&&t();if(!r||!r.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");r.$id&&(n.$themeId=r.$id),i.importCssString(r.cssText,r.cssClass,n.container),n.theme&&i.removeCssClass(n.container,n.theme.cssClass);var o="padding"in r?r.padding:"padding"in(n.theme||{})?4:n.$padding;n.$padding&&o!=n.$padding&&n.setPadding(o),n.$theme=r.cssClass,n.theme=r,i.addCssClass(n.container,r.cssClass),i.setCssClass(n.container,"ace_dark",r.isDark),n.$size&&(n.$size.width=0,n.$updateSizeAsync()),n._dispatchEvent("themeLoaded",{theme:r}),t&&t()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,t){i.setCssClass(this.container,e,!1!==t)},this.unsetStyle=function(e){i.removeCssClass(this.container,e)},this.setCursorStyle=function(e){i.setStyle(this.scroller.style,"cursor",e)},this.setMouseCursor=function(e){i.setStyle(this.scroller.style,"cursor",e)},this.attachToShadowRoot=function(){i.importCssString(g,"ace_editor.css",this.container)},this.destroy=function(){this.$fontMetrics.destroy(),this.$cursorLayer.destroy()}}).call(y.prototype),o.defineOptions(y.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){i.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){this.$gutterLayer.setHighlightGutterLine(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!m.isMobile&&!m.isIE}}),t.VirtualRenderer=y})),ace.define("ace/worker/worker_client",[],(function(e,t,n){"use strict";var r=e("../lib/oop"),i=e("../lib/net"),o=e("../lib/event_emitter").EventEmitter,s=e("../config");function a(e){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(s.get("loadWorkerFromBlob")){var t=function(e){var t="importScripts('"+i.qualifyURL(e)+"');";try{return new Blob([t],{type:"application/javascript"})}catch(e){var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder);return n.append(t),n.getBlob("application/javascript")}}(e),n=(window.URL||window.webkitURL).createObjectURL(t);return new Worker(n)}return new Worker(e)}var l=function(e){e.postMessage||(e=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=e,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){r.implement(this,o),this.$createWorkerFromOldConfig=function(t,n,r,i,o){if(e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl),s.get("packaged")||!e.toUrl)i=i||s.moduleUrl(n,"worker");else{var l=this.$normalizePath;i=i||l(e.toUrl("ace/worker/worker.js",null,"_"));var c={};t.forEach((function(t){c[t]=l(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))}))}return this.$worker=a(i),o&&this.send("importScripts",o),this.$worker.postMessage({init:!0,tlns:c,module:n,classname:r}),this.$worker},this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var n=this.callbacks[t.id];n&&(n(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return i.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,n){if(n){var r=this.callbackId++;this.callbacks[r]=n,t.push(r)}this.send(e,t)},this.emit=function(e,t){try{t.data&&t.data.err&&(t.data.err={message:t.data.err.message,stack:t.data.err.stack,code:t.data.err.code}),this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==e.action?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(l.prototype);t.UIWorkerClient=function(e,t,n){var r=null,i=!1,a=Object.create(o),c=[],u=new l({messageBuffer:c,terminate:function(){},postMessage:function(e){c.push(e),r&&(i?setTimeout(h):h())}});u.setEmitSync=function(e){i=e};var h=function(){var e=c.shift();e.command?r[e.command].apply(r,e.args):e.event&&a._signal(e.event,e.data)};return a.postMessage=function(e){u.onMessage({data:e})},a.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},a.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},s.loadModule(["worker",t],(function(e){for(r=new e[n](a);c.length;)h()})),u},t.WorkerClient=l,t.createWorker=a})),ace.define("ace/placeholder",[],(function(e,t,n){"use strict";var r=e("./range").Range,i=e("./lib/event_emitter").EventEmitter,o=e("./lib/oop"),s=function(e,t,n,r,i,o){var s=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=i,this.othersClass=o,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=r,this.$onCursorChange=function(){setTimeout((function(){s.onCursorChange()}))},this.$pos=n;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){o.implement(this,i),this.setup=function(){var e=this,t=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=t.createAnchor(this.$pos.row,this.$pos.column);var i=this.pos;i.$insertRight=!0,i.detach(),i.markerId=n.addMarker(new r(i.row,i.column,i.row,i.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach((function(n){var r=t.createAnchor(n.row,n.column);r.$insertRight=!0,r.detach(),e.others.push(r)})),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach((function(n){n.markerId=e.addMarker(new r(n.row,n.column,n.row,n.column+t.length),t.othersClass,null,!1)}))}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){if(this.$updating)return this.updateAnchors(e);var t=e;if(t.start.row===t.end.row&&t.start.row===this.pos.row){this.$updating=!0;var n="insert"===e.action?t.end.column-t.start.column:t.start.column-t.end.column,i=t.start.column>=this.pos.column&&t.start.column<=this.pos.column+this.length+1,o=t.start.column-this.pos.column;if(this.updateAnchors(e),i&&(this.length+=n),i&&!this.session.$fromUndo)if("insert"===e.action)for(var s=this.others.length-1;s>=0;s--){var a={row:(l=this.others[s]).row,column:l.column+o};this.doc.insertMergedLines(a,e.lines)}else if("remove"===e.action)for(s=this.others.length-1;s>=0;s--){var l;a={row:(l=this.others[s]).row,column:l.column+o};this.doc.remove(new r(a.row,a.column,a.row,a.column-n))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var e=this,t=this.session,n=function(n,i){t.removeMarker(n.markerId),n.markerId=t.addMarker(new r(n.row,n.column,n.row,n.column+e.length),i,null,!1)};n(this.pos,this.mainClass);for(var i=this.others.length;i--;)n(this.others[i],this.othersClass)}},this.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,n=0;n<t;n++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(s.prototype),t.PlaceHolder=s})),ace.define("ace/mouse/multi_select_handler",[],(function(e,t,n){var r=e("../lib/event"),i=e("../lib/useragent");function o(e,t){return e.row==t.row&&e.column==t.column}t.onMouseDown=function(e){var t=e.domEvent,n=t.altKey,s=t.shiftKey,a=t.ctrlKey,l=e.getAccelKey(),c=e.getButton();if(a&&i.isMac&&(c=t.button),e.editor.inMultiSelectMode&&2==c)e.editor.textInput.onContextMenu(e.domEvent);else if(a||n||l){if(0===c){var u,h=e.editor,d=h.selection,f=h.inMultiSelectMode,p=e.getDocumentPosition(),g=d.getCursor(),m=e.inSelection()||d.isEmpty()&&o(p,g),v=e.x,y=e.y,b=h.session,w=h.renderer.pixelToScreenCoordinates(v,y),_=w;if(h.$mouseHandler.$enableJumpToDef)a&&n||l&&n?u=s?"block":"add":n&&h.$blockSelectEnabled&&(u="block");else if(l&&!n){if(u="add",!f&&s)return}else n&&h.$blockSelectEnabled&&(u="block");if(u&&i.isMac&&t.ctrlKey&&h.$mouseHandler.cancelContextMenu(),"add"==u){if(!f&&m)return;if(!f){var C=d.toOrientedRange();h.addSelectionMarker(C)}var S=d.rangeList.rangeAtPoint(p);h.inVirtualSelectionMode=!0,s&&(S=null,C=d.ranges[0]||C,h.removeSelectionMarker(C)),h.once("mouseup",(function(){var e=d.toOrientedRange();S&&e.isEmpty()&&o(S.cursor,e.cursor)?d.substractPoint(e.cursor):(s?d.substractPoint(C.cursor):C&&(h.removeSelectionMarker(C),d.addRange(C)),d.addRange(e)),h.inVirtualSelectionMode=!1}))}else if("block"==u){var k;e.stop(),h.inVirtualSelectionMode=!0;var A=[],x=function(){var e=h.renderer.pixelToScreenCoordinates(v,y),t=b.screenToDocumentPosition(e.row,e.column,e.offsetX);o(_,e)&&o(t,d.lead)||(_=e,h.selection.moveToPosition(t),h.renderer.scrollCursorIntoView(),h.removeSelectionMarkers(A),A=d.rectangularRangeBlock(_,w),h.$mouseHandler.$clickSelection&&1==A.length&&A[0].isEmpty()&&(A[0]=h.$mouseHandler.$clickSelection.clone()),A.forEach(h.addSelectionMarker,h),h.updateSelectionMarkers())};f&&!l?d.toSingleRange():!f&&l&&(k=d.toOrientedRange(),h.addSelectionMarker(k)),s?w=b.documentToScreenPosition(d.lead):d.moveToPosition(p),_={row:-1,column:-1};var $=x;r.capture(h.container,(function(e){v=e.clientX,y=e.clientY}),(function(e){x(),clearInterval(T),h.removeSelectionMarkers(A),A.length||(A=[d.toOrientedRange()]),k&&(h.removeSelectionMarker(k),d.toSingleRange(k));for(var t=0;t<A.length;t++)d.addRange(A[t]);h.inVirtualSelectionMode=!1,h.$mouseHandler.$clickSelection=null}));var T=setInterval((function(){$()}),20);return e.preventDefault()}}}else 0===c&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode()}})),ace.define("ace/commands/multi_select_commands",[],(function(e,t,n){t.defaultCommands=[{name:"addCursorAbove",description:"Add cursor above",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",description:"Add cursor below",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",description:"Add cursor above (skip current)",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",description:"Add cursor below (skip current)",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",description:"Select more before",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",description:"Select more after",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",description:"Select next before",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",description:"Select next after",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",description:"Split into lines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",description:"Align cursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",description:"Find all",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],t.multiSelectCommands=[{name:"singleSelection",description:"Single selection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var r=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new r(t.multiSelectCommands)})),ace.define("ace/multi_select",[],(function(e,t,n){var r=e("./range_list").RangeList,i=e("./range").Range,o=e("./selection").Selection,s=e("./mouse/multi_select_handler").onMouseDown,a=e("./lib/event"),l=e("./lib/lang"),c=e("./commands/multi_select_commands");t.commands=c.defaultCommands.concat(c.multiSelectCommands);var u=new(0,e("./search").Search);var h=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(h.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var n=this.toOrientedRange();if(this.rangeList.add(n),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(n),this.$onAddRange(n)}e.cursor||(e.cursor=e.end);var r=this.rangeList.add(e);return this.$onAddRange(e),r.length&&this.$onRemoveRange(r),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length&&this.$onRemoveRange(e)},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var n=e.length;n--;){var r=this.ranges.indexOf(e[n]);this.ranges.splice(r,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new r,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=i.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{n=this.getRange();var r=this.isBackwards(),o=n.start.row,s=n.end.row;if(o==s){if(r)var a=n.end,l=n.start;else a=n.start,l=n.end;return this.addRange(i.fromPoints(l,l)),void this.addRange(i.fromPoints(a,a))}var c=[],u=this.getLineRange(o,!0);u.start.column=n.start.column,c.push(u);for(var h=o+1;h<s;h++)c.push(this.getLineRange(h,!0));(u=this.getLineRange(s,!0)).end.column=n.end.column,c.push(u),c.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],n=i.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(n,t.cursor==t.start)}else{var r=this.session.documentToScreenPosition(this.cursor),o=this.session.documentToScreenPosition(this.anchor);this.rectangularRangeBlock(r,o).forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,n){var r=[],o=e.column<t.column;if(o)var s=e.column,a=t.column,l=e.offsetX,c=t.offsetX;else s=t.column,a=e.column,l=t.offsetX,c=e.offsetX;var u,h,d,f=e.row<t.row;if(f)var p=e.row,g=t.row;else p=t.row,g=e.row;s<0&&(s=0),p<0&&(p=0),p==g&&(n=!0);for(var m=p;m<=g;m++){var v=i.fromPoints(this.session.screenToDocumentPosition(m,s,l),this.session.screenToDocumentPosition(m,a,c));if(v.isEmpty()){if(u&&(h=v.end,d=u,h.row==d.row&&h.column==d.column))break;u=v.end}v.cursor=o?v.start:v.end,r.push(v)}if(f&&r.reverse(),!n){for(var y=r.length-1;r[y].isEmpty()&&y>0;)y--;if(y>0)for(var b=0;r[b].isEmpty();)b++;for(var w=y;w>=b;w--)r[w].isEmpty()&&r.splice(w,1)}return r}}.call(o.prototype);var d=e("./editor").Editor;function f(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=t.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",s),e.commands.addCommands(c.defaultCommands),function(e){var t=e.textInput.getElement(),n=!1;function r(t){n&&(e.renderer.setMouseCursor(""),n=!1)}a.addListener(t,"keydown",(function(t){var i=18==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&i?n||(e.renderer.setMouseCursor("crosshair"),n=!0):n&&r()})),a.addListener(t,"keyup",r),a.addListener(t,"blur",r)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,n=e.length;n--;){var r=e[n];if(r.marker){this.session.removeMarker(r.marker);var i=t.indexOf(r);-1!=i&&t.splice(i,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(c.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(c.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,n=e.editor;if(n.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?r=n.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?r=n.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(n.exitMultiSelectMode(),r=t.exec(n,e.args||{})):r=t.multiSelectAction(n,e.args||{});else{var r=t.exec(n,e.args||{});n.multiSelect.addRange(n.multiSelect.toOrientedRange()),n.multiSelect.mergeOverlappingRanges()}return r}},this.forEachSelection=function(e,t,n){if(!this.inVirtualSelectionMode){var r,i=n&&n.keepOrder,s=1==n||n&&n.$byLines,a=this.session,l=this.selection,c=l.rangeList,u=(i?l:c).ranges;if(!u.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var h=l._eventRegistry;l._eventRegistry={};var d=new o(a);this.inVirtualSelectionMode=!0;for(var f=u.length;f--;){if(s)for(;f>0&&u[f].start.row==u[f-1].end.row;)f--;d.fromOrientedRange(u[f]),d.index=f,this.selection=a.selection=d;var p=e.exec?e.exec(this,t||{}):e(this,t||{});r||void 0===p||(r=p),d.toOrientedRange(u[f])}d.detach(),this.selection=a.selection=l,this.inVirtualSelectionMode=!1,l._eventRegistry=h,l.mergeOverlappingRanges(),l.ranges[0]&&l.fromOrientedRange(l.ranges[0]);var g=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),g&&g.from==g.to&&this.renderer.animateScrolling(g.from),r}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,n=[],r=0;r<t.length;r++)n.push(this.session.getTextRange(t[r]));var i=this.session.getDocument().getNewLineCharacter();(e=n.join(i)).length==(n.length-1)*i.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var n=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var r=t==this.multiSelect.anchor?n.cursor==n.start?n.end:n.start:n.cursor;r.row!=t.row||this.session.$clipPositionToDocument(r.row,r.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,n){if((t=t||{}).needle=e||t.needle,null==t.needle){var r=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(r)}this.$search.set(t);var i=this.$search.findAll(this.session);if(!i.length)return 0;var o=this.multiSelect;n||o.toSingleRange(i[0]);for(var s=i.length;s--;)o.addRange(i[s],!0);return r&&o.rangeList.rangeAtPoint(r.start)&&o.addRange(r,!0),i.length},this.selectMoreLines=function(e,t){var n=this.selection.toOrientedRange(),r=n.cursor==n.end,o=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(o.column=this.selection.$desiredColumn);var s,a=this.session.screenToDocumentPosition(o.row+e,o.column);if(n.isEmpty())c=a;else var l=this.session.documentToScreenPosition(r?n.end:n.start),c=this.session.screenToDocumentPosition(l.row+e,l.column);r?(s=i.fromPoints(a,c)).cursor=s.start:(s=i.fromPoints(c,a)).cursor=s.end;if(s.desiredColumn=o.column,this.selection.inMultiSelectMode){if(t)var u=n.cursor}else this.selection.addRange(n);this.selection.addRange(s),u&&this.selection.substractPoint(u)},this.transposeSelections=function(e){for(var t=this.session,n=t.multiSelect,r=n.ranges,i=r.length;i--;){if((a=r[i]).isEmpty()){var o=t.getWordRange(a.start.row,a.start.column);a.start.row=o.start.row,a.start.column=o.start.column,a.end.row=o.end.row,a.end.column=o.end.column}}n.mergeOverlappingRanges();var s=[];for(i=r.length;i--;){var a=r[i];s.unshift(t.getTextRange(a))}e<0?s.unshift(s.pop()):s.push(s.shift());for(i=r.length;i--;){o=(a=r[i]).clone();t.replace(a,s[i]),a.start.row=o.start.row,a.start.column=o.start.column}n.fromOrientedRange(n.ranges[0])},this.selectMore=function(e,t,n){var r=this.session,i=r.multiSelect.toOrientedRange();if(!i.isEmpty()||((i=r.getWordRange(i.start.row,i.start.column)).cursor=-1==e?i.start:i.end,this.multiSelect.addRange(i),!n)){var o=r.getTextRange(i),s=function(e,t,n){return u.$options.wrap=!0,u.$options.needle=t,u.$options.backwards=-1==n,u.find(e)}(r,o,e);s&&(s.cursor=-1==e?s.start:s.end,this.session.unfold(s),this.multiSelect.addRange(s),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(i.cursor)}},this.alignCursors=function(){var e=this.session,t=e.multiSelect,n=t.ranges,r=-1,o=n.filter((function(e){if(e.cursor.row==r)return!0;r=e.cursor.row}));if(n.length&&o.length!=n.length-1){o.forEach((function(e){t.substractPoint(e.cursor)}));var s=0,a=1/0,c=n.map((function(t){var n=t.cursor,r=e.getLine(n.row).substr(n.column).search(/\S/g);return-1==r&&(r=0),n.column>s&&(s=n.column),r<a&&(a=r),r}));n.forEach((function(t,n){var r=t.cursor,o=s-r.column,u=c[n]-a;o>u?e.insert(r,l.stringRepeat(" ",o-u)):e.remove(new i(r.row,r.column,r.row,r.column-o+u)),t.start.column=t.end.column=s,t.start.row=t.end.row=r.row,t.cursor=t.end})),t.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var u=this.selection.getRange(),h=u.start.row,d=u.end.row,f=h==d;if(f){var p,g=this.session.getLength();do{p=this.session.getLine(d)}while(/[=:]/.test(p)&&++d<g);do{p=this.session.getLine(h)}while(/[=:]/.test(p)&&--h>0);h<0&&(h=0),d>=g&&(d=g-1)}var m=this.session.removeFullLines(h,d);m=this.$reAlignText(m,f),this.session.insert({row:h,column:0},m.join("\n")+"\n"),f||(u.start.column=0,u.end.column=m[m.length-1].length),this.selection.setRange(u)}},this.$reAlignText=function(e,t){var n,r,i,o=!0,s=!0;return e.map((function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==n?(n=t[1].length,r=t[2].length,i=t[3].length,t):(n+r+i!=t[1].length+t[2].length+t[3].length&&(s=!1),n!=t[1].length&&(o=!1),n>t[1].length&&(n=t[1].length),r<t[2].length&&(r=t[2].length),i>t[3].length&&(i=t[3].length),t):[e]})).map(t?c:o?s?function(e){return e[2]?a(n+r-e[2].length)+e[2]+a(i)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:c:function(e){return e[2]?a(n)+e[2]+a(i)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function a(e){return l.stringRepeat(" ",e)}function c(e){return e[2]?a(n)+e[2]+a(r-e[2].length+i)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(d.prototype),t.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var n=e.oldSession;n&&(n.multiSelect.off("addRange",this.$onAddRange),n.multiSelect.off("removeRange",this.$onRemoveRange),n.multiSelect.off("multiSelect",this.$onMultiSelect),n.multiSelect.off("singleSelect",this.$onSingleSelect),n.multiSelect.lead.off("change",this.$checkMultiselectChange),n.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=f,e("./config").defineOptions(d.prototype,"editor",{enableMultiselect:{set:function(e){f(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",s)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",s))},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})})),ace.define("ace/mode/folding/fold_mode",[],(function(e,t,n){"use strict";var r=e("../../range").Range,i=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,n){var r=e.getLine(n);return this.foldingStartMarker.test(r)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(r)?"end":""},this.getFoldWidgetRange=function(e,t,n){return null},this.indentationBlock=function(e,t,n){var i=/\S/,o=e.getLine(t),s=o.search(i);if(-1!=s){for(var a=n||o.length,l=e.getLength(),c=t,u=t;++t<l;){var h=e.getLine(t).search(i);if(-1!=h){if(h<=s)break;u=t}}if(u>c){var d=e.getLine(u).length;return new r(c,a,u,d)}}},this.openingBracketBlock=function(e,t,n,i,o){var s={row:n,column:i+1},a=e.$findClosingBracket(t,s,o);if(a){var l=e.foldWidgets[a.row];return null==l&&(l=e.getFoldWidget(a.row)),"start"==l&&a.row>s.row&&(a.row--,a.column=e.getLine(a.row).length),r.fromPoints(s,a)}},this.closingBracketBlock=function(e,t,n,i,o){var s={row:n,column:i},a=e.$findOpeningBracket(t,s);if(a)return a.column++,s.column--,r.fromPoints(a,s)}}).call(i.prototype)})),ace.define("ace/theme/textmate",[],(function(e,t,n){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText='.ace-tm .ace_gutter {background: #f0f0f0;color: #333;}.ace-tm .ace_print-margin {width: 1px;background: #e8e8e8;}.ace-tm .ace_fold {background-color: #6B72E6;}.ace-tm {background-color: #FFFFFF;color: black;}.ace-tm .ace_cursor {color: black;}.ace-tm .ace_invisible {color: rgb(191, 191, 191);}.ace-tm .ace_storage,.ace-tm .ace_keyword {color: blue;}.ace-tm .ace_constant {color: rgb(197, 6, 11);}.ace-tm .ace_constant.ace_buildin {color: rgb(88, 72, 246);}.ace-tm .ace_constant.ace_language {color: rgb(88, 92, 246);}.ace-tm .ace_constant.ace_library {color: rgb(6, 150, 14);}.ace-tm .ace_invalid {background-color: rgba(255, 0, 0, 0.1);color: red;}.ace-tm .ace_support.ace_function {color: rgb(60, 76, 114);}.ace-tm .ace_support.ace_constant {color: rgb(6, 150, 14);}.ace-tm .ace_support.ace_type,.ace-tm .ace_support.ace_class {color: rgb(109, 121, 222);}.ace-tm .ace_keyword.ace_operator {color: rgb(104, 118, 135);}.ace-tm .ace_string {color: rgb(3, 106, 7);}.ace-tm .ace_comment {color: rgb(76, 136, 107);}.ace-tm .ace_comment.ace_doc {color: rgb(0, 102, 255);}.ace-tm .ace_comment.ace_doc.ace_tag {color: rgb(128, 159, 191);}.ace-tm .ace_constant.ace_numeric {color: rgb(0, 0, 205);}.ace-tm .ace_variable {color: rgb(49, 132, 149);}.ace-tm .ace_xml-pe {color: rgb(104, 104, 91);}.ace-tm .ace_entity.ace_name.ace_function {color: #0000A2;}.ace-tm .ace_heading {color: rgb(12, 7, 255);}.ace-tm .ace_list {color:rgb(185, 6, 144);}.ace-tm .ace_meta.ace_tag {color:rgb(0, 22, 142);}.ace-tm .ace_string.ace_regex {color: rgb(255, 0, 0)}.ace-tm .ace_marker-layer .ace_selection {background: rgb(181, 213, 255);}.ace-tm.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px white;}.ace-tm .ace_marker-layer .ace_step {background: rgb(252, 255, 0);}.ace-tm .ace_marker-layer .ace_stack {background: rgb(164, 229, 101);}.ace-tm .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgb(192, 192, 192);}.ace-tm .ace_marker-layer .ace_active-line {background: rgba(0, 0, 0, 0.07);}.ace-tm .ace_gutter-active-line {background-color : #dcdcdc;}.ace-tm .ace_marker-layer .ace_selected-word {background: rgb(250, 250, 255);border: 1px solid rgb(200, 200, 250);}.ace-tm .ace_indent-guide {background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;}',t.$id="ace/theme/textmate",e("../lib/dom").importCssString(t.cssText,t.cssClass)})),ace.define("ace/line_widgets",[],(function(e,t,n){"use strict";e("./lib/oop");var r=e("./lib/dom");e("./range").Range;function i(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach((function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)})),e},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var n=this.session.lineWidgets;n&&n.forEach((function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))}))}},this.updateOnFold=function(e,t){var n=t.lineWidgets;if(n&&e.action){for(var r=e.data,i=r.start.row,o=r.end.row,s="add"==e.action,a=i+1;a<o;a++)n[a]&&(n[a].hidden=s);n[o]&&(s?n[i]?n[o].hidden=s:n[i]=n[o]:(n[i]==n[o]&&(n[i]=void 0),n[o].hidden=s))}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var n=e.start.row,r=e.end.row-n;if(0===r);else if("remove"==e.action){t.splice(n+1,r).forEach((function(e){e&&this.removeLineWidget(e)}),this),this.$updateRows()}else{var i=new Array(r);i.unshift(n,0),t.splice.apply(t,i),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach((function(e,n){if(e)for(t=!1,e.row=n;e.$oldWidget;)e.$oldWidget.row=n,e=e.$oldWidget})),t&&(this.session.lineWidgets=null)}},this.addLineWidget=function(e){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var t=this.session.lineWidgets[e.row];t&&(e.$oldWidget=t,t.el&&t.el.parentNode&&(t.el.parentNode.removeChild(t.el),t._inDocument=!1)),this.session.lineWidgets[e.row]=e,e.session=this.session;var n=this.editor.renderer;e.html&&!e.el&&(e.el=r.createElement("div"),e.el.innerHTML=e.html),e.el&&(r.addCssClass(e.el,"ace_lineWidgetContainer"),e.el.style.position="absolute",e.el.style.zIndex=5,n.container.appendChild(e.el),e._inDocument=!0),e.coverGutter||(e.el.style.zIndex=3),null==e.pixelHeight&&(e.pixelHeight=e.el.offsetHeight),null==e.rowCount&&(e.rowCount=e.pixelHeight/n.layerConfig.lineHeight);var i=this.session.getFoldAt(e.row,0);if(e.$fold=i,i){var o=this.session.lineWidgets;e.row!=i.end.row||o[i.start.row]?e.hidden=!0:o[i.start.row]=e}return this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows(),this.renderWidgets(null,n),this.onWidgetChanged(e),e},this.removeLineWidget=function(e){if(e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}if(this.session.lineWidgets){var t=this.session.lineWidgets[e.row];if(t==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else for(;t;){if(t.$oldWidget==e){t.$oldWidget=e.$oldWidget;break}t=t.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(e){for(var t=this.session.lineWidgets,n=t&&t[e],r=[];n;)r.push(n),n=n.$oldWidget;return r},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var n=this.session._changedWidgets,r=t.layerConfig;if(n&&n.length){for(var i=1/0,o=0;o<n.length;o++){var s=n[o];if(s&&s.el&&s.session==this.session){if(!s._inDocument){if(this.session.lineWidgets[s.row]!=s)continue;s._inDocument=!0,t.container.appendChild(s.el)}s.h=s.el.offsetHeight,s.fixedWidth||(s.w=s.el.offsetWidth,s.screenWidth=Math.ceil(s.w/r.characterWidth));var a=s.h/r.lineHeight;s.coverLine&&(a-=this.session.getRowLineCount(s.row))<0&&(a=0),s.rowCount!=a&&(s.rowCount=a,s.row<i&&(i=s.row))}}i!=1/0&&(this.session._emit("changeFold",{data:{start:{row:i}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var n=t.layerConfig,r=this.session.lineWidgets;if(r){for(var i=Math.min(this.firstRow,n.firstRow),o=Math.max(this.lastRow,n.lastRow,r.length);i>0&&!r[i];)i--;this.firstRow=n.firstRow,this.lastRow=n.lastRow,t.$cursorLayer.config=n;for(var s=i;s<=o;s++){var a=r[s];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el));var l=t.$cursorLayer.getPixelPosition({row:s,column:0},!0).top;a.coverLine||(l+=n.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-n.offset+"px";var c=a.coverGutter?0:t.gutterWidth;a.fixedWidth||(c-=t.scrollLeft),a.el.style.left=c+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=n.width+2*n.padding+"px"),a.fixedWidth?a.el.style.right=t.scrollBar.getWidth()+"px":a.el.style.right=""}}}}}).call(i.prototype),t.LineWidgets=i})),ace.define("ace/ext/error_marker",[],(function(e,t,n){"use strict";var r=e("../line_widgets").LineWidgets,i=e("../lib/dom"),o=e("../range").Range;t.showErrorMarker=function(e,t){var n=e.session;n.widgetManager||(n.widgetManager=new r(n),n.widgetManager.attach(e));var s=e.getCursorPosition(),a=s.row,l=n.widgetManager.getWidgetsAtRow(a).filter((function(e){return"errorMarker"==e.type}))[0];l?l.destroy():a-=t;var c,u=function(e,t,n){var r=e.getAnnotations().sort(o.comparePoints);if(r.length){var i=function(e,t,n){for(var r=0,i=e.length-1;r<=i;){var o=r+i>>1,s=n(t,e[o]);if(s>0)r=o+1;else{if(!(s<0))return o;i=o-1}}return-(r+1)}(r,{row:t,column:-1},o.comparePoints);i<0&&(i=-i-1),i>=r.length?i=n>0?0:r.length-1:0===i&&n<0&&(i=r.length-1);var s=r[i];if(s&&n){if(s.row===t){do{s=r[i+=n]}while(s&&s.row===t);if(!s)return r.slice()}var a=[];t=s.row;do{a[n<0?"unshift":"push"](s),s=r[i+=n]}while(s&&s.row==t);return a.length&&a}}}(n,a,t);if(u){var h=u[0];s.column=(h.pos&&"number"!=typeof h.column?h.pos.sc:h.column)||0,s.row=h.row,c=e.renderer.$gutterLayer.$annotations[s.row]}else{if(l)return;c={text:["Looks good!"],className:"ace_ok"}}e.session.unfold(s.row),e.selection.moveToPosition(s);var d={row:s.row,fixedWidth:!0,coverGutter:!0,el:i.createElement("div"),type:"errorMarker"},f=d.el.appendChild(i.createElement("div")),p=d.el.appendChild(i.createElement("div"));p.className="error_widget_arrow "+c.className;var g=e.renderer.$cursorLayer.getPixelPosition(s).left;p.style.left=g+e.renderer.gutterWidth-5+"px",d.el.className="error_widget_wrapper",f.className="error_widget "+c.className,f.innerHTML=c.text.join("<br>"),f.appendChild(i.createElement("div"));var m=function(e,t,n){if(0===t&&("esc"===n||"return"===n))return d.destroy(),{command:"null"}};d.destroy=function(){e.$mouseHandler.isMousePressed||(e.keyBinding.removeKeyboardHandler(m),n.widgetManager.removeLineWidget(d),e.off("changeSelection",d.destroy),e.off("changeSession",d.destroy),e.off("mouseup",d.destroy),e.off("change",d.destroy))},e.keyBinding.addKeyboardHandler(m),e.on("changeSelection",d.destroy),e.on("changeSession",d.destroy),e.on("mouseup",d.destroy),e.on("change",d.destroy),e.session.widgetManager.addLineWidget(d),d.el.onmousedown=e.focus.bind(e),e.renderer.scrollCursorIntoView(null,.5,{bottom:d.el.offsetHeight})},i.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")})),ace.define("ace/ace",[],(function(e,t,r){"use strict";e("./lib/fixoldbrowsers");var i=e("./lib/dom"),o=e("./lib/event"),s=e("./range").Range,a=e("./editor").Editor,l=e("./edit_session").EditSession,c=e("./undomanager").UndoManager,u=e("./virtual_renderer").VirtualRenderer;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./multi_select"),e("./mode/folding/fold_mode"),e("./theme/textmate"),e("./ext/error_marker"),t.config=e("./config"),t.require=e,t.define=n(23),t.edit=function(e,n){if("string"==typeof e){var r=e;if(!(e=document.getElementById(r)))throw new Error("ace.edit can't find div #"+r)}if(e&&e.env&&e.env.editor instanceof a)return e.env.editor;var s="";if(e&&/input|textarea/i.test(e.tagName)){var l=e;s=l.value,e=i.createElement("pre"),l.parentNode.replaceChild(e,l)}else e&&(s=e.textContent,e.innerHTML="");var c=t.createEditSession(s),h=new a(new u(e),c,n),d={document:c,editor:h,onResize:h.resize.bind(h,null)};return l&&(d.textarea=l),o.addListener(window,"resize",d.onResize),h.on("destroy",(function(){o.removeListener(window,"resize",d.onResize),d.editor.container.env=null})),h.container.env=h.env=d,h},t.createEditSession=function(e,t){var n=new l(e,t);return n.setUndoManager(new c),n},t.Range=s,t.Editor=a,t.EditSession=l,t.UndoManager=c,t.VirtualRenderer=u,t.version=t.config.version})),ace.require(["ace/ace"],(function(n){for(var i in n&&(n.config.init(!0),n.define=ace.define),window.ace||(window.ace=n),n)n.hasOwnProperty(i)&&(window.ace[i]=n[i]);window.ace.default=window.ace,"object"==r(e)&&"object"==r(t)&&e&&(e.exports=window.ace)}))}).call(this,n(8)(e))},,,function(e,t,n){var r,i;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r=[n(9)],void 0===(i=function(e){return{getColorScheme:function(e,t){return this.isDarkTheme(t)?{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 100%, 28%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 100%, 20%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 100%, 60%);")}:{cursor:"hsl(".concat(e,", 70%, 50%)"),labelBackgroundColor:"hsl(".concat(e,", 70%, 50%)"),highlightBackgroundColor:"hsl(".concat(e,", 70%, 85%);"),strikeThroughBackgroundColor:"hsl(".concat(e,", 70%, 95%);"),strikeThroughForegroundColor:"hsl(".concat(e,", 70%, 40%);")}},isDarkTheme:function(e){var t=e.find(".ace_editor").css("background-color"),n=o(Array.from(t.match(/rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)/)),4),r=(n[0],n[1]),i=n[2],s=n[3];return(r=parseInt(r,10))+(i=parseInt(i,10))+(s=parseInt(s,10))<384},OWN_HUE:200,ANONYMOUS_HUE:100,getHueForUserId:function(e){return null==e||"anonymous-user"===e?this.ANONYMOUS_HUE:window.user.id===e?this.OWN_HUE:(hue=this.getHueForId(e),hue>this.OWNER_HUE-20&&(hue+=40),hue)},getHueForTagId:function(e){return this.getHueForId(e)},getHueForId:function(t){var n=e(t);return parseInt(n.toString().slice(0,8),16)%320}}}.apply(t,r))||(e.exports=i)},,,,,function(e,t,n){var r;void 0===(r=function(){return function(e){if(null==e)return"Anonymous";if(e.id===window.user.id)return"you";if(null!=e.name)return e.name;var t=[e.first_name,e.last_name].filter((function(e){return null!=e})).join(" ").trim();return""===t&&(t=e.email.split("@")[0]),null==t||""===t?"?":t}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r;function i(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"on",value:function(e,t){var n;this.events||(this.events={});var r=o(Array.from(e.split(".")),2);return e=r[0],n=r[1],this.events[e]||(this.events[e]=[]),this.events[e].push({callback:t,namespace:n})}},{key:"off",value:function(e){if(this.events||(this.events={}),null!=e){var t,n=o(Array.from(e.split(".")),2);if(e=n[0],null==(t=n[1]))return delete this.events[e];for(var r=[],i=0,s=Array.from(this.events[e]||[]);i<s.length;i++){var a=s[i];a.namespace!==t&&r.push(a)}return this.events[e]=r}return this.events={}}},{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.events||(this.events={}),Array.from(this.events[e]||[]).map((function(e){return e.callback.apply(e,i(Array.from(n||[])))}))}},{key:"emit",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.trigger.apply(this,i(Array.from(t||[])))}}])&&s(t.prototype,n),r&&s(t,r),e}()}.apply(t,[]))||(e.exports=r)},,function(e,t,n){var r,i;r=[n(46),n(47),n(48),n(49),n(25),n(50),n(51),n(52),n(18),n(53),n(54)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t){angular.module("localStorage",[]).value("localStorage",(function(){try{var e;return(e=$).localStorage.apply(e,arguments)}catch(e){return console.error("localStorage exception",e),null}}))},,,function(e,t,n){var r,i;function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r=[n(0)],void 0===(i=function(e){return e.factory("queuedHttp",["$http","$q",function(e,t){var n=[],r=!1,i=function e(){if(!r){var t=n.shift();return null!=t?(r=!0,t().then((function(){return r=!1,e()})).catch((function(){return r=!1,e()}))):void 0}},s=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a={},l=[],c=[];a.then=function(e,t){return l.push(e),null!=t&&c.push(t),a},a.catch=function(e){return c.push(e),a};var u=function(){return e.apply(void 0,o(Array.from(r||[]))).then((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(l).map((function(e){return e.apply(void 0,o(Array.from(t||[])))}))})).catch((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(c).map((function(e){return e.apply(void 0,o(Array.from(t||[])))}))}))};return n.push(u),i(),a};return s.post=function(e,t){return s({method:"POST",url:e,data:t})},s}])}.apply(t,r))||(e.exports=i)},,function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("mathjax",["$compile","$parse",function(e,t){return{link:function(n,r,i){if(MathJax&&MathJax.Hub){if(!t(i.mathjaxAllowHtml)(n)){var o=r.html(),s=e("<span ng-non-bindable></span>")({});r.html("").append(s),s.html(o)}if("no-single-dollar"!==i.delimiter){var a=MathJax.Hub.config&&MathJax.Hub.config.tex2jax.inlineMath;_.find(a,(function(e){return"$"===e[0]&&"$"===e[1]}))||MathJax.Hub.Config({tex2jax:{inlineMath:a.concat([["$","$"]])}})}setTimeout((function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,r.get(0)])}),0)}}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){return e.factory("algoliaSearch",(function(){var e,t;if(null!=(null!=window.sharelatex?window.sharelatex.algolia:void 0)&&null!=o(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))){var n=new AlgoliaSearch(null!=window.sharelatex.algolia?window.sharelatex.algolia.app_id:void 0,null!=window.sharelatex.algolia?window.sharelatex.algolia.api_key:void 0);t=n.initIndex(o(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.wiki}))),e=n.initIndex(o(null!=window.sharelatex.algolia?window.sharelatex.algolia.indexes:void 0,(function(e){return e.kb})))}return{searchWiki:t?t.search.bind(t):null,searchKB:e?e.search.bind(e):null}}))}.apply(t,r))||(e.exports=i)},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){var r;void 0===(r=function(){var e;return e={rangeToShareJs:function(e,t){for(var n=0,r=0;r<t.length;r++){var i=t[r];n+=r<e.row?i.length:e.column}return n+=e.row},changeToShareJs:function(t,n){var r=e.rangeToShareJs(t.start,n),i=t.lines.join("\n");switch(t.action){case"insert":return{i:i,p:r};case"remove":return{d:i,p:r};default:throw new Error("unknown action: ".concat(t.action))}},shareJsOffsetToRowColumn:function(e,t){var n=0;for(n=0;n<t.length;n++){if(e<=t[n].length)break;e-=t[n].length+1}return{row:n,column:e}}}}.apply(t,[]))||(e.exports=r)},,function(e,t){angular.module("RecursionHelper",[]).factory("RecursionHelper",["$compile",function(e){return{compile:function(t,n){angular.isFunction(n)&&(n={post:n});var r,i=t.contents().remove();return{pre:n&&n.pre?n.pre:null,post:function(t,o){r||(r=e(i)),r(t,(function(e){o.append(e)})),n&&n.post&&n.post.apply(null,arguments)}}}}}])},function(e,t){var n=angular.module("ErrorCatcher",[]);n.config(["$provide",function(e){return e.decorator("$exceptionHandler",["$log","$delegate",function(e,t){return function(e,n){if("Possibly unhandled rejection: canceled"!==e||void 0!==n)return null!=("undefined"!=typeof Raven&&null!==Raven?Raven.captureException:void 0)&&Raven.captureException(e),t(e,n)}}])}]),n.factory("unAuthHttpResponseInterceptor",["$q","$location",function(e,t){return{responseError:function(t){return[401,403].includes(t.status)&&!(null!=t.config?t.config.disableAutoLoginRedirect:void 0)&&(window.location.pathname.match(/^\/project/)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):window.location="/login"),e.reject(t)}}}]),n.config(["$httpProvider",function(e){return e.interceptors.push("unAuthHttpResponseInterceptor")}])},function(e,t){angular.module("sessionStorage",[]).value("sessionStorage",(function(){try{var e;return(e=$).sessionStorage.apply(e,arguments)}catch(e){return console.error("sessionStorage exception",e),null}}))},function(e,t,n){var r,i;r=[n(15)],void 0===(i=function(){return angular.module("underscore",[]).factory("_",(function(){return window._}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("FreeTrialModalController",["$scope","eventTracking",function(e,t){e.buttonClass="btn-primary",e.startFreeTrial=function(n,r){var i,o="collaborator_free_trial_7_days",s=window.open();"function"==typeof ga&&ga("send","event","subscription-funnel","upgraded-free-trial",n),i="/user/subscription/new?planCode=".concat(o,"&ssp=true"),i="".concat(i,"&itm_campaign=").concat(n),r&&(i="".concat(i,"&itm_content=").concat(r)),e.startedFreeTrial=!0,t.sendMB("subscription-start-trial",{source:n,plan:o}),s.location=i}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(2),n(0),n(16)],void 0===(i=function(e,t){var n=0,r=new Date;return t.factory("eventTracking",["$http","localStorage",function(t,i){var o=function(){var e=i("mbEvents");return null==e&&i("mbEvents",e={}),e},s=function(e){return o()[e]||!1},a=function(e){var t=o();return t[e]=!0,i("mbEvents",t)};return{send:function(e,t,n,r){return ga("send","event",e,t,n,r)},sendGAOnce:function(e,t,n,r){if(!s(t))return a(t),this.send(e,t,n,r)},editingSessionHeartbeat:function(){if(r<=new Date){t({url:"/editingSession/".concat(window.project_id),method:"PUT",headers:{"X-CSRF-Token":window.csrfToken}});var i=++n<=2?30:n<=6?60*(n-2):300;return r=e().add(i,"seconds").toDate()}},sendMB:function(e,n){return null==n&&(n={}),t({url:"/event/".concat(e),method:"POST",data:n,headers:{"X-CSRF-Token":window.csrfToken}})},sendMBSampled:function(e,t){if(Math.random()<.01)return this.sendMB(e,t)},sendMBOnce:function(e,t){if(!s(e))return a(e),this.sendMB(e,t)},eventInCache:function(e){return s(e)}}}]),$(".navbar a").on("click",(function(e){var t=$(e.target).attr("href");if(null!=t)return ga("send","event","navigation","top menu bar",t)}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){e.constant("ExposedSettings",window.ExposedSettings)}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(9)],void 0===(i=function(e,t){var n=["sl_abt_multi_currency_editor_eu-eu","sl_abt_multi_currency_eu-eu","sl_abt_multi_currency_editor_eu-usd","sl_abt_multi_currency_eu-usd","sl_abt_trial_len_14d","sl_abt_trial_len_7d","sl_abt_trial_len_30d","sl_utt","sl_utt_trial_len","sl_utt_multi_currency"];return e.factory("abTestManager",["$http","ipCookie",function(e,r){_.each(n,(function(e){return r.remove(e)}));var i=function(e,t){return"sl_abt_".concat(e,"_").concat(t)};return{processTestWithStep:function(e,t,n){var o,s;if(function(e,t){return(null!=e||0===t)&&(0===t||e+1===t)}((o=function(e,t){var n=i(e,t);return r(n)}(e,t),s=function(e){return e.step},null!=o?s(o):void 0),n))return function(e,t,n){var o=i(e,t);return r(o,{step:n},{expires:100,path:"/"}),ga("send","event","ab_tests","".concat(e,":").concat(t),"step-".concat(n))}(e,t,n)},getABTestBucket:function(e,n){var i,o,s,a=(o="sl_utt_".concat(i=e),null==(s=r(o))&&(s=Math.random(),r(o,s,{expires:365,path:"/"})),t("".concat(s,":").concat(i)));return n[parseInt(a.toString().slice(0,2),16)%((null!=n?n.length:void 0)||2)]}}}]),e.controller("AbTestController",["$scope","abTestManager",function(e,t){_.keys(window.ab);return _.each(window.ab,(function(e){return t.processTestWithStep(e.testName,e.bucket,e.step)}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("stopPropagation",["$http",function(e){return{restrict:"A",link:function(e,t,n){return t.bind(n.stopPropagation,(function(e){return e.stopPropagation()}))}}}]),e.directive("preventDefault",["$http",function(e){return{restrict:"A",link:function(e,t,n){return t.bind(n.preventDefault,(function(e){return e.preventDefault()}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t;e.directive("focusWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch(r.focusWhen,(function(t){if(t)return e((function(){return n.focus()}))}))}}}]),e.directive("focusOn",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){return e.$on(n.focusOn,(function(){return t.focus()}))}}}]),e.directive("selectWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch(r.selectWhen,(function(t){if(t)return e((function(){return n.select()}))}))}}}]),e.directive("selectOn",["$timeout",function(e){return{restrict:"A",link:function(e,t,n){return e.$on(n.selectOn,(function(){return t.select()}))}}}]),e.directive("selectNameWhen",["$timeout",function(e){return{restrict:"A",link:function(n,r,i){return n.$watch(i.selectNameWhen,(function(n){if(n)return e((function(){return t(r)}))}))}}}]),e.directive("selectNameOn",(function(){return{restrict:"A",link:function(e,n,r){return e.$on(r.selectNameOn,(function(){return t(n)}))}}})),e.directive("focus",["$timeout",function(e){return{scope:{trigger:"@focus"},link:function(t,n){return t.$watch("trigger",(function(t){if("true"===t)return e((function(){return n[0].focus()}))}))}}}]),t=function(e){e.focus();var t=e.val();if(null!=e[0].setSelectionRange){var n=t.lastIndexOf(".");return-1===n&&(n=t.length),e[0].setSelectionRange(0,n)}}}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(61)],void 0===(i=function(e,t){return e.directive("fineUpload",["$timeout",function(e){return{scope:{multiple:"=",endpoint:"@",templateId:"@",sizeLimit:"@",allowedExtensions:"=",onCompleteCallback:"=",onUploadCallback:"=",onValidateBatch:"=",onErrorCallback:"=",onSubmitCallback:"=",onCancelCallback:"=",autoUpload:"=",params:"=",control:"="},link:function(e,n,r){var i,o,s=e.multiple||!1,a=e.endpoint,l=e.templateId;o=null!=e.allowedExtensions?{allowedExtensions:e.allowedExtensions}:{},e.sizeLimit&&(o.sizeLimit=e.sizeLimit);var c=e.maxConnections||1,u=e.onCompleteCallback||function(){},h=e.onUploadCallback||function(){},d=e.onErrorCallback||function(){},f=e.onValidateBatch||function(){},p=e.onSubmitCallback||function(){},g=e.onCancelCallback||function(){};i=null==e.autoUpload||e.autoUpload;var m=e.params||{};m._csrf=window.csrfToken;var v=new t.FineUploader({element:n[0],multiple:s,autoUpload:i,disabledCancelForFormUploads:!0,validation:o,maxConnections:c,request:{endpoint:a,forceMultipart:!0,params:m,paramsInBody:!1},callbacks:{onComplete:u,onUpload:h,onValidateBatch:f,onError:d,onSubmit:p,onCancel:g},template:l,failedUploadTextDisplay:{mode:"custom",responseProperty:"error"}});return window.q=v,null!=e.control&&(e.control.q=v),v}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("onEnter",(function(){return function(e,t,n){return t.bind("keydown keypress",(function(t){if(13===t.which)return e.$apply((function(){return e.$eval(n.onEnter,{event:t})})),t.preventDefault()}))}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("validateCaptcha",(function(){var e=[],t=function(t){for(var n=0,r=e;n<r.length;n++){(0,r[n])(t)}e=[]},n=null;return function(r,i){if(null==r&&(r=function(e){}),"undefined"==typeof grecaptcha||null===grecaptcha||i)return r();if(e.push(r),e.push((function(){return grecaptcha.reset()})),null==n){var o=$("#recaptcha")[0];n=grecaptcha.render(o,{callback:t})}return grecaptcha.execute(n)}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("validateCaptchaV3",(function(){var e=window.grecaptcha,t=window.ExposedSettings;return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&t&&t.recaptchaSiteKeyV3&&e.ready((function(){e.execute(t.recaptchaSiteKeyV3,{action:n}).then(r)}))}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(2)],void 0===(i=function(e,t){t.locale("en",{calendar:{lastDay:"[Yesterday]",sameDay:"[Today]",nextDay:"[Tomorrow]",lastWeek:"ddd, Do MMM YY",nextWeek:"ddd, Do MMM YY",sameElse:"ddd, Do MMM YY"}}),e.filter("formatDate",(function(){return function(e,n){return e?(null==n&&(n="Do MMM YYYY, h:mm a"),t(e).format(n)):"N/A"}})),e.filter("relativeDate",(function(){return function(e){return t(e).calendar()}})),e.filter("fromNowDate",(function(){return function(e){return t(e).fromNow()}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0),n(20),n(22)],void 0===(i=function(e,t){return e.controller("ContactModal",["$scope","$modal","sessionStorage",function(e,t,n){n("contact-form.user-input",null),e.contactUsModal=function(){t.open({templateUrl:"contactModalTemplate",controller:"ContactModalController",scope:e})}}]),e.controller("ContactGeneralModal",["$scope","$modal","sessionStorage",function(e,t,n){n("contact-form.user-input",null),e.openModal=function(){t.open({templateUrl:"contactGeneralModalTemplate",controller:"ContactGeneralModalController"})}}]),e.controller("ContactModalController",["$scope","$modalInstance",function(e,t){return e.close=function(){return t.close()}}]),e.controller("ContactGeneralModalController",["$scope","$modalInstance",function(e,t){return e.close=function(){return t.close()}}]),e.controller("ContactFormController",["$scope","algoliaSearch","eventTracking","$http","sessionStorage",function(e,n,r,i,s){var a=s("contact-form.user-input");a?e.form=a:(e.form={email:""},window.project_id&&(e.form.project_url=window.location.href)),e.sent=!1,e.sending=!1,e.suggestions=[],e.$on("modal.closing",(function(){e.sent?s("contact-form.user-input",null):s("contact-form.user-input",{subject:e.form.subject,message:e.form.message,project_url:e.form.project_url})}));var l=function(t,n){var i=function(){for(var e=[],t=0,r=Array.from(n.hits);t<r.length;t++){var i=r[t],s=o(null!=i?i.pageName:void 0,(function(e){return e.replace(/\s/g,"_")})),a=encodeURIComponent(s),l=i.kb?"how-to":"latex",c=i.sectionName&&""!==i.sectionName,u=c?"#".concat(i.sectionName.replace(/\s/g,"_")):"",h=i._highlightResult.pageName.value;c&&(h+=" - "+i.sectionName),e.push({url:"/learn/".concat(l,"/").concat(a).concat(u),name:h})}return e}();return n.hits.length&&r.sendMB("contact-form-suggestions-shown"),e.$applyAsync((function(){return e.suggestions=i}))};e.contactUs=function(){if(null!=e.form.email&&""!==e.form.email){e.sending=!0;var n=Math.floor(65536*(1+Math.random())).toString(32),r=e.form.message;null!=e.form.project_url&&(r="".concat(r,"\n\n project_url = ").concat(e.form.project_url));var s={_csrf:window.csrfToken,email:e.form.email,message:r||"",subject:e.form.subject+" - [".concat(n,"]"),labels:"support",inbox:e.inbox||"support",about:"<div>browser: ".concat(null!=t?t.name:void 0," ").concat(null!=t?t.version:void 0,"</div> <div>os: ").concat(o(null!=t?t.os:void 0,(function(e){return e.family}))," ").concat(o(null!=t?t.os:void 0,(function(e){return e.version})),"</div>")},a=i.post("/support",s);return a.then((function(t){return e.sent=!0})),a.catch((function(){return e.error=!0,e.sending=!1,console.log("the request failed")}))}console.log("email not set")},e.$watch("inbox",(function(t){return e.inbox}))();var c=e.$watch("showContactFormSuggestions",(function(e){if(null!=e)return!0===e&&u(),c()})),u=function(){return e.$watch("form.subject",(function(t,r){return t&&t!==r&&t.length>3?n.searchWiki(t,l,{hitsPerPage:3,typoTolerance:"strict"}):e.suggestions=[]}))};return e.clickSuggestionLink=function(e){return r.sendMB("contact-form-suggestions-clicked",{url:e})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){return function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.permissions={read:!1,write:!1,admin:!1,comment:!1},this.$scope.$watch("permissionsLevel",(function(e){if(null!=e&&("readOnly"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.comment=!0):"readAndWrite"===e?(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.comment=!0):"owner"===e&&(r.$scope.permissions.read=!0,r.$scope.permissions.write=!0,r.$scope.permissions.admin=!0,r.$scope.permissions.comment=!0)),r.$scope.anonymous)return r.$scope.permissions.comment=!1}))}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r=n(215),i=n(73);"undefined"!=typeof window&&"Worker"in window&&(r.GlobalWorkerOptions.workerPort=new i),e.exports=r},,function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,,,,,,,,,,,,,,,,,function(e,t,n){var r;void 0===(r=function(){return function(e){var t,n,r=(t=e.split(".").pop(),n=function(e){return e.toLowerCase()},null!=t?n(t):void 0);return["png","pdf","jpg","jpeg","gif"].includes(r)?"image":["csv","xls","xlsx"].includes(r)?"table":["py","r"].includes(r)?"file-text":["bib"].includes(r)?"book":"file"}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n(13),n(157),n(65)],void 0===(i=function(e,t,n){var r;return(r=function(e){function r(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=function(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?l(e):t}(this,a(r).call(this))).ide=e,n.doc_id=t,n.connected=n.ide.socket.socket.connected,n.joined=!1,n.wantToBeJoined=!1,n._checkAceConsistency=_.bind(n._checkConsistency,l(n),n.ace),n._checkCMConsistency=_.bind(n._checkConsistency,l(n),n.cm),n._bindToEditorEvents(),n._bindToSocketEvents(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(r,e),u(r,null,[{key:"initClass",value:function(){this.prototype.MAX_PENDING_OP_SIZE=64}},{key:"getDocument",value:function(e,t){return this.openDocs||(this.openDocs={}),null==this.openDocs[t]?(sl_console.log("[getDocument] Creating new document instance for ".concat(t)),this.openDocs[t]=new r(e,t)):sl_console.log("[getDocument] Returning existing document instance for ".concat(t)),this.openDocs[t]}},{key:"hasUnsavedChanges",value:function(){var e=this.openDocs||{};for(var t in e)if(e[t].hasBufferedOps())return!0;return!1}},{key:"flushAll",value:function(){var e=this;return function(){var t=[];for(var n in e.openDocs){var r=e.openDocs[n];t.push(r.flush())}return t}()}}]),u(r,[{key:"attachToAce",value:function(e){return this.ace=e,null!=this.doc&&this.doc.attachToAce(this.ace),this.ace.getSession().getDocument().on("change",this._checkAceConsistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromAce",value:function(){null!=this.doc&&this.doc.detachFromAce();var e=null!=this.ace?this.ace.getSession().getDocument():void 0;return null!=e&&e.off("change",this._checkAceConsistency),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"attachToCM",value:function(e){return this.cm=e,null!=this.doc&&this.doc.attachToCM(this.cm),null!=this.cm&&this.cm.on("change",this._checkCMConsistency),this.ide.$scope.$emit("document:opened",this.doc)}},{key:"detachFromCM",value:function(){return null!=this.doc&&this.doc.detachFromCM(),null!=this.cm&&this.cm.off("change",this._checkCMConsistency),this.ide.$scope.$emit("document:closed",this.doc)}},{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return null!=this.doc?(e=this.doc).submitOp.apply(e,s(Array.from(n||[]))):void 0}},{key:"_checkConsistency",value:function(e){var t=this;return function(){return setTimeout((function(){if((null!=e?e.getValue():void 0)!==(null!=t.doc?t.doc.getSnapshot():void 0))return t._onError(new Error("Editor text does not match server text"))}),0)}}},{key:"getSnapshot",value:function(){return null!=this.doc?this.doc.getSnapshot():void 0}},{key:"getType",value:function(){return null!=this.doc?this.doc.getType():void 0}},{key:"getInflightOp",value:function(){return null!=this.doc?this.doc.getInflightOp():void 0}},{key:"getPendingOp",value:function(){return null!=this.doc?this.doc.getPendingOp():void 0}},{key:"getRecentAck",value:function(){return null!=this.doc?this.doc.getRecentAck():void 0}},{key:"getOpSize",value:function(e){return null!=this.doc?this.doc.getOpSize(e):void 0}},{key:"hasBufferedOps",value:function(){return null!=this.doc?this.doc.hasBufferedOps():void 0}},{key:"setTrackingChanges",value:function(e){return this.doc.track_changes=e}},{key:"getTrackingChanges",value:function(){return!!this.doc.track_changes}},{key:"setTrackChangesIdSeeds",value:function(e){return this.doc.track_changes_id_seeds=e}},{key:"_bindToSocketEvents",value:function(){var e=this;return this._onUpdateAppliedHandler=function(t){return e._onUpdateApplied(t)},this.ide.socket.on("otUpdateApplied",this._onUpdateAppliedHandler),this._onErrorHandler=function(t,n){return e._onError(t,n)},this.ide.socket.on("otUpdateError",this._onErrorHandler),this._onDisconnectHandler=function(t){return e._onDisconnect(t)},this.ide.socket.on("disconnect",this._onDisconnectHandler)}},{key:"_bindToEditorEvents",value:function(){var e=this;return this._unsubscribeReconnectHandler=this.ide.$scope.$on("project:joined",(function(t){return e._onReconnect(t)}))}},{key:"_unBindFromEditorEvents",value:function(){return this._unsubscribeReconnectHandler()}},{key:"_unBindFromSocketEvents",value:function(){return this.ide.socket.removeListener("otUpdateApplied",this._onUpdateAppliedHandler),this.ide.socket.removeListener("otUpdateError",this._onErrorHandler),this.ide.socket.removeListener("disconnect",this._onDisconnectHandler)}},{key:"leaveAndCleanUp",value:function(){var e=this;return this.leave((function(t){return e._cleanUp()}))}},{key:"join",value:function(e){return null==e&&(e=function(e){}),this.wantToBeJoined=!0,this._cancelLeave(),this.connected?this._joinDoc(e):(this._joinCallbacks||(this._joinCallbacks=[]),this._joinCallbacks.push(e))}},{key:"leave",value:function(e){return null==e&&(e=function(e){}),this.wantToBeJoined=!1,this._cancelJoin(),null!=this.doc&&this.doc.hasBufferedOps()?(sl_console.log("[leave] Doc has buffered ops, pushing callback for later"),this._leaveCallbacks||(this._leaveCallbacks=[]),this._leaveCallbacks.push(e)):this.connected?(sl_console.log("[leave] Leaving now"),this._leaveDoc(e)):(sl_console.log("[leave] Not connected, returning now"),e())}},{key:"flush",value:function(){return null!=this.doc?this.doc.flushPendingOps():void 0}},{key:"chaosMonkey",value:function(e,t){var n=this;null==e&&(e=0),null==t&&(t="a");var r=t,i=null,o=0;return this._cm=function s(){return null!=i&&i.length||(i=r.slice()+" "+new Date+"\n",(e+=Math.random()>.1?1:-2)<0&&(e=0),o=0),t=i[0],i=i.slice(1),n.ace.session.insert({row:e,column:o},t),o+=1,n._cm=setTimeout(s,100+(Math.random()<.1?1e3:0))}()}},{key:"clearChaosMonkey",value:function(){return clearTimeout(this._cm)}},{key:"pollSavedStatus",value:function(){var e,t=this.getInflightOp(),n=this.getPendingOp(),r=this.getRecentAck(),i=null!=n&&this.getOpSize(n);return null==t&&null==n?(e=!0,sl_console.logOnce("[pollSavedStatus] no inflight or pending ops")):null!=t&&t===this.oldInflightOp?(e=!1,sl_console.log("[pollSavedStatus] inflight op is same as before")):null!=n&&r&&i<this.MAX_PENDING_OP_SIZE?(e=!0,sl_console.log("[pollSavedStatus] pending op (small with recent ack) assume ok",n,i)):(e=!1,sl_console.log("[pollSavedStatus] assuming not saved (inflightOp?: ".concat(null!=t,", pendingOp?: ").concat(null!=n,")"))),this.oldInflightOp=t,e}},{key:"_cancelLeave",value:function(){if(null!=this._leaveCallbacks)return delete this._leaveCallbacks}},{key:"_cancelJoin",value:function(){if(null!=this._joinCallbacks)return delete this._joinCallbacks}},{key:"_onUpdateApplied",value:function(e){return this.ide.pushEvent("received-update",{doc_id:this.doc_id,remote_doc_id:null!=e?e.doc:void 0,wantToBeJoined:this.wantToBeJoined,update:e,hasDoc:null!=this.doc}),null!=window.disconnectOnAck&&Math.random()<window.disconnectOnAck?(sl_console.log("Disconnecting on ack",e),void window._ide.socket.socket.disconnect()):null!=window.dropAcks&&Math.random()<window.dropAcks&&null==e.op?void sl_console.log("Simulating a lost ack",e):(null!=e?e.doc:void 0)!==this.doc_id||null==this.doc||(this.ide.pushEvent("received-update:processing",{update:e}),this.doc.processUpdateFromServerInOrder(e),this.wantToBeJoined)?void 0:this.leave()}},{key:"_onDisconnect",value:function(){return sl_console.log("[onDisconnect] disconnecting"),this.connected=!1,this.joined=!1,null!=this.doc?this.doc.updateConnectionState("disconnected"):void 0}},{key:"_onReconnect",value:function(){var e=this;if(sl_console.log("[onReconnect] reconnected (joined project)"),this.ide.pushEvent("reconnected:afterJoinProject"),this.connected=!0,this.wantToBeJoined||(null!=this.doc?this.doc.hasBufferedOps():void 0))return sl_console.log("[onReconnect] Rejoining (wantToBeJoined: ".concat(this.wantToBeJoined," OR hasBufferedOps: ").concat(null!=this.doc?this.doc.hasBufferedOps():void 0,")")),this._joinDoc((function(t){return null!=t?e._onError(t):(e.doc.updateConnectionState("ok"),e.doc.flushPendingOps(),e._callJoinCallbacks())}))}},{key:"_callJoinCallbacks",value:function(){for(var e=0,t=Array.from(this._joinCallbacks||[]);e<t.length;e++)(0,t[e])();return delete this._joinCallbacks}},{key:"_joinDoc",value:function(e){var r=this;return null==e&&(e=function(e){}),null!=this.doc?(this.ide.pushEvent("joinDoc:existing",{doc_id:this.doc_id,version:this.doc.getVersion()}),this.ide.socket.emit("joinDoc",this.doc_id,this.doc.getVersion(),{encodeRanges:!0},(function(t,n,i,o,s){return null!=t?e(t):(r.joined=!0,r.doc.catchUp(o),r._decodeRanges(s),r._catchUpRanges(null!=s?s.changes:void 0,null!=s?s.comments:void 0),e())}))):(this.ide.pushEvent("joinDoc:new",{doc_id:this.doc_id}),this.ide.socket.emit("joinDoc",this.doc_id,{encodeRanges:!0},(function(i,o,s,a,l){return null!=i?e(i):(r.joined=!0,r.ide.pushEvent("joinDoc:inited",{doc_id:r.doc_id,version:s}),r.doc=new t(r.doc_id,o,s,r.ide.socket),r._decodeRanges(l),r.ranges=new n(null!=l?l.changes:void 0,null!=l?l.comments:void 0),r._bindToShareJsDocEvents(),e())})))}},{key:"_decodeRanges",value:function(e){var t=function(e){return decodeURIComponent(escape(e))};try{for(var n=0,r=Array.from(e.changes||[]);n<r.length;n++){var i=r[n];null!=i.op.i&&(i.op.i=t(i.op.i)),null!=i.op.d&&(i.op.d=t(i.op.d))}return function(){for(var n=[],r=0,i=Array.from(e.comments||[]);r<i.length;r++){var o=i[r];null!=o.op.c?n.push(o.op.c=t(o.op.c)):n.push(void 0)}return n}()}catch(e){return console.log(e)}}},{key:"_leaveDoc",value:function(e){var t=this;return null==e&&(e=function(e){}),sl_console.log("[_leaveDoc] Sending leaveDoc request"),this.ide.socket.emit("leaveDoc",this.doc_id,(function(n){if(null!=n)return e(n);t.joined=!1;for(var r=0,i=Array.from(t._leaveCallbacks||[]);r<i.length;r++)e=i[r],sl_console.log("[_leaveDoc] Calling buffered callback",e),e(n);return delete t._leaveCallbacks,e(n)}))}},{key:"_cleanUp",value:function(){return r.openDocs[this.doc_id]===this?(sl_console.log("[_cleanUp] Removing self (".concat(this.doc_id,") from in openDocs")),delete r.openDocs[this.doc_id]):sl_console.log("[_cleanUp] New instance of (".concat(this.doc_id,") created. Not removing")),this._unBindFromEditorEvents(),this._unBindFromSocketEvents()}},{key:"_bindToShareJsDocEvents",value:function(){var e=this;return this.doc.on("error",(function(t,n){return e._onError(t,n)})),this.doc.on("externalUpdate",(function(t){return e.ide.pushEvent("externalUpdate",{doc_id:e.doc_id}),e.trigger("externalUpdate",t)})),this.doc.on("remoteop",(function(){e.ide.pushEvent("remoteop",{doc_id:e.doc_id});for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.trigger.apply(e,["remoteop"].concat(s(Array.from(n))))})),this.doc.on("op:sent",(function(t){return e.ide.pushEvent("op:sent",{doc_id:e.doc_id,op:t}),e.trigger("op:sent")})),this.doc.on("op:acknowledged",(function(t){return e.ide.pushEvent("op:acknowledged",{doc_id:e.doc_id,op:t}),e.ide.$scope.$emit("ide:opAcknowledged",{doc_id:e.doc_id,op:t}),e.trigger("op:acknowledged")})),this.doc.on("op:timeout",(function(t){return e.ide.pushEvent("op:timeout",{doc_id:e.doc_id,op:t}),e.trigger("op:timeout"),e._onError(new Error("op timed out"),{op:t})})),this.doc.on("flush",(function(t,n,r){return e.ide.pushEvent("flush",{doc_id:e.doc_id,inflightOp:t,pendingOp:n,v:r})})),this.doc.on("change",(function(t,n,r){return e._applyOpsToRanges(t,n,r),e.ide.$scope.$emit("doc:changed",{doc_id:e.doc_id})})),this.doc.on("flipped_pending_to_inflight",(function(){return e.trigger("flipped_pending_to_inflight")})),this.doc.on("saved",(function(){return e.ide.$scope.$emit("doc:saved",{doc_id:e.doc_id})}))}},{key:"_onError",value:function(e,t){if(null==t&&(t={}),t.doc_id=this.doc_id,sl_console.log("ShareJS error",e,t),"no project_id found on client"!==e.message){if("function"==typeof ga){var n=e.message;/^Delete component/.test(n)&&(n="Delete component does not match deleted text"),ga("send","event","error","shareJsError","".concat(n," - ").concat(this.ide.socket.socket.transport.name))}return null!=this.doc&&this.doc.clearInflightAndPendingOps(),this.trigger("error",e,t),this._cleanUp()}sl_console.log("ignoring error, will wait to join project")}},{key:"_applyOpsToRanges",value:function(e,t,n){var r,i=this;null==e&&(e=[]);var o,s,a=null,l=null!=n;null!=(o=null!=n?n.meta:void 0,s=function(e){return e.tc},null!=o?s(o):void 0)&&(r=this.ranges.getIdSeed(),this.ranges.setIdSeed(n.meta.tc)),l&&(null!=n.meta?n.meta.tc:void 0)?a=n.meta.user_id:l||null==this.track_changes_as||(a=this.track_changes_as),this.ranges.track_changes=null!=a;for(var c=0,u=Array.from(e);c<u.length;c++){var h=u[c];this.ranges.applyOp(h,{user_id:a})}return null!=r&&this.ranges.setIdSeed(r),l?setTimeout((function(){return i.emit("ranges:dirty")})):this.emit("ranges:dirty")}},{key:"_catchUpRanges",value:function(e,t){null==e&&(e=[]),null==t&&(t=[]),this.emit("ranges:clear"),this.ranges.changes=e,this.ranges.comments=t,this.ranges.track_changes=this.doc.track_changes;for(var n=0,r=Array.from(this.doc.getInflightOp()||[]);n<r.length;n++){var i=r[n];this.ranges.setIdSeed(this.doc.track_changes_id_seeds.inflight),this.ranges.applyOp(i,{user_id:this.track_changes_as})}for(var o=0,s=Array.from(this.doc.getPendingOp()||[]);o<s.length;o++)i=s[o],this.ranges.setIdSeed(this.doc.track_changes_id_seeds.pending),this.ranges.applyOp(i,{user_id:this.track_changes_as});return this.emit("ranges:redraw")}}]),r}(e)).initClass(),r}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i,o;function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){return function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),null==t&&(t=[]),this.changes=t,null==n&&(n=[]),this.comments=n,this.setIdSeed(e.generateIdSeed()),this.resetDirtyState()}var t,n,r;return t=e,r=[{key:"generateIdSeed",value:function(){var e=Math.floor(32767*Math.random()).toString(16),t=Math.floor(16777216*Math.random()).toString(16),n=Math.floor((new Date).valueOf()/1e3).toString(16);return"00000000".substr(0,8-n.length)+n+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-e.length)+e}},{key:"generateId",value:function(){return this.generateIdSeed()+"000001"}}],(n=[{key:"getIdSeed",value:function(){return this.id_seed}},{key:"setIdSeed",value:function(e){return this.id_seed=e,this.id_increment=0}},{key:"newId",value:function(){this.id_increment++;var e=this.id_increment.toString(16);return this.id_seed+"000000".substr(0,6-e.length)+e}},{key:"getComment",value:function(e){for(var t=null,n=0,r=Array.from(this.comments);n<r.length;n++){var i=r[n];if(i.id===e){t=i;break}}return t}},{key:"removeCommentId",value:function(e){var t=this.getComment(e);if(null!=t)return this.comments=this.comments.filter((function(t){return t.id!==e})),this._markAsDirty(t,"comment","removed")}},{key:"moveCommentId",value:function(e,t,n){var r=this;return function(){for(var i=[],o=0,s=Array.from(r.comments);o<s.length;o++){var a=s[o];a.id===e?(a.op.p=t,a.op.c=n,i.push(r._markAsDirty(a,"comment","moved"))):i.push(void 0)}return i}()}},{key:"getChange",value:function(e){for(var t=null,n=0,r=Array.from(this.changes);n<r.length;n++){var i=r[n];if(i.id===e){t=i;break}}return t}},{key:"getChanges",value:function(e){for(var t=[],n={},r=0,i=Array.from(e);r<i.length;r++)n[i[r]]=!0;for(var o=0,s=Array.from(this.changes);o<s.length;o++){var a=s[o];n[a.id]&&(delete n[a.id],t.push(a))}return t}},{key:"removeChangeId",value:function(e){var t=this.getChange(e);if(null!=t)return this._removeChange(t)}},{key:"removeChangeIds",value:function(e){if(!(!(null!=e?e.length:void 0)>0)){this.changes.length;for(var t={},n=0,r=Array.from(e);n<r.length;n++)t[r[n]]=!0;for(var i=[],o=0,s=Array.from(this.changes);o<s.length;o++){var a=s[o];t[a.id]?(delete t[a.id],this._markAsDirty(a,"change","removed")):i.push(a)}return this.changes=i}}},{key:"validate",value:function(e){for(var t,n=0,r=Array.from(this.changes);n<r.length;n++){var i=r[n];if(null!=i.op.i&&(t=e.slice(i.op.p,i.op.p+i.op.i.length))!==i.op.i)throw new Error("Change (".concat(JSON.stringify(i),") doesn't match text (").concat(JSON.stringify(t),")"))}for(var o=0,s=Array.from(this.comments);o<s.length;o++){var a=s[o];if((t=e.slice(a.op.p,a.op.p+a.op.c.length))!==a.op.c)throw new Error("Comment (".concat(JSON.stringify(a),") doesn't match text (").concat(JSON.stringify(t),")"))}return!0}},{key:"applyOp",value:function(e,t){if(null==t&&(t={}),null==t.ts&&(t.ts=new Date),null!=e.i)return this.applyInsertToChanges(e,t),this.applyInsertToComments(e);if(null!=e.d)return this.applyDeleteToChanges(e,t),this.applyDeleteToComments(e);if(null!=e.c)return this.addComment(e,t);throw new Error("unknown op type")}},{key:"applyOps",value:function(e,t){var n=this;return null==t&&(t={}),Array.from(e).map((function(e){return n.applyOp(e,t)}))}},{key:"addComment",value:function(e,t){var n,r=this.getComment(e.t);return null!=r?(this.moveCommentId(e.t,e.p,e.c),r):(this.comments.push(n={id:e.t||this.newId(),op:{c:e.c,p:e.p,t:e.t},metadata:t}),this._markAsDirty(n,"comment","added"),n)}},{key:"applyInsertToComments",value:function(e){var t=this;return function(){for(var n=[],r=0,i=Array.from(t.comments);r<i.length;r++){var o=i[r];if(e.p<=o.op.p)o.op.p+=e.i.length,n.push(t._markAsDirty(o,"comment","moved"));else if(e.p<o.op.p+o.op.c.length){var s=e.p-o.op.p;o.op.c=o.op.c.slice(0,+(s-1)+1||void 0)+e.i+o.op.c.slice(s),n.push(t._markAsDirty(o,"comment","moved"))}else n.push(void 0)}return n}()}},{key:"applyDeleteToComments",value:function(e){var t=this,n=e.p,r=e.d.length,i=e.p+r;return function(){for(var o=[],s=0,a=Array.from(t.comments);s<a.length;s++){var l=a[s],c=l.op.p,u=l.op.p+l.op.c.length,h=u-c;if(i<=c)l.op.p-=r,o.push(t._markAsDirty(l,"comment","moved"));else if(n>=u);else{var d,f;f=n<=c?"":l.op.c.slice(0,n-c),d=i>=u?"":l.op.c.slice(i-c);var p=l.op.c.slice(f.length,h-d.length),g=Math.max(0,c-n);if(p!==e.d.slice(g).slice(0,p.length))throw new Error("deleted content does not match comment content");l.op.p=Math.min(c,n),l.op.c=f+d,o.push(t._markAsDirty(l,"comment","moved"))}}return o}()}},{key:"applyInsertToChanges",value:function(e,t){for(var n,r=this,i=e.p,o=e.i.length,s=e.p+o,a=!!e.u,l=!1,c=null,u=[],h=[],d=[],f=0;f<this.changes.length;f++){var p=(n=this.changes[f]).op.p;if(null!=n.op.d)i<p?(n.op.p+=o,u.push(n)):i===p&&(a&&n.op.d.length>=e.i.length&&n.op.d.slice(0,e.i.length)===e.i?(n.op.d=n.op.d.slice(e.i.length),n.op.p+=e.i.length,""===n.op.d?h.push(n):u.push(n),l=!0):(n.op.p+=o,u.push(n)));else if(null!=n.op.i){var g,m=p+n.op.i.length,v=i>=p&&i<=m,y=t.user_id===n.metadata.user_id,b=this.changes[f+1],w=null!=b&&null!=b.op.d&&e.p===m&&b.op.p===e.p,_=a&&w&&b.op.d.slice(0,e.i.length)===e.i,C=null!=c&&null!=c.op.d&&c.op.p===s;if(this.track_changes&&v&&!C&&!l&&!_&&y)g=i-p,n.op.i=n.op.i.slice(0,g)+e.i+n.op.i.slice(g),n.metadata.ts=t.ts,l=!0,u.push(n);else if(i<=p)n.op.p+=o,u.push(n);else if((!y||!this.track_changes)&&p<i&&i<m){g=i-p;var S=n.op.i.slice(0,g),k=n.op.i.slice(g);n.op.i=S,u.push(n);var A={op:{i:k,p:p+g+o},metadata:{}};for(var x in n.metadata){var $=n.metadata[x];A.metadata[x]=$}d.push(A)}}c=n}this.track_changes&&!l&&this._addOp(e,t);for(var T=0,E=Array.from(d);T<E.length;T++){var R=E[T];e=R.op,t=R.metadata,this._addOp(e,t)}for(var M=0,L=Array.from(h);M<L.length;M++)n=L[M],this._removeChange(n);return function(){for(var e=[],t=0,i=Array.from(u);t<i.length;t++)n=i[t],e.push(r._markAsDirty(n,"change","moved"));return e}()}},{key:"applyDeleteToChanges",value:function(e,t){for(var n=this,r=e.p,i=e.d.length,o=e.p+i,s=[],a=[],l=[],c=0,u=Array.from(this.changes);c<u.length;c++){var h,d=u[c];if(null!=d.op.i){var f=(h=d.op.p)+d.op.i.length;if(o<=h)d.op.p-=i,a.push(d);else if(r>=f);else{var p,g,m,v;r>=h?(g="",v=d.op.i.slice(0,r-h)):(g=e.d.slice(0,h-r),v=""),o<=f?(p="",m=d.op.i.slice(o-h)):(p=e.d.slice(f-r),m="");var y=v+m;y.length>0?(d.op.i=y,d.op.p=Math.min(h,r),d.metadata.ts=t.ts,a.push(d)):s.push(d);var b=e.d.length-g.length-p.length,w=g.length,_={d:e.d.slice(w,w+b),p:w};_.d.length>0&&l.push(_)}}else if(null!=d.op.d)if(o<(h=d.op.p)||!this.track_changes&&o===h)d.op.p-=i,a.push(d);else if(r<=h&&h<=o)if(this.track_changes){var C=h-r;l.push({i:d.op.d,p:C}),s.push(d)}else d.op.p=r,a.push(d)}e={p:e.p,d:this._applyOpModifications(e.d,l)};for(var S=0,k=Array.from(s);S<k.length;S++)d=k[S],e.d.length>0&&null!=d.op.d&&e.p<=d.op.p&&d.op.p<=e.p+e.d.length?(d.op.p=e.p,d.op.d=e.d,d.metadata=t,a.push(d),e.d=""):this._removeChange(d);if(this.track_changes&&e.d.length>0)this._addOp(e,t);else{var A=this._scanAndMergeAdjacentUpdates();a=a.concat(A.moved_changes);for(var x=0,$=Array.from(A.remove_changes);x<$.length;x++)d=$[x],this._removeChange(d),a=a.filter((function(e){return e!==d}))}return function(){for(var e=[],t=0,r=Array.from(a);t<r.length;t++)d=r[t],e.push(n._markAsDirty(d,"change","moved"));return e}()}},{key:"_addOp",value:function(e,t){var n={id:this.newId(),op:this._clone(e),metadata:this._clone(t)};return this.changes.push(n),this.changes.sort((function(e,t){var n=e.op.p-t.op.p;return 0!==n?n:null!=e.op.i&&null!=t.op.d?1:-1})),this._markAsDirty(n,"change","added")}},{key:"_removeChange",value:function(e){return this.changes=this.changes.filter((function(t){return t.id!==e.id})),this._markAsDirty(e,"change","removed")}},{key:"_applyOpModifications",value:function(e,t){t.sort((function(e,t){var n=t.p-e.p;return 0!==n?n:null!=e.i&&null!=t.d?1:-1}));for(var n=0,r=Array.from(t);n<r.length;n++){var i=r[n];if(null!=i.i)e=e.slice(0,i.p)+i.i+e.slice(i.p);else if(null!=i.d){if(e.slice(i.p,i.p+i.d.length)!==i.d)throw new Error("deleted content does not match. content: ".concat(JSON.stringify(e),"; modification: ").concat(JSON.stringify(i)));e=e.slice(0,i.p)+e.slice(i.p+i.d.length)}}return e}},{key:"_scanAndMergeAdjacentUpdates",value:function(){for(var e=null,t=[],n=[],r=0,i=Array.from(this.changes);r<i.length;r++){var o=i[r];if(null!=(null!=e?e.op.i:void 0)&&null!=o.op.i){var s=e.op.p+e.op.i.length,a=e.metadata.user_id,l=o.op.p,c=o.metadata.user_id;s===l&&a===c&&(t.push(o),e.op.i+=o.op.i,n.push(e))}else null!=(null!=e?e.op.d:void 0)&&null!=o.op.d&&e.op.p===o.op.p?(e.op.d+=o.op.d,t.push(o),n.push(e)):e=o}return{moved_changes:n,remove_changes:t}}},{key:"resetDirtyState",value:function(){return this._dirtyState={comment:{moved:{},removed:{},added:{}},change:{moved:{},removed:{},added:{}}}}},{key:"getDirtyState",value:function(){return this._dirtyState}},{key:"_markAsDirty",value:function(e,t,n){return this._dirtyState[t][n][e.id]=e}},{key:"_clone",value:function(e){var t={};for(var n in e){var r=e[n];t[n]=r}return t}}])&&s(t.prototype,n),r&&s(t,r),e}()};null!==n(23)?(i=[],void 0===(o="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=o)):e.exports=a()},function(e,t,n){var r;void 0===(r=function(){return[{caption:"\\begin{}",snippet:"\\begin{$1}",meta:"env",score:7.849662248028187},{caption:"\\begin{}[]",snippet:"\\begin{$1}[$2]",meta:"env",score:7.849662248028187},{caption:"\\begin{}{}",snippet:"\\begin{$1}{$2}",meta:"env",score:7.849662248028187},{caption:"\\end{}",snippet:"\\end{$1}",meta:"env",score:7.847906405228455},{caption:"\\usepackage[]{}",snippet:"\\usepackage[$1]{$2}",meta:"pkg",score:5.427890758130527},{caption:"\\item",snippet:"\\item",meta:"cmd",score:3.800886892251021},{caption:"\\item[]",snippet:"\\item[$1]",meta:"cmd",score:3.800886892251021},{caption:"\\section{}",snippet:"\\section{$1}",meta:"cmd",score:3.0952612541683835},{caption:"\\textbf{}",snippet:"\\textbf{$1}",meta:"cmd",score:2.627755982816738},{caption:"\\cite{}",snippet:"\\cite{$1}",meta:"cmd",score:2.341195220791228},{caption:"\\label{}",snippet:"\\label{$1}",meta:"cmd",score:1.897791904799601},{caption:"\\textit{}",snippet:"\\textit{$1}",meta:"cmd",score:1.6842996195493385},{caption:"\\includegraphics[]{}",snippet:"\\includegraphics[$1]{$2}",meta:"cmd",score:1.4595731795525781},{caption:"\\documentclass[]{}",snippet:"\\documentclass[$1]{$2}",meta:"cmd",score:1.4425339817971206},{caption:"\\documentclass{}",snippet:"\\documentclass{$1}",meta:"cmd",score:1.4425339817971206},{caption:"\\ref{}",snippet:"\\ref{$1}",meta:"cross-reference",score:.014379554883991673},{caption:"\\frac{}{}",snippet:"\\frac{$1}{$2}",meta:"cmd",score:1.4341091141105058},{caption:"\\subsection{}",snippet:"\\subsection{$1}",meta:"cmd",score:1.3890912739512353},{caption:"\\hline",snippet:"\\hline",meta:"cmd",score:1.3209538327406387},{caption:"\\caption{}",snippet:"\\caption{$1}",meta:"cmd",score:1.2569477427490174},{caption:"\\centering",snippet:"\\centering",meta:"cmd",score:1.1642881814937829},{caption:"\\vspace{}",snippet:"\\vspace{$1}",meta:"cmd",score:.9533807826673939},{caption:"\\title{}",snippet:"\\title{$1}",meta:"cmd",score:.9202908262245683},{caption:"\\author{}",snippet:"\\author{$1}",meta:"cmd",score:.8973590434087177},{caption:"\\author[]{}",snippet:"\\author[$1]{$2}",meta:"cmd",score:.8973590434087177},{caption:"\\maketitle",snippet:"\\maketitle",meta:"cmd",score:.7504160124360846},{caption:"\\textwidth",snippet:"\\textwidth",meta:"cmd",score:.7355328080889112},{caption:"\\newcommand{}{}",snippet:"\\newcommand{$1}{$2}",meta:"cmd",score:.7264891987129375},{caption:"\\newcommand{}[]{}",snippet:"\\newcommand{$1}[$2]{$3}",meta:"cmd",score:.7264891987129375},{caption:"\\date{}",snippet:"\\date{$1}",meta:"cmd",score:.7225518453076786},{caption:"\\emph{}",snippet:"\\emph{$1}",meta:"cmd",score:.7060308784832261},{caption:"\\textsc{}",snippet:"\\textsc{$1}",meta:"cmd",score:.6926466355384758},{caption:"\\multicolumn{}{}{}",snippet:"\\multicolumn{$1}{$2}{$3}",meta:"cmd",score:.5473606021405326},{caption:"\\input{}",snippet:"\\input{$1}",meta:"cmd",score:.4966021927742672},{caption:"\\alpha",snippet:"\\alpha",meta:"cmd",score:.49520006391384913},{caption:"\\in",snippet:"\\in",meta:"cmd",score:.4716039670146658},{caption:"\\mathbf{}",snippet:"\\mathbf{$1}",meta:"cmd",score:.4682018419466319},{caption:"\\right",snippet:"\\right",meta:"cmd",score:.4299239459457309},{caption:"\\left",snippet:"\\left",meta:"cmd",score:.42937815279867964},{caption:"\\left[]",snippet:"\\left[$1]",meta:"cmd",score:.42937815279867964},{caption:"\\sum",snippet:"\\sum",meta:"cmd",score:.42607994509619934},{caption:"\\noindent",snippet:"\\noindent",meta:"cmd",score:.42355747798114207},{caption:"\\chapter{}",snippet:"\\chapter{$1}",meta:"cmd",score:.422097569591803},{caption:"\\par",snippet:"\\par",meta:"cmd",score:.413853376001159},{caption:"\\lambda",snippet:"\\lambda",meta:"cmd",score:.39389600578684125},{caption:"\\subsubsection{}",snippet:"\\subsubsection{$1}",meta:"cmd",score:.3727781330132016},{caption:"\\bibitem{}",snippet:"\\bibitem{$1}",meta:"cmd",score:.3689547570562042},{caption:"\\bibitem[]{}",snippet:"\\bibitem[$1]{$2}",meta:"cmd",score:.3689547570562042},{caption:"\\text{}",snippet:"\\text{$1}",meta:"cmd",score:.3608680734736821},{caption:"\\setlength{}{}",snippet:"\\setlength{$1}{$2}",meta:"cmd",score:.354445763583904},{caption:"\\setlength",snippet:"\\setlength",meta:"cmd",score:.354445763583904},{caption:"\\mathcal{}",snippet:"\\mathcal{$1}",meta:"cmd",score:.35084018920966636},{caption:"\\newline",snippet:"\\newline",meta:"cmd",score:.3311721696201715},{caption:"\\newpage",snippet:"\\newpage",meta:"cmd",score:.3277033727934986},{caption:"\\renewcommand{}{}",snippet:"\\renewcommand{$1}{$2}",meta:"cmd",score:.3267437011085663},{caption:"\\renewcommand",snippet:"\\renewcommand",meta:"cmd",score:.3267437011085663},{caption:"\\theta",snippet:"\\theta",meta:"cmd",score:.3210417159232142},{caption:"\\hspace{}",snippet:"\\hspace{$1}",meta:"cmd",score:.3147206476372336},{caption:"\\beta",snippet:"\\beta",meta:"cmd",score:.3061799530337638},{caption:"\\texttt{}",snippet:"\\texttt{$1}",meta:"cmd",score:.3019066753744355},{caption:"\\times",snippet:"\\times",meta:"cmd",score:.2957960629411553},{caption:"\\citep{}",snippet:"\\citep{$1}",meta:"cmd",score:.2941882834697057},{caption:"\\color[]{}",snippet:"\\color[$1]{$2}",meta:"cmd",score:.2864294797053033},{caption:"\\color{}",snippet:"\\color{$1}",meta:"cmd",score:.2864294797053033},{caption:"\\mu",snippet:"\\mu",meta:"cmd",score:.27635652476799255},{caption:"\\bibliography{}",snippet:"\\bibliography{$1}",meta:"cmd",score:.2659628337907604},{caption:"\\linewidth",snippet:"\\linewidth",meta:"cmd",score:.2639498312518439},{caption:"\\delta",snippet:"\\delta",meta:"cmd",score:.2620578600722735},{caption:"\\sigma",snippet:"\\sigma",meta:"cmd",score:.25940147926344487},{caption:"\\pi",snippet:"\\pi",meta:"cmd",score:.25920934567729714},{caption:"\\hat{}",snippet:"\\hat{$1}",meta:"cmd",score:.25264309033778715},{caption:"\\hat",snippet:"\\hat",meta:"cmd",score:.25264309033778715},{caption:"\\bibliographystyle{}",snippet:"\\bibliographystyle{$1}",meta:"cmd",score:.25122317941387773},{caption:"\\small",snippet:"\\small",meta:"cmd",score:.2447632045426295},{caption:"\\small{}",snippet:"\\small{$1}",meta:"cmd",score:.2447632045426295},{caption:"\\LaTeX",snippet:"\\LaTeX",meta:"cmd",score:.2334089308452787},{caption:"\\LaTeX{}",snippet:"\\LaTeX{$1}",meta:"cmd",score:.2334089308452787},{caption:"\\cdot",snippet:"\\cdot",meta:"cmd",score:.23029085545522762},{caption:"\\footnote{}",snippet:"\\footnote{$1}",meta:"cmd",score:.2253056071787701},{caption:"\\newtheorem{}[]{}",snippet:"\\newtheorem{$1}[$2]{$3}",meta:"cmd",score:.215689795055434},{caption:"\\newtheorem{}{}",snippet:"\\newtheorem{$1}{$2}",meta:"cmd",score:.215689795055434},{caption:"\\newtheorem{}{}[]",snippet:"\\newtheorem{$1}{$2}[$3]",meta:"cmd",score:.215689795055434},{caption:"\\Delta",snippet:"\\Delta",meta:"cmd",score:.21386475063892618},{caption:"\\tau",snippet:"\\tau",meta:"cmd",score:.21236188205859796},{caption:"\\hfill",snippet:"\\hfill",meta:"cmd",score:.2058248088519886},{caption:"\\leq",snippet:"\\leq",meta:"cmd",score:.20498894440637172},{caption:"\\footnotesize",snippet:"\\footnotesize",meta:"cmd",score:.2038592081252624},{caption:"\\footnotesize{}",snippet:"\\footnotesize{$1}",meta:"cmd",score:.2038592081252624},{caption:"\\large",snippet:"\\large",meta:"cmd",score:.20377416734108866},{caption:"\\large{}",snippet:"\\large{$1}",meta:"cmd",score:.20377416734108866},{caption:"\\sqrt{}",snippet:"\\sqrt{$1}",meta:"cmd",score:.20240160977404634},{caption:"\\epsilon",snippet:"\\epsilon",meta:"cmd",score:.2005136761359043},{caption:"\\Large",snippet:"\\Large",meta:"cmd",score:.1987771081149759},{caption:"\\Large{}",snippet:"\\Large{$1}",meta:"cmd",score:.1987771081149759},{caption:"\\cvitem{}{}",snippet:"\\cvitem{$1}{$2}",meta:"cmd",score:.19605476980016281},{caption:"\\rho",snippet:"\\rho",meta:"cmd",score:.1959287380541684},{caption:"\\omega",snippet:"\\omega",meta:"cmd",score:.19326783415115262},{caption:"\\mathrm{}",snippet:"\\mathrm{$1}",meta:"cmd",score:.19117752976172653},{caption:"\\boldsymbol{}",snippet:"\\boldsymbol{$1}",meta:"cmd",score:.18137737738638837},{caption:"\\boldsymbol",snippet:"\\boldsymbol",meta:"cmd",score:.18137737738638837},{caption:"\\gamma",snippet:"\\gamma",meta:"cmd",score:.17940276535431304},{caption:"\\clearpage",snippet:"\\clearpage",meta:"cmd",score:.1789117552185788},{caption:"\\infty",snippet:"\\infty",meta:"cmd",score:.17837290019711305},{caption:"\\phi",snippet:"\\phi",meta:"cmd",score:.17405809173097808},{caption:"\\partial",snippet:"\\partial",meta:"cmd",score:.17168102367966637},{caption:"\\include{}",snippet:"\\include{$1}",meta:"cmd",score:.1547080054979312},{caption:"\\address{}",snippet:"\\address{$1}",meta:"cmd",score:.1525055392611109},{caption:"\\address[]{}",snippet:"\\address[$1]{$2}",meta:"cmd",score:.1525055392611109},{caption:"\\address{}{}{}",snippet:"\\address{$1}{$2}{$3}",meta:"cmd",score:.1525055392611109},{caption:"\\quad",snippet:"\\quad",meta:"cmd",score:.15242755832392743},{caption:"\\email{}",snippet:"\\email{$1}",meta:"cmd",score:.1522294670109857},{caption:"\\paragraph{}",snippet:"\\paragraph{$1}",meta:"cmd",score:.152074250347974},{caption:"\\varepsilon",snippet:"\\varepsilon",meta:"cmd",score:.05411564201390573},{caption:"\\zeta",snippet:"\\zeta",meta:"cmd",score:.023330249803752954},{caption:"\\eta",snippet:"\\eta",meta:"cmd",score:.11088718379889091},{caption:"\\vartheta",snippet:"\\vartheta",meta:"cmd",score:.0025822992078068712},{caption:"\\iota",snippet:"\\iota",meta:"cmd",score:.0024774003791525486},{caption:"\\kappa",snippet:"\\kappa",meta:"cmd",score:.04887876299369008},{caption:"\\nu",snippet:"\\nu",meta:"cmd",score:.09206962821059342},{caption:"\\xi",snippet:"\\xi",meta:"cmd",score:.06496042899265699},{caption:"\\varpi",snippet:"\\varpi",meta:"cmd",score:.0007039358167790341},{caption:"\\varrho",snippet:"\\varrho",meta:"cmd",score:.0011279491613898612},{caption:"\\varsigma",snippet:"\\varsigma",meta:"cmd",score:.0010424880711234978},{caption:"\\varsigma{}",snippet:"\\varsigma{$1}",meta:"cmd",score:.0010424880711234978},{caption:"\\upsilon",snippet:"\\upsilon",meta:"cmd",score:.00420715572598688},{caption:"\\varphi",snippet:"\\varphi",meta:"cmd",score:.03351251516668212},{caption:"\\chi",snippet:"\\chi",meta:"cmd",score:.043373492287805675},{caption:"\\psi",snippet:"\\psi",meta:"cmd",score:.09994508706163642},{caption:"\\Gamma",snippet:"\\Gamma",meta:"cmd",score:.04801549269801977},{caption:"\\Theta",snippet:"\\Theta",meta:"cmd",score:.038090902146599444},{caption:"\\Lambda",snippet:"\\Lambda",meta:"cmd",score:.032206594305977686},{caption:"\\Xi",snippet:"\\Xi",meta:"cmd",score:.01060997225400494},{caption:"\\Pi",snippet:"\\Pi",meta:"cmd",score:.021264671817473237},{caption:"\\Sigma",snippet:"\\Sigma",meta:"cmd",score:.05769642802079917},{caption:"\\Upsilon",snippet:"\\Upsilon",meta:"cmd",score:.00032875192955749566},{caption:"\\Phi",snippet:"\\Phi",meta:"cmd",score:.0538724950042562},{caption:"\\Psi",snippet:"\\Psi",meta:"cmd",score:.03056589143021648},{caption:"\\Omega",snippet:"\\Omega",meta:"cmd",score:.09490387997853639}]}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(){var e=["abstract","align","align*","equation","equation*","gather","gather*","multline","multline*","split","verbatim","quote","center"];return{all:e.concat(["array","figure","tabular","table","list","enumerate","itemize","frame","thebibliography"]),withoutSnippets:e}}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ace.define("ace/snippets",[],(function(e,t,r){"use strict";var i=e("./lib/oop"),o=e("./lib/event_emitter").EventEmitter,s=e("./lib/lang"),a=e("./range").Range,l=e("./anchor").Anchor,c=e("./keyboard/hash_handler").HashHandler,u=e("./tokenizer").Tokenizer,h=a.comparePoints,d=function(){this.snippetMap={},this.snippetNameMap={}};(function(){i.implement(this,o),this.getTokenizer=function(){function e(e,t,n){return e=e.substr(1),/^\d+$/.test(e)&&!n.inFormatString?[{tabstopId:parseInt(e,10)}]:[{text:e}]}function t(e){return"(?:[^\\\\"+e+"]|\\\\.)"}return d.$tokenizer=new u({start:[{regex:/:/,onMatch:function(e,t,n){return n.length&&n[0].expectIf?(n[0].expectIf=!1,n[0].elseBranch=n[0],[n[0]]):":"}},{regex:/\\./,onMatch:function(e,t,n){var r=e[1];return"}"==r&&n.length?e=r:-1!="`$\\".indexOf(r)?e=r:n.inFormatString&&("n"==r?e="\n":"t"==r?e="\n":-1!="ulULE".indexOf(r)&&(e={changeCase:r,local:r>"a"})),[e]}},{regex:/}/,onMatch:function(e,t,n){return[n.length?n.shift():e]}},{regex:/\$(?:\d+|\w+)/,onMatch:e},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(t,n,r){var i=e(t.substr(1),0,r);return r.unshift(i[0]),i},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+t("\\|")+"*\\|",onMatch:function(e,t,n){n[0].choices=e.slice(1,-1).split(",")},next:"start"},{regex:"/("+t("/")+"+)/(?:("+t("/")+"*)/)(\\w*):?",onMatch:function(e,t,n){var r=n[0];return r.fmtString=e,e=this.splitRegex.exec(e),r.guard=e[1],r.fmt=e[2],r.flag=e[3],""},next:"start"},{regex:"`"+t("`")+"*`",onMatch:function(e,t,n){return n[0].code=e.splice(1,-1),""},next:"start"},{regex:"\\?",onMatch:function(e,t,n){n[0]&&(n[0].expectIf=!0)},next:"start"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:"/("+t("/")+"+)/",token:"regex"},{regex:"",onMatch:function(e,t,n){n.inFormatString=!0},next:"start"}]}),d.prototype.getTokenizer=function(){return d.$tokenizer},d.$tokenizer},this.tokenizeTmSnippet=function(e,t){return this.getTokenizer().getLineTokens(e,t).tokens.map((function(e){return e.value||e}))},this.$getDefaultValue=function(e,t){if(/^[A-Z]\d+$/.test(t)){var n=t.substr(1);return(this.variables[t[0]+"__"]||{})[n]}if(/^\d+$/.test(t))return(this.variables.__||{})[t];if(t=t.replace(/^TM_/,""),e){var r=e.session;switch(t){case"CURRENT_WORD":var i=r.getWordRange();case"SELECTION":case"SELECTED_TEXT":return r.getTextRange(i);case"CURRENT_LINE":return r.getLine(e.getCursorPosition().row);case"PREV_LINE":return r.getLine(e.getCursorPosition().row-1);case"LINE_INDEX":return e.getCursorPosition().column;case"LINE_NUMBER":return e.getCursorPosition().row+1;case"SOFT_TABS":return r.getUseSoftTabs()?"YES":"NO";case"TAB_SIZE":return r.getTabSize();case"FILENAME":case"FILEPATH":return"";case"FULLNAME":return"Ace"}}},this.variables={},this.getVariableValue=function(e,t){return this.variables.hasOwnProperty(t)?this.variables[t](e,t)||"":this.$getDefaultValue(e,t)||""},this.tmStrFormat=function(e,t,r){var i=t.flag||"",o=t.guard;o=new RegExp(o,i.replace(/[^gi]/,""));var s=this.tokenizeTmSnippet(t.fmt,"formatString"),a=this,l=e.replace(o,(function(){a.variables.__=arguments;for(var e=a.resolveVariables(s,r),t="E",i=0;i<e.length;i++){var o=e[i];if("object"==n(o))if(e[i]="",o.changeCase&&o.local){var l=e[i+1];l&&"string"==typeof l&&("u"==o.changeCase?e[i]=l[0].toUpperCase():e[i]=l[0].toLowerCase(),e[i+1]=l.substr(1))}else o.changeCase&&(t=o.changeCase);else"U"==t?e[i]=o.toUpperCase():"L"==t&&(e[i]=o.toLowerCase())}return e.join("")}));return this.variables.__=null,l},this.resolveVariables=function(e,t){for(var r=[],i=0;i<e.length;i++){var o=e[i];if("string"==typeof o)r.push(o);else{if("object"!=n(o))continue;if(o.skip)a(o);else{if(o.processed<i)continue;if(o.text){var s=this.getVariableValue(t,o.text);s&&o.fmtString&&(s=this.tmStrFormat(s,o)),o.processed=i,null==o.expectIf?s&&(r.push(s),a(o)):s?o.skip=o.elseBranch:a(o)}else null!=o.tabstopId?r.push(o):null!=o.changeCase&&r.push(o)}}}function a(t){var n=e.indexOf(t,i+1);-1!=n&&(i=n)}return r},this.insertSnippetForSelection=function(e,t){var r=e.getCursorPosition(),i=e.session.getLine(r.row),o=e.session.getTabString(),s=i.match(/^\s*/)[0];r.column<s.length&&(s=s.slice(0,r.column)),t=t.replace(/\r/g,"");var a=this.tokenizeTmSnippet(t);a=(a=this.resolveVariables(a,e)).map((function(e){return"\n"==e?e+s:"string"==typeof e?e.replace(/\t/g,o):e}));var l=[];a.forEach((function(e,t){if("object"==n(e)){var r=e.tabstopId,i=l[r];if(i||((i=l[r]=[]).index=r,i.value=""),-1===i.indexOf(e)){i.push(e);var o=a.indexOf(e,t+1);if(-1!==o){var s=a.slice(t+1,o);s.some((function(e){return"object"===n(e)}))&&!i.value?i.value=s:!s.length||i.value&&"string"==typeof i.value||(i.value=s.join(""))}}}})),l.forEach((function(e){e.length=0}));var c={};function u(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];if("object"==n(i)){if(c[i.tabstopId])continue;i=t[e.lastIndexOf(i,r-1)]||{tabstopId:i.tabstopId}}t[r]=i}return t}for(var h=0;h<a.length;h++){var d=a[h];if("object"==n(d)){var p=d.tabstopId,g=a.indexOf(d,h+1);if(c[p])c[p]===d&&(c[p]=null);else{var m=l[p],v="string"==typeof m.value?[m.value]:u(m.value);v.unshift(h+1,Math.max(0,g-h)),v.push(d),c[p]=d,a.splice.apply(a,v),-1===m.indexOf(d)&&m.push(d)}}}var y=0,b=0,w="";a.forEach((function(e){if("string"==typeof e){var t=e.split("\n");t.length>1?(b=t[t.length-1].length,y+=t.length-1):b+=e.length,w+=e}else e.start?e.end={row:y,column:b}:e.start={row:y,column:b}}));var _=e.getSelectionRange(),C=e.session.replace(_,w),S=new f(e),k=e.inVirtualSelectionMode&&e.selection.index;S.addTabstops(l,_.start,C,k)},this.insertSnippet=function(e,t){var n=this;if(e.inVirtualSelectionMode)return n.insertSnippetForSelection(e,t);e.forEachSelection((function(){n.insertSnippetForSelection(e,t)}),null,{keepOrder:!0}),e.tabstopManager&&e.tabstopManager.tabNext()},this.$getScope=function(e){var t=e.session.$mode.$id||"";if("html"===(t=t.split("/").pop())||"php"===t){"php"!==t||e.session.$mode.inlinePhp||(t="html");var r=e.getCursorPosition(),i=e.session.getState(r.row);"object"===n(i)&&(i=i[0]),i.substring&&("js-"==i.substring(0,3)?t="javascript":"css-"==i.substring(0,4)?t="css":"php-"==i.substring(0,4)&&(t="php"))}return t},this.getActiveScopes=function(e){var t=this.$getScope(e),n=[t],r=this.snippetMap;return r[t]&&r[t].includeScopes&&n.push.apply(n,r[t].includeScopes),n.push("_"),n},this.expandWithTab=function(e,t){var n=this,r=e.forEachSelection((function(){return n.expandSnippetForSelection(e,t)}),null,{keepOrder:!0});return r&&e.tabstopManager&&e.tabstopManager.tabNext(),r},this.expandSnippetForSelection=function(e,t){var n,r=e.getCursorPosition(),i=e.session.getLine(r.row),o=i.substring(0,r.column),s=i.substr(r.column),a=this.snippetMap;return this.getActiveScopes(e).some((function(e){var t=a[e];return t&&(n=this.findMatchingSnippet(t,o,s)),!!n}),this),!!n&&(!(!t||!t.dryRun)||(e.session.doc.removeInLine(r.row,r.column-n.replaceBefore.length,r.column+n.replaceAfter.length),this.variables.M__=n.matchBefore,this.variables.T__=n.matchAfter,this.insertSnippetForSelection(e,n.content),this.variables.M__=this.variables.T__=null,!0))},this.findMatchingSnippet=function(e,t,n){for(var r=e.length;r--;){var i=e[r];if((!i.startRe||i.startRe.test(t))&&((!i.endRe||i.endRe.test(n))&&(i.startRe||i.endRe)))return i.matchBefore=i.startRe?i.startRe.exec(t):[""],i.matchAfter=i.endRe?i.endRe.exec(n):[""],i.replaceBefore=i.triggerRe?i.triggerRe.exec(t)[0]:"",i.replaceAfter=i.endTriggerRe?i.endTriggerRe.exec(n)[0]:"",i}},this.snippetMap={},this.snippetNameMap={},this.register=function(e,t){var n=this.snippetMap,r=this.snippetNameMap,i=this;function o(e){return e&&!/^\^?\(.*\)\$?$|^\\b$/.test(e)&&(e="(?:"+e+")"),e||""}function a(e,t,n){return e=o(e),t=o(t),n?(e=t+e)&&"$"!=e[e.length-1]&&(e+="$"):(e+=t)&&"^"!=e[0]&&(e="^"+e),new RegExp(e)}function l(e){e.scope||(e.scope=t||"_"),t=e.scope,n[t]||(n[t]=[],r[t]={});var o=r[t];if(e.name){var l=o[e.name];l&&i.unregister(l),o[e.name]=e}n[t].push(e),e.tabTrigger&&!e.trigger&&(!e.guard&&/^\w/.test(e.tabTrigger)&&(e.guard="\\b"),e.trigger=s.escapeRegExp(e.tabTrigger)),(e.trigger||e.guard||e.endTrigger||e.endGuard)&&(e.startRe=a(e.trigger,e.guard,!0),e.triggerRe=new RegExp(e.trigger),e.endRe=a(e.endTrigger,e.endGuard,!0),e.endTriggerRe=new RegExp(e.endTrigger))}e||(e=[]),e&&e.content?l(e):Array.isArray(e)&&e.forEach(l),this._signal("registerSnippets",{scope:t})},this.unregister=function(e,t){var n=this.snippetMap,r=this.snippetNameMap;function i(e){var i=r[e.scope||t];if(i&&i[e.name]){delete i[e.name];var o=n[e.scope||t],s=o&&o.indexOf(e);s>=0&&o.splice(s,1)}}e.content?i(e):Array.isArray(e)&&e.forEach(i)},this.parseSnippetFile=function(e){e=e.replace(/\r/g,"");for(var t,n=[],r={},i=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm;t=i.exec(e);){if(t[1])try{r=JSON.parse(t[1]),n.push(r)}catch(e){}if(t[4])r.content=t[4].replace(/^\t/gm,""),n.push(r),r={};else{var o=t[2],s=t[3];if("regex"==o){var a=/\/((?:[^\/\\]|\\.)*)|$/g;r.guard=a.exec(s)[1],r.trigger=a.exec(s)[1],r.endTrigger=a.exec(s)[1],r.endGuard=a.exec(s)[1]}else"snippet"==o?(r.tabTrigger=s.match(/^\S*/)[0],r.name||(r.name=s)):r[o]=s}}return n},this.getSnippetByName=function(e,t){var n,r=this.snippetNameMap;return this.getActiveScopes(t).some((function(t){var i=r[t];return i&&(n=i[e]),!!n}),this),n}}).call(d.prototype);var f=function(e){if(e.tabstopManager)return e.tabstopManager;e.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=s.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(e)};(function(){this.attach=function(e){this.index=0,this.ranges=[],this.tabstops=[],this.$openTabstops=null,this.selectedTabstop=null,this.editor=e,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},this.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges=null,this.tabstops=null,this.selectedTabstop=null,this.editor.removeListener("change",this.$onChange),this.editor.removeListener("changeSelection",this.$onChangeSelection),this.editor.removeListener("changeSession",this.$onChangeSession),this.editor.commands.removeListener("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.editor=null},this.onChange=function(e){var t="r"==e.action[0],n=e.start,r=e.end,i=n.row,o=r.row-i,s=r.column-n.column;if(t&&(o=-o,s=-s),!this.$inChange&&t){var a=this.selectedTabstop;if(a&&!a.some((function(e){return h(e.start,n)<=0&&h(e.end,r)>=0})))return this.detach()}for(var l=this.ranges,c=0;c<l.length;c++){var u=l[c];u.end.row<n.row||(t&&h(n,u.start)<0&&h(r,u.end)>0?(this.removeRange(u),c--):(u.start.row==i&&u.start.column>n.column&&(u.start.column+=s),u.end.row==i&&u.end.column>=n.column&&(u.end.column+=s),u.start.row>=i&&(u.start.row+=o),u.end.row>=i&&(u.end.row+=o),h(u.start,u.end)>0&&this.removeRange(u)))}l.length||this.detach()},this.updateLinkedFields=function(){var e=this.selectedTabstop;if(e&&e.hasLinkedRanges){this.$inChange=!0;for(var n=this.editor.session,r=n.getTextRange(e.firstNonLinked),i=e.length;i--;){var o=e[i];if(o.linked){var s=t.snippetManager.tmStrFormat(r,o.original);n.replace(o,s)}}this.$inChange=!1}},this.onAfterExec=function(e){e.command&&!e.command.readOnly&&this.updateLinkedFields()},this.onChangeSelection=function(){if(this.editor){for(var e=this.editor.selection.lead,t=this.editor.selection.anchor,n=this.editor.selection.isEmpty(),r=this.ranges.length;r--;)if(!this.ranges[r].linked){var i=this.ranges[r].contains(e.row,e.column),o=n||this.ranges[r].contains(t.row,t.column);if(i&&o)return}this.detach()}},this.onChangeSession=function(){this.detach()},this.tabNext=function(e){var t=this.tabstops.length,n=this.index+(e||1);(n=Math.min(Math.max(n,1),t))==t&&(n=0),this.selectTabstop(n),0===n&&this.detach()},this.selectTabstop=function(e){this.$openTabstops=null;var t=this.tabstops[this.index];if(t&&this.addTabstopMarkers(t),this.index=e,(t=this.tabstops[this.index])&&t.length){if(this.selectedTabstop=t,this.editor.inVirtualSelectionMode)this.editor.selection.setRange(t.firstNonLinked);else{var n=this.editor.multiSelect;n.toSingleRange(t.firstNonLinked.clone());for(var r=t.length;r--;)t.hasLinkedRanges&&t[r].linked||n.addRange(t[r].clone(),!0);n.ranges[0]&&n.addRange(n.ranges[0].clone())}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)}},this.addTabstops=function(e,t,n){if(this.$openTabstops||(this.$openTabstops=[]),!e[0]){var r=a.fromPoints(n,n);m(r.start,t),m(r.end,t),e[0]=[r],e[0].index=0}var i=[this.index+1,0],o=this.ranges;e.forEach((function(e,n){for(var r=this.$openTabstops[n]||e,s=e.length;s--;){var l=e[s],c=a.fromPoints(l.start,l.end||l.start);g(c.start,t),g(c.end,t),c.original=l,c.tabstop=r,o.push(c),r!=e?r.unshift(c):r[s]=c,l.fmtString?(c.linked=!0,r.hasLinkedRanges=!0):r.firstNonLinked||(r.firstNonLinked=c)}r.firstNonLinked||(r.hasLinkedRanges=!1),r===e&&(i.push(r),this.$openTabstops[n]=r),this.addTabstopMarkers(r)}),this),i.length>2&&(this.tabstops.length&&i.push(i.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,i))},this.addTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){e.markerId||(e.markerId=t.addMarker(e,"ace_snippet-marker","text"))}))},this.removeTabstopMarkers=function(e){var t=this.editor.session;e.forEach((function(e){t.removeMarker(e.markerId),e.markerId=null}))},this.removeRange=function(e){var t=e.tabstop.indexOf(e);e.tabstop.splice(t,1),t=this.ranges.indexOf(e),this.ranges.splice(t,1),this.editor.session.removeMarker(e.markerId),e.tabstop.length||(-1!=(t=this.tabstops.indexOf(e.tabstop))&&this.tabstops.splice(t,1),this.tabstops.length||this.detach())},this.keyboardHandler=new c,this.keyboardHandler.bindKeys({Tab:function(e){t.snippetManager&&t.snippetManager.expandWithTab(e)||e.tabstopManager.tabNext(1)},"Shift-Tab":function(e){e.tabstopManager.tabNext(-1)},Esc:function(e){e.tabstopManager.detach()},Return:function(e){return!1}})}).call(f.prototype);var p={};p.onChange=l.prototype.onChange,p.setPosition=function(e,t){this.pos.row=e,this.pos.column=t},p.update=function(e,t,n){this.$insertRight=n,this.pos=e,this.onChange(t)};var g=function(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row},m=function(e,t){e.row==t.row&&(e.column-=t.column),e.row-=t.row};e("./lib/dom").importCssString(".ace_snippet-marker {    -moz-box-sizing: border-box;    box-sizing: border-box;    background: rgba(194, 193, 208, 0.09);    border: 1px dotted rgba(211, 208, 235, 0.62);    position: absolute;}"),t.snippetManager=new d;var v=e("./editor").Editor;(function(){this.insertSnippet=function(e,n){return t.snippetManager.insertSnippet(this,e,n)},this.expandSnippet=function(e){return t.snippetManager.expandWithTab(this,e)}}).call(v.prototype)})),ace.define("ace/autocomplete/popup",[],(function(e,t,n){"use strict";var r=e("../virtual_renderer").VirtualRenderer,i=e("../editor").Editor,o=e("../range").Range,s=e("../lib/event"),a=e("../lib/lang"),l=e("../lib/dom"),c=function(e){var t=new r(e);t.$maxLines=4;var n=new i(t);return n.setHighlightActiveLine(!1),n.setShowPrintMargin(!1),n.renderer.setShowGutter(!1),n.renderer.setHighlightGutterLine(!1),n.$mouseHandler.$focusTimeout=0,n.$highlightTagPending=!0,n};l.importCssString(".ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #CAD6FA;    z-index: 1;}.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {    background-color: #3a674e;}.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid #abbffe;    margin-top: -1px;    background: rgba(233,233,253,0.4);    position: absolute;    z-index: 2;}.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {    border: 1px solid rgba(109, 150, 13, 0.8);    background: rgba(58, 103, 78, 0.62);}.ace_completion-meta {    opacity: 0.5;    margin: 0.9em;}.ace_completion-message {    color: blue;}.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #2d69c7;}.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{    color: #93ca12;}.ace_editor.ace_autocomplete {    width: 300px;    z-index: 200000;    border: 1px lightgray solid;    position: fixed;    box-shadow: 2px 3px 5px rgba(0,0,0,.2);    line-height: 1.4;    background: #fefefe;    color: #111;}.ace_dark.ace_editor.ace_autocomplete {    border: 1px #484747 solid;    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);    line-height: 1.4;    background: #25282c;    color: #c1c1c1;}","autocompletion.css"),t.AcePopup=function(e){var t=l.createElement("div"),n=new c(t);e&&e.appendChild(t),t.style.display="none",n.renderer.content.style.cursor="default",n.renderer.setStyle("ace_autocomplete"),n.setOption("displayIndentGuides",!1),n.setOption("dragDelay",150);var r,i=function(){};n.focus=i,n.$isFocused=!0,n.renderer.$cursorLayer.restartTimer=i,n.renderer.$cursorLayer.element.style.opacity=0,n.renderer.$maxLines=8,n.renderer.$keepTextAreaAtCursor=!1,n.setHighlightActiveLine(!1),n.session.highlight(""),n.session.$searchHighlight.clazz="ace_highlight-marker",n.on("mousedown",(function(e){var t=e.getDocumentPosition();n.selection.moveToPosition(t),h.start.row=h.end.row=t.row,e.stop()}));var u=new o(-1,0,-1,1/0),h=new o(-1,0,-1,1/0);h.id=n.session.addMarker(h,"ace_active-line","fullLine"),n.setSelectOnHover=function(e){e?u.id&&(n.session.removeMarker(u.id),u.id=null):u.id=n.session.addMarker(u,"ace_line-hover","fullLine")},n.setSelectOnHover(!1),n.on("mousemove",(function(e){if(r){if(r.x!=e.x||r.y!=e.y){(r=e).scrollTop=n.renderer.scrollTop;var t=r.getDocumentPosition().row;u.start.row!=t&&(u.id||n.setRow(t),f(t))}}else r=e})),n.renderer.on("beforeRender",(function(){if(r&&-1!=u.start.row){r.$pos=null;var e=r.getDocumentPosition().row;u.id||n.setRow(e),f(e,!0)}})),n.renderer.on("afterRender",(function(){var e=n.getRow(),t=n.renderer.$textLayer,r=t.element.childNodes[e-t.config.firstRow];r!==t.selectedNode&&t.selectedNode&&l.removeCssClass(t.selectedNode,"ace_selected"),t.selectedNode=r,r&&l.addCssClass(r,"ace_selected")}));var d=function(){f(-1)},f=function(e,t){e!==u.start.row&&(u.start.row=u.end.row=e,t||n.session._emit("changeBackMarker"),n._emit("changeHoverMarker"))};n.getHoveredRow=function(){return u.start.row},s.addListener(n.container,"mouseout",d),n.on("hide",d),n.on("changeSelection",d),n.session.doc.getLength=function(){return n.data.length},n.session.doc.getLine=function(e){var t=n.data[e];return"string"==typeof t?t:t&&t.value||""};var p=n.session.bgTokenizer;return p.$tokenizeRow=function(e){var t=n.data[e],r=[];if(!t)return r;"string"==typeof t&&(t={value:t});var i=t.caption||t.value||t.name;function o(e,n){e&&r.push({type:(t.className||"")+(n||""),value:e})}for(var s=i.toLowerCase(),a=(n.filterText||"").toLowerCase(),l=0,c=0,u=0;u<=a.length;u++)if(u!=c&&(t.matchMask&1<<u||u==a.length)){var h=a.slice(c,u);c=u;var d=s.indexOf(h,l);if(-1==d)continue;o(i.slice(l,d),""),l=d+h.length,o(i.slice(d,l),"completion-highlight")}return o(i.slice(l,i.length),""),t.meta&&r.push({type:"completion-meta",value:t.meta}),t.message&&r.push({type:"completion-message",value:t.message}),r},p.$updateOnChange=i,p.start=i,n.session.$computeWidth=function(){return this.screenWidth=0},n.isOpen=!1,n.isTopdown=!1,n.autoSelect=!0,n.filterText="",n.data=[],n.setData=function(e,t){n.filterText=t||"",n.setValue(a.stringRepeat("\n",e.length),-1),n.data=e||[],n.setRow(0)},n.getData=function(e){return n.data[e]},n.getRow=function(){return h.start.row},n.setRow=function(e){e=Math.max(this.autoSelect?0:-1,Math.min(this.data.length,e)),h.start.row!=e&&(n.selection.clearSelection(),h.start.row=h.end.row=e||0,n.session._emit("changeBackMarker"),n.moveCursorTo(e||0,0),n.isOpen&&n._signal("select"))},n.on("changeSelection",(function(){n.isOpen&&n.setRow(n.selection.lead.row),n.renderer.scrollCursorIntoView()})),n.hide=function(){this.container.style.display="none",this._signal("hide"),n.isOpen=!1},n.show=function(e,t,i){var o=this.container,s=window.innerHeight,a=window.innerWidth,l=this.renderer,c=l.$maxLines*t*1.4,u=e.top+this.$borderSize;u>s/2&&!i&&u+t+c>s?(l.$maxPixelHeight=u-2*this.$borderSize,o.style.top="",o.style.bottom=s-u+"px",n.isTopdown=!1):(u+=t,l.$maxPixelHeight=s-u-.2*t,o.style.top=u+"px",o.style.bottom="",n.isTopdown=!0),o.style.display="";var h=e.left;h+o.offsetWidth>a&&(h=a-o.offsetWidth),o.style.left=h+"px",this._signal("show"),r=null,n.isOpen=!0},n.goTo=function(e){var t=this.getRow(),n=this.session.getLength()-1;switch(e){case"up":t=t<=0?n:t-1;break;case"down":t=t>=n?-1:t+1;break;case"start":t=0;break;case"end":t=n}this.setRow(t)},n.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},n.$imageSize=0,n.$borderSize=1,n},t.$singleLineEditor=c})),ace.define("ace/autocomplete/util",[],(function(e,t,n){"use strict";t.parForEach=function(e,t,n){var r=0,i=e.length;0===i&&n();for(var o=0;o<i;o++)t(e[o],(function(e,t){++r===i&&n(e,t)}))};var r=/[a-zA-Z_0-9\$\-\u00A2-\uFFFF]/;t.retrievePrecedingIdentifier=function(e,t,n){n=n||r;for(var i=[],o=t-1;o>=0&&n.test(e[o]);o--)i.push(e[o]);return i.reverse().join("")},t.retrieveFollowingIdentifier=function(e,t,n){n=n||r;for(var i=[],o=t;o<e.length&&n.test(e[o]);o++)i.push(e[o]);return i},t.getCompletionPrefix=function(e){var t,n=e.getCursorPosition(),r=e.session.getLine(n.row);return e.completers.forEach(function(e){e.identifierRegexps&&e.identifierRegexps.forEach(function(e){!t&&e&&(t=this.retrievePrecedingIdentifier(r,n.column,e))}.bind(this))}.bind(this)),t||this.retrievePrecedingIdentifier(r,n.column)}})),ace.define("ace/autocomplete",[],(function(e,t,n){"use strict";var r=e("./keyboard/hash_handler").HashHandler,i=e("./autocomplete/popup").AcePopup,o=e("./autocomplete/util"),s=(e("./lib/event"),e("./lib/lang")),a=e("./lib/dom"),l=e("./snippets").snippetManager,c=e("./config"),u=function(){this.autoInsert=!1,this.autoSelect=!0,this.exactMatch=!1,this.gatherCompletionsId=0,this.keyboardHandler=new r,this.keyboardHandler.bindKeys(this.commands),this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.changeTimer=s.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=s.delayedCall(this.updateDocTooltip.bind(this),50)};(function(){this.$init=function(){return this.popup=new i(document.body||document.documentElement),this.popup.on("click",function(e){this.insertMatch(),e.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.tooltipTimer.bind(null,null)),this.popup.on("select",this.tooltipTimer.bind(null,null)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup},this.getPopup=function(){return this.popup||this.$init()},this.openPopup=function(e,t,n){this.popup||this.$init(),this.popup.autoSelect=this.autoSelect,this.popup.setData(this.completions.filtered,this.completions.filterText),e.keyBinding.addKeyboardHandler(this.keyboardHandler);var r=e.renderer;if(this.popup.setRow(this.autoSelect?0:-1),n)n&&!t&&this.detach();else{this.popup.setTheme(e.getTheme()),this.popup.setFontSize(e.getFontSize());var i=r.layerConfig.lineHeight,o=r.$cursorLayer.getPixelPosition(this.base,!0);o.left-=this.popup.getTextLeftOffset();var s=e.container.getBoundingClientRect();o.top+=s.top-r.layerConfig.offset,o.left+=s.left-e.renderer.scrollLeft,o.left+=r.gutterWidth,this.popup.show(o,i)}},this.detach=function(){this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener),this.changeTimer.cancel(),this.hideDocTooltip(),this.gatherCompletionsId+=1,this.popup&&this.popup.isOpen&&this.popup.hide(),this.base&&this.base.detach(),this.activated=!1,this.completions=this.base=null},this.changeListener=function(e){var t=this.editor.selection.lead;(t.row!=this.base.row||t.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},this.blurListener=function(e){var t=document.activeElement,n=this.editor.textInput.getElement(),r=e.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(e.relatedTarget),i=this.popup&&this.popup.container;t==n||t.parentNode==i||r||t==this.tooltipNode||e.relatedTarget==n||this.detach()},this.mousedownListener=function(e){this.detach()},this.mousewheelListener=function(e){this.detach()},this.goTo=function(e){this.popup.goTo(e)},this.insertMatch=function(e,t){if(e||(e=this.popup.getData(this.popup.getRow())),!e)return!1;if(e.completer&&e.completer.insertMatch)e.completer.insertMatch(this.editor,e);else{if(this.completions.filterText)for(var n,r=this.editor.selection.getAllRanges(),i=0;n=r[i];i++)n.start.column-=this.completions.filterText.length,this.editor.session.remove(n);e.snippet?l.insertSnippet(this.editor,e.snippet):this.editor.execCommand("insertstring",e.value||e)}this.detach()},this.commands={Up:function(e){e.completer.goTo("up")},Down:function(e){e.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(e){e.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(e){e.completer.goTo("end")},Esc:function(e){e.completer.detach()},Return:function(e){return e.completer.insertMatch()},"Shift-Return":function(e){e.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(e){var t=e.completer.insertMatch();if(t||e.tabstopManager)return t;e.completer.goTo("down")},PageUp:function(e){e.completer.popup.gotoPageUp()},PageDown:function(e){e.completer.popup.gotoPageDown()}},this.gatherCompletions=function(e,t){var n=e.getSession(),r=e.getCursorPosition(),i=o.getCompletionPrefix(e);this.base=n.doc.createAnchor(r.row,r.column-i.length),this.base.$insertRight=!0;var s=[],a=e.completers.length;return e.completers.forEach((function(l,c){l.getCompletions(e,n,r,i,(function(n,r){!n&&r&&(s=s.concat(r)),t(null,{prefix:o.getCompletionPrefix(e),matches:s,finished:0==--a})}))})),!0},this.showPopup=function(e){this.editor&&this.detach(),this.activated=!0,this.editor=e,e.completer!=this&&(e.completer&&e.completer.detach(),e.completer=this),e.on("changeSelection",this.changeListener),e.on("blur",this.blurListener),e.on("mousedown",this.mousedownListener),e.on("mousewheel",this.mousewheelListener),this.updateCompletions()},this.updateCompletions=function(e){if(e&&this.base&&this.completions){var t=this.editor.getCursorPosition(),n=this.editor.session.getTextRange({start:this.base,end:t});if(n==this.completions.filterText)return;return this.completions.setFilter(n),this.completions.filtered.length?1!=this.completions.filtered.length||this.completions.filtered[0].value!=n||this.completions.filtered[0].snippet?void this.openPopup(this.editor,n,e):this.detach():this.detach()}var r=this.gatherCompletionsId;this.gatherCompletions(this.editor,function(t,n){var i=function(){if(n.finished)return this.detach()}.bind(this),o=n.prefix,s=n&&n.matches;if(!s||!s.length)return i();if(0===o.indexOf(n.prefix)&&r==this.gatherCompletionsId){this.completions=new h(s),this.exactMatch&&(this.completions.exactMatch=!0),this.completions.setFilter(o);var a=this.completions.filtered;return a.length&&(1!=a.length||a[0].value!=o||a[0].snippet)?this.autoInsert&&1==a.length&&n.finished?this.insertMatch(a[0]):void this.openPopup(this.editor,o,e):i()}}.bind(this))},this.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},this.updateDocTooltip=function(){var e=this.popup,t=e.data,n=t&&(t[e.getHoveredRow()]||t[e.getRow()]),r=null;return n&&this.editor&&this.popup.isOpen?(this.editor.completers.some((function(e){return e.getDocTooltip&&(r=e.getDocTooltip(n)),r})),r||(r=n),"string"==typeof r&&(r={docText:r}),r&&(r.docHTML||r.docText)?void this.showDocTooltip(r):this.hideDocTooltip()):this.hideDocTooltip()},this.showDocTooltip=function(e){this.tooltipNode||(this.tooltipNode=a.createElement("div"),this.tooltipNode.className="ace_tooltip ace_doc-tooltip",this.tooltipNode.style.margin=0,this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this));var t=this.tooltipNode;e.docHTML?t.innerHTML=e.docHTML:e.docText&&(t.textContent=e.docText),t.parentNode||document.body.appendChild(t);var n=this.popup,r=n.container.getBoundingClientRect();t.style.top=n.container.style.top,t.style.bottom=n.container.style.bottom,t.style.display="block",window.innerWidth-r.right<320?r.left<320?n.isTopdown?(t.style.top=r.bottom+"px",t.style.left=r.left+"px",t.style.right="",t.style.bottom=""):(t.style.top=n.container.offsetTop-t.offsetHeight+"px",t.style.left=r.left+"px",t.style.right="",t.style.bottom=""):(t.style.right=window.innerWidth-r.left+"px",t.style.left=""):(t.style.left=r.right+1+"px",t.style.right="")},this.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),this.tooltipNode){var e=this.tooltipNode;this.editor.isFocused()||document.activeElement!=e||this.editor.focus(),this.tooltipNode=null,e.parentNode&&e.parentNode.removeChild(e)}},this.onTooltipClick=function(e){for(var t=e.target;t&&t!=this.tooltipNode;){if("A"==t.nodeName&&t.href){t.rel="noreferrer",t.target="_blank";break}t=t.parentNode}},this.destroy=function(){this.detach(),this.popup&&this.popup.destroy();var e=this.popup.container;e&&e.parentNode&&e.parentNode.removeChild(e),this.editor&&this.editor.completer==this&&this.editor.completer,this.popup=null}}).call(u.prototype),u.for=function(e){return e.completer?e.completer:(c.get("sharedPopups")?(u.$shared||(u.$sharedInstance=new u),e.completer=u.$sharedInstance):(e.completer=new u,e.once("destroy",(function(e,t){t.completer.destroy()}))),e.completer)},u.startCommand={name:"startAutocomplete",exec:function(e){var t=u.for(e);t.autoInsert=!1,t.autoSelect=!0,t.showPopup(e),t.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var h=function(e,t){this.all=e,this.filtered=e,this.filterText=t||"",this.exactMatch=!1};(function(){this.setFilter=function(e){if(e.length>this.filterText&&0===e.lastIndexOf(this.filterText,0))var t=this.filtered;else t=this.all;this.filterText=e,t=(t=this.filterCompletions(t,this.filterText)).sort((function(e,t){return t.exactMatch-e.exactMatch||t.$score-e.$score||(e.caption||e.value)<(t.caption||t.value)}));var n=null;t=t.filter((function(e){var t=e.snippet||e.caption||e.value;return t!==n&&(n=t,!0)})),this.filtered=t},this.filterCompletions=function(e,t){var n=[],r=t.toUpperCase(),i=t.toLowerCase();e:for(var o,s=0;o=e[s];s++){var a=o.value||o.caption||o.snippet;if(a){var l,c,u=-1,h=0,d=0;if(this.exactMatch){if(t!==a.substr(0,t.length))continue e}else{var f=a.toLowerCase().indexOf(i);if(f>-1)d=f;else for(var p=0;p<t.length;p++){var g=a.indexOf(i[p],u+1),m=a.indexOf(r[p],u+1);if((l=g>=0&&(m<0||g<m)?g:m)<0)continue e;(c=l-u-1)>0&&(-1===u&&(d+=10),d+=c,h|=1<<p),u=l}}o.matchMask=h,o.exactMatch=d?0:1,o.$score=(o.score||0)-d,n.push(o)}}return n}}).call(h.prototype),t.Autocomplete=u,t.FilteredList=h})),ace.define("ace/autocomplete/text_completer",[],(function(e,t,n){var r=e("../range").Range,i=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;function o(e,t){var n=function(e,t){return e.getTextRange(r.fromPoints({row:0,column:0},t)).split(i).length-1}(e,t),o=e.getValue().split(i),s=Object.create(null),a=o[n];return o.forEach((function(e,t){if(e&&e!==a){var r=Math.abs(n-t),i=o.length-r;s[e]?s[e]=Math.max(i,s[e]):s[e]=i}})),s}t.getCompletions=function(e,t,n,r,i){var s=o(t,n);i(null,Object.keys(s).map((function(e){return{caption:e,value:e,score:s[e],meta:"local"}})))}})),ace.define("ace/ext/language_tools",[],(function(e,t,n){"use strict";var r=e("../snippets").snippetManager,i=e("../autocomplete").Autocomplete,o=e("../config"),s=e("../lib/lang"),a=e("../autocomplete/util"),l=e("../autocomplete/text_completer"),c={getCompletions:function(e,t,n,r,i){if(t.$mode.completer)return t.$mode.completer.getCompletions(e,t,n,r,i);var o=e.session.getState(n.row);i(null,t.$mode.getCompletions(o,t,n,r))}},u={getCompletions:function(e,t,n,i,o){var s=[],a=t.getTokenAt(n.row,n.column);a&&a.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\.xml$/)?s.push("html-tag"):s=r.getActiveScopes(e);var l=r.snippetMap,c=[];s.forEach((function(e){for(var t=l[e]||[],n=t.length;n--;){var r=t[n],i=r.name||r.tabTrigger;i&&c.push({caption:i,snippet:r.content,meta:r.tabTrigger&&!r.name?r.tabTrigger+"⇥ ":"snippet",type:"snippet"})}}),this),o(null,c)},getDocTooltip:function(e){"snippet"!=e.type||e.docHTML||(e.docHTML=["<b>",s.escapeHTML(e.caption),"</b>","<hr></hr>",s.escapeHTML(e.snippet)].join(""))}},h=[u,l,c];t.setCompleters=function(e){h.length=0,e&&h.push.apply(h,e)},t.addCompleter=function(e){h.push(e)},t.textCompleter=l,t.keyWordCompleter=c,t.snippetCompleter=u;var d={name:"expandSnippet",exec:function(e){return r.expandWithTab(e)},bindKey:"Tab"},f=function(e,t){p(t.session.$mode)},p=function e(t){var n=t.$id;r.files||(r.files={}),g(n),t.modes&&t.modes.forEach(e)},g=function e(t){if(t&&!r.files[t]){var n=t.replace("mode","snippets");r.files[t]={},o.loadModule(n,(function(n){n&&(r.files[t]=n,!n.snippets&&n.snippetText&&(n.snippets=r.parseSnippetFile(n.snippetText)),r.register(n.snippets||[],n.scope),n.includeScopes&&(r.snippetMap[n.scope].includeScopes=n.includeScopes,n.includeScopes.forEach((function(t){e("ace/mode/"+t)}))))}))}},m=function(e){var t=e.editor,n=t.completer&&t.completer.activated;if("backspace"===e.command.name)n&&!a.getCompletionPrefix(t)&&t.completer.detach();else if("insertstring"===e.command.name){if(a.getCompletionPrefix(t)&&!n){var r=i.for(t);r.autoInsert=!1,r.showPopup(t)}}},v=e("../editor").Editor;e("../config").defineOptions(v.prototype,"editor",{enableBasicAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:h),this.commands.addCommand(i.startCommand)):this.commands.removeCommand(i.startCommand)},value:!1},enableLiveAutocompletion:{set:function(e){e?(this.completers||(this.completers=Array.isArray(e)?e:h),this.commands.on("afterExec",m)):this.commands.removeListener("afterExec",m)},value:!1},enableSnippets:{set:function(e){e?(this.commands.addCommand(d),this.on("changeMode",f),f(0,this)):(this.commands.removeCommand(d),this.off("changeMode",f))},value:!1}})})),ace.require(["ace/ext/language_tools"],(function(r){"object"==n(e)&&"object"==n(t)&&e&&(e.exports=r)}))}).call(this,n(8)(e))},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}void 0===(r=function(){var e;return(e=function(){function e(t,n,r,i,o){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onChange=this.onChange.bind(this),this.onSessionChange=this.onSessionChange.bind(this),this.onContextMenu=this.onContextMenu.bind(this),this.onScroll=this.onScroll.bind(this),this.learnWord=this.learnWord.bind(this),this.$scope=t,this.cache=n,this.$http=r,this.$q=i,this.adapter=o,this.$scope.spellMenu={open:!1,top:"0px",left:"0px",suggestions:[]},this.inProgressRequest=null,this.updatedLines=[],this.$scope.$watch("spellCheckLanguage",(function(e,t){if(e!==t&&null!=t)return s.runFullCheck()})),this.$scope.replaceWord=this.adapter.replaceWord,this.$scope.learnWord=this.learnWord,$(document).on("click",(function(e){return 3!==e.which&&s.closeContextMenu(),!0}))}return o(e,null,[{key:"initClass",value:function(){this.prototype.blacklistedCommandRegex=new RegExp("\\\\(label|[a-z]{0,16}ref|usepackage|begin|end|[a-z]{0,16}cite|input|include|includegraphics)(\\[[^\\]]*\\])?\\{[^}]*\\}","g")}}]),o(e,[{key:"init",value:function(){if(this.updatedLines=Array(this.adapter.getLines().length).fill(!0),this.isSpellCheckEnabled())return this.runSpellCheckSoon(200)}},{key:"isSpellCheckEnabled",value:function(){return!(!this.$scope.spellCheck||!this.$scope.spellCheckLanguage||""===this.$scope.spellCheckLanguage)}},{key:"onChange",value:function(e){if(this.isSpellCheckEnabled())return this.markLinesAsUpdated(this.adapter.normalizeChangeEvent(e)),this.adapter.highlightedWordManager.clearHighlightTouchingRange(e),this.runSpellCheckSoon()}},{key:"onSessionChange",value:function(){if(this.adapter.highlightedWordManager.reset(),null!=this.inProgressRequest&&this.inProgressRequest.abort(),this.isSpellCheckEnabled())return this.runSpellCheckSoon(200)}},{key:"onContextMenu",value:function(e){return this.closeContextMenu(),this.openContextMenu(e)}},{key:"onScroll",value:function(){return this.closeContextMenu()}},{key:"openContextMenu",value:function(e){var t=this,n=this.adapter.getCoordsFromContextMenuEvent(e),r=this.adapter.getHighlightFromCoords(n),i=this.adapter.isContextMenuEventOnBottomHalf(e);if(r)return this.adapter.preventContextMenuEventDefault(e),this.adapter.selectHighlightedWord(r),this.$scope.$apply((function(){return t.$scope.spellMenu={open:!0,top:n.y+"px",left:n.x+"px",layoutFromBottom:i,highlight:r}})),!1}},{key:"closeContextMenu",value:function(){var e=this;if((null!=this.$scope?this.$scope.spellMenu:void 0)&&!1!==this.$scope.spellMenu.open)return this.$scope.$apply((function(){return e.$scope.spellMenu.open=!1}))}},{key:"learnWord",value:function(e){this.apiRequest("/learn",{word:e.word}),this.adapter.highlightedWordManager.removeWord(e.word);var t=this.$scope.spellCheckLanguage;return null!=this.cache?this.cache.put("".concat(t,":").concat(e.word),!0):void 0}},{key:"runFullCheck",value:function(){if(this.adapter.highlightedWordManager.reset(),this.isSpellCheckEnabled())return this.runSpellCheck()}},{key:"markLinesAsUpdated",value:function(e){var t,n=this,r=e.start,i=e.end;return"insert"===e.action?(this.updatedLines[r.row]=!0,t=i.row-r.row,function(){for(var e=[];t--;)e.push(n.updatedLines.splice(r.row,0,!0));return e}()):"remove"===e.action?(this.updatedLines[r.row]=!0,function(){var e=i.row-r.row;return function(){for(var t=[];e--;)t.push(n.updatedLines.splice(r.row+1,1));return t}()}()):void 0}},{key:"runSpellCheckSoon",value:function(e){var t=this;return null==e&&(e=1e3),null!=this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((function(){return delete t.timeoutId,t.runSpellCheck(t.updatedLines),t.updatedLines=[]}),e)}},{key:"runSpellCheck",value:function(e){var t,n,r,i,o=this,s=this.getWords(e),a=s.words,l=s.positions,c=this.$scope.spellCheckLanguage,u=[],h={},d=[],f=[];for(n=t=0;t<a.length;t++,n=t){i=a[n],r="".concat(c,":").concat(i),null==h[r]&&(h[r]=this.cache.get(r));var p=h[r];null==p?(d.push(a[n]),f.push(l[n])):!0===p||u.push({column:l[n].column,row:l[n].row,word:i,suggestions:p})}l=f;var g=function(t){if(null!=e)for(var n=0;n<e.length;n++)e[n]&&o.adapter.highlightedWordManager.clearRow(n);else o.adapter.highlightedWordManager.reset();return Array.from(t).map((function(e){return o.adapter.highlightedWordManager.addHighlight(e)}))};return(a=d).length?this.inProgressRequest=this.apiRequest("/check",{language:c,words:a},(function(e,t){if(delete o.inProgressRequest,null!=e||null==t||null==t.misspellings)return null;for(var s=[],d=0,f=Array.from(t.misspellings);d<f.length;d++){var p=f[d];i=a[p.index];var m=l[p.index];s[p.index]=!0,u.push({column:m.column,row:m.row,word:i,suggestions:p.suggestions}),r="".concat(c,":").concat(i),h[r]||(o.cache.put(r,p.suggestions),h[r]=!0)}for(n=0;n<a.length;n++)i=a[n],s[n]||(r="".concat(c,":").concat(i),h[r]||(o.cache.put(r,!0),h[r]=!0));return g(u)})):g(u)}},{key:"apiRequest",value:function(e,t,n){null==n&&(n=function(e,t){}),t.token=window.user.id,t._csrf=window.csrfToken;var r=this.$q.defer(),i={timeout:r.promise};return this.$http.post("/spelling".concat(e),t,i).then((function(e){return n(null,e.data)})).catch((function(e){return n(new Error("api failure"))})),{abort:function(){return r.resolve()}}}},{key:"getWords",value:function(e){for(var t=this.adapter.getLines(),n=[],r=[],i=0;i<t.length;i++){var o=t[i];if(o=this.blankOutBlacklistedCommands(o),null==e||e[i])for(var s,a=/\\?(?:['A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D])+/g;s=a.exec(o);){var l=s[0];"'"===l[0]&&(l=l.slice(1)),"'"===l[l.length-1]&&(l=l.slice(0,-1)),r.push({row:i,column:s.index}),n.push(l)}}return{words:n,positions:r}}},{key:"blankOutBlacklistedCommands",value:function(e){return e.replace(this.blacklistedCommandRegex,(function(e){return Array(e.length+1).join(".")}))}}]),e}()).initClass(),e}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.storePositionAndLine=this.storePositionAndLine.bind(this),this.jumpToPositionInNewDoc=this.jumpToPositionInNewDoc.bind(this),this.onUnload=this.onUnload.bind(this),this.onCursorChange=this.onCursorChange.bind(this),this.onSyncToPdf=this.onSyncToPdf.bind(this),this.$scope=t,this.adapter=n,this.localStorage=r,this.$scope.$on("editorInit",this.jumpToPositionInNewDoc),this.$scope.$on("beforeChangeDocument",this.storePositionAndLine),this.$scope.$on("afterChangeDocument",this.jumpToPositionInNewDoc),this.$scope.$on("changeEditor",this.storePositionAndLine),this.$scope.$on("".concat(this.$scope.name,":gotoLine"),(function(e,t,n){if(null!=t)return setTimeout((function(){return i.adapter.gotoLine(t,n)}),10)})),this.$scope.$on("".concat(this.$scope.name,":gotoOffset"),(function(e,t){if(null!=t)return setTimeout((function(){return i.adapter.gotoOffset(t)}),10)})),this.$scope.$on("".concat(this.$scope.name,":clearSelection"),(function(e){return i.adapter.clearSelection()}))}var t,n,r;return t=e,(n=[{key:"storePositionAndLine",value:function(){return this.storeCursorPosition(),this.storeFirstVisibleLine()}},{key:"jumpToPositionInNewDoc",value:function(){var e=this;return this.doc_id=null!=this.$scope.sharejsDoc?this.$scope.sharejsDoc.doc_id:void 0,setTimeout((function(){return e.gotoStoredPosition()}),0)}},{key:"onUnload",value:function(){return this.storeCursorPosition(),this.storeFirstVisibleLine()}},{key:"onCursorChange",value:function(){return this.emitCursorUpdateEvent()}},{key:"onSyncToPdf",value:function(){return this.$scope.$emit("cursor:".concat(this.$scope.name,":syncToPdf"))}},{key:"storeFirstVisibleLine",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return e.firstVisibleLine=this.adapter.getEditorScrollPosition(),this.localStorage("doc.position.".concat(this.doc_id),e)}}},{key:"storeCursorPosition",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return e.cursorPosition=this.adapter.getCursor(),this.localStorage("doc.position.".concat(this.doc_id),e)}}},{key:"emitCursorUpdateEvent",value:function(){var e=this.adapter.getCursor();return this.$scope.$emit("cursor:".concat(this.$scope.name,":update"),e)}},{key:"gotoStoredPosition",value:function(){if(null!=this.doc_id){var e=this.localStorage("doc.position.".concat(this.doc_id))||{};return this.adapter.setCursor(e),this.adapter.setEditorScrollPosition(e)}}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4),n(13),n(7),n(24)],void 0===(i=function(e,t,n,r){var i=ace.require("ace/range").Range;return function(){function e(t,n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._doneUpdateThisLoop=!1,this._pendingUpdates=!1,this.onChangeSession=this.onChangeSession.bind(this),this.onChangeSelection=this.onChangeSelection.bind(this),this.onCut=this.onCut.bind(this),this.onPaste=this.onPaste.bind(this),this.onResize=this.onResize.bind(this),this.tearDown=this.tearDown.bind(this),this.$scope=t,this.editor=n,this.element=r,this.adapter=i,this._scrollTimeout=null,this.changingSelection=!1,null==window.trackChangesManager&&(window.trackChangesManager=this),this.$scope.$watch("trackChanges",(function(e){null!=e&&o.setTrackChanges(e)})),this.$scope.$watch("sharejsDoc",(function(e,t){null!=e&&(null!=t&&o.disconnectFromDoc(t),o.setTrackChanges(o.$scope.trackChanges),o.connectToDoc(e))})),this.$scope.$on("comment:add",(function(e,t,n,r){o.addCommentToSelection(t,n,r)})),this.$scope.$on("comment:select_line",(function(e){o.selectLineIfNoSelection()})),this.$scope.$on("changes:accept",(function(e,t){o.acceptChangeIds(t)})),this.$scope.$on("changes:reject",(function(e,t){o.rejectChangeIds(t)})),this.$scope.$on("comment:remove",(function(e,t){o.removeCommentId(t)})),this.$scope.$on("comment:resolve_threads",(function(e,t){o.hideCommentsByThreadIds(t)})),this.$scope.$on("comment:unresolve_thread",(function(e,t){o.showCommentByThreadId(t)})),this.$scope.$on("review-panel:recalculate-screen-positions",(function(){o.recalculateReviewEntriesScreenPositions()})),this._resetCutState()}var t,n,s;return t=e,(n=[{key:"onChangeSession",value:function(e){this.clearAnnotations(),this.redrawAnnotations(),this.editor&&this.editor.session.on("changeScrollTop",this.onChangeScroll.bind(this))}},{key:"onChangeScroll",value:function(){var e=this;if(null==this._scrollTimeout)return this._scrollTimeout=setTimeout((function(){return e.recalculateVisibleEntries(),e.$scope.$apply(),e._scrollTimeout=null}),200)}},{key:"onChangeSelection",value:function(){var e=this;if(!this.changingSelection)return this.changingSelection=!0,this.$scope.$evalAsync((function(){return e.changingSelection=!1,e.updateFocus()}))}},{key:"onResize",value:function(){this.recalculateReviewEntriesScreenPositions()}},{key:"connectToDoc",value:function(e){var t=this;this.rangesTracker=e.ranges,this.setTrackChanges(this.$scope.trackChanges),e.on("ranges:dirty",(function(){t.updateAnnotations()})),e.on("ranges:clear",(function(){t.clearAnnotations()})),e.on("ranges:redraw",(function(){t.redrawAnnotations()}))}},{key:"disconnectFromDoc",value:function(e){e.off("ranges:clear"),e.off("ranges:redraw"),e.off("ranges:dirty")}},{key:"tearDown",value:function(){this.adapter.tearDown()}},{key:"setTrackChanges",value:function(e){e?null!=this.$scope.sharejsDoc&&(this.$scope.sharejsDoc.track_changes_as=window.user.id||"anonymous"):null!=this.$scope.sharejsDoc&&(this.$scope.sharejsDoc.track_changes_as=null)}},{key:"clearAnnotations",value:function(){this.adapter.clearAnnotations()}},{key:"redrawAnnotations",value:function(){for(var e=this,t=0,n=Array.from(this.rangesTracker.changes);t<n.length;t++){var r=n[t];null!=r.op.i?this.adapter.onInsertAdded(r):null!=r.op.d&&this.adapter.onDeleteAdded(r)}Array.from(this.rangesTracker.comments).map((function(t){e.isCommentResolved(t)||e.adapter.onCommentAdded(t)})),this.broadcastChange()}},{key:"updateAnnotations",value:function(){var e=this;if(!this._doneUpdateThisLoop)return this._doUpdateAnnotations(),this._doneUpdateThisLoop=!0,setTimeout((function(){e._pendingUpdates&&e._doUpdateAnnotations(),e._doneUpdateThisLoop=!1,e._pendingUpdates=!1}));this._pendingUpdates=!0}},{key:"_doUpdateAnnotations",value:function(){var e,t,n=this.rangesTracker.getDirtyState(),r=!1;for(var i in n.change.added)null!=(e=n.change.added[i]).op.i?this.adapter.onInsertAdded(e):null!=e.op.d&&this.adapter.onDeleteAdded(e);for(i in n.change.removed)null!=(e=n.change.removed[i]).op.i?this.adapter.onInsertRemoved(e):null!=e.op.d&&this.adapter.onDeleteRemoved(e);for(i in n.change.moved)e=n.change.moved[i],r=!0,this.adapter.onChangeMoved(e);for(i in n.comment.added)t=n.comment.added[i],this.isCommentResolved(t)||this.adapter.onCommentAdded(t);for(i in n.comment.removed)t=n.comment.removed[i],this.isCommentResolved(t)||this.adapter.onCommentRemoved(t);for(i in n.comment.moved)t=n.comment.moved[i],this.adapter.onCommentMoved&&!this.isCommentResolved(t)&&(r=!0,this.adapter.onCommentMoved(t));this.editor||(r=!1),this.rangesTracker.resetDirtyState(),r&&this.editor.renderer.updateBackMarkers(),this.broadcastChange()}},{key:"addComment",value:function(e,t,n){var r={c:t,p:e,t:n};this.$scope.sharejsDoc.submitOp(r)}},{key:"addCommentToSelection",value:function(e,t,n){var r=this.adapter.shareJsOffsetToRowColumn(t),o=this.adapter.shareJsOffsetToRowColumn(t+n),s=new i(r.row,r.column,o.row,o.column),a=this.editor.session.getTextRange(s);this.addComment(t,a,e)}},{key:"isCommentResolved",value:function(e){return this.rangesTracker.resolvedThreadIds[e.op.t]}},{key:"selectLineIfNoSelection",value:function(){this.editor.selection.isEmpty()&&this.editor.selection.selectLine()}},{key:"acceptChangeIds",value:function(e){this.rangesTracker.removeChangeIds(e),this.updateAnnotations(),this.updateFocus()}},{key:"rejectChangeIds",value:function(e){var t=this,n=this.rangesTracker.getChanges(e);if(0!==n.length){n.sort((function(e,t){return t.op.p-e.op.p}));for(var r=this.editor.getSession(),i=0,o=Array.from(n);i<o.length;i++){var s=o[i];if(null!=s.op.d){var a=s.op.d,l=this.adapter.shareJsOffsetToRowColumn(s.op.p);r.$fromReject=!0,r.insert(l,a),r.$fromReject=!1}else{if(null==s.op.i)throw new Error("unknown change: ".concat(JSON.stringify(s)));var c=this.adapter.shareJsOffsetToRowColumn(s.op.p),u=this.adapter.shareJsOffsetToRowColumn(s.op.p+s.op.i.length),h=r.getDocument().getTextRange({start:c,end:u});if(h!==s.op.i)throw new Error("Op to be removed (".concat(JSON.stringify(s.op),"), does not match editor text, '").concat(h,"'"));r.$fromReject=!0,r.remove({start:c,end:u}),r.$fromReject=!1}}setTimeout((function(){return t.updateFocus()}))}}},{key:"removeCommentId",value:function(e){return this.rangesTracker.removeCommentId(e),this.updateAnnotations()}},{key:"hideCommentsByThreadIds",value:function(e){for(var t={},n=this.rangesTracker.comments||[],r=0,i=Array.from(e);r<i.length;r++)t[i[r]]=!0;var o=!0,s=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;t[u.op.t]&&this.adapter.onCommentRemoved(u)}}catch(e){s=!0,a=e}finally{try{o||null==c.return||c.return()}finally{if(s)throw a}}return this.broadcastChange()}},{key:"showCommentByThreadId",value:function(e){var t=this.rangesTracker.comments||[],n=!0,r=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;a.op.t!==e||this.isCommentResolved(a)||this.adapter.onCommentAdded(a)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return this.broadcastChange()}},{key:"_resetCutState",value:function(){return this._cutState={text:null,comments:[],docId:null}}},{key:"onCut",value:function(){var e=this;this._resetCutState();var t=this.editor.getSelectionRange(),n=this._rangeToShareJs(t.start),r=this._rangeToShareJs(t.end);return this._cutState.text=this.editor.getSelectedText(),this._cutState.docId=this.$scope.docId,function(){for(var t=[],i=0,o=Array.from(e.rangesTracker.comments);i<o.length;i++){var s=o[i],a=s.op.p,l=a+s.op.c.length;n<=a&&l<=r?t.push(e._cutState.comments.push({offset:s.op.p-n,text:s.op.c,comment:s})):t.push(void 0)}return t}()}},{key:"onPaste",value:function(){var e=this;this.editor.once("change",(function(t){if("insert"===t.action){var n=t.lines.join("\n"),r=e._rangeToShareJs(t.start);e.$scope.sharejsDoc.on("ranges:dirty.paste",(function(){if(e.$scope.sharejsDoc.off("ranges:dirty.paste"),n===e._cutState.text&&e.$scope.docId===e._cutState.docId)for(var t=0,i=Array.from(e._cutState.comments);t<i.length;t++){var o=i[t],s=o.comment,a=o.offset,l={c:o.text,p:r+a,t:s.id};e.$scope.sharejsDoc.submitOp(l)}e._resetCutState(),e.rangesTracker.validate(e.editor.getValue())}))}}))}},{key:"checkMapping",value:function(){var e,t,n,r,i,o,s=this.editor.getSession(),a={},l=s.getMarkers();for(var c in l)r=l[c],a[c]=r;for(var u=[],h=0,d=Array.from(this.rangesTracker.changes);h<d.length;h++){var f=d[h];if(null!=this.adapter.changeIdToMarkerIdMap[f.id]){i=f.op;var p=this.adapter.changeIdToMarkerIdMap[f.id];e=p.background_marker_id,t=p.callout_marker_id,o=this.adapter.shareJsOffsetToRowColumn(i.p),null!=i.i?n=this.adapter.shareJsOffsetToRowColumn(i.p+i.i.length):null!=i.d&&(n=o),u.push({marker_id:e,start:o,end:n}),u.push({marker_id:t,start:o,end:o})}}for(var g=0,m=Array.from(this.rangesTracker.comments);g<m.length;g++){var v=m[g];if(null!=this.adapter.changeIdToMarkerIdMap[v.id]){var y=this.adapter.changeIdToMarkerIdMap[v.id];e=y.background_marker_id,t=y.callout_marker_id,o=this.adapter.shareJsOffsetToRowColumn(v.op.p),n=this.adapter.shareJsOffsetToRowColumn(v.op.p+v.op.c.length),u.push({marker_id:e,start:o,end:n}),u.push({marker_id:t,start:o,end:o})}}for(var b=0,w=Array.from(u);b<w.length;b++){var _=w[b];c=_.marker_id,o=_.start,n=_.end,r=a[c],delete a[c],r.range.start.row===o.row&&r.range.start.column===o.column&&r.range.end.row===n.row&&r.range.end.column===n.column||console.error("Change doesn't match marker anymore",{change:f,marker:r,start:o,end:n})}return function(){var e=[];for(c in a)r=a[c],/track-changes/.test(r.clazz)?e.push(console.error("Orphaned ace marker",r)):e.push(void 0);return e}()}},{key:"broadcastChange",value:function(){this.$scope.$emit("editor:track-changes:changed",this.$scope.docId)}},{key:"recalculateReviewEntriesScreenPositions",value:function(){var e=this.editor.getSession(),t=this.editor.renderer,n=this._getCurrentDocEntries()||{};for(var r in n){var i=n[r],o=this.adapter.shareJsOffsetToRowColumn(i.offset),s=e.documentToScreenPosition(o.row,o.column).row*t.lineHeight;null==i.screenPos&&(i.screenPos={}),i.screenPos.y=s,i.docPos=o}this.recalculateVisibleEntries(),this.$scope.$apply()}},{key:"recalculateVisibleEntries",value:function(){var e=this.editor.renderer.layerConfig,t=e.firstRow,n=e.lastRow,r=this._getCurrentDocEntries()||{},i=Object.keys(r).length,o=!1;for(var s in r){var a=r[s],l=a.visible;a.visible=i<100||t-20<=a.docPos.row&&a.docPos.row<=n+20,a.visible!==l&&(o=!0)}o&&this.$scope.$emit("editor:track-changes:visibility_changed")}},{key:"_getCurrentDocEntries",value:function(){var e=this.$scope.docId;return this.$scope.reviewPanel.entries[e]||{}}},{key:"updateFocus",value:function(){if(this.editor){var e=this.editor.getSelectionRange(),t=this._rangeToShareJs(e.start),n=this._rangeToShareJs(e.end),r=t!==n;this.$scope.$emit("editor:focus:changed",t,n,r)}}},{key:"_rangeToShareJs",value:function(e){var t=this.editor.getSession().getDocument().getLines(0,e.row);return r.rangeToShareJs(e,t)}},{key:"_changeToShareJs",value:function(e){var t=this.editor.getSession().getDocument().getLines(0,e.start.row);return r.changeToShareJs(e,t)}}])&&o(t.prototype,n),s&&o(t,s),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("infiniteScroll",(function(){return{link:function(e,t,n,r){var i=t.find(".infinite-scroll-inner");t.css({"overflow-y":"auto"});var o=function(){return t.scrollTop()<30},s=function(){return t.scrollTop()+t.height()>=i.height()-30},a=function r(){if((t.height()>i.height()||(null!=n.infiniteScrollUpwards?o():s()))&&!e.$eval(n.infiniteScrollDisabled))return e.$eval(n.infiniteScroll).then((function(){return setTimeout((function(){return r()}),0)}))};return t.on("scroll",(function(e){return a()})),e.$watch(n.infiniteScrollInitialize,(function(e){if(e)return a()}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){e.exports=function(){return new Worker(n.p+"js/pdfjs-worker.d7c05000dbee1211c8e8.js")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0),n(147),n(155),n(156),n(183),n(185),n(188),n(42),n(204),n(234),n(236),n(237),n(238),n(255),n(256),n(257),n(261),n(268),n(274),n(277),n(280),n(283),n(286),n(288),n(33),n(35),n(36),n(289),n(37),n(34),n(290),n(291),n(292),n(19),n(38),n(39),n(293),n(40),n(31),n(30),n(32),n(294)],void 0===(i=function(e,t,n,r,i,s,a,l,c,u,h,d,f,p){return e.controller("IdeController",["$scope","$timeout","ide","localStorage","eventTracking","metadata","$q","CobrandingDataService",function(e,f,g,m,v,y,b,w){var _,C,S;e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)},e.state={loading:!0,load_progress:40,error:null},e.ui={leftMenuShown:!1,view:"editor",chatOpen:!1,pdfLayout:"sideBySide",pdfHidden:!1,pdfWidth:0,reviewPanelOpen:m("ui.reviewPanelOpen.".concat(window.project_id)),miniReviewPanelVisible:!1,chatResizerSizeOpen:window.uiConfig.chatResizerSizeOpen,chatResizerSizeClosed:window.uiConfig.chatResizerSizeClosed,defaultFontFamily:window.uiConfig.defaultFontFamily,defaultLineHeight:window.uiConfig.defaultLineHeight},e.user=window.user,e.settings=window.userSettings,e.anonymous=window.anonymous,e.isTokenMember=window.isTokenMember,e.isRestrictedTokenMember=window.isRestrictedTokenMember,e.cobranding={isProjectCobranded:w.isProjectCobranded(),logoImgUrl:w.getLogoImgUrl(),submitBtnHtml:w.getSubmitBtnHtml(),brandVariationName:w.getBrandVariationName(),brandVariationHomeUrl:w.getBrandVariationHomeUrl()},e.chat={},g.toggleReviewPanel=e.toggleReviewPanel=function(){if(e.project.features.trackChangesVisible)return e.ui.reviewPanelOpen=!e.ui.reviewPanelOpen,v.sendMB("rp-toggle-panel",{value:e.ui.reviewPanelOpen})},e.$watch("ui.reviewPanelOpen",(function(e){if(null!=e)return m("ui.reviewPanelOpen.".concat(window.project_id),e)})),e.$on("layout:pdf:resize",(function(t,n){return e.ui.pdfHidden=n.east.initClosed,e.ui.pdfWidth=n.east.size})),e.$watch("ui.view",(function(t,n){if(t!==n&&e.$broadcast("layout:flat-screen:toggle"),null!=t&&"editor"!==t&&"pdf"!==t)return v.sendMBOnce("ide-open-view-".concat(t,"-once"))})),e.$watch("ui.chatOpen",(function(e){if(e)return v.sendMBOnce("ide-open-chat-once")})),e.$watch("ui.leftMenuShown",(function(e){if(e)return v.sendMBOnce("ide-open-left-menu-once")})),e.trackHover=function(e){return v.sendMBOnce("ide-hover-".concat(e,"-once"))},window._ide=g,g.validFileRegex="^[^*/]*$";var k=window.location&&window.location.search&&window.location.search.match(/ws=fallback/);g.wsUrl=k?null:window.sharelatex.wsUrl||null,g.project_id=e.project_id=window.project_id,g.$scope=e,g.referencesSearchManager=new h(g,e),g.connectionManager=new n(g,e),g.fileTreeManager=new t(g,e),g.editorManager=new r(g,e,m),g.onlineUsersManager=new i(g,e),window.data.useV2History?g.historyManager=new a(g,e,m):g.historyManager=new s(g,e),g.pdfManager=new c(g,e),g.permissionsManager=new l(g,e),g.binaryFilesManager=new u(g,e),g.metadataManager=new d(g,e,y);var A=!1;e.$on("project:joined",(function(){if(!A)return A=!0,o(null!=e?e.project:void 0,(function(e){return e.deletedByExternalDataSource}))&&g.showGenericMessageModal("Project Renamed or Deleted","This project has either been renamed or deleted by an external data source such as Dropbox.\nWe don't want to delete your data on ShareLaTeX, so this project still contains your history and collaborators.\nIf the project has been renamed please look in your project list for a new project under the new name."),f((function(){if(e.permissions.write)return g.metadataManager.loadProjectMetaFromServer(),!0}),200)}));var x=!1;e.$on("doc:opened",(function(){if(!x)return e.$broadcast("ide:loaded"),x=!0})),e.$on("cursor:editor:update",v.editingSessionHeartbeat);var $=["ambiance","chaos","clouds_midnight","cobalt","idle_fingers","merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","terminal","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink"];e.darkTheme=!1,e.$watch("settings.editorTheme",(function(t){return Array.from($).includes(t)?e.darkTheme=!0:e.darkTheme=!1})),g.localStorage=m,g.browserIsSafari=!1,e.switchToFlatLayout=function(t){return e.ui.pdfLayout="flat",e.ui.view=t,g.localStorage("pdf.layout","flat")},e.switchToSideBySideLayout=function(t){return e.ui.pdfLayout="sideBySide",e.ui.view=t,m("pdf.layout","split")},(C=m("pdf.layout"))?("split"===C&&e.switchToSideBySideLayout(),"flat"===C&&e.switchToFlatLayout()):e.switchToSideBySideLayout();try{S=navigator.userAgent,g.browserIsSafari=S&&/.*Safari\/.*/.test(S)&&!/.*Chrome\/.*/.test(S)&&!/.*Chromium\/.*/.test(S)}catch(e){_=e,console.error(_)}g.browserIsSafari&&(g.safariScrollPatcher=new p(e));try{null!=(parseFloat(navigator.userAgent.split(" Chrome/")[1])||null)&&document.styleSheets[0].insertRule(".ace_editor.ace_autocomplete .ace_completion-highlight { text-shadow: none !important; font-weight: bold; }",1)}catch(e){_=e,console.error(_)}return g.featureToggle=o(o("undefined"!=typeof location&&null!==location?location.search:void 0,(function(e){return e.match(/^\?ft=(\w+)$/)})),(function(e){return e[1]})),g.socket.on("project:publicAccessLevel:changed",(function(t){if(null!=t.newAccessLevel)return g.$scope.project.publicAccesLevel=t.newAccessLevel,e.$digest()}))}]),angular.bootstrap(document.body,["SharelatexApp"])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return null!=e?t(e):void 0}r=[n(148),n(149),n(150),n(151),n(152),n(153),n(154)],void 0===(i=function(){return function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("project:joined",(function(){return r.loadRootFolder(),r.loadDeletedDocs(),r.$scope.$emit("file-tree:initialized")})),this.$scope.$watch("rootFolder",(function(e){if(null!=e)return r.recalculateDocList()})),this._bindToSocketEvents(),this.$scope.multiSelectedCount=0,$(document).on("click",(function(){return r.clearMultiSelectedEntities(),r.$scope.$digest()}))}var t,n,r;return t=e,(n=[{key:"_bindToSocketEvents",value:function(){var e=this;return this.ide.socket.on("reciveNewDoc",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"doc"}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFile",(function(t,n,r,i){var o=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return o.children.push({name:n.name,id:n._id,type:"file",linkedFileData:i,created:n.created}),e.recalculateDocList()}))})),this.ide.socket.on("reciveNewFolder",(function(t,n){var r=e.findEntityById(t)||e.$scope.rootFolder;return e.$scope.$apply((function(){return r.children.push({name:n.name,id:n._id,type:"folder",children:[]}),e.recalculateDocList()}))})),this.ide.socket.on("reciveEntityRename",(function(t,n){var r=e.findEntityById(t);if(null!=r)return e.$scope.$apply((function(){return r.name=n,e.recalculateDocList()}))})),this.ide.socket.on("removeEntity",(function(t){var n=e.findEntityById(t);if(null!=n)return e.$scope.$apply((function(){return e._deleteEntityFromScope(n),e.recalculateDocList()})),e.$scope.$broadcast("entity:deleted",n)})),this.ide.socket.on("reciveEntityMove",(function(t,n){var r=e.findEntityById(t),i=e.findEntityById(n);return e.$scope.$apply((function(){return e._moveEntityInScope(r,i),e.recalculateDocList()}))}))}},{key:"selectEntity",value:function(e){return this.selected_entity_id=e.id,this.ide.fileTreeManager.forEachEntity((function(e){return e.selected=!1})),e.selected=!0}},{key:"toggleMultiSelectEntity",value:function(e){return e.multiSelected=!e.multiSelected,this.$scope.multiSelectedCount=this.multiSelectedCount()}},{key:"multiSelectedCount",value:function(){var e=0;return this.forEachEntity((function(t){if(t.multiSelected)return e++})),e}},{key:"getMultiSelectedEntities",value:function(){var e=[];return this.forEachEntity((function(t){if(t.multiSelected)return e.push(t)})),e}},{key:"getMultiSelectedEntityChildNodes",value:function(){for(var e=this.getMultiSelectedEntities(),t={},n=0,r=Array.from(e);n<r.length;n++){var i=r[n];t["/"+this.getEntityPath(i)]=i}var o={};for(var s in t){i=t[s];var a=s.split("/");if(!(a.length<=2))for(var l=1,c=a.length-1,u=c>=1;u?l<=c:l>=c;u?l++:l--)o["/"+a.slice(0,l).join("/")]=!0}var h=[];for(s in t)i=t[s],null==o[s]&&h.push(i);return h}},{key:"clearMultiSelectedEntities",value:function(){if(0!==this.$scope.multiSelectedCount)return this.forEachEntity((function(e){return e.multiSelected=!1})),this.$scope.multiSelectedCount=0}},{key:"multiSelectSelectedEntity",value:function(){return s(this.findSelectedEntity(),(function(e){return e.multiSelected=!0}))}},{key:"existsInFolder",value:function(e,t){var n=this.findEntityById(e);return null!=n&&null!=this._findEntityByPathInFolder(n,t)}},{key:"findSelectedEntity",value:function(){var e=null;return this.forEachEntity((function(t){if(t.selected)return e=t})),e}},{key:"findEntityById",value:function(e,t){if(null==t&&(t={}),this.$scope.rootFolder.id===e)return this.$scope.rootFolder;var n=this._findEntityByIdInFolder(this.$scope.rootFolder,e);if(null!=n)return n;if(t.includeDeleted)for(var r=0,i=Array.from(this.$scope.deletedDocs);r<i.length;r++)if((n=i[r]).id===e)return n;return null}},{key:"_findEntityByIdInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var i=r[n];if(i.id===t)return i;if(null!=i.children){var o=this._findEntityByIdInFolder(i,t);if(null!=o)return o}}return null}},{key:"findEntityByPath",value:function(e){return this._findEntityByPathInFolder(this.$scope.rootFolder,e)}},{key:"_findEntityByPathInFolder",value:function(e,t){if(null==t||null==e)return null;if(""===t)return e;var n=t.split("/"),r=n.shift(),i=n.join("/");if("."===r)return this._findEntityByPathInFolder(e,i);for(var o=0,s=Array.from(e.children);o<s.length;o++){var a=s[o];if(a.name===r){if(""===i)return a;if("folder"===a.type)return this._findEntityByPathInFolder(a,i)}}return null}},{key:"forEachEntity",value:function(e){var t=this;return null==e&&(e=function(e,t,n){}),this._forEachEntityInFolder(this.$scope.rootFolder,null,e),function(){for(var n=[],r=0,i=Array.from(t.$scope.deletedDocs||[]);r<i.length;r++){var o=i[r];n.push(e(o))}return n}()}},{key:"_forEachEntityInFolder",value:function(e,t,n){var r=this;return function(){for(var i=[],o=0,s=Array.from(e.children||[]);o<s.length;o++){var a,l=s[o];a=null!=t?t+"/"+l.name:l.name,n(l,e,a),null!=l.children?i.push(r._forEachEntityInFolder(l,a,n)):i.push(void 0)}return i}()}},{key:"getEntityPath",value:function(e){return this._getEntityPathInFolder(this.$scope.rootFolder,e)}},{key:"_getEntityPathInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var i=r[n];if(i===t)return t.name;if("folder"===i.type){var o=this._getEntityPathInFolder(i,t);if(null!=o)return i.name+"/"+o}}return null}},{key:"getRootDocDirname",value:function(){var e=this.findEntityById(this.$scope.project.rootDoc_id);if(null!=e)return this._getEntityDirname(e)}},{key:"_getEntityDirname",value:function(e){var t=this.getEntityPath(e);if(null!=t)return t.split("/").slice(0,-1).join("/")}},{key:"_findParentFolder",value:function(e){var t=this._getEntityDirname(e);if(null!=t)return this.findEntityByPath(t)}},{key:"loadRootFolder",value:function(){return this.$scope.rootFolder=this._parseFolder(s(null!=this.$scope?this.$scope.project:void 0,(function(e){return e.rootFolder[0]})))}},{key:"_parseFolder",value:function(e){for(var t={name:e.name,id:e._id,type:"folder",children:[],selected:e._id===this.selected_entity_id},n=0,r=Array.from(e.docs||[]);n<r.length;n++){var i=r[n];t.children.push({name:i.name,id:i._id,type:"doc",selected:i._id===this.selected_entity_id})}for(var o=0,s=Array.from(e.fileRefs||[]);o<s.length;o++){var a=s[o];t.children.push({name:a.name,id:a._id,type:"file",selected:a._id===this.selected_entity_id,linkedFileData:a.linkedFileData,created:a.created})}for(var l=0,c=Array.from(e.folders||[]);l<c.length;l++){var u=c[l];t.children.push(this._parseFolder(u))}return t}},{key:"loadDeletedDocs",value:function(){var e=this;return this.$scope.deletedDocs=[],Array.from(this.$scope.project.deletedDocs||[]).map((function(t){return e.$scope.deletedDocs.push({name:t.name,id:t._id,type:"doc",deleted:!0})}))}},{key:"recalculateDocList",value:function(){var e=this;return this.$scope.docs=[],this.forEachEntity((function(t,n,r){if("doc"===t.type&&!t.deleted)return e.$scope.docs.push({doc:t,path:r})})),this.$scope.docs.sort((function(e,t){var n=(e.path.match(/\//g)||[]).length,r=(t.path.match(/\//g)||[]).length;return n-r!=0?-(n-r):e.path<t.path?-1:1}))}},{key:"getEntityPath",value:function(e){return this._getEntityPathInFolder(this.$scope.rootFolder,e)}},{key:"_getEntityPathInFolder",value:function(e,t){for(var n=0,r=Array.from(e.children||[]);n<r.length;n++){var i=r[n];if(i===t)return t.name;if("folder"===i.type){var o=this._getEntityPathInFolder(i,t);if(null!=o)return i.name+"/"+o}}return null}},{key:"getCurrentFolder",value:function(){return this._getCurrentFolder(this.$scope.rootFolder)||this.$scope.rootFolder}},{key:"_getCurrentFolder",value:function(e){null==e&&(e=this.$scope.rootFolder);for(var t=0,n=Array.from(e.children||[]);t<n.length;t++){var r=n[t];if(r.selected)return"folder"===r.type?r:e;if("folder"===r.type){var i=this._getCurrentFolder(r);if(null!=i)return i}}return null}},{key:"projectContainsFolder",value:function(){for(var e=0,t=Array.from(this.$scope.rootFolder.children);e<t.length;e++)if("folder"===t[e].type)return!0;return!1}},{key:"existsInThisFolder",value:function(e,t){for(var n=0,r=Array.from((null!=e?e.children:void 0)||[]);n<r.length;n++)if(r[n].name===t)return!0;return!1}},{key:"nameExistsError",value:function(e){null==e&&(e="already exists");var t=this.ide.$q.defer();return t.reject({data:e}),t.promise}},{key:"createDoc",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/doc"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createFolder",value:function(e,t){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/folder"),{name:e,parent_folder_id:null!=t?t.id:void 0,_csrf:window.csrfToken})}},{key:"createLinkedFile",value:function(e,t,n,r){return null==t&&(t=this.getCurrentFolder()),this.existsInThisFolder(t,e)?this.nameExistsError():this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file"),{name:e,parent_folder_id:null!=t?t.id:void 0,provider:n,data:r,_csrf:window.csrfToken},{disableAutoLoginRedirect:!0})}},{key:"refreshLinkedFile",value:function(e){if(this._findParentFolder(e),null!=(null!=e.linkedFileData?e.linkedFileData.provider:void 0))return this.ide.$http.post("/project/".concat(this.ide.project_id,"/linked_file/").concat(e.id,"/refresh"),{_csrf:window.csrfToken},{disableAutoLoginRedirect:!0});console.warn(">> no provider for ".concat(e.name),e)}},{key:"renameEntity",value:function(e,t,n){if(null==n&&(n=function(e){}),e.name!==t&&!(t.length>=150)){var r=this.getCurrentFolder();return this.existsInThisFolder(r,t)?this.nameExistsError():(e.renamingToName=t,this.ide.$http.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/rename"),{name:t,_csrf:window.csrfToken}).then((function(){return e.name=t})).finally((function(){return e.renamingToName=null})))}}},{key:"deleteEntity",value:function(e,t){return null==t&&(t=function(e){}),this.ide.queuedHttp({method:"DELETE",url:"/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id),headers:{"X-Csrf-Token":window.csrfToken}})}},{key:"moveEntity",value:function(e,t,n){var r=this;if(null==n&&(n=function(e){}),!this._isChildFolder(e,t))return this.existsInThisFolder(t,e.name)?this.nameExistsError():this.ide.queuedHttp.post("/project/".concat(this.ide.project_id,"/").concat(e.type,"/").concat(e.id,"/move"),{folder_id:t.id,_csrf:window.csrfToken}).then((function(){return r._moveEntityInScope(e,t)}))}},{key:"_isChildFolder",value:function(e,t){var n=this.getEntityPath(e)||"";return(this.getEntityPath(t)||"").slice(0,n.length)===n}},{key:"_deleteEntityFromScope",value:function(e,t){if(null==t&&(t={moveToDeleted:!0}),null!=e){var n=null;if(this.forEachEntity((function(t,r){if(t===e)return n=r})),null!=n){var r=n.children.indexOf(e);r>-1&&n.children.splice(r,1)}return"doc"===e.type&&t.moveToDeleted?(e.deleted=!0,this.$scope.deletedDocs.push(e)):void 0}}},{key:"_moveEntityInScope",value:function(e,t){if(!Array.from(t.children).includes(e))return this._deleteEntityFromScope(e,{moveToDeleted:!1}),t.children.push(e)}}])&&o(t.prototype,n),r&&o(t,r),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("fileEntity",["RecursionHelper",function(e){return{restrict:"E",scope:{entity:"=",permissions:"="},templateUrl:"entityListItemTemplate",compile:function(t){return e.compile(t,(function(e,t,n,r){return e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)}}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("draggable",(function(){return{link:function(e,t,n){return e.$watch(n.draggable,(function(r){if(r)return t.draggable({delay:250,opacity:.95,scroll:!0,helper:e.$eval(n.draggableHelper)})}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("droppable",(function(){return{link:function(e,t,n){return e.$watch(n.droppable,(function(r){if(r)return t.droppable({greedy:!0,hoverClass:"droppable-hover",tolerance:"pointer",accept:n.accept,drop:e.$eval(n.onDropCallback)})}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){return e.controller("FileTreeController",["$scope","$modal","ide","$rootScope",function(e,t,n,r){return e.openNewDocModal=function(){return t.open({templateUrl:"newFileModalTemplate",controller:"NewFileModalController",size:"lg",resolve:{parent_folder:function(){return n.fileTreeManager.getCurrentFolder()},projectFeatures:function(){return n.$scope.project.features},type:function(){return"doc"},userFeatures:function(){return n.$scope.user.features}}})},e.openNewFolderModal=function(){return t.open({templateUrl:"newFolderModalTemplate",controller:"NewFolderModalController",resolve:{parent_folder:function(){return n.fileTreeManager.getCurrentFolder()}}})},e.openUploadFileModal=function(){return t.open({templateUrl:"newFileModalTemplate",controller:"NewFileModalController",size:"lg",resolve:{projectFeatures:function(){return n.$scope.project.features},parent_folder:function(){return n.fileTreeManager.getCurrentFolder()},type:function(){return"upload"},userFeatures:function(){return n.$scope.user.features}}})},e.orderByFoldersFirst=function(e){return"folder"===(null!=e?e.type:void 0)?"0":"1"},e.startRenamingSelected=function(){return e.$broadcast("rename:selected")},e.openDeleteModalForSelected=function(){return e.$broadcast("delete:selected")}}]),e.controller("NewFolderModalController",["$scope","ide","$modalInstance","$timeout","parent_folder",function(e,t,n,r,i){return e.inputs={name:"name"},e.state={inflight:!1},n.opened.then((function(){return r((function(){return e.$broadcast("open")}),200)})),e.create=function(){var r=e.inputs.name;if(null!=r&&0!==r.length)return e.state.inflight=!0,t.fileTreeManager.createFolder(r,e.parent_folder).then((function(){return e.state.inflight=!1,n.dismiss("done")})).catch((function(t){var n=t.data;return e.error=n,e.state.inflight=!1}))},e.cancel=function(){return n.dismiss("cancel")}}]),e.controller("NewFileModalController",["$scope","ide","type","parent_folder","$modalInstance","eventTracking","projectFeatures","userFeatures",function(e,t,n,r,i,o,s,a){e.type=n,e.parent_folder=r,e.state={inflight:!1,valid:!0},e.cancel=function(){return i.dismiss("cancel")},e.create=function(){return e.$broadcast("create")};var l=s&&s.references||s&&s.mendeley||a&&a.references||a&&a.mendeley,c=s&&s.references||s&&s.zotero||a&&a.references||a&&a.zotero;return e.$watch("type",(function(){"mendeley"!==e.type||l||o.send("subscription-funnel","editor-click-feature",e.type),"zotero"!==e.type||c||o.send("subscription-funnel","editor-click-feature",e.type)})),e.$on("done",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};isBibFile=n.name&&/^.*\.bib$/.test(n.name),(n.shouldReindexReferences||isBibFile)&&t.$scope.$emit("references:should-reindex",{}),i.dismiss("done")}))}]),e.controller("NewDocModalController",["$scope","ide","$timeout",function(e,t,n){e.inputs={name:"name.tex"};return e.$watch("inputs.name",(function(){var t=e.inputs.name;e.state.valid=null!=t&&t.length>0})),n((function(){return e.$broadcast("open")}),200),e.$on("create",(function(){var n=e.inputs.name;if(null!=n&&0!==n.length)return e.state.inflight=!0,t.fileTreeManager.createDoc(n,e.parent_folder).then((function(){return e.state.inflight=!1,e.$emit("done")})).catch((function(t){var n=t.data;e.error=n,e.state.inflight=!1}))}))}]),e.controller("UploadFileModalController",["$scope","$rootScope","ide","$timeout","$window",function(e,t,n,r,i){e.parent_folder_id=null!=e.parent_folder?e.parent_folder.id:void 0,e.project_id=n.project_id,e.tooManyFiles=!1,e.rateLimitHit=!1,e.secondsToRedirect=10,e.notLoggedIn=!1,e.conflicts=[],e.control={};e.max_files=40,e.onComplete=function(n,i,o){return r((function(){if(l--,o.success&&t.$broadcast("file:upload:complete",o),0===l&&null!=o&&o.success)return e.$emit("done",{name:i})}),250)},e.onValidateBatch=function(t){return!(t.length>e.max_files)||(r((function(){return e.tooManyFiles=!0}),1),!1)},e.onError=function(t,o,s){return console.log(t,o,s),-1!==s.indexOf("429")?e.rateLimitHit=!0:-1!==s.indexOf("403")?function(){e.notLoggedIn=!0;return function t(){return r((function(){return 0===e.secondsToRedirect?i.location.href="/login?redir=/project/".concat(n.project_id):(t(),e.secondsToRedirect=e.secondsToRedirect-1)}),1e3)}()}():void 0};var s=null,a=function(){if(0===e.conflicts.length)return e.doUpload()},l=0;return e.onSubmit=function(t,r){return l++,n.fileTreeManager.existsInFolder(e.parent_folder_id,r)&&(e.conflicts.push(r),e.$apply()),null==s&&(s=setTimeout((function(){return s=null,a()}),0)),!0},e.onCancel=function(t,n){l--;var r=e.conflicts.indexOf(n);return r>-1&&e.conflicts.splice(r,1),e.$apply(),a()},e.doUpload=function(){return o(null!=e.control?e.control.q:void 0,(function(e){return e.uploadStoredFiles()}))}}]),e.controller("ProjectLinkedFileModalController",["$scope","ide","$timeout",function(e,t,n){e.data={projects:null,selectedProjectId:null,projectEntities:null,projectOutputFiles:null,selectedProjectEntity:null,selectedProjectOutputFile:null,buildId:null,name:null},e.state.inFlight={projects:!1,entities:!1,compile:!1},e.state.isOutputFilesMode=!1,e.state.error=!1,e.$watch("data.selectedProjectId",(function(t,n){if(t)return e.data.selectedProjectEntity=null,e.data.selectedProjectOutputFile=null,e.state.isOutputFilesMode?e.compileProjectAndGetOutputFiles(e.data.selectedProjectId):e.getProjectEntities(e.data.selectedProjectId)})),e.$watch("state.isOutputFilesMode",(function(t,n){if(t||n)return e.data.selectedProjectOutputFile=null,!0===t?e.compileProjectAndGetOutputFiles(e.data.selectedProjectId):e.getProjectEntities(e.data.selectedProjectId)})),e.$watch("data.selectedProjectEntity",(function(t,n){if(t){var r=t.split("/").reverse()[0];r&&(e.data.name=r)}})),e.$watch("data.selectedProjectOutputFile",(function(t,n){if(t)if("output.pdf"===t){var r=_.find(e.data.projects,(function(t){return t._id===e.data.selectedProjectId}));e.data.name=null!=(null!=r?r.name:void 0)?"".concat(r.name,".pdf"):"output.pdf"}else{var i=t.split("/").reverse()[0];i&&(e.data.name=i)}}));var r=function(t){return e.state.inFlight[t]=!0},i=function(t){var n=!0===t.err,r=e.state.inFlight;return r.projects=r.entities=r.compile=!1,e.state.inflight=!1,e.state.error=n};e.toggleOutputFilesMode=function(){if(e.data.selectedProjectId)return e.state.isOutputFilesMode=!e.state.isOutputFilesMode},e.shouldEnableProjectSelect=function(){var t=e.state,n=e.data;return!t.inFlight.projects&&n.projects},e.hasNoProjects=function(){var t=e.state,n=e.data;return!t.inFlight.projects&&(null==n.projects||0===n.projects.length)},e.shouldEnableProjectEntitySelect=function(){var t=e.state,n=e.data;return!t.inFlight.projects&&!t.inFlight.entities&&n.projects&&n.selectedProjectId},e.shouldEnableProjectOutputFileSelect=function(){var t=e.state,n=e.data;return!t.inFlight.projects&&!t.inFlight.compile&&n.projects&&n.selectedProjectId};var s=function(){var t=e.state,n=e.data;e.state.valid=!t.inFlight.projects&&!t.inFlight.entities&&n.projects&&n.selectedProjectId&&(!e.state.isOutputFilesMode&&n.projectEntities&&n.selectedProjectEntity||e.state.isOutputFilesMode&&n.projectOutputFiles&&n.selectedProjectOutputFile)&&n.name};return e.$watch("state",s,!0),e.$watch("data",s,!0),e.getUserProjects=function(){return r("projects"),t.$http.get("/user/projects",{_csrf:window.csrfToken}).then((function(n){return e.data.projectEntities=null,e.data.projects=n.data.projects.filter((function(e){return e._id!==t.project_id})),i({err:!1})})).catch((function(e){return i({err:!0})}))},e.getProjectEntities=function(n){return r("entities"),t.$http.get("/project/".concat(n,"/entities"),{_csrf:window.csrfToken}).then((function(t){if(e.data.selectedProjectId===t.data.project_id)return e.data.projectEntities=t.data.entities,i({err:!1})})).catch((function(e){return i({err:!0})}))},e.compileProjectAndGetOutputFiles=function(n){return r("compile"),t.$http.post("/project/".concat(n,"/compile"),{check:"silent",draft:!1,incrementalCompilesEnabled:!1,_csrf:window.csrfToken}).then((function(t){if("success"===t.data.status){var n=t.data.outputFiles.filter((function(e){return e.path.match(/.*\.(pdf|png|jpeg|jpg|gif)/)}));return e.data.projectOutputFiles=n,e.data.buildId=o(null!=n?n[0]:void 0,(function(e){return e.build})),console.log(">> build_id",e.data.buildId),i({err:!1})}return e.data.projectOutputFiles=null,i({err:!0})})).catch((function(e){return console.error(e),i({err:!0})}))},e.init=function(){return e.getUserProjects()},n(e.init,0),e.$on("create",(function(){var n,o,s=e.data.selectedProjectId,a=e.data.name;e.state.isOutputFilesMode?(o="project_output_file",n={source_project_id:s,source_output_file_path:e.data.selectedProjectOutputFile,build_id:e.data.buildId}):(o="project_file",n={source_project_id:s,source_entity_path:e.data.selectedProjectEntity}),r("create"),t.fileTreeManager.createLinkedFile(a,e.parent_folder,o,n).then((function(){return i({err:!1}),e.$emit("done",{name:a})})).catch((function(t){var n=t.data;e.error=n}))}))}]),e.controller("UrlLinkedFileModalController",["$scope","ide","$timeout",function(e,t,n){e.inputs={name:"",url:""},e.nameChangedByUser=!1,n((function(){return e.$broadcast("open")}),200);var r=function(){var t=e.inputs,n=t.name,r=t.url;return null==n||0===n.length?e.state.valid=!1:null==r||0===r.length?e.state.valid=!1:e.state.valid=!0};return e.$watch("inputs.name",r),e.$watch("inputs.url",r),e.$watch("inputs.url",(function(t){if(null!=t&&""!==t&&!e.nameChangedByUser){var n=(t=t.replace("://","")).split("/").reverse();if(n.length>1)return e.inputs.name=n[0]}})),e.$on("create",(function(){var n=e.inputs,r=n.name,i=n.url;if(null!=r&&0!==r.length&&null!=i&&0!==i.length)return e.state.inflight=!0,t.fileTreeManager.createLinkedFile(r,e.parent_folder,"url",{url:i}).then((function(){return e.state.inflight=!1,e.$emit("done",{name:r})})).catch((function(t){var n=t.data;return e.error=n,e.state.inflight=!1}))}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(63)],void 0===(i=function(e,t){return e.controller("FileTreeEntityController",["$scope","ide","$modal",function(e,n,r){e.select=function(t){if(!t.ctrlKey&&!t.metaKey)return n.fileTreeManager.selectEntity(e.entity),e.$emit("entity:selected",e.entity);t.stopPropagation();var r=n.fileTreeManager.multiSelectedCount();return n.fileTreeManager.toggleMultiSelectEntity(e.entity),0===r?n.fileTreeManager.multiSelectSelectedEntity():void 0},e.draggableHelper=function(){return n.fileTreeManager.multiSelectedCount()>0?$("<strong style='z-index:100'>".concat(n.fileTreeManager.multiSelectedCount()," Files</strong>")):$("<strong style='z-index:100'>".concat(e.entity.name,"</strong>"))},e.inputs={name:e.entity.name},e.startRenaming=function(){return e.entity.renaming=!0};var i=!1;return e.finishRenaming=function(){if(e.entity.renaming){var t=e.inputs.name;if(null==t){if(i)return;return i=!0,void r.open({templateUrl:"invalidFileNameModalTemplate"}).result.then((function(){return i=!1}))}if(delete e.entity.renaming,null!=t&&0!==t.length)return n.fileTreeManager.renameEntity(e.entity,t);e.inputs.name=e.entity.name}},e.$on("rename:selected",(function(){if(e.entity.selected)return e.startRenaming()})),e.openDeleteModal=function(){var t;return t=n.fileTreeManager.multiSelectedCount()>0?n.fileTreeManager.getMultiSelectedEntityChildNodes():[e.entity],r.open({templateUrl:"deleteEntityModalTemplate",controller:"DeleteEntityModalController",resolve:{entities:function(){return t}}})},e.$on("delete:selected",(function(){if(e.entity.selected)return e.openDeleteModal()})),e.iconTypeFromName=t}]),e.controller("DeleteEntityModalController",["$scope","ide","$modalInstance","entities",function(e,t,n,r){return e.state={inflight:!1},e.entities=r,e.delete=function(){e.state.inflight=!0;for(var r=0,i=Array.from(e.entities);r<i.length;r++){var o=i[r];t.fileTreeManager.deleteEntity(o)}return n.close()},e.cancel=function(){return n.dismiss("cancel")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("FileTreeFolderController",["$scope","ide","$modal","localStorage",function(e,t,n,r){return e.expanded=r("folder.".concat(e.entity.id,".expanded"))||!1,e.toggleExpanded=function(){return e.expanded=!e.expanded,r("folder.".concat(e.entity.id,".expanded"),e.expanded)},e.onDrop=function(n,r){var i;i=t.fileTreeManager.multiSelectedCount()?t.fileTreeManager.getMultiSelectedEntityChildNodes():[$(r.draggable).scope().entity];for(var o=0,s=Array.from(i);o<s.length;o++){var a=s[o];t.fileTreeManager.moveEntity(a,e.entity)}return e.$digest(),$(".file-tree-inner .droppable-hover").removeClass("droppable-hover")},e.orderByFoldersFirst=function(e){return"folder"===(null!=e?e.type:void 0)?"0":"1"},e.openNewDocModal=function(){return n.open({templateUrl:"newFileModalTemplate",controller:"NewFileModalController",size:"lg",resolve:{parent_folder:function(){return e.entity},projectFeatures:function(){return t.$scope.project.features},type:function(){return"doc"},userFeatures:function(){return t.$scope.user.features}}})},e.openNewFolderModal=function(){return n.open({templateUrl:"newFolderModalTemplate",controller:"NewFolderModalController",resolve:{parent_folder:function(){return e.entity}}})},e.openUploadFileModal=function(){return n.open({templateUrl:"newFileModalTemplate",controller:"NewFileModalController",size:"lg",resolve:{parent_folder:function(){return e.entity},projectFeatures:function(){return t.$scope.project.features},type:function(){return"upload"},userFeatures:function(){return t.$scope.user.features}}})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("FileTreeRootFolderController",["$scope","ide",function(e,t){var n=e.rootFolder;return e.onDrop=function(r,i){var o;o=t.fileTreeManager.multiSelectedCount()?t.fileTreeManager.getMultiSelectedEntityChildNodes():[$(i.draggable).scope().entity];for(var s=0,a=Array.from(o);s<a.length;s++){var l=a[s];t.fileTreeManager.moveEntity(l,n)}return e.$digest(),$(".file-tree-inner .droppable-hover").removeClass("droppable-hover")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}void 0===(r=function(){var e,t=36e5;return(e=function(){function e(n,r){var i=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=n,this.$scope=r,this.wsUrl=n.wsUrl||null,"undefined"==typeof io||null===io)return console.error("Socket.io javascript not loaded. Please check that the real-time service is running and accessible."),this.ide.socket={on:function(){}},void this.$scope.$apply((function(){return i.$scope.state.error="Could not connect to websocket server :("}));setInterval((function(){return i.disconnectIfInactive()}),t),window.addEventListener("online",(function(){if(sl_console.log("[online] browser notified online"),!i.connected)return i.tryReconnectWithRateLimit({force:!0})})),this.userIsLeavingPage=!1,window.addEventListener("beforeunload",(function(){i.userIsLeavingPage=!0})),this.connected=!1,this.userIsInactive=!1,this.gracefullyReconnecting=!1,this.joinProjectRetryInterval=this.JOIN_PROJECT_RETRY_INTERVAL,this.$scope.connection={debug:sl_debugging,reconnecting:!1,stillReconnecting:!1,forced_disconnect:!1,inactive_disconnect:!1,jobId:0},this.$scope.tryReconnectNow=function(){return i.tryReconnectWithRateLimit({force:!0})},this.$scope.$on("cursor:editor:update",(function(){if(i.lastUserAction=new Date,!i.connected)return i.tryReconnectWithRateLimit()})),document.querySelector("body").addEventListener("click",(function(e){if(!i.connected&&"try-reconnect-now-button"!==e.target.id)return i.tryReconnectWithRateLimit()})),this.updateConnectionManagerState("connecting"),this.ide.socket=io.connect(this.wsUrl,{reconnect:!1,"connect timeout":3e4,"force new connection":!0});var o=function(e){if(i.updateConnectionManagerState("error"),sl_console.log("socket.io error",e),!i.wsUrl||window.location.href.match(/ws=fallback/))return i.connected=!1,i.$scope.$apply((function(){return i.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}));window.location=window.location.href+"?ws=fallback"};this.ide.socket.on("error",o),this.ide.socket.on("connect",(function(){i.ide.socket.removeListener("error",o),sl_console.log("[socket.io connect] Connected"),i.updateConnectionManagerState("authenticating")})),this.ide.socket.on("connectionAccepted",(function(e){sl_console.log("[socket.io connectionAccepted] allowed to connect"),i.connected=!0,i.gracefullyReconnecting=!1,i.ide.pushEvent("connected"),i.updateConnectionManagerState("joining"),i.$scope.$apply((function(){if(i.$scope.state.loading)return i.$scope.state.load_progress=70}));var t=i.$scope.connection.jobId;setTimeout((function(){i.joinProject(t)}),100)})),this.ide.socket.on("connectionRejected",(function(e){return sl_console.log("[socket.io connectionRejected] session not valid or other connection error"),e&&"retry"===e.message?i.tryReconnectWithRateLimit():i.reportConnectionError(e)})),this.ide.socket.on("connect_failed",(function(){return i.updateConnectionManagerState("error"),i.connected=!1,i.$scope.$apply((function(){return i.$scope.state.error="Unable to connect, please view the <u><a href='/learn/Kb/Connection_problems'>connection problems guide</a></u> to fix the issue."}))})),this.ide.socket.on("disconnect",(function(){sl_console.log("[socket.io disconnect] Disconnected"),i.connected=!1,i.ide.pushEvent("disconnected"),i.$scope.connection.state.match(/^waiting/)||(i.$scope.connection.forced_disconnect||i.userIsInactive?i.updateConnectionManagerState("inactive"):i.startAutoReconnectCountdown())})),this.ide.socket.on("forceDisconnect",(function(e){return i.updateConnectionManagerState("inactive"),i.$scope.$apply((function(){return i.$scope.permissions.write=!1,i.$scope.connection.forced_disconnect=!0})),i.ide.socket.disconnect(),i.ide.showGenericMessageModal("Please Refresh","We're performing maintenance on Overleaf and you need to refresh the editor.\nSorry for any inconvenience.\nThe editor will refresh in automatically in 10 seconds."),setTimeout((function(){return location.reload()}),1e4)})),this.ide.socket.on("reconnectGracefully",(function(){sl_console.log("Reconnect gracefully"),i.reconnectGracefully()}))}return o(e,null,[{key:"initClass",value:function(){this.prototype.disconnectAfterMs=24*t,this.prototype.lastUserAction=new Date,this.prototype.MIN_RETRY_INTERVAL=1e3,this.prototype.BACKGROUND_RETRY_INTERVAL=5e3,this.prototype.JOIN_PROJECT_RETRY_INTERVAL=5e3,this.prototype.JOIN_PROJECT_MAX_RETRY_INTERVAL=6e4,this.prototype.RECONNECT_GRACEFULLY_RETRY_INTERVAL=5e3,this.prototype.MAX_RECONNECT_GRACEFULLY_INTERVAL=45e3}}]),o(e,[{key:"updateConnectionManagerState",value:function(e){var t=this;this.$scope.$apply((function(){t.$scope.connection.jobId+=1;var n=t.$scope.connection.jobId;sl_console.log("[updateConnectionManagerState ".concat(n,"] from ").concat(t.$scope.connection.state," to ").concat(e)),t.$scope.connection.state=e,t.$scope.connection.reconnecting=!1,t.$scope.connection.stillReconnecting=!1,t.$scope.connection.inactive_disconnect=!1,t.$scope.connection.joining=!1,t.$scope.connection.reconnection_countdown=null,"connecting"===e||("reconnecting"===e?(t.$scope.connection.reconnecting=!0,setTimeout((function(){t.$scope.connection.reconnecting&&t.$scope.connection.jobId===n&&(t.$scope.connection.stillReconnecting=!0)}),1e3)):"authenticating"===e||("joining"===e?t.$scope.connection.joining=!0:"ready"===e||("waitingCountdown"===e?t.cancelReconnect():"waitingGracefully"===e?t.cancelReconnect():"inactive"===e||"error"===e||sl_console.log("[WARN] [updateConnectionManagerState ".concat(n,"] got unrecognised state ").concat(e)))))}))}},{key:"expectConnectionManagerState",value:function(e,t){return!(this.$scope.connection.state!==e||t&&t!==this.$scope.connection.jobId)||(sl_console.log("[WARN] [state mismatch] expected state ".concat(e).concat(t?"/"+t:""," when in ").concat(this.$scope.connection.state,"/").concat(this.$scope.connection.jobId)),!1)}},{key:"reportConnectionError",value:function(e){return sl_console.log("[socket.io] reporting connection error"),this.updateConnectionManagerState("error"),"not authorized"===(null!=e?e.message:void 0)||"invalid session"===(null!=e?e.message:void 0)?window.location="/login?redir=".concat(encodeURI(window.location.pathname)):(this.ide.socket.disconnect(),this.ide.showGenericMessageModal("Something went wrong connecting","Something went wrong connecting to your project. Please refresh if this continues to happen."))}},{key:"joinProject",value:function(e){var t=this;if(sl_console.log("[joinProject ".concat(e,"] joining...")),this.expectConnectionManagerState("joining",e)){var n={project_id:this.ide.project_id};window.anonymousAccessToken&&(n.anonymousAccessToken=window.anonymousAccessToken),this.ide.socket.emit("joinProject",n,(function(n,r,i,o){if(null!=n||null==r)return"TooManyRequests"===n.code?(sl_console.log("[joinProject ".concat(e,"] retrying: ").concat(n.message)),setTimeout((function(){return t.joinProject(e)}),t.joinProjectRetryInterval),void(t.joinProjectRetryInterval<t.JOIN_PROJECT_MAX_RETRY_INTERVAL&&(t.joinProjectRetryInterval+=t.JOIN_PROJECT_RETRY_INTERVAL))):t.reportConnectionError(n);t.joinProjectRetryInterval=t.JOIN_PROJECT_RETRY_INTERVAL,null!=t.$scope.protocolVersion&&t.$scope.protocolVersion!==o&&location.reload(!0),t.$scope.$apply((function(){t.updateConnectionManagerState("ready"),t.$scope.protocolVersion=o,t.$scope.project=r,t.$scope.permissionsLevel=i,t.$scope.state.load_progress=100,t.$scope.state.loading=!1,t.$scope.$broadcast("project:joined")}))}))}else sl_console.log("[joinProject ".concat(e,"] aborting with stale connection"))}},{key:"reconnectImmediately",value:function(){return this.disconnect(),this.tryReconnect()}},{key:"disconnect",value:function(){if(!this.ide.socket.socket||this.ide.socket.socket.connected)return sl_console.log("[socket.io] disconnecting client"),this.ide.socket.disconnect();sl_console.log("[socket.io] skipping disconnect because socket.io has not connected")}},{key:"startAutoReconnectCountdown",value:function(){var e=this;this.updateConnectionManagerState("waitingCountdown");var t,n=this.$scope.connection.jobId;sl_console.log("[ConnectionManager] starting autoreconnect countdown"),t=null!=this.lastUserAction&&new Date-this.lastUserAction>12e4?60+Math.floor(120*Math.random()):3+Math.floor(7*Math.random()),this.userIsLeavingPage||(this.$scope.$apply((function(){e.$scope.connection.reconnecting=!1,e.$scope.connection.stillReconnecting=!1,e.$scope.connection.joining=!1,e.$scope.connection.reconnection_countdown=t})),setTimeout((function(){e.connected||(e.countdownTimeoutId=setTimeout((function(){return e.decreaseCountdown(n)}),1e3))}),200))}},{key:"cancelReconnect",value:function(){this.disconnect(),null!=this.countdownTimeoutId&&(sl_console.log("[ConnectionManager] cancelling existing reconnect timer"),clearTimeout(this.countdownTimeoutId),this.countdownTimeoutId=null)}},{key:"decreaseCountdown",value:function(e){var t=this;this.countdownTimeoutId=null,null!=this.$scope.connection.reconnection_countdown&&(this.expectConnectionManagerState("waitingCountdown",e)?(sl_console.log("[ConnectionManager] decreasing countdown",this.$scope.connection.reconnection_countdown),this.$scope.$apply((function(){t.$scope.connection.reconnection_countdown--})),this.$scope.connection.reconnection_countdown<=0?(this.$scope.connection.reconnecting=!1,this.$scope.$apply((function(){t.tryReconnect()}))):this.countdownTimeoutId=setTimeout((function(){return t.decreaseCountdown(e)}),1e3)):sl_console.log("[ConnectionManager] Aborting stale countdown ".concat(e)))}},{key:"tryReconnect",value:function(){sl_console.log("[ConnectionManager] tryReconnect"),this.connected||this.$scope.connection.reconnecting||(this.updateConnectionManagerState("reconnecting"),sl_console.log("[ConnectionManager] Starting new connection"),this.ide.socket.socket.connect(),this.lastConnectionAttempt=new Date)}},{key:"tryReconnectWithRateLimit",value:function(e){if(!this.$scope.connection.reconnecting&&!this.connected){var t=null!=this.$scope.connection.reconnection_countdown&&this.$scope.connection.reconnection_countdown<=5,n=null!=e?e.force:void 0;if(!t||n){var r=n?this.MIN_RETRY_INTERVAL:this.BACKGROUND_RETRY_INTERVAL;null!=this.lastConnectionAttempt&&new Date-this.lastConnectionAttempt<r?"waitingCountdown"!==this.$scope.connection.state&&this.startAutoReconnectCountdown():this.tryReconnect()}}}},{key:"disconnectIfInactive",value:function(){var e=this;if(this.userIsInactive=new Date-this.lastUserAction>this.disconnectAfterMs,this.userIsInactive&&this.connected)return this.disconnect(),this.$scope.$apply((function(){return e.$scope.connection.inactive_disconnect=!0}))}},{key:"reconnectGracefully",value:function(e){var t=this;if(null==this.reconnectGracefullyStarted)this.reconnectGracefullyStarted=new Date;else if(!e)return void sl_console.log("[reconnectGracefully] reconnection is already in process, so skipping");var n=new Date-this.lastUserAction>this.RECONNECT_GRACEFULLY_RETRY_INTERVAL,r=new Date-this.reconnectGracefullyStarted>this.MAX_RECONNECT_GRACEFULLY_INTERVAL;n||r?(sl_console.log("[reconnectGracefully] User didn't do anything for last 5 seconds, reconnecting"),this._reconnectGracefullyNow()):(sl_console.log("[reconnectGracefully] User is working, will try again in 5 seconds"),this.updateConnectionManagerState("waitingGracefully"),setTimeout((function(){t.reconnectGracefully(!0)}),this.RECONNECT_GRACEFULLY_RETRY_INTERVAL))}},{key:"_reconnectGracefullyNow",value:function(){return this.gracefullyReconnecting=!0,this.reconnectGracefullyStarted=null,$.cookie("SERVERID","",{expires:-1,path:"/"}),this.reconnectImmediately()}}]),e}()).initClass(),e}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}r=[n(64),n(160),n(161),n(181),n(182)],void 0===(i=function(e){var t;return(t=function(){function t(n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.ide=n,this.$scope=r,this.localStorage=i,this.$scope.editor={sharejs_doc:null,open_doc_id:null,open_doc_name:null,opening:!0,trackChanges:!1,wantTrackChanges:!1,showRichText:this.showRichText()},this.$scope.$on("entity:selected",(function(e,t){if("history"!==o.$scope.ui.view&&"doc"===t.type)return o.openDoc(t)})),this.$scope.$on("entity:deleted",(function(e,t){if(o.$scope.editor.open_doc_id===t.id){if(!o.$scope.project.rootDoc_id)return;var n=o.ide.fileTreeManager.findEntityById(o.$scope.project.rootDoc_id);if(null==n)return;return o.openDoc(n)}}));var s=!1;this.$scope.$on("file-tree:initialized",(function(){if(!s)return s=!0,o.autoOpenDoc()})),this.$scope.$on("flush-changes",(function(){return e.flushAll()})),this.$scope.$watch("editor.wantTrackChanges",(function(e){if(null!=e)return o._syncTrackChangesState(o.$scope.editor.sharejs_doc)}))}return s(t,null,[{key:"initClass",value:function(){this.prototype._syncTimeout=null}}]),s(t,[{key:"showRichText",value:function(){return"rich-text"===this.localStorage("editor.mode.".concat(this.$scope.project_id))}},{key:"autoOpenDoc",value:function(){var e=this.ide.localStorage("doc.open_id.".concat(this.$scope.project_id))||this.$scope.project.rootDoc_id;if(null!=e){var t=this.ide.fileTreeManager.findEntityById(e);if(null!=t)return this.openDoc(t)}}},{key:"openDocId",value:function(e,t){null==t&&(t={});var n=this.ide.fileTreeManager.findEntityById(e);if(null!=n)return this.openDoc(n,t)}},{key:"openDoc",value:function(e,t){var n=this;null==t&&(t={}),sl_console.log("[openDoc] Opening ".concat(e.id)),this.$scope.ui.view="editor";var r=function(){return null!=t.gotoLine?setTimeout((function(){return n.$scope.$broadcast("editor:gotoLine",t.gotoLine,t.gotoColumn)}),0):null!=t.gotoOffset?setTimeout((function(){return n.$scope.$broadcast("editor:gotoOffset",t.gotoOffset)}),0):void 0};if(e.id!==this.$scope.editor.open_doc_id||t.forceReopen)return this.$scope.editor.open_doc_id=e.id,this.$scope.editor.open_doc_name=e.name,this.ide.localStorage("doc.open_id.".concat(this.$scope.project_id),e.id),this.ide.fileTreeManager.selectEntity(e),this.$scope.editor.opening=!0,this._openNewDocument(e,(function(e,t){if(null==e)return n._syncTrackChangesState(t),n.$scope.$broadcast("doc:opened"),n.$scope.$apply((function(){return n.$scope.editor.opening=!1,n.$scope.editor.sharejs_doc=t,r()}));n.ide.showGenericMessageModal("Error opening document","Sorry, something went wrong opening this document. Please try again.")}));this.$scope.$apply((function(){return r()}))}},{key:"_openNewDocument",value:function(t,n){var r=this;null==n&&(n=function(e,t){}),sl_console.log("[_openNewDocument] Opening...");var i=this.$scope.editor.sharejs_doc;null!=i&&(sl_console.log("[_openNewDocument] Leaving existing open doc..."),i.leaveAndCleanUp(),this._unbindFromDocumentEvents(i));var o=e.getDocument(this.ide,t.id);return o.join((function(e){return null!=e?n(e):(r._bindToDocumentEvents(t,o),n(null,o))}))}},{key:"_bindToDocumentEvents",value:function(e,t){var n=this;return t.on("error",(function(t,r){var i;return i=null!=(null!=t?t.message:void 0)?t.message:"string"==typeof t?t:"",/maxDocLength/.test(i)?n.ide.showGenericMessageModal("Document Too Long","Sorry, this file is too long to be edited manually. Please upload it directly."):/too many comments or tracked changes/.test(i)?n.ide.showGenericMessageModal("Too many comments or tracked changes","Sorry, this file has too many comments or tracked changes. Please try accepting or rejecting some existing changes, or resolving and deleting some comments."):(n.ide.socket.disconnect(),n.ide.reportError(t,r),n.ide.showGenericMessageModal("Out of sync","Sorry, this file has gone out of sync and we need to do a full refresh. <br> <a href='/learn/Kb/Editor_out_of_sync_problems'>Please see this help guide for more information</a>")),n.openDoc(e,{forceReopen:!0})})),t.on("externalUpdate",(function(e){if(!n._ignoreExternalUpdates&&("external"!==_.property(["meta","type"])(e)||"git-bridge"!==_.property(["meta","source"])(e)))return n.ide.showGenericMessageModal("Document Updated Externally","This document was just updated externally. Any recent changes you have made may have been overwritten. To see previous versions please look in the history.")}))}},{key:"_unbindFromDocumentEvents",value:function(e){return e.off()}},{key:"getCurrentDocValue",value:function(){return null!=this.$scope.editor.sharejs_doc?this.$scope.editor.sharejs_doc.getSnapshot():void 0}},{key:"getCurrentDocId",value:function(){return this.$scope.editor.open_doc_id}},{key:"startIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!0}},{key:"stopIgnoringExternalUpdates",value:function(){return this._ignoreExternalUpdates=!1}},{key:"_syncTrackChangesState",value:function(e){var t,n=this;if(null!=e){null!=this._syncTimeout&&(clearTimeout(this._syncTimeout),this._syncTimeout=null);var r=this.$scope.editor.wantTrackChanges,i=e.getTrackingChanges();if(r!==i)return(t=function(){return null==e.getInflightOp()&&null==e.getPendingOp()?(e.setTrackingChanges(r),n.$scope.$apply((function(){return n.$scope.editor.trackChanges=r}))):n._syncTimeout=setTimeout(t,100)})();this.$scope.editor.trackChanges=r}}}]),t}()).initClass(),t}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r=[n(13),n(158)],void 0===(i=function(e,t){var n,r=1e3;return(n=function(e){function n(e,i,o,c){var u;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(u=a(this,l(n).call(this))).doc_id=e,u.socket=c,u.type="text";var h=(i=Array.from(i).map((function(e){return decodeURIComponent(escape(e))}))).join("\n");return u.track_changes=!1,u.connection={send:function(e){if(u._startInflightOpTimeout(e),null!=window.disconnectOnUpdate&&Math.random()<window.disconnectOnUpdate&&(sl_console.log("Disconnecting on update",e),window._ide.socket.socket.disconnect()),!(null!=window.dropUpdates&&Math.random()<window.dropUpdates))return u.track_changes&&(null==e.meta&&(e.meta={}),e.meta.tc=u.track_changes_id_seeds.inflight),u.socket.emit("applyOtUpdate",u.doc_id,e,(function(e){if(null!=e)return u._handleError(e)}));sl_console.log("Simulating a lost update",e)},state:"ok",id:u.socket.socket.sessionid},u._doc=new t.Doc(u.connection,u.doc_id,{type:u.type}),u._doc.setFlushDelay(r),u._doc.on("change",(function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=u).trigger.apply(e,["change"].concat(s(Array.from(n))))})),u._doc.on("acknowledge",(function(){return u.lastAcked=new Date,u.trigger("acknowledge")})),u._doc.on("remoteop",(function(){var e;u._doc.setFlushDelay(0);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=u).trigger.apply(e,["remoteop"].concat(s(Array.from(n))))})),u._doc.on("flipped_pending_to_inflight",(function(){return u.trigger("flipped_pending_to_inflight")})),u._doc.on("saved",(function(){return u.trigger("saved")})),u._doc.on("error",(function(e){return u._handleError(e)})),u._bindToDocChanges(u._doc),u.processUpdateFromServer({open:!0,v:o,snapshot:h}),u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(n,e),u(n,null,[{key:"initClass",value:function(){this.prototype.INFLIGHT_OP_TIMEOUT=5e3,this.prototype.WAIT_FOR_CONNECTION_TIMEOUT=500,this.prototype.FATAL_OP_TIMEOUT=3e4}}]),u(n,[{key:"submitOp",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this._doc).submitOp.apply(e,s(Array.from(n||[])))}},{key:"_isAheadOfExpectedVersion",value:function(e){return this._doc.version>0&&e.v>this._doc.version}},{key:"_pushOntoQueue",value:function(e){var t=this;sl_console.log("[processUpdate] push onto queue ".concat(e.v)),this.queuedMessageTimer||(this.queuedMessageTimer=setTimeout((function(){sl_console.log("[processUpdate] queue timeout fired for ".concat(e.v)),t.processUpdateFromServer(e)}),this.INFLIGHT_OP_TIMEOUT)),this.queuedMessages.push(e),this.queuedMessages.sort((function(e,t){return e.v-t.v}))}},{key:"_clearQueue",value:function(){this.queuedMessages=[]}},{key:"_processQueue",value:function(){this.queuedMessages.length>0&&(nextAvailableVersion=this.queuedMessages[0].v,nextAvailableVersion>this._doc.version||(sl_console.log("[processUpdate] taken from queue ".concat(nextAvailableVersion)),this.processUpdateFromServerInOrder(this.queuedMessages.shift()),0===this.queuedMessages.length&&this.queuedMessageTimer&&(sl_console.log("[processUpdate] queue is empty, cleared timeout"),clearTimeout(this.queuedMessageTimer),this.queuedMessageTimer=null)))}},{key:"processUpdateFromServerInOrder",value:function(e){if(this.queuedMessages||(this.queuedMessages=[]),this._isAheadOfExpectedVersion(e))this._pushOntoQueue(e);else{var t=this.processUpdateFromServer(e);t instanceof Error&&"Invalid version from server"===t.message?this._clearQueue():this._processQueue()}}},{key:"processUpdateFromServer",value:function(e){try{this._doc._onMessage(e)}catch(e){return console.log(e),this._handleError(e),e}if("external"===(t=null!=e?e.meta:void 0,n=function(e){return e.type},null!=t?n(t):void 0))return this.trigger("externalUpdate",e);var t,n}},{key:"catchUp",value:function(e){var t=this;return function(){for(var n=[],r=0;r<e.length;r++){var i=e[r];i.v=t._doc.version,i.doc=t.doc_id,n.push(t.processUpdateFromServer(i))}return n}()}},{key:"getSnapshot",value:function(){return this._doc.snapshot}},{key:"getVersion",value:function(){return this._doc.version}},{key:"getType",value:function(){return this.type}},{key:"clearInflightAndPendingOps",value:function(){return this._doc.inflightOp=null,this._doc.inflightCallbacks=[],this._doc.pendingOp=null,this._doc.pendingCallbacks=[]}},{key:"flushPendingOps",value:function(){return this._doc.flush()}},{key:"updateConnectionState",value:function(e){return sl_console.log("[updateConnectionState] Setting state to ".concat(e)),this.connection.state=e,this.connection.id=this.socket.socket.sessionid,this._doc.autoOpen=!1,this._doc._connectionStateChanged(e),this.lastAcked=null}},{key:"hasBufferedOps",value:function(){return null!=this._doc.inflightOp||null!=this._doc.pendingOp}},{key:"getInflightOp",value:function(){return this._doc.inflightOp}},{key:"getPendingOp",value:function(){return this._doc.pendingOp}},{key:"getRecentAck",value:function(){return null!=this.lastAcked&&new Date-this.lastAcked<2*r}},{key:"getOpSize",value:function(e){for(var t=0,n=0,r=Array.from(e||[]);n<r.length;n++){var i=r[n];null!=(null!=i?i.i:void 0)&&(t+=i.i.length),null!=(null!=i?i.d:void 0)&&(t+=i.d.length)}return t}},{key:"attachToAce",value:function(e){return this._doc.attach_ace(e,!1,window.maxDocLength)}},{key:"detachFromAce",value:function(){return"function"==typeof this._doc.detach_ace?this._doc.detach_ace():void 0}},{key:"attachToCM",value:function(e){return this._doc.attach_cm(e,!1)}},{key:"detachFromCM",value:function(){return"function"==typeof this._doc.detach_cm?this._doc.detach_cm():void 0}},{key:"_startInflightOpTimeout",value:function(e){var t=this;this._startFatalTimeoutTimer(e);var n=setTimeout((function n(){if(sl_console.log("[inflightOpTimeout] Trying op again"),null!=t._doc.inflightOp)return e.dupIfSource=[t.connection.id].concat(s(Array.from(t._doc.inflightSubmittedIds))),"ok"!==t.connection.state?(sl_console.log("[inflightOpTimeout] Not connected, retrying in 0.5s"),setTimeout(n,t.WAIT_FOR_CONNECTION_TIMEOUT)):(sl_console.log("[inflightOpTimeout] Sending"),t.connection.send(e))}),this.INFLIGHT_OP_TIMEOUT);return this._doc.inflightCallbacks.push((function(){return t._clearFatalTimeoutTimer(),clearTimeout(n)}))}},{key:"_startFatalTimeoutTimer",value:function(e){var t=this;if(null==this._timeoutTimer)return this._timeoutTimer=setTimeout((function(){return t._clearFatalTimeoutTimer(),t.trigger("op:timeout",e)}),this.FATAL_OP_TIMEOUT)}},{key:"_clearFatalTimeoutTimer",value:function(){if(null!=this._timeoutTimer)return clearTimeout(this._timeoutTimer),this._timeoutTimer=null}},{key:"_handleError",value:function(e,t){return null==t&&(t={}),this.trigger("error",e,t)}},{key:"_bindToDocChanges",value:function(e){var t=this,n=e.submitOp;e.submitOp=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t.trigger.apply(t,["op:sent"].concat(s(Array.from(i)))),e.pendingCallbacks.push((function(){return t.trigger.apply(t,["op:acknowledged"].concat(s(Array.from(i))))})),n.apply(e,i)};var r=e.flush;return e.flush=function(){t.trigger("flush",e.inflightOp,e.pendingOp,e.version);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return r.apply(e,i)}}}]),n}(e)).initClass(),n}.apply(t,r))||(e.exports=i)},function(e,t,n){(function(r){var i,o;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)},c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i=[n(4),n(159)],void 0===(o=function(e,t){var n,r,i,o=void 0;window.sharejs=o={};var s=o.types={};o._bt=r=function(e,t,n,r){var i=void 0;return e.transformX=e.transformX=i=function(e,o){n(e),n(o);var s,a,l,u=[],h=!0,d=!1,f=void 0;try{for(var p,g=Array.from(o)[Symbol.iterator]();!(h=(p=g.next()).done);h=!0){for(var m=p.value,v=[],y=0;y<e.length;){var b,w=[];if(s=e[y],l=w,t(v,s,a=m,"left"),t(l,a,s,"right"),y++,1!==w.length){if(0===w.length){var _=!0,C=!1,S=void 0;try{for(var k,A=Array.from(e.slice(y))[Symbol.iterator]();!(_=(k=A.next()).done);_=!0)b=k.value,r(v,b)}catch(e){C=!0,S=e}finally{try{!_&&A.return&&A.return()}finally{if(C)throw S}}m=null;break}var x=Array.from(i(e.slice(y),w)),$=c(x,2),T=$[0],E=$[1],R=!0,M=!1,L=void 0;try{for(var P,O=Array.from(T)[Symbol.iterator]();!(R=(P=O.next()).done);R=!0)b=P.value,r(v,b)}catch(e){M=!0,L=e}finally{try{!R&&O.return&&O.return()}finally{if(M)throw L}}var D=!0,I=!1,F=void 0;try{for(var j,N=Array.from(E)[Symbol.iterator]();!(D=(j=N.next()).done);D=!0){var B=j.value;r(u,B)}}catch(e){I=!0,F=e}finally{try{!D&&N.return&&N.return()}finally{if(I)throw F}}m=null;break}m=w[0]}null!=m&&r(u,m),e=v}}catch(e){d=!0,f=e}finally{try{!h&&g.return&&g.return()}finally{if(d)throw f}}return[e,u]},e.transform=e.transform=function(e,n,r){if("left"!==r&&"right"!==r)throw new Error("type must be 'left' or 'right'");if(0===n.length)return e;if(1===e.length&&1===n.length)return t([],e[0],n[0],r);if("left"===r){var o,s=Array.from(i(e,n)),a=c(s,2);return o=a[0],a[1],o}var l=Array.from(i(n,e)),u=c(l,2);return u[0],u[1]}};var h={name:"text",create:function(){return""}},d=function(e,t,n){return e.slice(0,t)+n+e.slice(t)},f=function(e){if("number"!=typeof e.p)throw new Error("component missing position field");if(!("string"===l(e.i)^"string"===l(e.d)^"string"===l(e.c)))throw new Error("component needs an i, d or c field");if(!(e.p>=0))throw new Error("position cannot be negative")},p=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=Array.from(e)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;f(s)}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return!0};h.apply=function(e,t){p(t);var n=!0,r=!1,i=void 0;try{for(var o,s=Array.from(t)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;if(null!=a.i)e=d(e,a.p,a.i);else if(null!=a.d){var l=e.slice(a.p,a.p+a.d.length);if(a.d!==l)throw new Error("Delete component '"+a.d+"' does not match deleted text '"+l+"'");e=e.slice(0,a.p)+e.slice(a.p+a.d.length)}else{if(null==a.c)throw new Error("Unknown op type");var c=e.slice(a.p,a.p+a.c.length);if(a.c!==c)throw new Error("Comment component '"+a.c+"' does not match commented text '"+c+"'")}}}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}return e};var g=function(e,t){var n=void 0,r={};for(var i in e)n=e[i],r[i]=n;for(i in t)n=t[i],r[i]=n;return r};h._append=n=function(e,t){if(""!==t.i&&""!==t.d){if(0===e.length)return e.push(t);var n=e[e.length-1];return null!=n.i&&null!=t.i&&n.p<=t.p&&t.p<=n.p+n.i.length&&n.u===t.u?e[e.length-1]=g(n,{i:d(n.i,t.p-n.p,t.i)}):null!=n.d&&null!=t.d&&t.p<=n.p&&n.p<=t.p+t.d.length&&n.u===t.u?e[e.length-1]=g(n,{d:d(t.d,n.p-t.p,n.d),p:t.p}):e.push(t)}},h.compose=function(e,t){p(e),p(t);var r=e.slice(),i=!0,o=!1,s=void 0;try{for(var a,l=Array.from(t)[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var c=a.value;n(r,c)}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return r},h.compress=function(e){return h.compose([],e)},h.normalize=function(e){var t=[];null==e.i&&null==e.p||(e=[e]);var r=!0,i=!1,o=void 0;try{for(var s,a=Array.from(e)[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var l=s.value;null==l.p&&(l.p=0),n(t,l)}}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return t};var m=function(e,t,n){if(null!=t.i)return t.p<e||t.p===e&&n?e+t.i.length:e;if(null!=t.d)return e<=t.p?e:e<=t.p+t.d.length?t.p:e-t.d.length;if(null!=t.c)return e;throw new Error("unknown op type")};h.transformCursor=function(e,t,n){var r="right"===n,i=!0,o=!1,s=void 0;try{for(var a,l=Array.from(t)[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var c=a.value;e=m(e,c,r)}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return e},h._tc=i=function(e,t,r,i){var o=void 0,s=void 0,a=void 0;if(p([t]),p([r]),null!=t.i)n(e,g(t,{p:m(t.p,r,"right"===i)}));else if(null!=t.d)if(null!=r.i){var l=t.d;t.p<r.p&&(n(e,g(t,{d:l.slice(0,r.p-t.p)})),l=l.slice(r.p-t.p)),""!==l&&n(e,g(t,{d:l,p:t.p+r.i.length}))}else if(null!=r.d)if(t.p>=r.p+r.d.length)n(e,g(t,{p:t.p-r.d.length}));else if(t.p+t.d.length<=r.p)n(e,t);else{if(a=g(t,{d:""}),t.p<r.p&&(a.d=t.d.slice(0,r.p-t.p)),t.p+t.d.length>r.p+r.d.length&&(a.d+=t.d.slice(r.p+r.d.length-t.p)),s=Math.max(t.p,r.p),o=Math.min(t.p+t.d.length,r.p+r.d.length),t.d.slice(s-t.p,o-t.p)!==r.d.slice(s-r.p,o-r.p))throw new Error("Delete ops delete different text in the same region of the document");""!==a.d&&(a.p=m(a.p,r),n(e,a))}else{if(null==r.c)throw new Error("unknown op type");n(e,t)}else if(null!=t.c)if(null!=r.i)if(t.p<r.p&&r.p<t.p+t.c.length){var c=r.p-t.p,u=t.c.slice(0,+(c-1)+1||void 0)+r.i+t.c.slice(c);n(e,g(t,{c:u}))}else n(e,g(t,{p:m(t.p,r,!0)}));else if(null!=r.d)if(t.p>=r.p+r.d.length)n(e,g(t,{p:t.p-r.d.length}));else if(t.p+t.c.length<=r.p)n(e,t);else{if(a=g(t,{c:""}),t.p<r.p&&(a.c=t.c.slice(0,r.p-t.p)),t.p+t.c.length>r.p+r.d.length&&(a.c+=t.c.slice(r.p+r.d.length-t.p)),s=Math.max(t.p,r.p),o=Math.min(t.p+t.c.length,r.p+r.d.length),t.c.slice(s-t.p,o-t.p)!==r.d.slice(s-r.p,o-r.p))throw new Error("Delete ops delete different text in the same region of the document");a.p=m(a.p,r),n(e,a)}else{if(null==r.c)throw new Error("unknown op type");n(e,t)}return e};h.invert=function(e){return Array.from(e.slice().reverse()).map((function(e){return function(e){return null!=e.i?{d:e.i,p:e.p}:{i:e.d,p:e.p}}(e)}))},o.types||(o.types={}),r(h,i,p,n),o.types.text=h,h.api={provides:{text:!0},getLength:function(){return this.snapshot.length},getText:function(){return this.snapshot},insert:function(e,t,n,r){var i={p:e,i:t};return n&&(i.u=!0),i=[i],this.submitOp(i,r),i},del:function(e,t,n,r){var i={p:e,d:this.snapshot.slice(e,e+t)};return n&&(i.u=!0),i=[i],this.submitOp(i,r),i},_register:function(){return this.on("remoteop",(function(e){var t=this;return function(){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=Array.from(e)[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var l=s.value;void 0!==l.i?n.push(t.emit("insert",l.p,l.i)):void 0!==l.d?n.push(t.emit("delete",l.p,l.d)):n.push(void 0)}}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}()}))}};var v=function(e){return setTimeout(e,0)},y=function(){function e(){u(this,e)}return a(e,[{key:"on",value:function(e,t){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),this._events[e].push(t),this}},{key:"removeListener",value:function(e,t){var n=this;this._events||(this._events={});for(var r=this._events[e]||(this._events[e]=[]),i=0;i<r.length;)r[i]===t&&(r[i]=void 0),i++;return v((function(){return n._events[e]=Array.from(n._events[e]).filter((function(e){return e}))})),this}},{key:"emit",value:function(e){if(!(null!=this._events?this._events[e]:void 0))return this;for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!0,o=!1,s=void 0;try{for(var a,l=Array.from(this._events[e])[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var c=a.value;c&&c.apply(this,n)}}catch(e){o=!0,s=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw s}}return this}}]),e}();y.mixin=function(e){var t=e.prototype||e;return t.on=y.prototype.on,t.removeListener=y.prototype.removeListener,t.emit=y.prototype.emit,e},o.extendDoc=function(e,t){return b.prototype[e]=t};var b=function(){function e(t,n,r){u(this,e),this.flush=this.flush.bind(this),this.setFlushDelay=this.setFlushDelay.bind(this),this.shout=this.shout.bind(this),this.connection=t,this.name=n,r||(r={}),this.version=r.v,this.snapshot=r.snaphot,r.type&&this._setType(r.type),this.state="closed",this.autoOpen=!1,this._create=r.create,this.inflightOp=null,this.inflightCallbacks=[],this.inflightSubmittedIds=[],this.pendingOp=null,this.pendingCallbacks=[],this.serverOps={}}return a(e,[{key:"_xf",value:function(e,t){return this.type.transformX?this.type.transformX(e,t):[this.type.transform(e,t,"left"),this.type.transform(t,e,"right")]}},{key:"_otApply",value:function(e,t,n){var r=this.snapshot;if(this.snapshot=this.type.apply(this.snapshot,e),this.emit("change",e,r,n),t)return this.emit("remoteop",e,r,n)}},{key:"_connectionStateChanged",value:function(e,t){switch(e){case"disconnected":this.state="closed",this.inflightOp&&this.inflightSubmittedIds.push(this.connection.id),this.emit("closed");break;case"ok":this.autoOpen&&this.open();break;case"stopped":"function"==typeof this._openCallback&&this._openCallback(t)}return this.emit(e,t)}},{key:"_setType",value:function(e){if("string"==typeof e&&(e=s[e]),!e||!e.compose)throw new Error("Support for types without compose() is not implemented");if(this.type=e,e.api){for(var t in e.api){var n=e.api[t];this[t]=n}return"function"==typeof this._register?this._register():void 0}return this.provides={}}},{key:"_onMessage",value:function(e){if(!0===e.open){if(this.state="open",this._create=!1,null==this.created&&(this.created=!!e.create),e.type&&this._setType(e.type),e.create?(this.created=!0,this.snapshot=this.type.create()):(!0!==this.created&&(this.created=!1),void 0!==e.snapshot&&(this.snapshot=e.snapshot)),null!=e.v&&(this.version=e.v),this.inflightOp){var t={doc:this.name,op:this.inflightOp,v:this.version};this.inflightSubmittedIds.length&&(t.dupIfSource=this.inflightSubmittedIds),this.connection.send(t)}else this.flush();return this.emit("open"),"function"==typeof this._openCallback?this._openCallback(null):void 0}if(!1===e.open)return e.error&&("undefined"!=typeof console&&null!==console&&console.error("Could not open document: "+e.error),this.emit("error",e.error),"function"==typeof this._openCallback&&this._openCallback(e.error)),this.state="closed",this.emit("closed"),"function"==typeof this._closeCallback&&this._closeCallback(),this._closeCallback=null;if(null===e.op&&"Op already submitted"===r);else{if(void 0===e.op&&void 0!==e.v||e.op&&Array.from(this.inflightSubmittedIds).includes(e.meta.source)){var n=this.inflightOp;this.inflightOp=null,this.inflightSubmittedIds.length=0,null===this.pendingOp&&this.emit("saved");var r=e.error;if(r){if(this.type.invert){var i=this.type.invert(n);if(this.pendingOp){var o=Array.from(this._xf(this.pendingOp,i)),s=c(o,2);this.pendingOp=s[0],i=s[1]}this._otApply(i,!0,e)}else this.emit("error","Op apply failed ("+r+") and the op could not be reverted");var a=!0,l=!1,u=void 0;try{for(var h,d=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(a=(h=d.next()).done);a=!0)(0,h.value)(r)}catch(e){l=!0,u=e}finally{try{!a&&d.return&&d.return()}finally{if(l)throw u}}}else{if(e.v<this.version)return;if(e.v!==this.version)throw new Error("Invalid version from server");this.serverOps[this.version]=n,this.version++,this.emit("acknowledge",n);var f=!0,p=!1,g=void 0;try{for(var m,v=Array.from(this.inflightCallbacks)[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)(0,m.value)(null,n)}catch(e){p=!0,g=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw g}}}return this.delayedFlush()}if(e.op){if(e.v<this.version)return;if(e.doc!==this.name)return this.emit("error","Expected docName '"+this.name+"' but got "+e.doc);if(e.v!==this.version)return this.emit("error","Expected version "+this.version+" but got "+e.v);var y=e.op;this.serverOps[this.version]=y;var b=y;if(null!==this.inflightOp){var w=Array.from(this._xf(this.inflightOp,b)),_=c(w,2);this.inflightOp=_[0],b=_[1]}if(null!==this.pendingOp){var C=Array.from(this._xf(this.pendingOp,b)),S=c(C,2);this.pendingOp=S[0],b=S[1]}return this.version++,this._otApply(b,!0,e)}if(!e.meta)return"undefined"!=typeof console&&null!==console?console.warn("Unhandled document message:",e):void 0;var k=e.meta,A=k.path,x=k.value;switch(null!=A?A[0]:void 0){case"shout":return this.emit("shout",x);default:return"undefined"!=typeof console&&null!==console?console.warn("Unhandled meta op:",e):void 0}}}},{key:"flush",value:function(){if(this.flushTimeout=null,"ok"===this.connection.state&&null===this.inflightOp&&null!==this.pendingOp){if(this.inflightOp=this.pendingOp,this.inflightCallbacks=this.pendingCallbacks,this.pendingOp=null,this.pendingCallbacks=[],this.emit("flipped_pending_to_inflight"),window.useShareJsHash||window.sl_debugging){var e=Date.now(),n=this.__lastSubmitTimestamp&&e-this.__lastSubmitTimestamp;if(!this.__lastSubmitTimestamp||n>5e3||n<0||window.sl_debugging){var r=t("blob "+this.snapshot.length+"\0"+this.snapshot).toString();this.__lastSubmitTimestamp=e}}var i=this.__lastVersion;return this.__lastVersion=this.version,this.connection.send({doc:this.name,op:this.inflightOp,v:this.version,lastV:i,hash:r})}}},{key:"submitOp",value:function(e,t){null!=this.type.normalize&&(e=this.type.normalize(e));var n=this.snapshot;return this.snapshot=this.type.apply(this.snapshot,e),null!==this.pendingOp?this.pendingOp=this.type.compose(this.pendingOp,e):this.pendingOp=e,t&&this.pendingCallbacks.push(t),this.emit("change",e,n),this.delayedFlush()}},{key:"delayedFlush",value:function(){if(null==this.flushTimeout)return this.flushTimeout=setTimeout(this.flush,this._flushDelay||0)}},{key:"setFlushDelay",value:function(e){return this._flushDelay=e}},{key:"shout",value:function(e){return this.connection.send({doc:this.name,meta:{path:["shout"],value:e}})}},{key:"open",value:function(e){var t=this;if(this.autoOpen=!0,"closed"===this.state){var n={doc:this.name,open:!0};return void 0===this.snapshot&&(n.snapshot=null),this.type&&(n.type=this.type.name),null!=this.version&&(n.v=this.version),this._create&&(n.create=!0),this.connection.send(n),this.state="opening",this._openCallback=function(n){return t._openCallback=null,"function"==typeof e?e(n):void 0}}}},{key:"close",value:function(e){return this.autoOpen=!1,"closed"===this.state?"function"==typeof e?e():void 0:(this.connection.send({doc:this.name,open:!1}),this.state="closed",this.emit("closing"),this._closeCallback=e)}}]),e}();y.mixin(b),o.Doc=b;var w=ace.require("ace/range").Range;window.sharejs.extendDoc("attach_ace",(function(e,t,n){if(!this.provides.text)throw new Error("Only text documents can be attached to ace");var r=this,i=e.getSession().getDocument();i.setNewLineMode("unix");var o=function(){return window.setTimeout((function(){var e=i.getValue(),t=r.getText();if(e!==t)return r.emit("error","Text does not match in ace"),console.error("Text does not match!"),console.error("editor: "+e),console.error("ot:     "+t)}),0)};t?(r.del(0,r.getText().length),r.insert(0,i.getValue())):i.setValue(r.getText()),o();var s=!1,a=function(t){if(!s){if(!(null!=n&&i.getValue().length>n)){var a=!(!e.getSession().$fromUndo&&!e.getSession().$fromReject);return function(e,t,n,r){var i=function(t){for(var n=e.getLines(0,t.row),r=0,i=0;i<n.length;i++){var o=n[i];r+=i<t.row?o.length:t.column}return r+t.row}(t.start);switch(t.action){case"insert":h=t.lines.join("\n"),n.insert(i,h,r);break;case"remove":h=t.lines.join("\n"),n.del(i,h.length,r);break;default:throw new Error("unknown action: "+t.action)}}(i,t,r,a),o()}r.emit("error",new Error("document length is greater than maxDocLength"))}};i.on("change",a);var l=function(e){var t=i.getAllLines(),n=0;for(n=0;n<t.length;n++){if(e<=t[n].length)break;e-=t[n].length+1}return{row:n,column:e}},c=function(e,t){i.getLength()<=1&&i.$detectNewLine(t);var n=i.$split(t),r=l(e),a=i.clippedPos(r.row,r.column),c={row:a.row+n.length-1,column:(1===n.length?a.column:0)+n[n.length-1].length};return s=!0,i.applyDelta({start:a,end:c,action:"insert",lines:n,remote:!0}),s=!1,o()},u=function(e,t){var n=w.fromPoints(l(e),l(e+t.length)),r=i.clippedPos(n.start.row,n.start.column),a=i.clippedPos(n.end.row,n.end.column);return s=!0,i.applyDelta({start:r,end:a,action:"remove",lines:i.getLinesForRange({start:r,end:a}),remote:!0}),s=!1,o()};r.on("insert",c),r.on("delete",u),r.detach_ace=function(){return r.removeListener("insert",c),r.removeListener("delete",u),i.removeListener("change",a),delete r.detach_ace}}));return window.sharejs.extendDoc("attach_cm",(function(e,t){if(!this.provides.text)throw new Error("Only text documents can be attached to CodeMirror2");var n=this,r=e.getDoc(),i=function(){return window.setTimeout((function(){var t=e.getValue(),r=n.getText();if(t!==r)return n.emit("error","Text does not match in CodeMirror"),console.error("Text does not match!"),console.error("editor: "+t),console.error("ot:     "+r)}),0)};t?(this.del(0,n.getText().length),this.insert(0,e.getValue())):e.setValue(n.getText()),i();var o=!1,s=function(e,t){if(!o){var r="undo"===t.origin;return function(e,t,n,r){for(var i=0,o=0,s=n.snapshot.split("\n",t.from.line);o<t.from.line;)i+=s[o].length+1,o++;if(i+=t.from.ch,t.removed&&n.del(i,t.removed.join("\n").length,r),t.text)n.insert(i,t.text.join("\n"),r)}(0,t,n,r),i()}};r.on("change",s);var a=function(t,n){return o=!0,e.replaceRange(n,e.posFromIndex(t)),e.clearHistory(),o=!1,i()},l=function(t,n){o=!0;var r=e.posFromIndex(t),s=e.posFromIndex(t+n.length);return e.replaceRange("",r,s),e.clearHistory(),o=!1,i()};this.on("insert",a),this.on("delete",l),this.detach_cm=function(){return this.removeListener("insert",a),this.removeListener("delete",l),r.off("change",s),delete this.detach_cm}})),window.sharejs}.apply(t,i))||(e.exports=o)}).call(this,n(45))},function(e,t,n){var r,i,o,s,a,l,c,u;e.exports=(u=n(58),i=(r=u).lib,o=i.WordArray,s=i.Hasher,a=r.algo,l=[],c=a.SHA1=s.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=0;c<80;c++){if(c<16)l[c]=0|e[t+c];else{var u=l[c-3]^l[c-8]^l[c-14]^l[c-16];l[c]=u<<1|u>>>31}var h=(r<<5|r>>>27)+a+l[c];h+=c<20?1518500249+(i&o|~i&s):c<40?1859775393+(i^o^s):c<60?(i&o|i&s|o&s)-1894007588:(i^o^s)-899497514,a=s,s=o,o=i<<30|i>>>2,i=r,r=h}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=s._createHelper(c),r.HmacSHA1=s._createHmacHelper(c),u.SHA1)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.component("spellMenu",{bindings:{open:"<",top:"<",left:"<",layoutFromBottom:"<",highlight:"<",replaceWord:"&",learnWord:"&"},template:'<div\n  class="dropdown context-menu spell-check-menu"\n  ng-show="$ctrl.open"\n  ng-style="{top: $ctrl.top, left: $ctrl.left}"\n  ng-class="{open: $ctrl.open, \'spell-check-menu-from-bottom\': $ctrl.layoutFromBottom}"\n>\n  <ul class="dropdown-menu">\n    <li ng-repeat="suggestion in $ctrl.highlight.suggestions | limitTo:8">\n      <a\n        href\n        ng-click="$ctrl.replaceWord({ highlight: $ctrl.highlight, suggestion: suggestion })"\n      >\n        {{ suggestion }}\n      </a>\n    </li>\n    <li class="divider"></li>\n    <li>\n      <a href ng-click="$ctrl.learnWord({ highlight: $ctrl.highlight })">Add to Dictionary</a>\n    </li>\n  </ul>\n</div>'})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r=[n(0),n(4),n(162),n(163),n(164),n(165),n(166),n(69),n(171),n(173),n(70),n(174),n(71),n(175),n(176),n(177),n(178),n(179),n(180)],void 0===(i=function(e,t,n,r,i,s,a,l,c,u,h,d,f,p,g){var m,v=ace.require("ace/edit_session").EditSession,y=ace.require("ace/ext/modelist"),b=ace.require("ace/keyboard/vim").Vim,w=ace.require("ace/ext/searchbox");""!==window.aceBasePath?(m=!0,ace.config.set("basePath","".concat(window.aceBasePath))):m=!1,ace.config.setDefaultValue("session","useWorker",!1),null==ace.config._moduleUrl&&(ace.config._moduleUrl=ace.config.moduleUrl,ace.config.moduleUrl=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(e=ace.config)._moduleUrl.apply(e,o(Array.from(n||[])));return i}),e.directive("aceEditor",["$timeout","$compile","$rootScope","eventTracking","localStorage","$cacheFactory","metadata","graphics","preamble","files","$http","$q","$window",function(e,t,n,r,i,o,C,S,k,A,x,T,E){return function(e,t){$("#ace_searchbox").remove();var n=w.SearchBox,r=n.prototype.$init;n.prototype.$init=function(){return this.element=t('<div class="ace_search right">\n\t<a href type="button" action="hide" class="ace_searchbtn_close">\n\t\t<i class="fa fa-fw fa-times"></i>\n\t</a>\n\t<div class="ace_search_form">\n\t\t<input class="ace_search_field form-control input-sm" placeholder="Search for" spellcheck="false"></input>\n\t\t<div class="btn-group">\n\t\t\t<button type="button" action="findNext" class="ace_searchbtn next btn btn-default btn-sm">\n\t\t\t\t<i class="fa fa-chevron-down fa-fw"></i>\n\t\t\t</button>\n\t\t\t<button type="button" action="findPrev" class="ace_searchbtn prev btn btn-default btn-sm">\n\t\t\t\t<i class="fa fa-chevron-up fa-fw"></i>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<div class="ace_replace_form">\n\t\t<input class="ace_search_field form-control input-sm" placeholder="Replace with" spellcheck="false"></input>\n\t\t<div class="btn-group">\n\t\t\t<button type="button" action="replaceAndFindNext" class="ace_replacebtn btn btn-default btn-sm">Replace</button>\n\t\t\t<button type="button" action="replaceAll" class="ace_replacebtn btn btn-default btn-sm">All</button>\n\t\t</div>\n\t</div>\n\t<div class="ace_search_options">\n\t\t<div class="btn-group">\n\t\t\t<button action="toggleRegexpMode" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="RegExp Search">.*</button>\n\t\t\t<button action="toggleCaseSensitive" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="CaseSensitive Search">Aa</button>\n\t\t\t<button action="toggleWholeWords" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="Whole Word Search">"..."</button>\n\t\t\t<button action="searchInSelection" class="btn btn-default btn-sm" tooltip-placement="bottom" tooltip-append-to-body="true" tooltip="Search Within Selection"><i class="fa fa-align-left"></i></button>\n\t\t</div>\n\t\t<span class="ace_search_counter"></span>\n\t</div>\n\t<div action="toggleReplace" class="hidden"></div>\n</div>')(e.$new())[0],r.apply(this)}}(n,t),{scope:{theme:"=",showPrintMargin:"=",keybindings:"=",fontSize:"=",autoComplete:"=",autoPairDelimiters:"=",sharejsDoc:"=",spellCheck:"=",spellCheckLanguage:"=",highlights:"=",text:"=",readOnly:"=",annotations:"=",navigateHighlights:"=",fileName:"=",onCtrlEnter:"=",onCtrlJ:"=",onCtrlShiftC:"=",onCtrlShiftA:"=",onSave:"=",syntaxValidation:"=",reviewPanel:"=",eventsBridge:"=",trackChanges:"=",docId:"=",rendererData:"=",lineHeight:"=",fontFamily:"="},link:function(e,t,R){var M;e.$originalApply=e.$apply,e.$apply=function(e){null==e&&(e=function(){});var t=this.$root.$$phase;return"$apply"===t||"$digest"===t?e():this.$originalApply(e)};var L=ace.edit(t.find(".ace-editor-body")[0]);if(L.$blockScrolling=1/0,L.setOption("behavioursEnabled",e.autoPairDelimiters||!1),L.setOption("wrapBehavioursEnabled",!1),e.$watch("autoPairDelimiters",(function(e){return e?L.setOption("behavioursEnabled",!0):L.setOption("behavioursEnabled",!1)})),window._debug_editors||(window._debug_editors=[]),window._debug_editors.push(L),e.name=R.aceEditor,e.spellCheck){var P=o.get("spellCheck-".concat(e.name))||o("spellCheck-".concat(e.name),{capacity:1e3});M=new l(e,P,x,T,new c(L))}var O=new s(L),D=(new u(e,L,t),new h(e,new d(L),i)),I=new f(e,L,t,new p(L)),F=new g(e,L,t,C),j=(new a(e,L,t,F,S,k,A),/[\0\uD800-\uDFFF]/g);L.commands.on("exec",(function(e){e.command&&"paste"===e.command.name&&e.args&&j.test(e.args.text)&&(e.args.text=e.args.text.replace(j,"�")),e.command&&"insertstring"===e.command.name&&e.args&&j.test(e.args)&&(e.args=e.args.replace(j,"�"))})),e.$watch("onSave",(function(e){if(null!=e)return b.defineEx("write","w",e),L.commands.addCommand({name:"save",bindKey:{win:"Ctrl-S",mac:"Command-S"},exec:e,readOnly:!0}),L.commands.addCommand({name:"recompile_v1",bindKey:{win:"Ctrl-.",mac:"Ctrl-."},exec:e,readOnly:!0})})),L.commands.removeCommand("transposeletters"),L.commands.removeCommand("showSettingsMenu"),L.commands.removeCommand("foldall"),L.commands.removeCommand("toggleBlockComment"),L.commands.removeCommand("togglecomment"),L.commands.addCommand({name:"togglecomment",bindKey:{win:"Ctrl-/|Ctrl-Shift-7",mac:"Command-/|Command-Shift-/"},exec:function(e){return e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"}),L.commands.addCommand({name:"find",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(e){return w.Search(e,!0)},readOnly:!0}),L.commands.addCommand({name:"bold",bindKey:{win:"Ctrl-B",mac:"Command-B"},exec:function(e){if(e.getSelection().isEmpty())return e.insert("\\textbf{}"),e.navigateLeft(1);var t=e.getCopyText();return e.insert("\\textbf{".concat(t,"}"))},readOnly:!1}),L.commands.addCommand({name:"italics",bindKey:{win:"Ctrl-I",mac:"Command-I"},exec:function(e){if(e.getSelection().isEmpty())return e.insert("\\textit{}"),e.navigateLeft(1);var t=e.getCopyText();return e.insert("\\textit{".concat(t,"}"))},readOnly:!1}),e.$watch("onCtrlEnter",(function(e){if(null!=e)return L.commands.addCommand({name:"compile",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(t){return e()},readOnly:!0})})),e.$watch("onCtrlJ",(function(e){if(null!=e)return L.commands.addCommand({name:"toggle-review-panel",bindKey:{win:"Ctrl-J",mac:"Command-J"},exec:function(t){return e()},readOnly:!0})})),e.$watch("onCtrlShiftC",(function(e){if(null!=e)return L.commands.addCommand({name:"add-new-comment",bindKey:{win:"Ctrl-Shift-C",mac:"Command-Shift-C"},exec:function(t){return e()},readOnly:!0})})),e.$watch("onCtrlShiftA",(function(e){if(null!=e)return L.commands.addCommand({name:"toggle-track-changes",bindKey:{win:"Ctrl-Shift-A",mac:"Command-Shift-A"},exec:function(t){return e()},readOnly:!0})})),L.showCommandLine=function(e){if("/"===e)return w.Search(L,!0)};var N=function(){var e=L.getSession(),t=e.selection.getCursor();return e.documentToScreenPosition(t.row,t.column).row*L.renderer.lineHeight-e.getScrollTop()};if(null!=R.resizeOn)for(var B=0,H=Array.from(R.resizeOn.split(","));B<H.length;B++){var z=H[B];e.$on(z,(function(){e.$applyAsync((function(){var e=N();L.resize();var t=N(),n=L.getSession();return n.setScrollTop(n.getScrollTop()+t-e)}))}))}e.$on("".concat(e.name,":set-scroll-size"),(function(e,t){var n=t.overflowTop,r=L.renderer.layerConfig.maxHeight,i=Math.max(t.height-r,0);return W(n,i)}));var W=function(e,t){var n=!1;if(L.renderer.scrollMargin.top!==e&&(L.renderer.scrollMargin.top=e,n=!0),L.renderer.scrollMargin.bottom!==t&&(L.renderer.scrollMargin.bottom=t,n=!0),n)return L.renderer.updateFull()};e.$watch("theme",(function(e){return L.setTheme("ace/theme/".concat(e))})),e.$watch("showPrintMargin",(function(e){return L.setShowPrintMargin(e)})),e.$watch("keybindings",(function(e){return["vim","emacs"].includes(e)?L.setKeyboardHandler("ace/keyboard/".concat(e)):L.setKeyboardHandler(null)})),e.$watch("fontSize",(function(e){return t.find(".ace_editor, .ace_content").css({"font-size":e+"px"})})),e.$watch("fontFamily",(function(e){if(null!=e)switch(e){case"monaco":return L.setOption("fontFamily",["Monaco","Menlo","Ubuntu Mono","Consolas","source-code-pro","monospace"].join(", "));case"lucida":return L.setOption("fontFamily",'"Lucida Console", monospace');default:return L.setOption("fontFamily",null)}})),e.$watch("lineHeight",(function(e){if(null!=e){switch(e){case"compact":L.container.style.lineHeight=1.33;break;case"normal":L.container.style.lineHeight=1.6;break;case"wide":L.container.style.lineHeight=2;break;default:L.container.style.lineHeight=1.6}return L.renderer.updateFontSize()}})),e.$watch("sharejsDoc",(function(t,n){if(null!=n&&(e.$broadcast("beforeChangeDocument"),ee(n)),null!=t&&Z(t),null!=t&&null!=n)return e.$broadcast("afterChangeDocument")})),e.$watch("text",(function(e){if(null!=e)return L.setValue(e,-1),L.getSession().setUseWrapMode(!0)})),e.$watch("annotations",(function(e){return L.getSession().setAnnotations(e)})),e.$watch("readOnly",(function(e){return L.setReadOnly(!!e)})),e.$watch("syntaxValidation",(function(e){if(null!=e&&m)return L.getSession().setOption("useWorker",e)})),L.setOption("scrollPastEnd",!0);var U=0,V=function(){return 100===++U&&r.send("editor-interaction","multi-doc-update"),e.$emit("".concat(e.name,":change"))},q=function(t){if(null!=e.eventsBridge){var n=L.renderer.layerConfig.maxHeight;return e.eventsBridge.emit("aceScroll",t,n)}};null!=e.eventsBridge&&(L.renderer.on("scrollbarVisibilityChanged",(function(t,n){if(null!=e.eventsBridge)return e.eventsBridge.emit("aceScrollbarVisibilityChanged",n.scrollBarV.isVisible,n.scrollBarV.width)})),e.eventsBridge.on("externalScroll",(function(e){return L.getSession().setScrollTop(e)})),e.eventsBridge.on("refreshScrollPosition",(function(){var e=L.getSession();return e.setScrollTop(e.getScrollTop()+1),e.setScrollTop(e.getScrollTop()-1)})));var G=function(e){return M.onSessionChange(),null!=e.oldSession&&e.oldSession.getDocument().off("change",M.onChange),e.session.getDocument().on("change",M.onChange),null!=e.oldSession&&e.oldSession.off("changeScrollTop",M.onScroll),e.session.on("changeScrollTop",M.onScroll)},K=function(){if(M)return L.off("changeSession",G),L.off("nativecontextmenu",M.onContextMenu)},X=function(){L.off("change",O.onChange)},Y=function(e){return null!=e.oldSession&&e.oldSession.selection.off("changeCursor",D.onCursorChange),e.session.selection.on("changeCursor",D.onCursorChange)},J=function(){return D.onUnload(L.getSession())};L.on("changeSession",Y),Y({session:L.getSession()}),$(window).on("unload",J);var Q=_.once((function(){return e.$broadcast("editorInit")})),Z=function(t){var i,o=t.getSnapshot().split("\n"),s=L.getSession();null!=s&&s.destroy();try{if(/\.(Rtex|bbl|tikz)$/i.test(e.fileName))i="ace/mode/latex";else if(/\.(sty|cls|clo)$/.test(e.fileName))i="ace/mode/tex";else{"ace/mode/text"===(i=y.getModeForPath(e.fileName).mode)&&(i="ace/mode/plain_text")}}catch(e){i="ace/mode/plain_text"}return(s=new v(o,i)).setUseWrapMode(!0),null!=e.syntaxValidation&&m&&!/\.bib$/.test(e.fileName)&&s.setOption("useWorker",e.syntaxValidation),L.setReadOnly(!0),L.setSession(s),s.getDocument().on("change",V),L.initing=!0,t.attachToAce(L),L.initing=!1,L.setReadOnly(e.readOnly),Q(),e.readOnly||function(){if(M)M.init(),L.on("changeSession",G),G({session:L.getSession()}),L.on("nativecontextmenu",M.onContextMenu)}(),I.rangesTracker=e.sharejsDoc.ranges,I.onChangeSession(),I&&(L.on("changeSelection",I.onChangeSelection),L.on("change",I.onChangeSelection),L.on("changeSession",I.onChangeSession),L.on("cut",I.onCut),L.on("paste",I.onPaste),L.renderer.on("resize",I.onResize)),O.onChangeSession(L.getSession()),L.on("change",O.onChange),W(0,0),s.setAnnotations(e.annotations),s.on("changeScrollTop",r.editingSessionHeartbeat),angular.element(E).on("click",r.editingSessionHeartbeat),e.$on("$destroy",(function(){return angular.element(E).off("click",r.editingSessionHeartbeat)})),null!=e.eventsBridge&&s.on("changeScrollTop",q),n.hasLintingError=!1,s.on("changeAnnotation",(function(){var e=s.getAnnotations().filter((function(e){return"info"!==e.type})).length>0;if(n.hasLintingError!==e)return n.hasLintingError=e})),setTimeout((function(){return q(L.renderer.getScrollTop())})),L.focus()},ee=function(e){K(),function(){I&&(this.trackChangesManager.tearDown(),L.off("changeSelection",I.onChangeSelection),L.off("change",I.onChangeSelection),L.off("changeSession",I.onChangeSession),L.off("cut",I.onCut),L.off("paste",I.onPaste),L.renderer.off("resize",I.onResize))}(),X(),e.detachFromAce(),e.off("remoteop.recordRemote");var t=L.getSession();return t.off("changeScrollTop"),t.getDocument().off("change",V)};return null!=e.rendererData&&L.renderer.on("changeCharacterSize",(function(){e.$apply((function(){return e.rendererData.lineHeight=L.renderer.lineHeight}))})),e.$watch("rendererData",(function(e){if(null!=e)return e.lineHeight=L.renderer.lineHeight})),e.$on("$destroy",(function(){if(null!=e.sharejsDoc){e.$broadcast("changeEditor"),K(),L.off("changeSession",Y),$(window).off("unload",J),X(),ee(e.sharejsDoc);var t=L.getSession();return null!=t&&t.destroy(),e.eventsBridge.emit("aceScrollbarVisibilityChanged",!1,0)}})),e.$emit("".concat(e.name,":inited"),L)},template:'<div class="ace-editor-wrapper">\n\t<div\n\t\tclass="undo-conflict-warning alert alert-danger small"\n\t\tng-show="undo.show_remote_warning"\n\t>\n\t\t<strong>Watch out!</strong>\n\t\tWe had to undo some of your collaborators changes before we could undo yours.\n\t\t<a\n\t\t\thref="#"\n\t\t\tclass="pull-right"\n\t\t\tng-click="undo.show_remote_warning = false"\n\t\t>Dismiss</a>\n\t</div>\n\t<div class="ace-editor-body"></div>\n\t<spell-menu\n\t\topen="spellMenu.open"\n\t\ttop="spellMenu.top"\n\t\tleft="spellMenu.left"\n\t\tlayout-from-bottom="spellMenu.layoutFromBottom"\n\t\thighlight="spellMenu.highlight"\n\t\treplace-word="replaceWord(highlight, suggestion)"\n\t\tlearn-word="learnWord(highlight)"\n\t></spell-menu>\n\t<div\n\t\tclass="annotation-label"\n\t\tng-show="annotationLabel.show"\n\t\tng-style="{\n\t\t\tposition: \'absolute\',\n\t\t\tleft:     annotationLabel.left,\n\t\t\tright:    annotationLabel.right,\n\t\t\tbottom:   annotationLabel.bottom,\n\t\t\ttop:      annotationLabel.top,\n\t\t\t\'background-color\': annotationLabel.backgroundColor\n\t\t}"\n\t>\n\t\t{{ annotationLabel.text }}\n\t</div>\n\n\t<a\n\t\thref\n\t\tclass="highlights-before-label btn btn-info btn-xs"\n\t\tng-show="updateLabels.highlightsBefore > 0"\n\t\tng-click="gotoHighlightAbove()"\n\t>\n\t\t<i class="fa fa-fw fa-arrow-up"></i>\n\t\t{{ updateLabels.highlightsBefore }} more update{{ updateLabels.highlightsBefore > 1 && "" || "s" }} above\n\t</a>\n\n\t<a\n\t\thref\n\t\tclass="highlights-after-label btn btn-info btn-xs"\n\t\tng-show="updateLabels.highlightsAfter > 0"\n\t\tng-click="gotoHighlightBelow()"\n\t>\n\t\t<i class="fa fa-fw fa-arrow-down"></i>\n\t\t{{ updateLabels.highlightsAfter }} more update{{ updateLabels.highlightsAfter > 1 && "" || "s" }} below\n\n\t</a>\n</div>'}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ace.define("ace/ext/searchbox",[],(function(e,t,n){"use strict";var r=e("../lib/dom"),i=e("../lib/lang"),o=e("../lib/event"),s=e("../keyboard/hash_handler").HashHandler,a=e("../lib/keys");r.importCssString('.ace_search {background-color: #ddd;color: #666;border: 1px solid #cbcbcb;border-top: 0 none;overflow: hidden;margin: 0;padding: 4px 6px 0 4px;position: absolute;top: 0;z-index: 99;white-space: normal;}.ace_search.left {border-left: 0 none;border-radius: 0px 0px 5px 0px;left: 0;}.ace_search.right {border-radius: 0px 0px 0px 5px;border-right: 0 none;right: 0;}.ace_search_form, .ace_replace_form {margin: 0 20px 4px 0;overflow: hidden;line-height: 1.9;}.ace_replace_form {margin-right: 0;}.ace_search_form.ace_nomatch {outline: 1px solid red;}.ace_search_field {border-radius: 3px 0 0 3px;background-color: white;color: black;border: 1px solid #cbcbcb;border-right: 0 none;outline: 0;padding: 0;font-size: inherit;margin: 0;line-height: inherit;padding: 0 6px;min-width: 17em;vertical-align: top;min-height: 1.8em;box-sizing: content-box;}.ace_searchbtn {border: 1px solid #cbcbcb;line-height: inherit;display: inline-block;padding: 0 6px;background: #fff;border-right: 0 none;border-left: 1px solid #dcdcdc;cursor: pointer;margin: 0;position: relative;color: #666;}.ace_searchbtn:last-child {border-radius: 0 3px 3px 0;border-right: 1px solid #cbcbcb;}.ace_searchbtn:disabled {background: none;cursor: default;}.ace_searchbtn:hover {background-color: #eef1f6;}.ace_searchbtn.prev, .ace_searchbtn.next {padding: 0px 0.7em}.ace_searchbtn.prev:after, .ace_searchbtn.next:after {content: "";border: solid 2px #888;width: 0.5em;height: 0.5em;border-width:  2px 0 0 2px;display:inline-block;transform: rotate(-45deg);}.ace_searchbtn.next:after {border-width: 0 2px 2px 0 ;}.ace_searchbtn_close {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAcCAYAAABRVo5BAAAAZ0lEQVR42u2SUQrAMAhDvazn8OjZBilCkYVVxiis8H4CT0VrAJb4WHT3C5xU2a2IQZXJjiQIRMdkEoJ5Q2yMqpfDIo+XY4k6h+YXOyKqTIj5REaxloNAd0xiKmAtsTHqW8sR2W5f7gCu5nWFUpVjZwAAAABJRU5ErkJggg==) no-repeat 50% 0;border-radius: 50%;border: 0 none;color: #656565;cursor: pointer;font: 16px/16px Arial;padding: 0;height: 14px;width: 14px;top: 9px;right: 7px;position: absolute;}.ace_searchbtn_close:hover {background-color: #656565;background-position: 50% 100%;color: white;}.ace_button {margin-left: 2px;cursor: pointer;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;overflow: hidden;opacity: 0.7;border: 1px solid rgba(100,100,100,0.23);padding: 1px;box-sizing:    border-box!important;color: black;}.ace_button:hover {background-color: #eee;opacity:1;}.ace_button:active {background-color: #ddd;}.ace_button.checked {border-color: #3399ff;opacity:1;}.ace_search_options{margin-bottom: 3px;text-align: right;-webkit-user-select: none;-moz-user-select: none;-o-user-select: none;-ms-user-select: none;user-select: none;clear: both;}.ace_search_counter {float: left;font-family: arial;padding: 0 8px;}',"ace_searchbox");var l=function(e,t,n){var i=r.createElement("div");r.buildDom(["div",{class:"ace_search right"},["span",{action:"hide",class:"ace_searchbtn_close"}],["div",{class:"ace_search_form"},["input",{class:"ace_search_field",placeholder:"Search for",spellcheck:"false"}],["span",{action:"findPrev",class:"ace_searchbtn prev"},"​"],["span",{action:"findNext",class:"ace_searchbtn next"},"​"],["span",{action:"findAll",class:"ace_searchbtn",title:"Alt-Enter"},"All"]],["div",{class:"ace_replace_form"},["input",{class:"ace_search_field",placeholder:"Replace with",spellcheck:"false"}],["span",{action:"replaceAndFindNext",class:"ace_searchbtn"},"Replace"],["span",{action:"replaceAll",class:"ace_searchbtn"},"All"]],["div",{class:"ace_search_options"},["span",{action:"toggleReplace",class:"ace_button",title:"Toggle Replace mode",style:"float:left;margin-top:-2px;padding:0 5px;"},"+"],["span",{class:"ace_search_counter"}],["span",{action:"toggleRegexpMode",class:"ace_button",title:"RegExp Search"},".*"],["span",{action:"toggleCaseSensitive",class:"ace_button",title:"CaseSensitive Search"},"Aa"],["span",{action:"toggleWholeWords",class:"ace_button",title:"Whole Word Search"},"\\b"],["span",{action:"searchInSelection",class:"ace_button",title:"Search In Selection"},"S"]]],i),this.element=i.firstChild,this.setSession=this.setSession.bind(this),this.$init(),this.setEditor(e)};(function(){this.setEditor=function(e){e.searchBox=this,e.renderer.scroller.appendChild(this.element),this.editor=e},this.setSession=function(e){this.searchRange=null,this.$syncOptions(!0)},this.$initElements=function(e){this.searchBox=e.querySelector(".ace_search_form"),this.replaceBox=e.querySelector(".ace_replace_form"),this.searchOption=e.querySelector("[action=searchInSelection]"),this.replaceOption=e.querySelector("[action=toggleReplace]"),this.regExpOption=e.querySelector("[action=toggleRegexpMode]"),this.caseSensitiveOption=e.querySelector("[action=toggleCaseSensitive]"),this.wholeWordOption=e.querySelector("[action=toggleWholeWords]"),this.searchInput=this.searchBox.querySelector(".ace_search_field"),this.replaceInput=this.replaceBox.querySelector(".ace_search_field"),this.searchCounter=e.querySelector(".ace_search_counter")},this.$init=function(){var e=this.element;this.$initElements(e);var t=this;o.addListener(e,"mousedown",(function(e){setTimeout((function(){t.activeInput.focus()}),0),o.stopPropagation(e)})),o.addListener(e,"click",(function(e){var n=(e.target||e.srcElement).getAttribute("action");n&&t[n]?t[n]():t.$searchBarKb.commands[n]&&t.$searchBarKb.commands[n].exec(t),o.stopPropagation(e)})),o.addCommandKeyListener(e,(function(e,n,r){var i=a.keyCodeToString(r),s=t.$searchBarKb.findKeyCommand(n,i);s&&s.exec&&(s.exec(t),o.stopEvent(e))})),this.$onChange=i.delayedCall((function(){t.find(!1,!1)})),o.addListener(this.searchInput,"input",(function(){t.$onChange.schedule(20)})),o.addListener(this.searchInput,"focus",(function(){t.activeInput=t.searchInput,t.searchInput.value&&t.highlight()})),o.addListener(this.replaceInput,"focus",(function(){t.activeInput=t.replaceInput,t.searchInput.value&&t.highlight()}))},this.$closeSearchBarKb=new s([{bindKey:"Esc",name:"closeSearchBar",exec:function(e){e.searchBox.hide()}}]),this.$searchBarKb=new s,this.$searchBarKb.bindKeys({"Ctrl-f|Command-f":function(e){var t=e.isReplace=!e.isReplace;e.replaceBox.style.display=t?"":"none",e.replaceOption.checked=!1,e.$syncOptions(),e.searchInput.focus()},"Ctrl-H|Command-Option-F":function(e){e.editor.getReadOnly()||(e.replaceOption.checked=!0,e.$syncOptions(),e.replaceInput.focus())},"Ctrl-G|Command-G":function(e){e.findNext()},"Ctrl-Shift-G|Command-Shift-G":function(e){e.findPrev()},esc:function(e){setTimeout((function(){e.hide()}))},Return:function(e){e.activeInput==e.replaceInput&&e.replace(),e.findNext()},"Shift-Return":function(e){e.activeInput==e.replaceInput&&e.replace(),e.findPrev()},"Alt-Return":function(e){e.activeInput==e.replaceInput&&e.replaceAll(),e.findAll()},Tab:function(e){(e.activeInput==e.replaceInput?e.searchInput:e.replaceInput).focus()}}),this.$searchBarKb.addCommands([{name:"toggleRegexpMode",bindKey:{win:"Alt-R|Alt-/",mac:"Ctrl-Alt-R|Ctrl-Alt-/"},exec:function(e){e.regExpOption.checked=!e.regExpOption.checked,e.$syncOptions()}},{name:"toggleCaseSensitive",bindKey:{win:"Alt-C|Alt-I",mac:"Ctrl-Alt-R|Ctrl-Alt-I"},exec:function(e){e.caseSensitiveOption.checked=!e.caseSensitiveOption.checked,e.$syncOptions()}},{name:"toggleWholeWords",bindKey:{win:"Alt-B|Alt-W",mac:"Ctrl-Alt-B|Ctrl-Alt-W"},exec:function(e){e.wholeWordOption.checked=!e.wholeWordOption.checked,e.$syncOptions()}},{name:"toggleReplace",exec:function(e){e.replaceOption.checked=!e.replaceOption.checked,e.$syncOptions()}},{name:"searchInSelection",exec:function(e){e.searchOption.checked=!e.searchRange,e.setSearchRange(e.searchOption.checked&&e.editor.getSelectionRange()),e.$syncOptions()}}]),this.setSearchRange=function(e){this.searchRange=e,e?this.searchRangeMarker=this.editor.session.addMarker(e,"ace_active-line"):this.searchRangeMarker&&(this.editor.session.removeMarker(this.searchRangeMarker),this.searchRangeMarker=null)},this.$syncOptions=function(e){r.setCssClass(this.replaceOption,"checked",this.searchRange),r.setCssClass(this.searchOption,"checked",this.searchOption.checked),this.replaceOption.textContent=this.replaceOption.checked?"-":"+",r.setCssClass(this.regExpOption,"checked",this.regExpOption.checked),r.setCssClass(this.wholeWordOption,"checked",this.wholeWordOption.checked),r.setCssClass(this.caseSensitiveOption,"checked",this.caseSensitiveOption.checked);var t=this.editor.getReadOnly();this.replaceOption.style.display=t?"none":"",this.replaceBox.style.display=this.replaceOption.checked&&!t?"":"none",this.find(!1,!1,e)},this.highlight=function(e){this.editor.session.highlight(e||this.editor.$search.$options.re),this.editor.renderer.updateBackMarkers()},this.find=function(e,t,n){var i=!this.editor.find(this.searchInput.value,{skipCurrent:e,backwards:t,wrap:!0,regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked,preventScroll:n,range:this.searchRange})&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",i),this.editor._emit("findSearchBox",{match:!i}),this.highlight(),this.updateCounter()},this.updateCounter=function(){var e=this.editor,t=e.$search.$options.re,n=0,r=0;if(t){var i=this.searchRange?e.session.getTextRange(this.searchRange):e.getValue(),o=e.session.doc.positionToIndex(e.selection.anchor);this.searchRange&&(o-=e.session.doc.positionToIndex(this.searchRange.start));for(var s,a=t.lastIndex=0;(s=t.exec(i))&&(n++,(a=s.index)<=o&&r++,!(n>999))&&(s[0]||(t.lastIndex=a+=1,!(a>=i.length))););}this.searchCounter.textContent=r+" of "+(n>999?"999+":n)},this.findNext=function(){this.find(!0,!1)},this.findPrev=function(){this.find(!0,!0)},this.findAll=function(){var e=!this.editor.findAll(this.searchInput.value,{regExp:this.regExpOption.checked,caseSensitive:this.caseSensitiveOption.checked,wholeWord:this.wholeWordOption.checked})&&this.searchInput.value;r.setCssClass(this.searchBox,"ace_nomatch",e),this.editor._emit("findSearchBox",{match:!e}),this.highlight(),this.hide()},this.replace=function(){this.editor.getReadOnly()||this.editor.replace(this.replaceInput.value)},this.replaceAndFindNext=function(){this.editor.getReadOnly()||(this.editor.replace(this.replaceInput.value),this.findNext())},this.replaceAll=function(){this.editor.getReadOnly()||this.editor.replaceAll(this.replaceInput.value)},this.hide=function(){this.active=!1,this.setSearchRange(null),this.editor.off("changeSession",this.setSession),this.element.style.display="none",this.editor.keyBinding.removeKeyboardHandler(this.$closeSearchBarKb),this.editor.focus()},this.show=function(e,t){this.active=!0,this.editor.on("changeSession",this.setSession),this.element.style.display="",this.replaceOption.checked=t,e&&(this.searchInput.value=e),this.searchInput.focus(),this.searchInput.select(),this.editor.keyBinding.addKeyboardHandler(this.$closeSearchBarKb),this.$syncOptions(!0)},this.isFocused=function(){var e=document.activeElement;return e==this.searchInput||e==this.replaceInput}}).call(l.prototype),t.SearchBox=l,t.Search=function(e,t){(e.searchBox||new l(e)).show(e.session.getTextRange(),t)}})),ace.require(["ace/ext/searchbox"],(function(r){"object"==n(e)&&"object"==n(t)&&e&&(e.exports=r)}))}).call(this,n(8)(e))},function(e,t,n){(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ace.define("ace/ext/modelist",[],(function(e,t,n){"use strict";var r=[];var i=function(e,t,n){var r;this.name=e,this.caption=t,this.mode="ace/mode/"+e,this.extensions=n,r=/\^/.test(n)?n.replace(/\|(\^)?/g,(function(e,t){return"$|"+(t?"^":"^.*\\.")}))+"$":"^.*\\.("+n+")$",this.extRe=new RegExp(r,"gi")};i.prototype.supportsFile=function(e){return e.match(this.extRe)};var o={ABAP:["abap"],ABC:["abc"],ActionScript:["as"],ADA:["ada|adb"],Apache_Conf:["^htaccess|^htgroups|^htpasswd|^conf|htaccess|htgroups|htpasswd"],AsciiDoc:["asciidoc|adoc"],ASL:["dsl|asl"],Assembly_x86:["asm|a"],AutoHotKey:["ahk"],Apex:["apex|cls|trigger|tgr"],AQL:["aql"],BatchFile:["bat|cmd"],C_Cpp:["cpp|c|cc|cxx|h|hh|hpp|ino"],C9Search:["c9search_results"],Crystal:["cr"],Cirru:["cirru|cr"],Clojure:["clj|cljs"],Cobol:["CBL|COB"],coffee:["coffee|cf|cson|^Cakefile"],ColdFusion:["cfm"],CSharp:["cs"],Csound_Document:["csd"],Csound_Orchestra:["orc"],Csound_Score:["sco"],CSS:["css"],Curly:["curly"],D:["d|di"],Dart:["dart"],Diff:["diff|patch"],Dockerfile:["^Dockerfile"],Dot:["dot"],Drools:["drl"],Edifact:["edi"],Eiffel:["e|ge"],EJS:["ejs"],Elixir:["ex|exs"],Elm:["elm"],Erlang:["erl|hrl"],Forth:["frt|fs|ldr|fth|4th"],Fortran:["f|f90"],FSharp:["fsi|fs|ml|mli|fsx|fsscript"],FSL:["fsl"],FTL:["ftl"],Gcode:["gcode"],Gherkin:["feature"],Gitignore:["^.gitignore"],Glsl:["glsl|frag|vert"],Gobstones:["gbs"],golang:["go"],GraphQLSchema:["gql"],Groovy:["groovy"],HAML:["haml"],Handlebars:["hbs|handlebars|tpl|mustache"],Haskell:["hs"],Haskell_Cabal:["cabal"],haXe:["hx"],Hjson:["hjson"],HTML:["html|htm|xhtml|vue|we|wpy"],HTML_Elixir:["eex|html.eex"],HTML_Ruby:["erb|rhtml|html.erb"],INI:["ini|conf|cfg|prefs"],Io:["io"],Jack:["jack"],Jade:["jade|pug"],Java:["java"],JavaScript:["js|jsm|jsx"],JSON:["json"],JSONiq:["jq"],JSP:["jsp"],JSSM:["jssm|jssm_state"],JSX:["jsx"],Julia:["jl"],Kotlin:["kt|kts"],LaTeX:["tex|latex|ltx|bib"],LESS:["less"],Liquid:["liquid"],Lisp:["lisp"],LiveScript:["ls"],LogiQL:["logic|lql"],LSL:["lsl"],Lua:["lua"],LuaPage:["lp"],Lucene:["lucene"],Makefile:["^Makefile|^GNUmakefile|^makefile|^OCamlMakefile|make"],Markdown:["md|markdown"],Mask:["mask"],MATLAB:["matlab"],Maze:["mz"],MEL:["mel"],MIXAL:["mixal"],MUSHCode:["mc|mush"],MySQL:["mysql"],Nginx:["nginx|conf"],Nix:["nix"],Nim:["nim"],NSIS:["nsi|nsh"],ObjectiveC:["m|mm"],OCaml:["ml|mli"],Pascal:["pas|p"],Perl:["pl|pm"],Perl6:["p6|pl6|pm6"],pgSQL:["pgsql"],PHP_Laravel_blade:["blade.php"],PHP:["php|inc|phtml|shtml|php3|php4|php5|phps|phpt|aw|ctp|module"],Puppet:["epp|pp"],Pig:["pig"],Powershell:["ps1"],Praat:["praat|praatscript|psc|proc"],Prolog:["plg|prolog"],Properties:["properties"],Protobuf:["proto"],Python:["py"],R:["r"],Razor:["cshtml|asp"],RDoc:["Rd"],Red:["red|reds"],RHTML:["Rhtml"],RST:["rst"],Ruby:["rb|ru|gemspec|rake|^Guardfile|^Rakefile|^Gemfile"],Rust:["rs"],SASS:["sass"],SCAD:["scad"],Scala:["scala|sbt"],Scheme:["scm|sm|rkt|oak|scheme"],SCSS:["scss"],SH:["sh|bash|^.bashrc"],SJS:["sjs"],Slim:["slim|skim"],Smarty:["smarty|tpl"],snippets:["snippets"],Soy_Template:["soy"],Space:["space"],SQL:["sql"],SQLServer:["sqlserver"],Stylus:["styl|stylus"],SVG:["svg"],Swift:["swift"],Tcl:["tcl"],Terraform:["tf","tfvars","terragrunt"],Tex:["tex"],Text:["txt"],Textile:["textile"],Toml:["toml"],TSX:["tsx"],Twig:["latte|twig|swig"],Typescript:["ts|typescript|str"],Vala:["vala"],VBScript:["vbs|vb"],Velocity:["vm"],Verilog:["v|vh|sv|svh"],VHDL:["vhd|vhdl"],Visualforce:["vfp|component|page"],Wollok:["wlk|wpgm|wtest"],XML:["xml|rdf|rss|wsdl|xslt|atom|mathml|mml|xul|xbl|xaml"],XQuery:["xq"],YAML:["yaml|yml"],Zeek:["zeek|bro"],Django:["html"]},s={ObjectiveC:"Objective-C",CSharp:"C#",golang:"Go",C_Cpp:"C and C++",Csound_Document:"Csound Document",Csound_Orchestra:"Csound",Csound_Score:"Csound Score",coffee:"CoffeeScript",HTML_Ruby:"HTML (Ruby)",HTML_Elixir:"HTML (Elixir)",FTL:"FreeMarker",PHP_Laravel_blade:"PHP (Blade Template)",Perl6:"Perl 6",AutoHotKey:"AutoHotkey / AutoIt"},a={};for(var l in o){var c=o[l],u=(s[l]||l).replace(/_/g," "),h=l.toLowerCase(),d=new i(h,u,c[0]);a[h]=d,r.push(d)}n.exports={getModeForPath:function(e){for(var t=a.text,n=e.split(/[\/\\]/).pop(),i=0;i<r.length;i++)if(r[i].supportsFile(n)){t=r[i];break}return t},modes:r,modesByName:a}})),ace.require(["ace/ext/modelist"],(function(r){"object"==n(e)&&"object"==n(t)&&e&&(e.exports=r)}))}).call(this,n(8)(e))},function(e,t,n){(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}ace.define("ace/keyboard/vim",[],(function(e,t,r){"use strict";var i=e("../range").Range,o=e("../lib/event_emitter").EventEmitter,s=e("../lib/dom"),a=e("../lib/oop"),l=e("../lib/keys"),c=e("../lib/event"),u=e("../search").Search,h=e("../lib/useragent"),d=e("../search_highlight").SearchHighlight,f=e("../commands/multi_select_commands"),p=e("../mode/text").Mode.prototype.tokenRe;e("../multi_select");var g=function(e){this.ace=e,this.state={},this.marks={},this.$uid=0,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this),this.onBeforeEndOperation=this.onBeforeEndOperation.bind(this),this.ace.on("change",this.onChange),this.ace.on("changeSelection",this.onSelectionChange),this.ace.on("beforeEndOperation",this.onBeforeEndOperation)};function m(e){return{row:e.line,column:e.ch}}function v(e){return new _(e.row,e.column)}g.Pos=function(e,t){if(!(this instanceof _))return new _(e,t);this.line=e,this.ch=t},g.defineOption=function(e,t,n){},g.commands={redo:function(e){e.ace.redo()},undo:function(e){e.ace.undo()},newlineAndIndent:function(e){e.ace.insert("\n")}},g.keyMap={},g.addClass=g.rmClass=function(){},g.e_stop=g.e_preventDefault=c.stopEvent,g.keyName=function(e){var t=l[e.keyCode]||e.key||"";return 1==t.length&&(t=t.toUpperCase()),t=c.getModifierString(e).replace(/(^|-)\w/g,(function(e){return e.toUpperCase()}))+t},g.keyMap.default=function(e){return function(t){var n=t.ace.commands.commandKeyBinding[e.toLowerCase()];return n&&!1!==t.ace.execCommand(n)}},g.lookupKey=function e(t,n,r){n||(n="default"),"string"==typeof n&&(n=g.keyMap[n]);var i="function"==typeof n?n(t):n[t];if(!1===i)return"nothing";if("..."===i)return"multi";if(null!=i&&r(i))return"handled";if(n.fallthrough){if(!Array.isArray(n.fallthrough))return e(t,n.fallthrough,r);for(var o=0;o<n.fallthrough.length;o++){var s=e(t,n.fallthrough[o],r);if(s)return s}}},g.signal=function(e,t,n){return e._signal(t,n)},g.on=c.addListener,g.off=c.removeListener,g.isWordChar=function(e){return e<""?/^\w$/.test(e):(p.lastIndex=0,p.test(e))},function(){a.implement(g.prototype,o),this.destroy=function(){this.ace.off("change",this.onChange),this.ace.off("changeSelection",this.onSelectionChange),this.ace.off("beforeEndOperation",this.onBeforeEndOperation),this.removeOverlay()},this.virtualSelectionMode=function(){return this.ace.inVirtualSelectionMode&&this.ace.selection.index},this.onChange=function(e){var t={text:"i"==e.action[0]?e.lines:[]},n=this.curOp=this.curOp||{};n.changeHandlers||(n.changeHandlers=this._eventRegistry.change&&this._eventRegistry.change.slice()),n.lastChange?n.lastChange.next=n.lastChange=t:n.lastChange=n.change=t,this.$updateMarkers(e)},this.onSelectionChange=function(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._eventRegistry.cursorActivity&&this._eventRegistry.cursorActivity.slice()),this.curOp.cursorActivity=!0,this.ace.inMultiSelectMode&&this.ace.keyBinding.removeKeyboardHandler(f.keyboardHandler)},this.operation=function(e,t){if(!t&&this.curOp||t&&this.curOp&&this.curOp.force)return e();if(!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),!this.ace.curOp){var n=this.ace.prevOp;this.ace.startOperation({command:{name:"vim",scrollIntoView:"cursor"}})}var r=this.curOp=this.curOp||{};this.curOp.force=t;var i=e();return this.ace.curOp&&"vim"==this.ace.curOp.command.name&&(this.state.dialog&&(this.ace.curOp.command.scrollIntoView=!1),this.ace.endOperation(),r.cursorActivity||r.lastChange||!n||(this.ace.prevOp=n)),!t&&this.ace.curOp||this.curOp&&this.onBeforeEndOperation(),i},this.onBeforeEndOperation=function(){var e=this.curOp;e&&(e.change&&this.signal("change",e.change,e),e&&e.cursorActivity&&this.signal("cursorActivity",null,e),this.curOp=null)},this.signal=function(e,t,n){var r=n?n[e+"Handlers"]:(this._eventRegistry||{})[e];if(r){r=r.slice();for(var i=0;i<r.length;i++)r[i](this,t)}},this.firstLine=function(){return 0},this.lastLine=function(){return this.ace.session.getLength()-1},this.lineCount=function(){return this.ace.session.getLength()},this.setCursor=function(e,t){"object"===n(e)&&(t=e.ch,e=e.line),this.ace.inVirtualSelectionMode||this.ace.exitMultiSelectMode(),this.ace.session.unfold({row:e,column:t}),this.ace.selection.moveTo(e,t)},this.getCursor=function(e){var t=this.ace.selection;return v("anchor"==e?t.isEmpty()?t.lead:t.anchor:"head"!=e&&e?t.getRange()[e]:t.lead)},this.listSelections=function(e){var t=this.ace.multiSelect.rangeList.ranges;return!t.length||this.ace.inVirtualSelectionMode?[{anchor:this.getCursor("anchor"),head:this.getCursor("head")}]:t.map((function(e){return{anchor:this.clipPos(v(e.cursor==e.end?e.start:e.end)),head:this.clipPos(v(e.cursor))}}),this)},this.setSelections=function(e,t){var n=this.ace.multiSelect,r=e.map((function(e){var t=m(e.anchor),n=m(e.head),r=i.comparePoints(t,n)<0?new i.fromPoints(t,n):new i.fromPoints(n,t);return r.cursor=i.comparePoints(r.start,n)?r.end:r.start,r}));if(this.ace.inVirtualSelectionMode)this.ace.selection.fromOrientedRange(r[0]);else{t?r[t]&&r.push(r.splice(t,1)[0]):r=r.reverse(),n.toSingleRange(r[0].clone());for(var o=this.ace.session,s=0;s<r.length;s++){var a=o.$clipRangeToDocument(r[s]);n.addRange(a)}}},this.setSelection=function(e,t,n){var r=this.ace.selection;r.moveTo(e.line,e.ch),r.selectTo(t.line,t.ch),n&&"*mouse"==n.origin&&this.onBeforeEndOperation()},this.somethingSelected=function(e){return!this.ace.selection.isEmpty()},this.clipPos=function(e){return v(this.ace.session.$clipPositionToDocument(e.line,e.ch))},this.markText=function(e){return{clear:function(){},find:function(){}}},this.$updateMarkers=function(e){var t="insert"==e.action,n=e.start,r=e.end,o=(r.row-n.row)*(t?1:-1),s=(r.column-n.column)*(t?1:-1);for(var a in t&&(r=n),this.marks){var l=this.marks[a],c=i.comparePoints(l,n);if(!(c<0)){if(0===c&&t){if(1!=l.bias){l.bias=-1;continue}c=1}var u=t?c:i.comparePoints(l,r);u>0?(l.row+=o,l.column+=l.row==r.row?s:0):!t&&u<=0&&(l.row=n.row,l.column=n.column,0===u&&(l.bias=1))}}};var e=function(e,t,n,r){this.cm=e,this.id=t,this.row=n,this.column=r,e.marks[this.id]=this};e.prototype.clear=function(){delete this.cm.marks[this.id]},e.prototype.find=function(){return v(this)},this.setBookmark=function(t,n){var r=new e(this,this.$uid++,t.line,t.ch);return n&&n.insertLeft||(r.$insertRight=!0),this.marks[r.id]=r,r},this.moveH=function(e,t){if("char"==t){var n=this.ace.selection;n.clearSelection(),n.moveCursorBy(0,e)}},this.findPosV=function(e,t,n,r){if("page"==n){var i=this.ace.renderer.layerConfig;t*=Math.floor(i.height/i.lineHeight),n="line"}if("line"==n){var o=this.ace.session.documentToScreenPosition(e.line,e.ch);return null!=r&&(o.column=r),o.row+=t,o.row=Math.min(Math.max(0,o.row),this.ace.session.getScreenLength()-1),v(this.ace.session.screenToDocumentPosition(o.row,o.column))}},this.charCoords=function(e,t){if("div"==t||!t)return{left:(r=this.ace.session.documentToScreenPosition(e.line,e.ch)).column,top:r.row};if("local"==t){var n=this.ace.renderer,r=this.ace.session.documentToScreenPosition(e.line,e.ch),i=n.layerConfig.lineHeight,o=n.layerConfig.characterWidth,s=i*r.row;return{left:r.column*o,top:s,bottom:s+i}}},this.coordsChar=function(e,t){var n=this.ace.renderer;if("local"==t){var r=Math.max(0,Math.floor(e.top/n.lineHeight)),i=Math.max(0,Math.floor(e.left/n.characterWidth));return v(n.session.screenToDocumentPosition(r,i))}if("div"==t)throw"not implemented"},this.getSearchCursor=function(e,t,n){var r=!1,i=!1;e instanceof RegExp&&!e.global&&(r=!e.ignoreCase,e=e.source,i=!0);var o=new u;null==t.ch&&(t.ch=Number.MAX_VALUE);var s={row:t.line,column:t.ch},a=this,l=null;return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){o.setOptions({needle:e,caseSensitive:r,wrap:!1,backwards:t,regExp:i,start:l||s});var n=o.find(a.ace.session);return n&&n.isEmpty()&&a.getLine(n.start.row).length==n.start.column&&(o.$options.start=n,n=o.find(a.ace.session)),l=n},from:function(){return l&&v(l.start)},to:function(){return l&&v(l.end)},replace:function(e){l&&(l.end=a.ace.session.doc.replace(l,e))}}},this.scrollTo=function(e,t){var n=this.ace.renderer,r=n.layerConfig,i=r.maxHeight;i-=(n.$size.scrollerHeight-n.lineHeight)*n.$scrollPastEnd,null!=t&&this.ace.session.setScrollTop(Math.max(0,Math.min(t,i))),null!=e&&this.ace.session.setScrollLeft(Math.max(0,Math.min(e,r.width)))},this.scrollInfo=function(){return 0},this.scrollIntoView=function(e,t){if(e){var n=this.ace.renderer,r={top:0,bottom:t};n.scrollCursorIntoView(m(e),2*n.lineHeight/n.$size.scrollerHeight,r)}},this.getLine=function(e){return this.ace.session.getLine(e)},this.getRange=function(e,t){return this.ace.session.getTextRange(new i(e.line,e.ch,t.line,t.ch))},this.replaceRange=function(e,t,n){return n||(n=t),this.ace.session.replace(new i(t.line,t.ch,n.line,n.ch),e)},this.replaceSelections=function(e){var t=this.ace.selection;if(this.ace.inVirtualSelectionMode)this.ace.session.replace(t.getRange(),e[0]||"");else{t.inVirtualSelectionMode=!0;var n=t.rangeList.ranges;n.length||(n=[this.ace.multiSelect.getRange()]);for(var r=n.length;r--;)this.ace.session.replace(n[r],e[r]||"");t.inVirtualSelectionMode=!1}},this.getSelection=function(){return this.ace.getSelectedText()},this.getSelections=function(){return this.listSelections().map((function(e){return this.getRange(e.anchor,e.head)}),this)},this.getInputField=function(){return this.ace.textInput.getElement()},this.getWrapperElement=function(){return this.ace.container};var t={indentWithTabs:"useSoftTabs",indentUnit:"tabSize",tabSize:"tabSize",firstLineNumber:"firstLineNumber",readOnly:"readOnly"};this.setOption=function(e,n){switch(this.state[e]=n,e){case"indentWithTabs":e=t[e],n=!n;break;case"keyMap":return void(this.state.$keyMap=n);default:e=t[e]}e&&this.ace.setOption(e,n)},this.getOption=function(e,n){var r=t[e];switch(r&&(n=this.ace.getOption(r)),e){case"indentWithTabs":return e=t[e],!n;case"keyMap":return this.state.$keyMap}return r?n:this.state[e]},this.toggleOverwrite=function(e){return this.state.overwrite=e,this.ace.setOverwrite(e)},this.addOverlay=function(e){if(!this.$searchHighlight||!this.$searchHighlight.session){var t=new d(null,"ace_highlight-marker","text"),n=this.ace.session.addDynamicMarker(t);t.id=n.id,t.session=this.ace.session,t.destroy=function(e){t.session.off("change",t.updateOnChange),t.session.off("changeEditor",t.destroy),t.session.removeMarker(t.id),t.session=null},t.updateOnChange=function(e){var n=e.start.row;n==e.end.row?t.cache[n]=void 0:t.cache.splice(n,t.cache.length)},t.session.on("changeEditor",t.destroy),t.session.on("change",t.updateOnChange)}var r=new RegExp(e.query.source,"gmi");this.$searchHighlight=e.highlight=t,this.$searchHighlight.setRegexp(r),this.ace.renderer.updateBackMarkers()},this.removeOverlay=function(e){this.$searchHighlight&&this.$searchHighlight.session&&this.$searchHighlight.destroy()},this.getScrollInfo=function(){var e=this.ace.renderer,t=e.layerConfig;return{left:e.scrollLeft,top:e.scrollTop,height:t.maxHeight,width:t.width,clientHeight:t.height,clientWidth:t.width}},this.getValue=function(){return this.ace.getValue()},this.setValue=function(e){return this.ace.setValue(e,-1)},this.getTokenTypeAt=function(e){var t=this.ace.session.getTokenAt(e.line,e.ch);return t&&/comment|string/.test(t.type)?"string":""},this.findMatchingBracket=function(e){var t=this.ace.session.findMatchingBracket(m(e));return{to:t&&v(t)}},this.indentLine=function(e,t){!0===t?this.ace.session.indentRows(e,e,"\t"):!1===t&&this.ace.session.outdentRows(new i(e,0,e,0))},this.indexFromPos=function(e){return this.ace.session.doc.positionToIndex(m(e))},this.posFromIndex=function(e){return v(this.ace.session.doc.indexToPosition(e))},this.focus=function(e){return this.ace.textInput.focus()},this.blur=function(e){return this.ace.blur()},this.defaultTextHeight=function(e){return this.ace.renderer.layerConfig.lineHeight},this.scanForBracket=function(e,t,n,r){var i=r.bracketRegex.source,o=/paren|text|operator|tag/;if(1==t)var s=this.ace.session.$findClosingBracket(i.slice(1,2),m(e),o);else s=this.ace.session.$findOpeningBracket(i.slice(-2,-1),{row:e.line,column:e.ch+1},o);return s&&{pos:v(s)}},this.refresh=function(){return this.ace.resize(!0)},this.getMode=function(){return{name:this.getOption("mode")}},this.execCommand=function(){}}.call(g.prototype),(g.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0}).prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){throw"not implemented"},indentation:function(){throw"not implemented"},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&!1!==t&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}},g.defineExtension=function(e,t){g.prototype[e]=t},s.importCssString(".normal-mode .ace_cursor{    border: none;    background-color: rgba(255,0,0,0.5);}.normal-mode .ace_hidden-cursors .ace_cursor{  background-color: transparent;  border: 1px solid red;  opacity: 0.7}.ace_dialog {  position: absolute;  left: 0; right: 0;  background: inherit;  z-index: 15;  padding: .1em .8em;  overflow: hidden;  color: inherit;}.ace_dialog-top {  border-bottom: 1px solid #444;  top: 0;}.ace_dialog-bottom {  border-top: 1px solid #444;  bottom: 0;}.ace_dialog input {  border: none;  outline: none;  background: transparent;  width: 20em;  color: inherit;  font-family: monospace;}","vimMode"),function(){function e(e,t,n){var r;return(r=e.ace.container.appendChild(document.createElement("div"))).className=n?"ace_dialog ace_dialog-bottom":"ace_dialog ace_dialog-top","string"==typeof t?r.innerHTML=t:r.appendChild(t),r}function t(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}g.defineExtension("openDialog",(function(n,r,i){if(!this.virtualSelectionMode()){i||(i={}),t(this,null);var o=e(this,n,i.bottom),s=!1,a=this;this.state.dialog=o;var l,c=o.getElementsByTagName("input")[0];return c?(i.value&&(c.value=i.value,!1!==i.selectValueOnOpen&&c.select()),i.onInput&&g.on(c,"input",(function(e){i.onInput(e,c.value,u)})),i.onKeyUp&&g.on(c,"keyup",(function(e){i.onKeyUp(e,c.value,u)})),g.on(c,"keydown",(function(e){i&&i.onKeyDown&&i.onKeyDown(e,c.value,u)||(13==e.keyCode&&r(c.value),(27==e.keyCode||!1!==i.closeOnEnter&&13==e.keyCode)&&(c.blur(),g.e_stop(e),u()))})),!1!==i.closeOnBlur&&g.on(c,"blur",u),c.focus()):(l=o.getElementsByTagName("button")[0])&&(g.on(l,"click",(function(){u(),a.focus()})),!1!==i.closeOnBlur&&g.on(l,"blur",u),l.focus()),u}function u(e){if("string"==typeof e)c.value=e;else{if(s)return;if(e&&"blur"==e.type&&document.activeElement===c)return;a.state.dialog=null,s=!0,o.parentNode.removeChild(o),a.focus(),i.onClose&&i.onClose(o)}}})),g.defineExtension("openNotification",(function(n,r){if(!this.virtualSelectionMode()){t(this,l);var i,o=e(this,n,r&&r.bottom),s=!1,a=r&&void 0!==r.duration?r.duration:5e3;return g.on(o,"click",(function(e){g.e_preventDefault(e),l()})),a&&(i=setTimeout(l,a)),l}function l(){s||(s=!0,clearTimeout(i),o.parentNode.removeChild(o))}}))}();var y=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<Del>",type:"keyToKey",toKeys:"x",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],b=y.length,w=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],_=g.Pos,C=function(){return te};function S(e,t){this==g.keyMap.vim&&g.rmClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==k||function(e){e.setOption("disableInput",!1),e.off("cursorActivity",ft),g.off(e.getInputField(),"paste",T(e)),e.state.vim=null}(e)}function k(e,t){this==g.keyMap.vim&&g.addClass(e.getWrapperElement(),"cm-fat-cursor"),t&&t.attach==k||function(e){e.setOption("disableInput",!0),e.setOption("showCursorWhenSelecting",!1),g.signal(e,"vim-mode-change",{mode:"normal"}),e.on("cursorActivity",ft),Z(e),g.on(e.getInputField(),"paste",T(e))}(e)}function A(e,t){if(t){if(this[e])return this[e];var n=function(e){if("'"==e.charAt(0))return e.charAt(1);var t=e.split(/-(?!$)/),n=t[t.length-1];if(1==t.length&&1==t[0].length)return!1;if(2==t.length&&"Shift"==t[0]&&1==n.length)return!1;for(var r=!1,i=0;i<t.length;i++){var o=t[i];o in x?t[i]=x[o]:r=!0,o in $&&(t[i]=$[o])}if(!r)return!1;B(n)&&(t[t.length-1]=n.toLowerCase());return"<"+t.join("-")+">"}(e);if(!n)return!1;var r=g.Vim.findKey(t,n);return"function"==typeof r&&g.signal(t,"vim-keypress",n),r}}g.defineOption("vimMode",!1,(function(e,t,n){t&&"vim"!=e.getOption("keyMap")?e.setOption("keyMap","vim"):!t&&n!=g.Init&&/^vim/.test(e.getOption("keyMap"))&&e.setOption("keyMap","default")}));var x={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},$={Enter:"CR",Backspace:"BS",Delete:"Del",Insert:"Ins"};function T(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(pe(e.getCursor(),0,1)),he.enterInsertMode(e,{},t))}),t.onPasteFn}var E=/[\d]/,R=[g.isWordChar,function(e){return e&&!g.isWordChar(e)&&!/\s/.test(e)}],M=[function(e){return/\S/.test(e)}];function L(e,t){for(var n=[],r=e;r<e+t;r++)n.push(String.fromCharCode(r));return n}var P=L(65,26),O=L(97,26),D=L(48,10),I=[].concat(P,O,D,["<",">"]),F=[].concat(P,O,D,["-",'"',".",":","/"]);function j(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function N(e){return/^[a-z]$/.test(e)}function B(e){return/^[A-Z]$/.test(e)}function H(e){return/^\s*$/.test(e)}function z(e){return-1!=".?!".indexOf(e)}function W(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}var U={};function V(e,t,n,r,i){if(void 0===t&&!i)throw Error("defaultValue is required unless callback is provided");if(n||(n="string"),U[e]={type:n,defaultValue:t,callback:i},r)for(var o=0;o<r.length;o++)U[r[o]]=U[e];t&&q(e,t)}function q(e,t,n,r){var i=U[e],o=(r=r||{}).scope;if(!i)return new Error("Unknown option: "+e);if("boolean"==i.type){if(t&&!0!==t)return new Error("Invalid argument: "+e+"="+t);!1!==t&&(t=!0)}i.callback?("local"!==o&&i.callback(t,void 0),"global"!==o&&n&&i.callback(t,n)):("local"!==o&&(i.value="boolean"==i.type?!!t:t),"global"!==o&&n&&(n.state.vim.options[e]={value:t}))}function G(e,t,n){var r=U[e],i=(n=n||{}).scope;if(!r)return new Error("Unknown option: "+e);if(r.callback){var o=t&&r.callback(void 0,t);return"global"!==i&&void 0!==o?o:"local"!==i?r.callback():void 0}return((o="global"!==i&&t&&t.state.vim.options[e])||"local"!==i&&r||{}).value}V("filetype",void 0,"string",["ft"],(function(e,t){if(void 0!==t){if(void 0===e)return"null"==(n=t.getOption("mode"))?"":n;var n=""==e?"null":e;t.setOption("mode",n)}}));var K,X,Y=function(){var e=100,t=-1,n=0,r=0,i=new Array(e);return{cachedCursor:void 0,add:function(o,s,a){var l=i[t%e];function c(n){var r=++t%e,s=i[r];s&&s.clear(),i[r]=o.setBookmark(n)}if(l){var u=l.find();u&&!ye(u,s)&&c(s)}else c(s);c(a),n=t,(r=t-e+1)<0&&(r=0)},move:function(o,s){(t+=s)>n?t=n:t<r&&(t=r);var a=i[(e+t)%e];if(a&&!a.find()){var l,c=s>0?1:-1,u=o.getCursor();do{if((a=i[(e+(t+=c))%e])&&(l=a.find())&&!ye(u,l))break}while(t<n&&t>r)}return a}}},J=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};function Q(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=J()}function Z(e){return e.state.vim||(e.state.vim={inputState:new ne,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),e.state.vim}function ee(){for(var e in K={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:Y(),macroModeState:new Q,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new oe({}),searchHistoryController:new se,exCommandHistoryController:new se},U){var t=U[e];t.value=t.defaultValue}}Q.prototype={exitMacroRecordMode:function(){var e=K.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=K.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,e.openDialog&&(this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0})),this.isRecording=!0)}};var te={buildKeyMap:function(){},getRegisterController:function(){return K.registerController},resetVimGlobalState_:ee,getVimGlobalState_:function(){return K},maybeInitVimState_:Z,suppressErrorLogging:!1,InsertModeKey:mt,map:function(e,t,n){lt.map(e,t,n)},unmap:function(e,t){lt.unmap(e,t)},noremap:function(e,t,n){function r(e){return e?[e]:["normal","insert","visual"]}for(var i=r(n),o=y.length,s=o-b;s<o&&i.length;s++){var a=y[s];if(!(a.keys!=t||n&&a.context&&a.context!==n||"ex"===a.type.substr(0,2)||"key"===a.type.substr(0,3))){var l={};for(var c in a)l[c]=a[c];l.keys=e,n&&!l.context&&(l.context=n),this._mapCommand(l);var u=r(a.context);i=i.filter((function(e){return-1===u.indexOf(e)}))}}},mapclear:function(e){var t=y.length,n=b,r=y.slice(0,t-n);if(y=y.slice(t-n),e)for(var i=r.length-1;i>=0;i--){var o=r[i];if(e!==o.context)if(o.context)this._mapCommand(o);else{var s=["normal","insert","visual"];for(var a in s)if(s[a]!==e){var l={};for(var c in o)l[c]=o[c];l.context=s[a],this._mapCommand(l)}}}},setOption:q,getOption:G,defineOption:V,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;at[e]=n,lt.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){var r=this.findKey(e,t,n);if("function"==typeof r)return r()},findKey:function(e,t,n){var r,i=Z(e);function o(){var r=K.macroModeState;if(r.isRecording){if("q"==t)return r.exitMacroRecordMode(),re(e),!0;"mapping"!=n&&function(e,t){if(e.isPlaying)return;var n=e.latestRegister,r=K.registerController.getRegister(n);r&&r.pushText(t)}(r,t)}}function s(){if("<Esc>"==t)return re(e),i.visualMode?Me(e):i.insertMode&&ct(e),!0}return!1===(r=i.insertMode?function(){if(s())return!0;for(var n=i.inputState.keyBuffer=i.inputState.keyBuffer+t,r=1==t.length,o=ae.matchCommand(n,y,i.inputState,"insert");n.length>1&&"full"!=o.type;){n=i.inputState.keyBuffer=n.slice(1);var a=ae.matchCommand(n,y,i.inputState,"insert");"none"!=a.type&&(o=a)}if("none"==o.type)return re(e),!1;if("partial"==o.type)return X&&window.clearTimeout(X),X=window.setTimeout((function(){i.insertMode&&i.inputState.keyBuffer&&re(e)}),G("insertModeEscKeysTimeout")),!r;if(X&&window.clearTimeout(X),r){for(var l=e.listSelections(),c=0;c<l.length;c++){var u=l[c].head;e.replaceRange("",pe(u,0,-(n.length-1)),u,"+input")}K.macroModeState.lastInsertModeChanges.changes.pop()}return re(e),o.command}():function(){if(o()||s())return!0;var n=i.inputState.keyBuffer=i.inputState.keyBuffer+t;if(/^[1-9]\d*$/.test(n))return!0;if(!(r=/^(\d*)(.*)$/.exec(n)))return re(e),!1;var r,a=i.visualMode?"visual":"normal",l=ae.matchCommand(r[2]||r[1],y,i.inputState,a);return"none"==l.type?(re(e),!1):"partial"==l.type||(i.inputState.keyBuffer="",(r=/^(\d*)(.*)$/.exec(n))[1]&&"0"!=r[1]&&i.inputState.pushRepeatDigit(r[1]),l.command)}())?void 0:!0===r?function(){return!0}:function(){if(!r.operator&&!r.isEdit||!e.getOption("readOnly"))return e.operation((function(){e.curOp.isVimOp=!0;try{"keyToKey"==r.type?function(n){for(var r;n;)r=/<\w+-.+?>|<\w+>|./.exec(n),t=r[0],n=n.substring(r.index+t.length),g.Vim.handleKey(e,t,"mapping")}(r.toKeys):ae.processCommand(e,i,r)}catch(t){throw e.state.vim=void 0,Z(e),g.Vim.suppressErrorLogging||console.log(t),t}return!0}))}},handleEx:function(e,t){lt.processCommand(e,t)},defineMotion:function(e,t){le[e]=t},defineAction:function(e,t){he[e]=t},defineOperator:function(e,t){ue[e]=t},mapCommand:function(e,t,n,r,i){var o={keys:e,type:t};for(var s in o[t]=n,o[t+"Args"]=r,i)o[s]=i[s];ut(o)},_mapCommand:ut,defineRegister:function(e,t){var n=K.registerController.registers;if(!e||1!=e.length)throw Error("Register name must be 1 character");n[e]=t,F.push(e)},exitVisualMode:Me,exitInsertMode:ct};function ne(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function re(e,t){e.state.vim.inputState=new ne,g.signal(e,"vim-command-done",t)}function ie(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}function oe(e){this.registers=e,this.unnamedRegister=e['"']=new ie,e["."]=new ie,e[":"]=new ie,e["/"]=new ie}function se(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}ne.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},ne.prototype.getRepeat=function(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e},ie.prototype={setText:function(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push(J(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},oe.prototype={pushText:function(e,t,n,r,i){r&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var o=this.isValidRegister(e)?this.getRegister(e):null;if(o){B(e)?o.pushText(n,r):o.setText(n,r,i),this.unnamedRegister.setText(o.toString(),r)}else{switch(t){case"yank":this.registers[0]=new ie(n,r,i);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new ie(n,r):(this.shiftNumericRegisters_(),this.registers[1]=new ie(n,r))}this.unnamedRegister.setText(n,r,i)}},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new ie),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&W(e,F)},shiftNumericRegisters_:function(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}},se.prototype={nextMatch:function(e,t){var n=this.historyBuffer,r=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var i=this.iterator+r;t?i>=0:i<n.length;i+=r)for(var o=n[i],s=0;s<=o.length;s++)if(this.initialPrefix==o.substring(0,s))return this.iterator=i,o;return i>=n.length?(this.iterator=n.length,this.initialPrefix):i<0?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var ae={matchCommand:function(e,t,n,r){var i,o=function(e,t,n,r){for(var i,o=[],s=[],a=0;a<t.length;a++){var l=t[a];"insert"==n&&"insert"!=l.context||l.context&&l.context!=n||r.operator&&"action"==l.type||!(i=ge(e,l.keys))||("partial"==i&&o.push(l),"full"==i&&s.push(l))}return{partial:o.length&&o,full:s.length&&s}}(e,t,r,n);if(!o.full&&!o.partial)return{type:"none"};if(!o.full&&o.partial)return{type:"partial"};for(var s=0;s<o.full.length;s++){var a=o.full[s];i||(i=a)}if("<character>"==i.keys.slice(-11)){var l=function(e){var t=/^.*(<[^>]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(n.length>1)switch(n){case"<CR>":n="\n";break;case"<Space>":n=" ";break;default:n=""}return n}(e);if(/<C-.>/.test(l)||!l)return{type:"none"};n.selectedCharacter=l}return{type:"full",command:i}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=fe(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var r=t.inputState;if(r.operator){if(r.operator==n.operator)return r.motion="expandToLine",r.motionArgs={linewise:!0},void this.evalInput(e,t);re(e)}r.operator=n.operator,r.operatorArgs=fe(n.operatorArgs),n.exitVisualBlock&&(t.visualBlock=!1,Ee(e)),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var r=t.visualMode,i=fe(n.operatorMotionArgs);i&&r&&i.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),r||this.processMotion(e,t,n)},processAction:function(e,t,n){var r=t.inputState,i=r.getRepeat(),o=!!i,s=fe(n.actionArgs)||{};r.selectedCharacter&&(s.selectedCharacter=r.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),s.repeat=i||1,s.repeatIsExplicit=o,s.registerName=r.registerName,re(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,r,n),he[n.action](e,s,t)},processSearch:function(e,t,n){if(e.getSearchCursor){var r=n.searchArgs.forward,i=n.searchArgs.wholeWordOnly;Ue(e).setReversed(!r);var o=r?"/":"?",s=Ue(e).getQuery(),a=e.getScrollInfo();switch(n.searchArgs.querySrc){case"prompt":var l=K.macroModeState;if(l.isPlaying)d(h=l.replaySearchQueries.shift(),!0,!1);else Ze(e,{onClose:function(e){d(e,!0,!0);var t=K.macroModeState;t.isRecording&&function(e,t){if(e.isPlaying)return;var n=e.latestRegister,r=K.registerController.getRegister(n);r&&r.pushSearchQuery&&r.pushSearchQuery(t)}(t,e)},prefix:o,desc:Qe,onKeyUp:function(t,n,i){var o,s,l,c=g.keyName(t);"Up"==c||"Down"==c?(o="Up"==c,s=t.target?t.target.selectionEnd:0,i(n=K.searchHistoryController.nextMatch(n,o)||""),s&&t.target&&(t.target.selectionEnd=t.target.selectionStart=Math.min(s,t.target.value.length))):"Left"!=c&&"Right"!=c&&"Ctrl"!=c&&"Alt"!=c&&"Shift"!=c&&K.searchHistoryController.reset();try{l=et(e,n,!0,!0)}catch(t){}l?e.scrollIntoView(nt(e,!r,l),30):(rt(e),e.scrollTo(a.left,a.top))},onKeyDown:function(t,n,r){var i=g.keyName(t);"Esc"==i||"Ctrl-C"==i||"Ctrl-["==i||"Backspace"==i&&""==n?(K.searchHistoryController.pushInput(n),K.searchHistoryController.reset(),et(e,s),rt(e),e.scrollTo(a.left,a.top),g.e_stop(t),re(e),r(),e.focus()):"Up"==i||"Down"==i?g.e_stop(t):"Ctrl-U"==i&&(g.e_stop(t),r(""))}});break;case"wordUnderCursor":var c=Pe(e,!1,!0,!1,!0),u=!0;if(c||(c=Pe(e,!1,!0,!1,!1),u=!1),!c)return;var h=e.getLine(c.start.line).substring(c.start.ch,c.end.ch);h=u&&i?"\\b"+h+"\\b":function(e){return e.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}(h),K.jumpList.cachedCursor=e.getCursor(),e.setCursor(c.start),d(h,!0,!1)}}function d(r,i,o){K.searchHistoryController.pushInput(r),K.searchHistoryController.reset();try{et(e,r,i,o)}catch(t){return Je(e,"Invalid regex: "+r),void re(e)}ae.processMotion(e,t,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:n.searchArgs.toJumplist}})}},processEx:function(e,t,n){function r(t){K.exCommandHistoryController.pushInput(t),K.exCommandHistoryController.reset(),lt.processCommand(e,t)}function i(t,n,r){var i,o,s=g.keyName(t);("Esc"==s||"Ctrl-C"==s||"Ctrl-["==s||"Backspace"==s&&""==n)&&(K.exCommandHistoryController.pushInput(n),K.exCommandHistoryController.reset(),g.e_stop(t),re(e),r(),e.focus()),"Up"==s||"Down"==s?(g.e_stop(t),i="Up"==s,o=t.target?t.target.selectionEnd:0,r(n=K.exCommandHistoryController.nextMatch(n,i)||""),o&&t.target&&(t.target.selectionEnd=t.target.selectionStart=Math.min(o,t.target.value.length))):"Ctrl-U"==s?(g.e_stop(t),r("")):"Left"!=s&&"Right"!=s&&"Ctrl"!=s&&"Alt"!=s&&"Shift"!=s&&K.exCommandHistoryController.reset()}"keyToEx"==n.type?lt.processCommand(e,n.exArgs.input):t.visualMode?Ze(e,{onClose:r,prefix:":",value:"'<,'>",onKeyDown:i,selectValueOnOpen:!1}):Ze(e,{onClose:r,prefix:":",onKeyDown:i})},evalInput:function(e,t){var n,r,i,o=t.inputState,s=o.motion,a=o.motionArgs||{},l=o.operator,c=o.operatorArgs||{},u=o.registerName,h=t.sel,d=ve(t.visualMode?de(e,h.head):e.getCursor("head")),f=ve(t.visualMode?de(e,h.anchor):e.getCursor("anchor")),p=ve(d),g=ve(f);if(l&&this.recordLastEdit(t,o),(i=void 0!==o.repeatOverride?o.repeatOverride:o.getRepeat())>0&&a.explicitRepeat?a.repeatIsExplicit=!0:(a.noRepeat||!a.explicitRepeat&&0===i)&&(i=1,a.repeatIsExplicit=!1),o.selectedCharacter&&(a.selectedCharacter=c.selectedCharacter=o.selectedCharacter),a.repeat=i,re(e),s){var m=le[s](e,d,a,t);if(t.lastMotion=le[s],!m)return;if(a.toJumplist){l||null==e.ace.curOp||(e.ace.curOp.command.scrollIntoView="center-animate");var v=K.jumpList,y=v.cachedCursor;y?(Oe(e,y,m),delete v.cachedCursor):Oe(e,d,m)}m instanceof Array?(r=m[0],n=m[1]):n=m,n||(n=ve(d)),t.visualMode?(t.visualBlock&&n.ch===1/0||(n=de(e,n,t.visualBlock)),r&&(r=de(e,r,!0)),r=r||g,h.anchor=r,h.head=n,Ee(e),Be(e,t,"<",be(r,n)?r:n),Be(e,t,">",be(r,n)?n:r)):l||(n=de(e,n),e.setCursor(n.line,n.ch))}if(l){if(c.lastSel){r=g;var b=c.lastSel,w=Math.abs(b.head.line-b.anchor.line),C=Math.abs(b.head.ch-b.anchor.ch);n=b.visualLine?_(g.line+w,g.ch):b.visualBlock?_(g.line+w,g.ch+C):b.head.line==b.anchor.line?_(g.line,g.ch+C):_(g.line+w,g.ch),t.visualMode=!0,t.visualLine=b.visualLine,t.visualBlock=b.visualBlock,h=t.sel={anchor:r,head:n},Ee(e)}else t.visualMode&&(c.lastSel={anchor:ve(h.anchor),head:ve(h.head),visualBlock:t.visualBlock,visualLine:t.visualLine});var S,k,A,x,$;if(t.visualMode){if(S=we(h.head,h.anchor),k=_e(h.head,h.anchor),A=t.visualLine||c.linewise,$=Re(e,{anchor:S,head:k},x=t.visualBlock?"block":A?"line":"char"),A){var T=$.ranges;if("block"==x)for(var E=0;E<T.length;E++)T[E].head.ch=Se(e,T[E].head.line);else"line"==x&&(T[0].head=_(T[0].head.line+1,0))}}else{if(S=ve(r||g),be(k=ve(n||p),S)){var R=S;S=k,k=R}(A=a.linewise||c.linewise)?function(e,t,n){t.ch=0,n.ch=0,n.line++}(0,S,k):a.forward&&function(e,t,n){var r=e.getRange(t,n);if(/\n\s*$/.test(r)){var i=r.split("\n");i.pop();for(var o=i.pop();i.length>0&&o&&H(o);o=i.pop())n.line--,n.ch=0;o?(n.line--,n.ch=Se(e,n.line)):n.ch=0}}(e,S,k),$=Re(e,{anchor:S,head:k},x="char",!a.inclusive||A)}e.setSelections($.ranges,$.primary),t.lastMotion=null,c.repeat=i,c.registerName=u,c.linewise=A;var M=ue[l](e,c,$.ranges,g,n);t.visualMode&&Me(e,null!=M),M&&e.setCursor(M)}},recordLastEdit:function(e,t,n){var r=K.macroModeState;r.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,r.lastInsertModeChanges.changes=[],r.lastInsertModeChanges.expectCursorActivityForChange=!1,r.lastInsertModeChanges.visualBlock=e.visualBlock?e.sel.head.line-e.sel.anchor.line:0)}},le={moveToTopLine:function(e,t,n){var r=it(e).top+n.repeat-1;return _(r,Le(e.getLine(r)))},moveToMiddleLine:function(e){var t=it(e),n=Math.floor(.5*(t.top+t.bottom));return _(n,Le(e.getLine(n)))},moveToBottomLine:function(e,t,n){var r=it(e).bottom-n.repeat+1;return _(r,Le(e.getLine(r)))},expandToLine:function(e,t,n){return _(t.line+n.repeat-1,1/0)},findNext:function(e,t,n){var r=Ue(e),i=r.getQuery();if(i){var o=!n.forward;return o=r.isReversed()?!o:o,tt(e,i),nt(e,o,i,n.repeat)}},goToMark:function(e,t,n,r){var i=ot(e,r,n.selectedCharacter);return i?n.linewise?{line:i.line,ch:Le(e.getLine(i.line))}:i:null},moveToOtherHighlightedEnd:function(e,t,n,r){if(r.visualBlock&&n.sameLine){var i=r.sel;return[de(e,_(i.anchor.line,i.head.ch)),de(e,_(i.head.line,i.anchor.ch))]}return[r.sel.head,r.sel.anchor]},jumpToMark:function(e,t,n,r){for(var i=t,o=0;o<n.repeat;o++){var s=i;for(var a in r.marks)if(N(a)){var l=r.marks[a].find();if(!((n.forward?be(l,s):be(s,l))||n.linewise&&l.line==s.line)){var c=ye(s,i),u=n.forward?Ce(s,l,i):Ce(i,l,s);(c||u)&&(i=l)}}}return n.linewise&&(i=_(i.line,Le(e.getLine(i.line)))),i},moveByCharacters:function(e,t,n){var r=t,i=n.repeat,o=n.forward?r.ch+i:r.ch-i;return _(r.line,o)},moveByLines:function(e,t,n,r){var i=t,o=i.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:o=r.lastHPos;break;default:r.lastHPos=o}var s=n.repeat+(n.repeatOffset||0),a=n.forward?i.line+s:i.line-s,l=e.firstLine(),c=e.lastLine();if(a<l&&i.line==l)return this.moveToStartOfLine(e,t,n,r);if(a>c&&i.line==c)return this.moveToEol(e,t,n,r,!0);var u=e.ace.session.getFoldLine(a);return u&&(n.forward?a>u.start.row&&(a=u.end.row+1):a=u.start.row),n.toFirstChar&&(o=Le(e.getLine(a)),r.lastHPos=o),r.lastHSPos=e.charCoords(_(a,o),"div").left,_(a,o)},moveByDisplayLines:function(e,t,n,r){var i=t;switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(i,"div").left}var o=n.repeat;if((a=e.findPosV(i,n.forward?o:-o,"line",r.lastHSPos)).hitSide)if(n.forward)var s={top:e.charCoords(a,"div").top+8,left:r.lastHSPos},a=e.coordsChar(s,"div");else{var l=e.charCoords(_(e.firstLine(),0),"div");l.left=r.lastHSPos,a=e.coordsChar(l,"div")}return r.lastHPos=a.ch,a},moveByPage:function(e,t,n){var r=t,i=n.repeat;return e.findPosV(r,n.forward?i:-i,"page")},moveByParagraph:function(e,t,n){var r=n.forward?1:-1;return ze(e,t,n.repeat,r)},moveBySentence:function(e,t,n){var r=n.forward?1:-1;return function(e,t,n,r){function i(e,t){if(t.pos+t.dir<0||t.pos+t.dir>=t.line.length){if(t.ln+=t.dir,!j(e,t.ln))return t.line=null,t.ln=null,void(t.pos=null);t.line=e.getLine(t.ln),t.pos=t.dir>0?0:t.line.length-1}else t.pos+=t.dir}function o(e,t,n,r){var o=""===(c=e.getLine(t)),s={line:c,ln:t,pos:n,dir:r},a={ln:s.ln,pos:s.pos},l=""===s.line;for(i(e,s);null!==s.line;){if(a.ln=s.ln,a.pos=s.pos,""===s.line&&!l)return{ln:s.ln,pos:s.pos};if(o&&""!==s.line&&!H(s.line[s.pos]))return{ln:s.ln,pos:s.pos};!z(s.line[s.pos])||o||s.pos!==s.line.length-1&&!H(s.line[s.pos+1])||(o=!0),i(e,s)}var c=e.getLine(a.ln);a.pos=0;for(var u=c.length-1;u>=0;--u)if(!H(c[u])){a.pos=u;break}return a}function s(e,t,n,r){var o={line:l=e.getLine(t),ln:t,pos:n,dir:r},s={ln:o.ln,pos:null},a=""===o.line;for(i(e,o);null!==o.line;){if(""===o.line&&!a)return null!==s.pos?s:{ln:o.ln,pos:o.pos};if(z(o.line[o.pos])&&null!==s.pos&&(o.ln!==s.ln||o.pos+1!==s.pos))return s;""===o.line||H(o.line[o.pos])||(a=!1,s={ln:o.ln,pos:o.pos}),i(e,o)}var l=e.getLine(s.ln);s.pos=0;for(var c=0;c<l.length;++c)if(!H(l[c])){s.pos=c;break}return s}var a={ln:t.line,pos:t.ch};for(;n>0;)a=r<0?s(e,a.ln,a.pos,r):o(e,a.ln,a.pos,r),n--;return _(a.ln,a.pos)}(e,t,n.repeat,r)},moveByScroll:function(e,t,n,r){var i=e.getScrollInfo(),o=null,s=n.repeat;s||(s=i.clientHeight/(2*e.defaultTextHeight()));var a=e.charCoords(t,"local");if(n.repeat=s,!(o=le.moveByDisplayLines(e,t,n,r)))return null;var l=e.charCoords(o,"local");return e.scrollTo(null,i.top+l.top-a.top),o},moveByWords:function(e,t,n){return function(e,t,n,r,i,o){var s=ve(t),a=[];(r&&!i||!r&&i)&&n++;for(var l=!(r&&i),c=0;c<n;c++){var u=je(e,t,r,o,l);if(!u){var h=Se(e,e.lastLine());a.push(r?{line:e.lastLine(),from:h,to:h}:{line:0,from:0,to:0});break}a.push(u),t=_(u.line,r?u.to-1:u.from)}var d=a.length!=n,f=a[0],p=a.pop();return r&&!i?(d||f.from==s.ch&&f.line==s.line||(p=a.pop()),_(p.line,p.from)):r&&i?_(p.line,p.to-1):!r&&i?(d||f.to==s.ch&&f.line==s.line||(p=a.pop()),_(p.line,p.to)):_(p.line,p.from)}(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var r=Ne(e,n.repeat,n.forward,n.selectedCharacter),i=n.forward?-1:1;return De(i,n),r?(r.ch+=i,r):null},moveToCharacter:function(e,t,n){var r=n.repeat;return De(0,n),Ne(e,r,n.forward,n.selectedCharacter)||t},moveToSymbol:function(e,t,n){return function(e,t,n,r){var i=ve(e.getCursor()),o=n?1:-1,s=n?e.lineCount():-1,a=i.ch,l=i.line,c=e.getLine(l),u={lineText:c,nextCh:c.charAt(a),lastCh:null,index:a,symb:r,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[r],forward:n,depth:0,curMoveThrough:!1},h=Ie[r];if(!h)return i;var d=Fe[h].init,f=Fe[h].isComplete;d&&d(u);for(;l!==s&&t;){if(u.index+=o,u.nextCh=u.lineText.charAt(u.index),!u.nextCh){if(l+=o,u.lineText=e.getLine(l)||"",o>0)u.index=0;else{var p=u.lineText.length;u.index=p>0?p-1:0}u.nextCh=u.lineText.charAt(u.index)}f(u)&&(i.line=l,i.ch=u.index,t--)}if(u.nextCh||u.curMoveThrough)return _(l,u.index);return i}(e,n.repeat,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,r){var i=n.repeat;return r.lastHPos=i-1,r.lastHSPos=e.charCoords(t,"div").left,function(e,t){var n=e.getCursor().line;return de(e,_(n,t-1))}(e,i)},moveToEol:function(e,t,n,r,i){var o=_(t.line+n.repeat-1,1/0),s=e.clipPos(o);return s.ch--,i||(r.lastHPos=1/0,r.lastHSPos=e.charCoords(s,"div").left),o},moveToFirstNonWhiteSpaceCharacter:function(e,t){var n=t;return _(n.line,Le(e.getLine(n.line)))},moveToMatchedSymbol:function(e,t){for(var n,r=t,i=r.line,o=r.ch,s=e.getLine(i);o<s.length;o++)if((n=s.charAt(o))&&-1!="()[]{}".indexOf(n)){var a=e.getTokenTypeAt(_(i,o+1));if("string"!==a&&"comment"!==a)break}if(o<s.length){var l=/[<>]/.test(s[o])?/[(){}[\]<>]/:/[(){}[\]]/;return e.findMatchingBracket(_(i,o+1),{bracketRegex:l}).to}return r},moveToStartOfLine:function(e,t){return _(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var r=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(r=n.repeat-e.getOption("firstLineNumber")),_(r,Le(e.getLine(r)))},textObjectManipulation:function(e,t,n,r){var i=n.selectedCharacter;"b"==i?i="(":"B"==i&&(i="{");var o,s=!n.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"}[i])o=function(e,t,n,r){var i,o,s=t,a={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[n],l={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[n],c=e.getLine(s.line).charAt(s.ch)===l?1:0;if(i=e.scanForBracket(_(s.line,s.ch+c),-1,void 0,{bracketRegex:a}),o=e.scanForBracket(_(s.line,s.ch+c),1,void 0,{bracketRegex:a}),!i||!o)return{start:s,end:s};if(i=i.pos,o=o.pos,i.line==o.line&&i.ch>o.ch||i.line>o.line){var u=i;i=o,o=u}r?o.ch+=1:i.ch+=1;return{start:i,end:o}}(e,t,i,s);else if({"'":!0,'"':!0,"`":!0}[i])o=function(e,t,n,r){var i,o,s,a,l=ve(t),c=e.getLine(l.line).split(""),u=c.indexOf(n);l.ch<u?l.ch=u:u<l.ch&&c[l.ch]==n&&(o=l.ch,--l.ch);if(c[l.ch]!=n||o)for(s=l.ch;s>-1&&!i;s--)c[s]==n&&(i=s+1);else i=l.ch+1;if(i&&!o)for(s=i,a=c.length;s<a&&!o;s++)c[s]==n&&(o=s);if(!i||!o)return{start:l,end:l};r&&(--i,++o);return{start:_(l.line,i),end:_(l.line,o)}}(e,t,i,s);else if("W"===i)o=Pe(e,s,!0,!0);else if("w"===i)o=Pe(e,s,!0,!1);else{if("p"!==i)return null;if(o=ze(e,t,n.repeat,0,s),n.linewise=!0,r.visualMode)r.visualLine||(r.visualLine=!0);else{var a=r.inputState.operatorArgs;a&&(a.linewise=!0),o.end.line--}}return e.state.vim.visualMode?function(e,t,n){var r,i=e.state.vim.sel,o=i.head,s=i.anchor;be(n,t)&&(r=n,n=t,t=r);be(o,s)?(o=we(t,o),s=_e(s,n)):(s=we(t,s),-1==(o=pe(o=_e(o,n),0,-1)).ch&&o.line!=e.firstLine()&&(o=_(o.line-1,Se(e,o.line-1))));return[s,o]}(e,o.start,o.end):[o.start,o.end]},repeatLastCharacterSearch:function(e,t,n){var r=K.lastCharacterSearch,i=n.repeat,o=n.forward===r.forward,s=(r.increment?1:0)*(o?-1:1);e.moveH(-s,"char"),n.inclusive=!!o;var a=Ne(e,i,o,r.selectedCharacter);return a?(a.ch+=s,a):(e.moveH(s,"char"),t)}};function ce(e,t){for(var n=[],r=0;r<t;r++)n.push(e);return n}var ue={change:function(e,t,n){var r,i,o=e.state.vim,s=n[0].anchor,a=n[0].head;if(o.visualMode)if(t.fullLine)a.ch=Number.MAX_VALUE,a.line--,e.setSelection(s,a),i=e.getSelection(),e.replaceSelections(""),r=s;else{i=e.getSelection();var l=ce("",n.length);e.replaceSelections(l),r=we(n[0].head,n[0].anchor)}else{i=e.getRange(s,a);var c=o.lastEditInputState||{};if("moveByWords"==c.motion&&!H(i)){var u=/\s+$/.exec(i);u&&c.motionArgs&&c.motionArgs.forward&&(a=pe(a,0,-u[0].length),i=i.slice(0,-u[0].length))}var h=new _(s.line-1,Number.MAX_VALUE),d=e.firstLine()==e.lastLine();a.line>e.lastLine()&&t.linewise&&!d?e.replaceRange("",h,a):e.replaceRange("",s,a),t.linewise&&(d||(e.setCursor(h),g.commands.newlineAndIndent(e)),s.ch=Number.MAX_VALUE),r=s}K.registerController.pushText(t.registerName,"change",i,t.linewise,n.length>1),he.enterInsertMode(e,{head:r},e.state.vim)},delete:function(e,t,n){var r,i,o=e.state.vim;if(o.visualBlock){i=e.getSelection();var s=ce("",n.length);e.replaceSelections(s),r=n[0].anchor}else{var a=n[0].anchor,l=n[0].head;t.linewise&&l.line!=e.firstLine()&&a.line==e.lastLine()&&a.line==l.line-1&&(a.line==e.firstLine()?a.ch=0:a=_(a.line-1,Se(e,a.line-1))),i=e.getRange(a,l),e.replaceRange("",a,l),r=a,t.linewise&&(r=le.moveToFirstNonWhiteSpaceCharacter(e,a))}return K.registerController.pushText(t.registerName,"delete",i,t.linewise,o.visualBlock),de(e,r,o.insertMode)},indent:function(e,t,n){var r=e.state.vim,i=n[0].anchor.line,o=r.visualBlock?n[n.length-1].anchor.line:n[0].head.line,s=r.visualMode?t.repeat:1;t.linewise&&o--;for(var a=i;a<=o;a++)for(var l=0;l<s;l++)e.indentLine(a,t.indentRight);return le.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},indentAuto:function(e,t,n){return e.execCommand("indentAuto"),le.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},changeCase:function(e,t,n,r,i){for(var o=e.getSelections(),s=[],a=t.toLower,l=0;l<o.length;l++){var c=o[l],u="";if(!0===a)u=c.toLowerCase();else if(!1===a)u=c.toUpperCase();else for(var h=0;h<c.length;h++){var d=c.charAt(h);u+=B(d)?d.toLowerCase():d.toUpperCase()}s.push(u)}return e.replaceSelections(s),t.shouldMoveCursor?i:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?le.moveToFirstNonWhiteSpaceCharacter(e,r):t.linewise?r:we(n[0].anchor,n[0].head)},yank:function(e,t,n,r){var i=e.state.vim,o=e.getSelection(),s=i.visualMode?we(i.sel.anchor,i.sel.head,n[0].head,n[0].anchor):r;return K.registerController.pushText(t.registerName,"yank",o,t.linewise,i.visualBlock),s}};var he={jumpListWalk:function(e,t,n){if(!n.visualMode){var r=t.repeat,i=t.forward,o=K.jumpList.move(e,i?r:-r),s=o?o.find():void 0;s=s||e.getCursor(),e.setCursor(s),e.ace.curOp.command.scrollIntoView="center-animate"}},scroll:function(e,t,n){if(!n.visualMode){var r=t.repeat||1,i=e.defaultTextHeight(),o=e.getScrollInfo().top,s=i*r,a=t.forward?o+s:o-s,l=ve(e.getCursor()),c=e.charCoords(l,"local");if(t.forward)a>c.top?(l.line+=(a-c.top)/i,l.line=Math.ceil(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.top)):e.scrollTo(null,a);else{var u=a+e.getScrollInfo().clientHeight;u<c.bottom?(l.line-=(c.bottom-u)/i,l.line=Math.floor(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,a)}}},scrollToCursor:function(e,t){var n=e.getCursor().line,r=e.charCoords(_(n,0),"local"),i=e.getScrollInfo().clientHeight,o=r.top,s=r.bottom-o;switch(t.position){case"center":o=o-i/2+s;break;case"bottom":o=o-i+s}e.scrollTo(null,o)},replayMacro:function(e,t,n){var r=t.selectedCharacter,i=t.repeat,o=K.macroModeState;for("@"==r?r=o.latestRegister:o.latestRegister=r;i--;)ht(e,n,o,r)},enterMacroRecordMode:function(e,t){var n=K.macroModeState,r=t.selectedCharacter;K.registerController.isValidRegister(r)&&n.enterMacroRecordMode(e,r)},toggleOverwrite:function(e){e.state.overwrite?(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),g.signal(e,"vim-mode-change",{mode:"insert"})):(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),g.signal(e,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(e,t,n){if(!e.getOption("readOnly")){n.insertMode=!0,n.insertModeRepeat=t&&t.repeat||1;var r=t?t.insertAt:null,i=n.sel,o=t.head||e.getCursor("head"),s=e.listSelections().length;if("eol"==r)o=_(o.line,Se(e,o.line));else if("charAfter"==r)o=pe(o,0,1);else if("firstNonBlank"==r)o=le.moveToFirstNonWhiteSpaceCharacter(e,o);else if("startOfSelectedArea"==r){if(!n.visualMode)return;n.visualBlock?(o=_(Math.min(i.head.line,i.anchor.line),Math.min(i.head.ch,i.anchor.ch)),s=Math.abs(i.head.line-i.anchor.line)+1):o=i.head.line<i.anchor.line?i.head:_(i.anchor.line,0)}else if("endOfSelectedArea"==r){if(!n.visualMode)return;n.visualBlock?(o=_(Math.min(i.head.line,i.anchor.line),Math.max(i.head.ch+1,i.anchor.ch)),s=Math.abs(i.head.line-i.anchor.line)+1):o=i.head.line>=i.anchor.line?pe(i.head,0,1):_(i.anchor.line,0)}else if("inplace"==r&&n.visualMode)return;e.setOption("disableInput",!1),t&&t.replace?(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),g.signal(e,"vim-mode-change",{mode:"replace"})):(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),g.signal(e,"vim-mode-change",{mode:"insert"})),K.macroModeState.isPlaying||(e.on("change",dt),g.on(e.getInputField(),"keydown",vt)),n.visualMode&&Me(e),$e(e,o,s)}},toggleVisualMode:function(e,t,n){var r,i=t.repeat,o=e.getCursor();n.visualMode?n.visualLine^t.linewise||n.visualBlock^t.blockwise?(n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,g.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),Ee(e)):Me(e):(n.visualMode=!0,n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,r=de(e,_(o.line,o.ch+i-1),!0),n.sel={anchor:o,head:r},g.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),Ee(e),Be(e,n,"<",we(o,r)),Be(e,n,">",_e(o,r)))},reselectLastSelection:function(e,t,n){var r=n.lastSelection;if(n.visualMode&&Te(e,n),r){var i=r.anchorMark.find(),o=r.headMark.find();if(!i||!o)return;n.sel={anchor:i,head:o},n.visualMode=!0,n.visualLine=r.visualLine,n.visualBlock=r.visualBlock,Ee(e),Be(e,n,"<",we(i,o)),Be(e,n,">",_e(i,o)),g.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""})}},joinLines:function(e,t,n){var r,i;if(n.visualMode){if(r=e.getCursor("anchor"),be(i=e.getCursor("head"),r)){var o=i;i=r,r=o}i.ch=Se(e,i.line)-1}else{var s=Math.max(t.repeat,2);r=e.getCursor(),i=de(e,_(r.line+s-1,1/0))}for(var a=0,l=r.line;l<i.line;l++){a=Se(e,r.line);o=_(r.line+1,Se(e,r.line+1));var c=e.getRange(r,o);c=c.replace(/\n\s*/g," "),e.replaceRange(c,r,o)}var u=_(r.line,a);n.visualMode&&Me(e,!1),e.setCursor(u)},newLineAndEnterInsertMode:function(e,t,n){n.insertMode=!0;var r=ve(e.getCursor());r.line!==e.firstLine()||t.after?(r.line=t.after?r.line:r.line-1,r.ch=Se(e,r.line),e.setCursor(r),(g.commands.newlineAndIndentContinueComment||g.commands.newlineAndIndent)(e)):(e.replaceRange("\n",_(e.firstLine(),0)),e.setCursor(e.firstLine(),0));this.enterInsertMode(e,{repeat:t.repeat},n)},paste:function(e,t,n){var r=ve(e.getCursor()),i=K.registerController.getRegister(t.registerName);if(d=i.toString()){if(t.matchIndent){var o=e.getOption("tabSize"),s=function(e){var t=e.split("\t").length-1,n=e.split(" ").length-1;return t*o+1*n},a=e.getLine(e.getCursor().line),l=s(a.match(/^\s*/)[0]),c=d.replace(/\n$/,""),u=d!==c,h=s(d.match(/^\s*/)[0]),d=c.replace(/^\s*/gm,(function(t){var n=l+(s(t)-h);if(n<0)return"";if(e.getOption("indentWithTabs")){var r=Math.floor(n/o);return Array(r+1).join("\t")}return Array(n+1).join(" ")}));d+=u?"\n":""}if(t.repeat>1)d=Array(t.repeat+1).join(d);var f,p,g=i.linewise,m=i.blockwise;if(m){d=d.split("\n"),g&&d.pop();for(var v=0;v<d.length;v++)d[v]=""==d[v]?" ":d[v];r.ch+=t.after?1:0,r.ch=Math.min(Se(e,r.line),r.ch)}else g?n.visualMode?d=n.visualLine?d.slice(0,-1):"\n"+d.slice(0,d.length-1)+"\n":t.after?(d="\n"+d.slice(0,d.length-1),r.ch=Se(e,r.line)):r.ch=0:r.ch+=t.after?1:0;if(n.visualMode){var y;n.lastPastedText=d;var b=function(e,t){var n=t.lastSelection;return t.visualMode?function(){var t=e.listSelections(),n=t[0],r=t[t.length-1];return[be(n.anchor,n.head)?n.anchor:n.head,be(r.anchor,r.head)?r.head:r.anchor]}():function(){var t=e.getCursor(),r=e.getCursor(),i=n.visualBlock;if(i){var o=i.width,s=i.height;r=_(t.line+s,t.ch+o);for(var a=[],l=t.line;l<r.line;l++){var c={anchor:_(l,t.ch),head:_(l,r.ch)};a.push(c)}e.setSelections(a)}else{var u=n.anchorMark.find(),h=n.headMark.find(),d=h.line-u.line,f=h.ch-u.ch;r={line:r.line+d,ch:d?r.ch:f+r.ch},n.visualLine&&(t=_(t.line,0),r=_(r.line,Se(e,r.line))),e.setSelection(t,r)}return[t,r]}()}(e,n),w=b[0],C=b[1],S=e.getSelection(),k=e.listSelections(),A=new Array(k.length).join("1").split("1");n.lastSelection&&(y=n.lastSelection.headMark.find()),K.registerController.unnamedRegister.setText(S),m?(e.replaceSelections(A),C=_(w.line+d.length-1,w.ch),e.setCursor(w),xe(e,C),e.replaceSelections(d),f=w):n.visualBlock?(e.replaceSelections(A),e.setCursor(w),e.replaceRange(d,w,w),f=w):(e.replaceRange(d,w,C),f=e.posFromIndex(e.indexFromPos(w)+d.length-1)),y&&(n.lastSelection.headMark=e.setBookmark(y)),g&&(f.ch=0)}else if(m){e.setCursor(r);for(v=0;v<d.length;v++){var x=r.line+v;x>e.lastLine()&&e.replaceRange("\n",_(x,0)),Se(e,x)<r.ch&&Ae(e,x,r.ch)}e.setCursor(r),xe(e,_(r.line+d.length-1,r.ch)),e.replaceSelections(d),f=r}else e.replaceRange(d,r),g&&t.after?f=_(r.line+1,Le(e.getLine(r.line+1))):g&&!t.after?f=_(r.line,Le(e.getLine(r.line))):!g&&t.after?(p=e.indexFromPos(r),f=e.posFromIndex(p+d.length-1)):(p=e.indexFromPos(r),f=e.posFromIndex(p+d.length));n.visualMode&&Me(e,!1),e.setCursor(f)}},undo:function(e,t){e.operation((function(){me(e,g.commands.undo,t.repeat)(),e.setCursor(e.getCursor("anchor"))}))},redo:function(e,t){me(e,g.commands.redo,t.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){Be(e,n,t.selectedCharacter,e.getCursor())},replace:function(e,t,n){var r,i,o=t.selectedCharacter,s=e.getCursor(),a=e.listSelections();if(n.visualMode)s=e.getCursor("start"),i=e.getCursor("end");else{var l=e.getLine(s.line);(r=s.ch+t.repeat)>l.length&&(r=l.length),i=_(s.line,r)}if("\n"==o)n.visualMode||e.replaceRange("",s,i),(g.commands.newlineAndIndentContinueComment||g.commands.newlineAndIndent)(e);else{var c=e.getRange(s,i);if(c=c.replace(/[^\n]/g,o),n.visualBlock){var u=new Array(e.getOption("tabSize")+1).join(" ");c=(c=e.getSelection()).replace(/\t/g,u).replace(/[^\n]/g,o).split("\n"),e.replaceSelections(c)}else e.replaceRange(c,s,i);n.visualMode?(s=be(a[0].anchor,a[0].head)?a[0].anchor:a[0].head,e.setCursor(s),Me(e,!1)):e.setCursor(pe(i,0,-1))}},incrementNumberToken:function(e,t){for(var n,r,i,o,s=e.getCursor(),a=e.getLine(s.line),l=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi;null!==(n=l.exec(a))&&(i=(r=n.index)+n[0].length,!(s.ch<i)););if((t.backtrack||!(i<=s.ch))&&n){var c=n[2]||n[4],u=n[3]||n[5],h=t.increase?1:-1,d={"0b":2,0:8,"":10,"0x":16}[c.toLowerCase()];o=(parseInt(n[1]+u,d)+h*t.repeat).toString(d);var f=c?new Array(u.length-o.length+1+n[1].length).join("0"):"";o="-"===o.charAt(0)?"-"+c+f+o.substr(1):c+f+o;var p=_(s.line,r),g=_(s.line,i);e.replaceRange(o,p,g),e.setCursor(_(s.line,r+o.length-1))}},repeatLastEdit:function(e,t,n){if(n.lastEditInputState){var r=t.repeat;r&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=r:r=n.lastEditInputState.repeatOverride||r,yt(e,n,r,!1)}},indent:function(e,t){e.indentLine(e.getCursor().line,t.indentRight)},exitInsertMode:ct};function de(e,t,n){var r=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),i=Se(e,r)-1;i=n?i+1:i;var o=Math.min(Math.max(0,t.ch),i);return _(r,o)}function fe(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function pe(e,t,r){return"object"===n(t)&&(r=t.ch,t=t.line),_(e.line+t,e.ch+r)}function ge(e,t){if("<character>"==t.slice(-11)){var n=t.length-11,r=e.slice(0,n),i=t.slice(0,n);return r==i&&e.length>n?"full":0==i.indexOf(r)&&"partial"}return e==t?"full":0==t.indexOf(e)&&"partial"}function me(e,t,n){return function(){for(var r=0;r<n;r++)t(e)}}function ve(e){return _(e.line,e.ch)}function ye(e,t){return e.ch==t.ch&&e.line==t.line}function be(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function we(e,t){return arguments.length>2&&(t=we.apply(void 0,Array.prototype.slice.call(arguments,1))),be(e,t)?e:t}function _e(e,t){return arguments.length>2&&(t=_e.apply(void 0,Array.prototype.slice.call(arguments,1))),be(e,t)?t:e}function Ce(e,t,n){var r=be(e,t),i=be(t,n);return r&&i}function Se(e,t){return e.getLine(t).length}function ke(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Ae(e,t,n){var r=Se(e,t),i=new Array(n-r+1).join(" ");e.setCursor(_(t,r)),e.replaceRange(i,e.getCursor())}function xe(e,t){var n=[],r=e.listSelections(),i=ve(e.clipPos(t)),o=!ye(t,i),s=function(e,t,n){for(var r=0;r<e.length;r++){var i="head"!=n&&ye(e[r].anchor,t),o="anchor"!=n&&ye(e[r].head,t);if(i||o)return r}return-1}(r,e.getCursor("head")),a=ye(r[s].head,r[s].anchor),l=r.length-1,c=l-s>s?l:0,u=r[c].anchor,h=Math.min(u.line,i.line),d=Math.max(u.line,i.line),f=u.ch,p=i.ch,g=r[c].head.ch-f,m=p-f;g>0&&m<=0?(f++,o||p--):g<0&&m>=0?(f--,a||p++):g<0&&-1==m&&(f--,p++);for(var v=h;v<=d;v++){var y={anchor:new _(v,f),head:new _(v,p)};n.push(y)}return e.setSelections(n),t.ch=p,u.ch=f,u}function $e(e,t,n){for(var r=[],i=0;i<n;i++){var o=pe(t,i,0);r.push({anchor:o,head:o})}e.setSelections(r,0)}function Te(e,t){var n=t.sel.anchor,r=t.sel.head;t.lastPastedText&&(r=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(r),anchor:ve(n),head:ve(r),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function Ee(e,t,n){var r=e.state.vim,i=Re(e,t=t||r.sel,n=n||r.visualLine?"line":r.visualBlock?"block":"char");e.setSelections(i.ranges,i.primary),pt(e)}function Re(e,t,n,r){var i=ve(t.head),o=ve(t.anchor);if("char"==n){var s=r||be(t.head,t.anchor)?0:1,a=be(t.head,t.anchor)?1:0;return i=pe(t.head,0,s),{ranges:[{anchor:o=pe(t.anchor,0,a),head:i}],primary:0}}if("line"==n){if(be(t.head,t.anchor))i.ch=0,o.ch=Se(e,o.line);else{o.ch=0;var l=e.lastLine();i.line>l&&(i.line=l),i.ch=Se(e,i.line)}return{ranges:[{anchor:o,head:i}],primary:0}}if("block"==n){for(var c=Math.min(o.line,i.line),u=Math.min(o.ch,i.ch),h=Math.max(o.line,i.line),d=Math.max(o.ch,i.ch)+1,f=h-c+1,p=i.line==c?0:f-1,g=[],m=0;m<f;m++)g.push({anchor:_(c+m,u),head:_(c+m,d)});return{ranges:g,primary:p}}}function Me(e,t){var n=e.state.vim;!1!==t&&e.setCursor(de(e,n.sel.head)),Te(e,n),n.visualMode=!1,n.visualLine=!1,n.visualBlock=!1,g.signal(e,"vim-mode-change",{mode:"normal"}),n.fakeCursor&&n.fakeCursor.clear()}function Le(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function Pe(e,t,n,r,i){for(var o=function(e){var t=e.getCursor("head");return 1==e.getSelection().length&&(t=we(t,e.getCursor("anchor"))),t}(e),s=e.getLine(o.line),a=o.ch,l=i?R[0]:M[0];!l(s.charAt(a));)if(++a>=s.length)return null;r?l=M[0]:(l=R[0])(s.charAt(a))||(l=R[1]);for(var c=a,u=a;l(s.charAt(c))&&c<s.length;)c++;for(;l(s.charAt(u))&&u>=0;)u--;if(u++,t){for(var h=c;/\s/.test(s.charAt(c))&&c<s.length;)c++;if(h==c){for(var d=u;/\s/.test(s.charAt(u-1))&&u>0;)u--;u||(u=d)}}return{start:_(o.line,u),end:_(o.line,c)}}function Oe(e,t,n){ye(t,n)||K.jumpList.add(e,t,n)}function De(e,t){K.lastCharacterSearch.increment=e,K.lastCharacterSearch.forward=t.forward,K.lastCharacterSearch.selectedCharacter=t.selectedCharacter}var Ie={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},Fe={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};function je(e,t,n,r,i){var o=t.line,s=t.ch,a=e.getLine(o),l=n?1:-1,c=r?M:R;if(i&&""==a){if(o+=l,a=e.getLine(o),!j(e,o))return null;s=n?0:a.length}for(;;){if(i&&""==a)return{from:0,to:0,line:o};for(var u=l>0?a.length:-1,h=u,d=u;s!=u;){for(var f=!1,p=0;p<c.length&&!f;++p)if(c[p](a.charAt(s))){for(h=s;s!=u&&c[p](a.charAt(s));)s+=l;if(f=h!=(d=s),h==t.ch&&o==t.line&&d==h+l)continue;return{from:Math.min(h,d+1),to:Math.max(h,d),line:o}}f||(s+=l)}if(!j(e,o+=l))return null;a=e.getLine(o),s=l>0?0:a.length}}function Ne(e,t,n,r){for(var i,o=e.getCursor(),s=o.ch,a=0;a<t;a++){if(-1==(i=He(s,e.getLine(o.line),r,n,!0)))return null;s=i}return _(e.getCursor().line,i)}function Be(e,t,n,r){W(n,I)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(r))}function He(e,t,n,r,i){var o;return r?-1==(o=t.indexOf(n,e+1))||i||(o-=1):-1==(o=t.lastIndexOf(n,e-1))||i||(o+=1),o}function ze(e,t,n,r,i){var o,s=t.line,a=e.firstLine(),l=e.lastLine(),c=s;function u(t){return!/\S/.test(e.getLine(t))}function h(e,t,n){return n?u(e)!=u(e+t):!u(e)&&u(e+t)}function d(t){r=r>0?1:-1;var n=e.ace.session.getFoldLine(t);n&&t+r>n.start.row&&t+r<n.end.row&&(r=(r>0?n.end.row:n.start.row)-t)}if(r){for(;a<=c&&c<=l&&n>0;)d(c),h(c,r)&&n--,c+=r;return new _(c,0)}var f=e.state.vim;if(f.visualLine&&h(s,1,!0)){var p=f.sel.anchor;h(p.line,-1,!0)&&(i&&p.line==s||(s+=1))}var g=u(s);for(c=s;c<=l&&n;c++)h(c,1,!0)&&(i&&u(c)==g||n--);for(o=new _(c,0),c>l&&!g?g=!0:i=!1,c=s;c>a&&(i&&u(c)!=g&&c!=s||!h(c,-1,!0));c--);return{start:new _(c,0),end:o}}function We(){}function Ue(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new We)}function Ve(e,t,n,r,i){e.openDialog?e.openDialog(t,r,{bottom:!0,value:i.value,onKeyDown:i.onKeyDown,onKeyUp:i.onKeyUp,selectValueOnOpen:!1,onClose:function(){e.state.vim&&(e.state.vim.status="",e.ace.renderer.$loop.schedule(e.ace.renderer.CHANGE_CURSOR))}}):r(prompt(n,""))}function qe(e,t){var n=Ge(e,t)||[];if(!n.length)return[];var r=[];if(0===n[0]){for(var i=0;i<n.length;i++)"number"==typeof n[i]&&r.push(e.substring(n[i]+1,n[i+1]));return r}}function Ge(e,t){t||(t="/");for(var n=!1,r=[],i=0;i<e.length;i++){var o=e.charAt(i);n||o!=t||r.push(i),n=!n&&"\\"==o}return r}V("pcre",!0,"boolean"),We.prototype={getQuery:function(){return K.query},setQuery:function(e){K.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return K.isReversed},setReversed:function(e){K.isReversed=e},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(e){this.annotate=e}};var Ke={"\\n":"\n","\\r":"\r","\\t":"\t"};var Xe={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"};function Ye(e,t,n){if(K.registerController.getRegister("/").setText(e),e instanceof RegExp)return e;var r,i,o=Ge(e,"/");o.length?(r=e.substring(0,o[0]),i=-1!=e.substring(o[0]).indexOf("i")):r=e;return r?(G("pcre")||(r=function(e){for(var t=!1,n=[],r=-1;r<e.length;r++){var i=e.charAt(r)||"",o=e.charAt(r+1)||"",s=o&&-1!="|(){".indexOf(o);t?("\\"===i&&s||n.push(i),t=!1):"\\"===i?(t=!0,o&&-1!="}".indexOf(o)&&(s=!0),s&&"\\"!==o||n.push(i)):(n.push(i),s&&"\\"!==o&&n.push("\\"))}return n.join("")}(r)),n&&(t=/^[^A-Z]*$/.test(r)),new RegExp(r,t||i?"i":void 0)):null}function Je(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}var Qe="(Javascript regexp)";function Ze(e,t){var n,r,i,o=(t.prefix||"")+" "+(t.desc||"");Ve(e,(n=t.prefix,r=t.desc,i='<span style="font-family: monospace; white-space: pre">'+(n||"")+'<input type="text" autocorrect="off" autocapitalize="none" autocomplete="off"></span>',r&&(i+=' <span style="color: #888">'+r+"</span>"),i),o,t.onClose,t)}function et(e,t,n,r){if(t){var i=Ue(e),o=Ye(t,!!n,!!r);if(o)return tt(e,o),function(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],r=0;r<n.length;r++){var i=n[r];if(e[i]!==t[i])return!1}return!0}return!1}(o,i.getQuery())?o:(i.setQuery(o),o)}}function tt(e,t){var n=Ue(e),r=n.getOverlay();r&&t==r.query||(r&&e.removeOverlay(r),r=function(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(!t||n.sol()){var r=n.match(e,!1);if(r)return 0==r[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+r[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););}else n.skipToEnd()},query:e}}(t),e.addOverlay(r),e.showMatchesOnScrollbar&&(n.getScrollbarAnnotate()&&n.getScrollbarAnnotate().clear(),n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),n.setOverlay(r))}function nt(e,t,n,r){return void 0===r&&(r=1),e.operation((function(){for(var i=e.getCursor(),o=e.getSearchCursor(n,i),s=0;s<r;s++){var a=o.find(t);if(0==s&&a&&ye(o.from(),i)&&(a=o.find(t)),!a&&!(o=e.getSearchCursor(n,t?_(e.lastLine()):_(e.firstLine(),0))).find(t))return}return o.from()}))}function rt(e){var t=Ue(e);e.removeOverlay(Ue(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function it(e){var t=e.ace.renderer;return{top:t.getFirstFullyVisibleRow(),bottom:t.getLastFullyVisibleRow()}}function ot(e,t,n){var r=t.marks[n];return r&&r.find()}var st=function(){this.buildCommandMap_()};st.prototype={processCommand:function(e,t,n){var r=this;e.operation((function(){e.curOp.isVimOp=!0,r._processCommand(e,t,n)}))},_processCommand:function(e,t,n){var r=e.state.vim,i=K.registerController.getRegister(":"),o=i.toString();r.visualMode&&Me(e);var s=new g.StringStream(t);i.setText(t);var a,l,c=n||{};c.input=t;try{this.parseInput_(e,s,c)}catch(t){throw Je(e,t),t}if(c.commandName){if(a=this.matchCommand_(c.commandName)){if(l=a.name,a.excludeFromCommandHistory&&i.setText(o),this.parseCommandArgs_(s,c,a),"exToKey"==a.type){for(var u=0;u<a.toKeys.length;u++)g.Vim.handleKey(e,a.toKeys[u],"mapping");return}if("exToEx"==a.type)return void this.processCommand(e,a.toInput)}}else void 0!==c.line&&(l="move");if(l)try{at[l](e,c),a&&a.possiblyAsync||!c.callback||c.callback()}catch(t){throw Je(e,t),t}else Je(e,'Not an editor command ":'+t+'"')},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t)));var r=t.match(/^(\w+)/);return n.commandName=r?r[1]:t.match(/.*/)[0],n},parseLineSpec_:function(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return this.parseLineSpecOffset_(t,e.getCursor().line);case"$":return this.parseLineSpecOffset_(t,e.lastLine());case"'":var r=t.next(),i=ot(0,e.state.vim,r);if(!i)throw new Error("Mark not set");return this.parseLineSpecOffset_(t,i.line);case"-":case"+":return t.backUp(1),this.parseLineSpecOffset_(t,e.getCursor().line);default:return void t.backUp(1)}},parseLineSpecOffset_:function(e,t){var n=e.match(/^([+-])?(\d+)/);if(n){var r=parseInt(n[2],10);"-"==n[1]?t-=r:t+=r}return t},parseCommandArgs_:function(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)[0];var r=n.argDelimiter||/\s+/,i=ke(t.argString).split(r);i.length&&i[0]&&(t.args=i)}},matchCommand_:function(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var r=this.commandMap_[n];if(0===r.name.indexOf(e))return r}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<w.length;e++){var t=w[e],n=t.shortName||t.name;this.commandMap_[n]=t}},map:function(e,t,n){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var r=e.substring(1);":"!=t&&":"==t.charAt(0)?this.commandMap_[r]={name:r,type:"exToEx",toInput:t.substring(1),user:!0}:this.commandMap_[r]={name:r,type:"exToKey",toKeys:t,user:!0}}else if(":"!=t&&":"==t.charAt(0)){var i={keys:e,type:"keyToEx",exArgs:{input:t.substring(1)}};n&&(i.context=n),y.unshift(i)}else{i={keys:e,type:"keyToKey",toKeys:t};n&&(i.context=n),y.unshift(i)}},unmap:function(e,t){if(":"!=e&&":"==e.charAt(0)){if(t)throw Error("Mode not supported for ex mappings");var n=e.substring(1);if(this.commandMap_[n]&&this.commandMap_[n].user)return void delete this.commandMap_[n]}else for(var r=e,i=0;i<y.length;i++)if(r==y[i].keys&&y[i].context===t)return void y.splice(i,1)}};var at={colorscheme:function(e,t){!t.args||t.args.length<1?Je(e,e.getOption("theme")):e.setOption("theme",t.args[0])},map:function(e,t,n){var r=t.args;!r||r.length<2?e&&Je(e,"Invalid mapping: "+t.input):lt.map(r[0],r[1],n)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var r=t.args;!r||r.length<1?e&&Je(e,"No such mapping: "+t.input):lt.unmap(r[0],n)},move:function(e,t){ae.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,r=t.setCfg||{};if(!n||n.length<1)e&&Je(e,"Invalid mapping: "+t.input);else{var i=n[0].split("="),o=i[0],s=i[1],a=!1;if("?"==o.charAt(o.length-1)){if(s)throw Error("Trailing characters: "+t.argString);o=o.substring(0,o.length-1),a=!0}void 0===s&&"no"==o.substring(0,2)&&(o=o.substring(2),s=!1);var l=U[o]&&"boolean"==U[o].type;if(l&&null==s&&(s=!0),!l&&void 0===s||a){var c=G(o,e,r);c instanceof Error?Je(e,c.message):Je(e,!0===c||!1===c?" "+(c?"":"no")+o:"  "+o+"="+c)}else{var u=q(o,s,e,r);u instanceof Error&&Je(e,u.message)}}},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,t){var n=t.args,r=K.registerController.registers,i="----------Registers----------<br><br>";if(n){n=n.join("");for(var o=0;o<n.length;o++){if(s=n.charAt(o),K.registerController.isValidRegister(s))i+='"'+s+"    "+(r[s]||new ie).toString()+"<br>"}}else for(var s in r){var a=r[s].toString();a.length&&(i+='"'+s+"    "+a+"<br>")}Je(e,i)},sort:function(e,t){var n,r,i,o,s;var a=function(){if(t.argString){var e=new g.StringStream(t.argString);if(e.eat("!")&&(n=!0),e.eol())return;if(!e.eatSpace())return"Invalid arguments";var a=e.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!a&&!e.eol())return"Invalid arguments";if(a[1]){r=-1!=a[1].indexOf("i"),i=-1!=a[1].indexOf("u");var l=-1!=a[1].indexOf("d")||-1!=a[1].indexOf("n")&&1,c=-1!=a[1].indexOf("x")&&1,u=-1!=a[1].indexOf("o")&&1;if(l+c+u>1)return"Invalid arguments";o=(l?"decimal":c&&"hex")||u&&"octal"}a[2]&&(s=new RegExp(a[2].substr(1,a[2].length-2),r?"i":""))}}();if(a)Je(e,a+": "+t.argString);else{var l=t.line||e.firstLine(),c=t.lineEnd||t.line||e.lastLine();if(l!=c){var u=_(l,0),h=_(c,Se(e,c)),d=e.getRange(u,h).split("\n"),f=s||("decimal"==o?/(-?)([\d]+)/:"hex"==o?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==o?/([0-7]+)/:null),p="decimal"==o?10:"hex"==o?16:"octal"==o?8:null,m=[],v=[];if(o||s)for(var y=0;y<d.length;y++){var b=s?d[y].match(s):null;b&&""!=b[0]?m.push(b):!s&&f.exec(d[y])?m.push(d[y]):v.push(d[y])}else v=d;if(m.sort(s?function(e,t){var i;return n&&(i=e,e=t,t=i),r&&(e[0]=e[0].toLowerCase(),t[0]=t[0].toLowerCase()),e[0]<t[0]?-1:1}:S),s)for(y=0;y<m.length;y++)m[y]=m[y].input;else o||v.sort(S);if(d=n?m.concat(v):v.concat(m),i){var w,C=d;d=[];for(y=0;y<C.length;y++)C[y]!=w&&d.push(C[y]),w=C[y]}e.replaceRange(d.join("\n"),u,h)}}function S(e,t){var i;n&&(i=e,e=t,t=i);r&&(e=e.toLowerCase(),t=t.toLowerCase());var s=o&&f.exec(e),a=o&&f.exec(t);return s?(s=parseInt((s[1]+s[2]).toLowerCase(),p))-(a=parseInt((a[1]+a[2]).toLowerCase(),p)):e<t?-1:1}},global:function(e,t){var n=t.argString;if(n){var r,i=void 0!==t.line?t.line:e.firstLine(),o=t.lineEnd||t.line||e.lastLine(),s=function(e){return qe(e,"/")}(n),a=n;if(s.length&&(a=s[0],r=s.slice(1,s.length).join("/")),a)try{et(e,a,!0,!0)}catch(t){return void Je(e,"Invalid regex: "+a)}for(var l=Ue(e).getQuery(),c=[],u="",h=i;h<=o;h++){l.test(e.getLine(h))&&(c.push(h+1),u+=e.getLine(h)+"<br>")}if(r){var d=0;!function t(){if(d<c.length){var n=c[d]+r;lt.processCommand(e,n,{callback:t})}d++}()}else Je(e,u)}else Je(e,"Regular Expression missing from global")},substitute:function(e,t){if(!e.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var n,r,i,o,s=t.argString,a=s?qe(s,s[0]):[],l="",c=!1,u=!1;if(a.length)n=a[0],l=a[1],n&&"$"===n[n.length-1]&&(n=n.slice(0,n.length-1)+"\\n",l=l?l+"\n":"\n"),void 0!==l&&(l=G("pcre")?function(e){for(var t=new g.StringStream(e),n=[];!t.eol();){for(;t.peek()&&"\\"!=t.peek();)n.push(t.next());var r=!1;for(var i in Xe)if(t.match(i,!0)){r=!0,n.push(Xe[i]);break}r||n.push(t.next())}return n.join("")}(l):function(e){for(var t,n=!1,r=[],i=-1;i<e.length;i++){var o=e.charAt(i)||"",s=e.charAt(i+1)||"";Ke[o+s]?(r.push(Ke[o+s]),i++):n?(r.push(o),n=!1):"\\"===o?(n=!0,t=s,E.test(t)||"$"===s?r.push("$"):"/"!==s&&"\\"!==s&&r.push("\\")):("$"===o&&r.push("$"),r.push(o),"/"===s&&r.push("\\"))}return r.join("")}(l),K.lastSubstituteReplacePart=l),r=a[2]?a[2].split(" "):[];else if(s&&s.length)return void Je(e,"Substitutions should be of the form :s/pattern/replace/");if(r&&(i=r[0],o=parseInt(r[1]),i&&(-1!=i.indexOf("c")&&(c=!0,i.replace("c","")),-1!=i.indexOf("g")&&(u=!0,i.replace("g","")),n=n.replace(/\//g,"\\/")+"/"+i)),n)try{et(e,n,!0,!0)}catch(t){return void Je(e,"Invalid regex: "+n)}if(void 0!==(l=l||K.lastSubstituteReplacePart)){var h=Ue(e).getQuery(),d=void 0!==t.line?t.line:e.getCursor().line,f=t.lineEnd||d;d==e.firstLine()&&f==e.lastLine()&&(f=1/0),o&&(f=(d=f)+o-1);var p=de(e,_(d,0)),m=e.getSearchCursor(h,p);!function(e,t,n,r,i,o,s,a,l){e.state.vim.exMode=!0;var c=!1,u=o.from();function h(){e.operation((function(){for(;!c;)d(),f();p()}))}function d(){var t=e.getRange(o.from(),o.to()).replace(s,a);o.replace(t)}function f(){for(;o.findNext()&&(t=o.from(),s=r,a=i,"number"!=typeof t&&(t=t.line),s instanceof Array?W(t,s):a?t>=s&&t<=a:t==s);)if(n||!u||o.from().line!=u.line)return e.scrollIntoView(o.from(),30),e.setSelection(o.from(),o.to()),u=o.from(),void(c=!1);var t,s,a;c=!0}function p(t){if(t&&t(),e.focus(),u){e.setCursor(u);var n=e.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=u.ch}l&&l()}if(f(),c)return void Je(e,"No matches for "+s.source);if(!t)return h(),void(l&&l());Ze(e,{prefix:"replace with <strong>"+a+"</strong> (y/n/a/q/l)",onKeyDown:function(t,n,r){switch(g.e_stop(t),g.keyName(t)){case"Y":d(),f();break;case"N":f();break;case"A":var i=l;l=void 0,e.operation(h),l=i;break;case"L":d();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":p(r)}return c&&p(r),!0}})}(e,c,u,d,f,m,h,l,t.callback)}else Je(e,"No previous substitute regular expression")},redo:g.commands.redo,undo:g.commands.undo,write:function(e){g.commands.save?g.commands.save(e):e.save&&e.save()},nohlsearch:function(e){rt(e)},yank:function(e){var t=ve(e.getCursor()).line,n=e.getLine(t);K.registerController.pushText("0","yank",n,!0,!0)},delmarks:function(e,t){if(t.argString&&ke(t.argString))for(var n=e.state.vim,r=new g.StringStream(ke(t.argString));!r.eol();){r.eatSpace();var i=r.pos;if(!r.match(/[a-zA-Z]/,!1))return void Je(e,"Invalid argument: "+t.argString.substring(i));var o=r.next();if(r.match("-",!0)){if(!r.match(/[a-zA-Z]/,!1))return void Je(e,"Invalid argument: "+t.argString.substring(i));var s=o,a=r.next();if(!(N(s)&&N(a)||B(s)&&B(a)))return void Je(e,"Invalid argument: "+s+"-");var l=s.charCodeAt(0),c=a.charCodeAt(0);if(l>=c)return void Je(e,"Invalid argument: "+t.argString.substring(i));for(var u=0;u<=c-l;u++){var h=String.fromCharCode(l+u);delete n.marks[h]}}else delete n.marks[o]}else Je(e,"Argument required")}},lt=new st;function ct(e){var t=e.state.vim,n=K.macroModeState,r=K.registerController.getRegister("."),i=n.isPlaying,o=n.lastInsertModeChanges;i||(e.off("change",dt),g.off(e.getInputField(),"keydown",vt)),!i&&t.insertModeRepeat>1&&(yt(e,t,t.insertModeRepeat-1,!0),t.lastEditInputState.repeatOverride=t.insertModeRepeat),delete t.insertModeRepeat,t.insertMode=!1,e.setCursor(e.getCursor().line,e.getCursor().ch-1),e.setOption("keyMap","vim"),e.setOption("disableInput",!0),e.toggleOverwrite(!1),r.setText(o.changes.join("")),g.signal(e,"vim-mode-change",{mode:"normal"}),n.isRecording&&function(e){if(e.isPlaying)return;var t=e.latestRegister,n=K.registerController.getRegister(t);n&&n.pushInsertModeChanges&&n.pushInsertModeChanges(e.lastInsertModeChanges)}(n)}function ut(e){y.unshift(e)}function ht(e,t,n,r){var i=K.registerController.getRegister(r);if(":"==r)return i.keyBuffer[0]&&lt.processCommand(e,i.keyBuffer[0]),void(n.isPlaying=!1);var o=i.keyBuffer,s=0;n.isPlaying=!0,n.replaySearchQueries=i.searchQueries.slice(0);for(var a=0;a<o.length;a++)for(var l,c,u=o[a];u;)if(c=(l=/<\w+-.+?>|<\w+>|./.exec(u))[0],u=u.substring(l.index+c.length),g.Vim.handleKey(e,c,"macro"),t.insertMode){var h=i.insertModeChanges[s++].changes;K.macroModeState.lastInsertModeChanges.changes=h,bt(e,h,1),ct(e)}n.isPlaying=!1}function dt(e,t){var n=K.macroModeState,r=n.lastInsertModeChanges;if(!n.isPlaying)for(;t;){if(r.expectCursorActivityForChange=!0,r.ignoreCount>1)r.ignoreCount--;else if("+input"==t.origin||"paste"==t.origin||void 0===t.origin){var i=e.listSelections().length;i>1&&(r.ignoreCount=i);var o=t.text.join("\n");r.maybeReset&&(r.changes=[],r.maybeReset=!1),o&&(e.state.overwrite&&!/\n/.test(o)?r.changes.push([o]):r.changes.push(o))}t=t.next}}function ft(e){var t=e.state.vim;if(t.insertMode){var n=K.macroModeState;if(n.isPlaying)return;var r=n.lastInsertModeChanges;r.expectCursorActivityForChange?r.expectCursorActivityForChange=!1:r.maybeReset=!0}else e.curOp.isVimOp||gt(e,t);t.visualMode&&pt(e)}function pt(e){var t=e.state.vim,n=de(e,ve(t.sel.head)),r=pe(n,0,1);t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(n,r,{className:"cm-animate-fat-cursor"})}function gt(e,t,n){var r=e.getCursor("anchor"),i=e.getCursor("head");if(t.visualMode&&!e.somethingSelected()?Me(e,!1):t.visualMode||t.insertMode||!e.somethingSelected()||(t.visualMode=!0,t.visualLine=!1,g.signal(e,"vim-mode-change",{mode:"visual"})),t.visualMode){var o=be(i,r)?0:-1,s=be(i,r)?-1:0;i=pe(i,0,o),r=pe(r,0,s),t.sel={anchor:r,head:i},Be(e,t,"<",we(i,r)),Be(e,t,">",_e(i,r))}else t.insertMode||n||(t.lastHPos=e.getCursor().ch)}function mt(e){this.keyName=e}function vt(e){var t=K.macroModeState.lastInsertModeChanges,n=g.keyName(e);n&&(-1==n.indexOf("Delete")&&-1==n.indexOf("Backspace")||g.lookupKey(n,"vim-insert",(function(){return t.maybeReset&&(t.changes=[],t.maybeReset=!1),t.changes.push(new mt(n)),!0})))}function yt(e,t,n,r){var i=K.macroModeState;i.isPlaying=!0;var o=!!t.lastEditActionCommand,s=t.inputState;function a(){o?ae.processAction(e,t,t.lastEditActionCommand):ae.evalInput(e,t)}function l(n){if(i.lastInsertModeChanges.changes.length>0){n=t.lastEditActionCommand?n:1;var r=i.lastInsertModeChanges;bt(e,r.changes,n)}}if(t.inputState=t.lastEditInputState,o&&t.lastEditActionCommand.interlaceInsertRepeat)for(var c=0;c<n;c++)a(),l(1);else r||a(),l(n);t.inputState=s,t.insertMode&&!r&&ct(e),i.isPlaying=!1}function bt(e,t,n){function r(t){return"string"==typeof t?g.commands[t](e):t(e),!0}var i=e.getCursor("head"),o=K.macroModeState.lastInsertModeChanges.visualBlock;o&&($e(e,i,o+1),n=e.listSelections().length,e.setCursor(i));for(var s=0;s<n;s++){o&&e.setCursor(pe(i,s,0));for(var a=0;a<t.length;a++){var l=t[a];if(l instanceof mt)g.lookupKey(l.keyName,"vim-insert",r);else if("string"==typeof l){var c=e.getCursor();e.replaceRange(l,c,c)}else{var u=e.getCursor(),h=pe(u,0,l[0].length);e.replaceRange(l[0],u,h)}}}o&&e.setCursor(pe(i,0,1))}g.keyMap.vim={attach:k,detach:S,call:A},V("insertModeEscKeysTimeout",200,"number"),g.keyMap["vim-insert"]={fallthrough:["default"],attach:k,detach:S,call:A},g.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:k,detach:S,call:A},ee(),g.Vim=C(),C=g.Vim;var wt={return:"CR",backspace:"BS",delete:"Del",esc:"Esc",left:"Left",right:"Right",up:"Up",down:"Down",space:"Space",home:"Home",end:"End",pageup:"PageUp",pagedown:"PageDown",enter:"CR"};var _t=C.handleKey.bind(C);function Ct(e){var t=new e.constructor;return Object.keys(e).forEach((function(r){var i=e[r];Array.isArray(i)?i=i.slice():i&&"object"==n(i)&&i.constructor!=Object&&(i=Ct(i)),t[r]=i})),e.sel&&(t.sel={head:e.sel.head&&ve(e.sel.head),anchor:e.sel.anchor&&ve(e.sel.anchor)}),t}C.handleKey=function(e,t,n){return e.operation((function(){return _t(e,t,n)}),!0)},t.CodeMirror=g;var St=C.maybeInitVimState_;function kt(e,t){t.off("beforeEndOperation",kt);var n=t.state.cm.vimCmd;n&&t.execCommand(n.exec?n:n.name,n.args),t.curOp=t.prevOp}t.handler={$id:"ace/keyboard/vim",drawCursor:function(e,t,n,r,o){var a=this.state.vim||{},l=n.characterWidth,c=n.lineHeight,u=t.top,h=t.left;a.insertMode||!(r.cursor?i.comparePoints(r.cursor,r.start)<=0:o.selection.isBackwards()||o.selection.isEmpty())&&h>l&&(h-=l);!a.insertMode&&a.status&&(u+=c/=2),s.translate(e,h,u),s.setStyle(e.style,"width",l+"px"),s.setStyle(e.style,"height",c+"px")},handleKeyboard:function(e,t,n,r,i){var o=e.editor,s=o.state.cm,a=St(s);if(-1!=r){if(a.insertMode||(-1==t?(n.charCodeAt(0)>255&&e.inputKey&&(n=e.inputKey)&&4==e.inputHash&&(n=n.toUpperCase()),e.inputChar=n):4==t||0==t?e.inputKey==n&&e.inputHash==t&&e.inputChar?(n=e.inputChar,t=-1):(e.inputChar=null,e.inputKey=n,e.inputHash=t):e.inputChar=e.inputKey=null),"c"==n&&1==t&&!h.isMac&&o.getCopyText())return o.once("copy",(function(){o.selection.clearSelection()})),{command:"null",passEvent:!0};if("esc"==n&&!a.insertMode&&!a.visualMode&&!s.ace.inMultiSelectMode){var l=Ue(s).getOverlay();l&&s.removeOverlay(l)}if(-1==t||1&t||0===t&&n.length>1){var c=a.insertMode,u=function(e,t,n){t.length>1&&"n"==t[0]&&(t=t.replace("numpad","")),t=wt[t]||t;var r="";return n.ctrlKey&&(r+="C-"),n.altKey&&(r+="A-"),(r||t.length>1)&&n.shiftKey&&(r+="S-"),(r+=t).length>1&&(r="<"+r+">"),r}(0,n,i||{});null==a.status&&(a.status="");var d=function(e,t,n){var r=!1,i=C.maybeInitVimState_(e),o=i.visualBlock||i.wasInVisualBlock,s=e.ace.inMultiSelectMode;if(i.wasInVisualBlock&&!s?i.wasInVisualBlock=!1:s&&i.visualBlock&&(i.wasInVisualBlock=!0),"<Esc>"!=t||i.insertMode||i.visualMode||!s)if(o||!s||e.ace.inVirtualSelectionMode)r=C.handleKey(e,t,n);else{var a=Ct(i);e.operation((function(){e.ace.forEachSelection((function(){var i=e.ace.selection;e.state.vim.lastHPos=null==i.$desiredColumn?i.lead.column:i.$desiredColumn;var o=e.getCursor("head"),s=e.getCursor("anchor"),l=be(o,s)?0:-1,c=be(o,s)?-1:0;o=pe(o,0,l),s=pe(s,0,c),e.state.vim.sel.head=o,e.state.vim.sel.anchor=s,r=_t(e,t,n),i.$desiredColumn=-1==e.state.vim.lastHPos?null:e.state.vim.lastHPos,e.virtualSelectionMode()&&(e.state.vim=Ct(a))})),e.curOp.cursorActivity&&!r&&(e.curOp.cursorActivity=!1)}),!0)}else e.ace.exitMultiSelectMode();return!r||i.visualMode||i.insert||i.visualMode==e.somethingSelected()||gt(e,i,!0),r}(s,u,"user");if(a=St(s),d&&null!=a.status?a.status+=u:null==a.status&&(a.status=""),s._signal("changeStatus"),!d&&(-1!=t||c))return;return{command:"null",passEvent:!d}}}},attach:function(e){e.state||(e.state={});var t=new g(e);function n(){var n=St(t).insertMode;t.ace.renderer.setStyle("normal-mode",!n),e.textInput.setCommandMode(!n),e.renderer.$keepTextAreaAtCursor=n,e.renderer.$blockCursor=!n}e.state.cm=t,e.$vimModeHandler=this,g.keyMap.vim.attach(t),St(t).status=null,t.on("vim-command-done",(function(){t.virtualSelectionMode()||(St(t).status=null,t.ace._signal("changeStatus"),t.ace.session.markUndoGroup())})),t.on("changeStatus",(function(){t.ace.renderer.updateCursor(),t.ace._signal("changeStatus")})),t.on("vim-mode-change",(function(){t.virtualSelectionMode()||(n(),t._signal("changeStatus"))})),n(),e.renderer.$cursorLayer.drawCursor=this.drawCursor.bind(t)},detach:function(e){var t=e.state.cm;g.keyMap.vim.detach(t),t.destroy(),e.state.cm=null,e.$vimModeHandler=null,e.renderer.$cursorLayer.drawCursor=null,e.renderer.setStyle("normal-mode",!1),e.textInput.setCommandMode(!1),e.renderer.$keepTextAreaAtCursor=!0},getStatusText:function(e){var t=e.state.cm,n=St(t);if(n.insertMode)return"INSERT";var r="";return n.visualMode&&(r+="VISUAL",n.visualLine&&(r+=" LINE"),n.visualBlock&&(r+=" BLOCK")),n.status&&(r+=(r?" ":"")+n.status),r}},C.defineOption({name:"wrap",set:function(e,t){t&&t.ace.setOption("wrap",e)},type:"boolean"},!1),C.defineEx("write","w",(function(){console.log(":write is not implemented")})),y.push({keys:"zc",type:"action",action:"fold",actionArgs:{open:!1}},{keys:"zC",type:"action",action:"fold",actionArgs:{open:!1,all:!0}},{keys:"zo",type:"action",action:"fold",actionArgs:{open:!0}},{keys:"zO",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"za",type:"action",action:"fold",actionArgs:{toggle:!0}},{keys:"zA",type:"action",action:"fold",actionArgs:{toggle:!0,all:!0}},{keys:"zf",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"zd",type:"action",action:"fold",actionArgs:{open:!0,all:!0}},{keys:"<C-A-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAbove"}},{keys:"<C-A-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelow"}},{keys:"<C-A-S-k>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorAboveSkipCurrent"}},{keys:"<C-A-S-j>",type:"action",action:"aceCommand",actionArgs:{name:"addCursorBelowSkipCurrent"}},{keys:"<C-A-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreBefore"}},{keys:"<C-A-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectMoreAfter"}},{keys:"<C-A-S-h>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextBefore"}},{keys:"<C-A-S-l>",type:"action",action:"aceCommand",actionArgs:{name:"selectNextAfter"}}),he.aceCommand=function(e,t,n){e.vimCmd=t,e.ace.inVirtualSelectionMode?e.ace.on("beforeEndOperation",kt):kt(null,e.ace)},he.fold=function(e,t,n){e.ace.execCommand(["toggleFoldWidget","toggleFoldWidget","foldOther","unfoldall"][(t.all?2:0)+(t.open?1:0)])},t.handler.defaultKeymap=y,t.handler.actions=he,t.Vim=C})),ace.require(["ace/keyboard/vim"],(function(r){"object"==n(e)&&"object"==n(t)&&e&&(e.exports=r)}))}).call(this,n(8)(e))},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4)],void 0===(i=function(){var e=ace.require("ace/undomanager").UndoManager;return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.editor=e,this.onChangeSession=this.onChangeSession.bind(this),this.onChange=this.onChange.bind(this)}var n,r,i;return n=t,(r=[{key:"onChangeSession",value:function(t){t.setUndoManager(new e)}},{key:"onChange",value:function(e){var t=this;e.remote&&setTimeout((function(){t.editor.getSession().getUndoManager().reset()}))}}])&&o(n.prototype,r),i&&o(n,i),t}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(167),n(168),n(169),n(170),n(4),n(68)],void 0===(i=function(e,t,n,r){var i=ace.require("ace/range").Range,a=ace.require("ace/snippets").snippetManager;return function(){function l(e,t,n,r,i,o,s){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.$scope=e,this.editor=t,this.element=n,this.metadataManager=r,this.graphics=i,this.preamble=o,this.files=s,this.monkeyPatchAutocomplete(),this.$scope.$watch("autoComplete",(function(e){e?a.enable():a.disable()}));var c=function(e){a.onChange(e)};this.editor.on("changeSession",(function(e){e.oldSession.off("change",c),e.session.on("change",c)}))}var c,u,h;return c=l,(u=[{key:"enable",value:function(){var i=this;this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1});var s=new e(this.metadataManager),a=new t,l=new n(this.metadataManager,r),c=this.graphics,u=this.preamble,h=this.files,d={getCompletions:function(e,t,n,i,o){var s=r.getContext(e,n).commandFragment;if(s){var a=s.match(/^~?\\(includegraphics(?:\[.*])?){([^}]*, *)?(\w*)/);if(a){var l=a[1],h=u.getGraphicsPaths(),d=[],f=!0,p=!1,g=void 0;try{for(var m,v=c.getGraphicsFiles()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var y=m.value.path,b=!0,w=!1,_=void 0;try{for(var C,S=h[Symbol.iterator]();!(b=(C=S.next()).done);b=!0){var k=C.value;if(0===y.indexOf(k)){y=y.slice(k.length);break}}}catch(e){w=!0,_=e}finally{try{b||null==S.return||S.return()}finally{if(w)throw _}}d.push({caption:"\\".concat(l,"{").concat(y,"}"),value:"\\".concat(l,"{").concat(y,"}"),meta:"graphic",score:50})}}catch(e){p=!0,g=e}finally{try{f||null==v.return||v.return()}finally{if(p)throw g}}o(null,d)}}}},f=this.metadataManager,p={getCompletions:function(e,t,n,o,s){var a=r.getContext(e,n).commandFragment;if(a){var l=a.match(/^\\(input|include){(\w*)/);if(l){var c=l[1],u=[],d=!0,f=!1,p=void 0;try{for(var g,m=h.getTeXFiles()[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var v=g.value;if(v.id!==i.$scope.docId){var y=v.path;u.push({caption:"\\".concat(c,"{").concat(y,"}"),value:"\\".concat(c,"{").concat(y,"}"),meta:"file",score:50})}}}catch(e){f=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw p}}s(null,u)}}}},g={getCompletions:function(e,t,n,i,o){var s=r.getContext(e,n).commandFragment;if(s){var a=s.match(/^~?\\([a-zA-Z]*ref){([^}]*, *)?(\w*)/);if(a){var l=a[1],c=[];"ref"!==l&&c.push({caption:"\\".concat(l,"{}"),snippet:"\\".concat(l,"{}"),meta:"cross-reference",score:60});var u=!0,h=!1,d=void 0;try{for(var p,g=f.getAllLabels()[Symbol.iterator]();!(u=(p=g.next()).done);u=!0){var m=p.value;c.push({caption:"\\".concat(l,"{").concat(m,"}"),value:"\\".concat(l,"{").concat(m,"}"),meta:"cross-reference",score:50})}}catch(e){h=!0,d=e}finally{try{u||null==g.return||g.return()}finally{if(h)throw d}}o(null,c)}}}},m=this.$scope.$root._references,v={getCompletions:function(e,t,n,i,s){var a=r.getContext(e,n).commandFragment;if(a){var l=a.match(/^~?\\([a-z]*cite[a-z]*(?:\[.*])?){([^}]*, *)?(\w*)/);if(l){var c=o(l,3),u=(c[0],c[1]),h=c[2];null==h&&(h="");var d=h.length>8?"…,":h,f=[];f.push({caption:"\\".concat(u,"{}"),snippet:"\\".concat(u,"{}"),meta:"reference",score:60}),m.keys&&m.keys.length>0?(m.keys.forEach((function(e){null!=e&&f.push({caption:"\\".concat(u,"{").concat(d).concat(e,"}"),value:"\\".concat(u,"{").concat(h).concat(e,"}"),meta:"reference",score:50})})),s(null,f)):s(null,f)}}}};this.editor.completers=[s,a,l,v,g,d,p]}},{key:"disable",value:function(){return this.editor.setOptions({enableBasicAutocompletion:!1,enableSnippets:!1})}},{key:"onChange",value:function(e){var t,n=this,i=this.editor.getCursorPosition(),o=e.end,s=r.getContext(this.editor,o),a=s.lineUpToCursor,l=s.commandFragment;if(!((t=a.indexOf("%"))>-1&&"\\"!==a[t-1])){var c="\\"===a.slice(-1),u=a.slice(-2);if(!/^\\[^a-zA-Z]$/.test(u)){e.remote||"insert"!==e.action||o.row!==i.row||o.column!==i.column+1||((null!=l?l.length:void 0)>2||c)&&setTimeout((function(){n.editor.execCommand("startAutocomplete")}),0);var h=e.lines[0].match(/\\(\w+){}/);return"insert"===e.action&&h&&h[1]&&/(begin|end|[a-zA-Z]*ref|usepackage|[a-z]*cite[a-z]*|input|include)/.test(h[1])?setTimeout((function(){n.editor.execCommand("startAutocomplete")}),0):void 0}this.editor.completer&&this.editor.completer.detach()}}},{key:"monkeyPatchAutocomplete",value:function(){var e=this,t=ace.require("ace/autocomplete").Autocomplete,n=ace.require("ace/autocomplete/util");null==t.prototype._insertMatch&&(t.prototype._insertMatch=t.prototype.insertMatch,t.prototype.insertMatch=function(e){var n=this.editor,o=n.getCursorPosition(),s=new i(o.row,o.column,o.row,o.column+1),l=n.session.getTextRange(s);if(/^\\\w+(\[[\w\\,=. ]*\])?{/.test(this.completions.filterText)&&"}"===l&&n.session.remove(s),null==e){var c=this.completions,u=this.popup;(e=u.getData(u.getRow())).completer={insertMatch:function(e,t){var n=!0,o=!1,l=void 0;try{for(var u,h=e.selection.getAllRanges()[Symbol.iterator]();!(n=(u=h.next()).done);n=!0){s=u.value;var d=_.clone(s),f=_.clone(s),p=e.getSession().getTextRange(new i(s.start.row,0,s.start.row,s.start.column)),g=r.getLastCommandFragmentIndex(p);-1!==g?d.start.column=g:d.start.column-=c.filterText.length,e.session.remove(d);var m=e.getSession().getTextRange(new i(f.start.row,f.start.column,f.end.row,99999));if(m){var v=m.match(/^([a-zA-Z0-9]+)\{/);if(v){var y=v[1];f.end.column+=y.length-c.filterText.length,e.session.remove(f),null!=t.snippet&&(t.snippet=t.snippet.replace(/[{[].*[}\]]/,"")),null!=t.caption&&(t.caption=t.caption.replace(/[{[].*[}\]]/,"")),null!=t.value&&(t.value=t.value.replace(/[{[].*[}\]]/,""))}var b=m.match(/^([\w._-]+)\}(.*)/);if(b){var w=b[1];b[2]&&(f.end.column=f.start.column+w.length+1),e.session.remove(f)}}}}catch(e){o=!0,l=e}finally{try{n||null==h.return||h.return()}finally{if(o)throw l}}t.snippet?a.insertSnippet(e,t.snippet):e.execCommand("insertstring",t.value||t)}}}t.prototype._insertMatch.call(this,e)},t.startCommand={name:"startAutocomplete",exec:function(n){var r;n.completer||(n.completer=new t),n.completer.autoInsert=!1,n.completer.autoSelect=!0,n.completer.showPopup(n),n.completer.cancelContextMenu();var i=$(null!=n.completer.popup?n.completer.popup.container:void 0);if(i.css({"font-size":e.$scope.fontSize+"px"}),r=n.completer.completions&&n.completer.completions.filtered){var o=_.max(r.map((function(e){return e.caption.length}))),s=_.max(r.map((function(e){return e.meta.length}))),a=n.renderer.characterWidth,l=Math.max(Math.min(Math.round(o*a+s*a+5*a),700),280);i.css({width:"".concat(l,"px")})}0===r.length&&n.completer.detach()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"}),n.retrievePrecedingIdentifier=function(e,t,n){for(var i=0,o=t-1;o<=0;o++)if("\n"===e[o]){i=o+1;break}var s=e.slice(i,t);return r.getLastCommandFragment(s)||""}}}])&&s(c.prototype,u),h&&s(c,h),l}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}r=[n(66)],void 0===(i=function(e){var t=function(){function e(t,n){o(this,e),this.doc=t,this.prefix=n}return a(e,null,[{key:"initClass",value:function(){this.prototype.commandRegex=/\\([a-zA-Z]{2,})/}}]),a(e,[{key:"parse",value:function(){var e,t,n,r=null;t="undefined"!=typeof window&&null!==window?window._ide:void 0,n=function(e){return e.browserIsSafari},(null!=t?n(t):void 0)&&(r=5e3);for(var i=[],o=[],s={},a=0;e=this.nextCommand();){if(a+=1,r&&a>r)return i;for(var l=this.doc,c=0;this.consumeArgument("[","]");)c++;for(var u=0;this.consumeArgument("{","}");)u++;var h="".concat(e,"\\").concat(c,"\\").concat(u);null!=this.prefix&&"\\".concat(e)===this.prefix?o.push([e,c,u]):null==s[h]&&(s[h]=!0,i.push([e,c,u])),this.doc=l}if(o.length>1){var d=o.sort((function(e,t){return e[1]+e[2]<t[1]+t[2]}))[0];i.push(d)}return i}},{key:"nextCommand",value:function(){var e=this.doc.search(this.commandRegex);if(-1===e)return!1;var t=this.doc.match(this.commandRegex)[1];return this.doc=this.doc.substr(e+t.length+1),t}},{key:"consumeWhitespace",value:function(){var e=this.doc.match(/^[ \t\n]*/m)[0];return this.doc=this.doc.substr(e.length)}},{key:"consumeArgument",value:function(e,t){if(this.consumeWhitespace(),this.doc[0]===e){for(var n=1,r=1;r>0&&n<this.doc.length;)this.doc[n]===e?r++:this.doc[n]===t&&r--,n++;return 0===r&&(this.doc=this.doc.substr(n),!0)}return!1}}]),e}();return t.initClass(),function(){function n(e){o(this,n),this.metadataManager=e}return a(n,[{key:"getCompletions",value:function(n,r,i,o,s){for(var a={},l=0,c=Array.from(e);l<c.length;l++){var u=c[l];a[u.caption.match(/\w+/)[0]]=!0}var h=this.metadataManager.getAllPackages(),d=[];for(var f in h)for(var p=h[f],g=0,m=Array.from(p);g<m.length;g++)u=m[g],d.push(u),a[u.caption.match(/\w+/)[0]]=!0;for(var v=r.getValue(),y=new t(v,o).parse(),b=[],w=0,C=Array.from(y);w<C.length;w++){var S=C[w];if(!a[S[0]]){var k="\\".concat(S[0]),A=k===o?99:50;u=k;var x=1;_.times(S[1],(function(){return u+="[${".concat(x,"}]"),k+="[]",x++})),_.times(S[2],(function(){return u+="{${".concat(x,"}}"),k+="{}",x++})),b.push({caption:k,snippet:u,meta:"cmd",score:A})}}return s(null,b=b.concat(e,d))}},{key:"loadCommandsFromDoc",value:function(e){var n=new t(e);return this.commands=n.parse()}},{key:"getSuggestions",value:function(e){var t=_.filter(this.commands,(function(t){return t[0].slice(0,e.length)===e}));return _.map(t,(function(t){var n,r,i="\\".concat(e),o="";_.times(t[1],(function(){return o+="[]"})),_.times(t[2],(function(){return o+="{}"}));var s=t[0].slice(e.length);return 0===t[1]+t[2]?(r=s,n=""):(r=s+o[0],n=o.slice(1)),{base:i,completion:s+o,completionBeforeCursor:r,completionAfterCursor:n}}))}}]),n}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(67)],void 0===(i=function(e){var t=Array.from(e.withoutSnippets).map((function(e){return{caption:"\\begin{".concat(e,"}..."),snippet:"\\begin{".concat(e,"}\n\t$1\n\\end{").concat(e,"}"),meta:"env"}}));t=t.concat([{caption:"\\begin{array}...",snippet:"\\begin{array}{${1:cc}}\n\t$2 & $3 \\\\\\\\\n\t$4 & $5\n\\end{array}",meta:"env"},{caption:"\\begin{figure}...",snippet:"\\begin{figure}\n\t\\centering\n\t\\includegraphics{$1}\n\t\\caption{${2:Caption}}\n\t\\label{${3:fig:my_label}}\n\\end{figure}",meta:"env"},{caption:"\\begin{tabular}...",snippet:"\\begin{tabular}{${1:c|c}}\n\t$2 & $3 \\\\\\\\\n\t$4 & $5\n\\end{tabular}",meta:"env"},{caption:"\\begin{table}...",snippet:"\\begin{table}[$1]\n\t\\centering\n\t\\begin{tabular}{${2:c|c}}\n\t\t$3 & $4 \\\\\\\\\n\t\t$5 & $6\n\t\\end{tabular}\n\t\\caption{${7:Caption}}\n\t\\label{${8:tab:my_label}}\n\\end{table}",meta:"env"},{caption:"\\begin{list}...",snippet:"\\begin{list}\n\t\\item $1\n\\end{list}",meta:"env"},{caption:"\\begin{enumerate}...",snippet:"\\begin{enumerate}\n\t\\item $1\n\\end{enumerate}",meta:"env"},{caption:"\\begin{itemize}...",snippet:"\\begin{itemize}\n\t\\item $1\n\\end{itemize}",meta:"env"},{caption:"\\begin{frame}...",snippet:"\\begin{frame}{${1:Frame Title}}\n\t$2\n\\end{frame}",meta:"env"}]);var n={caption:"\\begin{document}...",snippet:"\\begin{document}\n$1\n\\end{document}",meta:"env"},r={caption:"\\begin{thebibliography}...",snippet:"\\begin{thebibliography}{$1}\n\\bibitem{$2}\n$3\n\\end{thebibliography}",meta:"env"};t.push(n);return function(){function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i)}var s,a,l;return s=i,(a=[{key:"getCompletions",value:function(i,o,s,a,l){var c,u=o.getValue(),h=function(e){for(var t,n=/^\\newenvironment{(\w+)}.*$/gm,r=[],i=0;t=n.exec(e);)if(r.push({name:t[1],whitespace:null}),(i+=1)>=1e3)return r;return r}(u),d=function(t){for(var n,r=/^\\begin{(\w+)}.*\n([\t ]*).*$/gm,i=[],o=0;n=r.exec(t);)if(!Array.from(e.all).includes(n[1])&&"document"!==n[1]&&(i.push({name:n[1],whitespace:n[2]}),(o+=1)>=1e3))return i;return i}(u);null!==/^\\begin{document}/m.exec(u)?-1!==(c=t.indexOf(n))&&t.splice(c,1):t.push(n),function(e){return null!==/^\\begin{thebibliography}/m.exec(e)}(u)?-1!==(c=t.indexOf(r))&&t.splice(c,1):t.push(r);for(var f={},p=0,g=Array.from(h);p<g.length;p++){var m=g[p];f[m.name]=m}for(var v=0,y=Array.from(d);v<y.length;v++){var b=y[v];f[b.name]=b}var w=_.values(f);return l(null,t.concat(w.map((function(e){return{caption:"\\begin{".concat(e.name,"}..."),snippet:"\\begin{".concat(e.name,"}\n").concat(e.whitespace||"","$0\n\\end{").concat(e.name,"}"),meta:"env"}}))).concat(w.map((function(e){return{caption:"\\end{".concat(e.name,"}"),value:"\\end{".concat(e.name,"}"),meta:"env"}}))))}}])&&o(s.prototype,a),l&&o(s,l),i}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){var e=["inputenc","graphicx","amsmath","geometry","amssymb","hyperref","babel","color","xcolor","url","natbib","fontenc","fancyhdr","amsfonts","booktabs","amsthm","float","tikz","caption","setspace","multirow","array","multicol","titlesec","enumitem","ifthen","listings","blindtext","subcaption","times","bm","subfigure","algorithm","fontspec","biblatex","tabularx","microtype","etoolbox","parskip","calc","verbatim","mathtools","epsfig","wrapfig","lipsum","cite","textcomp","longtable","textpos","algpseudocode","enumerate","subfig","pdfpages","epstopdf","latexsym","lmodern","pifont","ragged2e","rotating","dcolumn","xltxtra","marvosym","indentfirst","xspace","csquotes","xparse","changepage","soul","xunicode","comment","mathrsfs","tocbibind","lastpage","algorithm2e","pgfplots","lineno","graphics","algorithmic","fullpage","mathptmx","todonotes","ulem","tweaklist","moderncvstyleclassic","collection","moderncvcompatibility","gensymb","helvet","siunitx","adjustbox","placeins","colortbl","appendix","makeidx","supertabular","ifpdf","framed","aliascnt","layaureo","authblk"];return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.metadataManager=e}var n,r,o;return n=t,(r=[{key:"getCompletions",value:function(t,n,r,i,o){for(var s=Object.keys(this.metadataManager.getAllPackages()),a=[],l=0,c=Array.from(e);l<c.length;l++){var u=c[l];Array.from(s).includes(u)||a.push({caption:"\\usepackage{".concat(u,"}"),snippet:"\\usepackage{".concat(u,"}"),meta:"pkg"})}return a.push({caption:"\\usepackage{}",snippet:"\\usepackage{$1}",meta:"pkg",score:70}),o(null,a)}}])&&i(n.prototype,r),o&&i(n,o),t}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(4),n(68)],void 0===(i=function(){var e=ace.require("ace/range").Range,t={getLastCommandFragment:function(e){var n;return(n=t.getLastCommandFragmentIndex(e))>-1?e.slice(n):null},getLastCommandFragmentIndex:function(e){var t;return(t=e.replace(/\[([^\]]*)\]/g,(function(e){return Array(e.length+1).join(".")})).match(/(\\[^\\]*)$/))?t.index:-1},getCommandNameFromFragment:function(e){return t=null!=e?e.match(/\\(\w+)\{/):void 0,n=function(e){return e[1]},null!=t?n(t):void 0;var t,n},getContext:function(n,r){var i=new e(r.row,0,r.row,r.column),o=n.getSession().getTextRange(i),s=t.getLastCommandFragment(o),a=t.getCommandNameFromFragment(s),l=new e(r.row,r.column,r.row,99999);return{lineUpToCursor:o,commandFragment:s,commandName:a,lineBeyondCursor:n.getSession().getTextRange(l)}}};return t}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4),n(172)],void 0===(i=function(e,t){var n=ace.require("ace/range").Range;return function(){function e(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.replaceWord=this.replaceWord.bind(this),this.editor=n,this.highlightedWordManager=new t(this.editor)}var r,i,s;return r=e,(i=[{key:"getLines",value:function(){return this.editor.getValue().split("\n")}},{key:"normalizeChangeEvent",value:function(e){return e}},{key:"getCoordsFromContextMenuEvent",value:function(e){return e.domEvent.stopPropagation(),{x:e.domEvent.clientX,y:e.domEvent.clientY}}},{key:"preventContextMenuEventDefault",value:function(e){return e.domEvent.preventDefault()}},{key:"getHighlightFromCoords",value:function(e){var t=this.editor.renderer.screenToTextCoordinates(e.x,e.y);return this.highlightedWordManager.findHighlightWithinRange({start:t,end:t})}},{key:"isContextMenuEventOnBottomHalf",value:function(e){var t=e.domEvent.clientY,n=e.target.container.getBoundingClientRect();return(t-n.top)/n.height>.5}},{key:"selectHighlightedWord",value:function(e){var t=e.range.start.row,r=e.range.start.column,i=e.range.end.column;return this.editor.getSession().getSelection().setSelectionRange(new n(t,r,t,i))}},{key:"replaceWord",value:function(e,t){var r=e.range.start.row,i=e.range.start.column,o=e.range.end.column;return this.editor.getSession().replace(new n(r,i,r,o),t),this.editor.focus()}}])&&o(r.prototype,i),s&&o(r,s),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r=[n(4)],void 0===(i=function(){var e=ace.require("ace/range").Range,t=function e(t,n,r){s(this,e),this.markerId=t,this.range=n,this.word=r.word,this.suggestions=r.suggestions};return function(){function n(e){s(this,n),this.editor=e,this.reset()}var r,i,a;return r=n,(i=[{key:"reset",value:function(){var e=this;return null!=this.highlights&&this.highlights.forEach((function(t){return e.editor.getSession().removeMarker(t.markerId)})),this.highlights=[]}},{key:"addHighlight",value:function(n){var r=this.editor.getSession(),i=r.getDocument(),o=new e;o.start=i.createAnchor({row:n.row,column:n.column}),o.end=i.createAnchor({row:n.row,column:n.column+n.word.length}),o.end.$insertRight=!0;var s=r.addMarker(o,"spelling-highlight","text",!1);return this.highlights.push(new t(s,o,n))}},{key:"removeHighlight",value:function(e){return this.editor.getSession().removeMarker(e.markerId),this.highlights=this.highlights.filter((function(t){return t!==e}))}},{key:"removeWord",value:function(e){var t=this;return this.highlights.filter((function(t){return t.word===e})).forEach((function(e){return t.removeHighlight(e)}))}},{key:"clearRow",value:function(e){var t=this;return this.highlights.filter((function(t){return t.range.start.row===e})).forEach((function(e){return t.removeHighlight(e)}))}},{key:"findHighlightWithinRange",value:function(e){var t=this;return _.find(this.highlights,(function(n){return t._doesHighlightOverlapRange(n,e.start,e.end)}))}},{key:"_doesHighlightOverlapRange",value:function(e,t,n){var r=e.range.start.row,i=e.range.start.column,o=e.range.end.column,s=r<t.row||r===t.row&&o<=t.column,a=r>n.row||r===n.row&&i>=n.column;return!(s||a)}},{key:"clearHighlightTouchingRange",value:function(e){var t=this,n=_.find(this.highlights,(function(n){return t._doesHighlightTouchRange(n,e.start,e.end)}));if(n)return this.removeHighlight(n)}},{key:"_doesHighlightTouchRange",value:function(e,t,n){var r=e.range.start.row,i=e.range.start.column,o=e.range.end.column,s=i<=t.column&&o>=t.column,a=i<=n.column&&o>=n.column;return r===t.row&&(s||a)}}])&&o(r.prototype,i),a&&o(r,a),n}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4),n(7)],void 0===(i=function(e,t){var n=ace.require("ace/range").Range;return function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$scope=t,this.editor=n,this.element=r,this.markerIds=[],this.labels=[],this.$scope.annotationLabel={show:!1,right:"auto",left:"auto",top:"auto",bottom:"auto",backgroundColor:"black",text:""},this.$scope.updateLabels={updatesAbove:0,updatesBelow:0},this.$scope.$watch("highlights",(function(e){return i.redrawAnnotations()})),this.$scope.$watch("theme",(function(e){return i.redrawAnnotations()})),this.editor.on("mousemove",(function(e){var t=i.editor.renderer.screenToTextCoordinates(e.clientX,e.clientY);return e.position=t,i.showAnnotationLabels(t)}));var o=function(){return i.updateShowMoreLabels()};this.editor.getSession().on("changeScrollTop",o),this.$scope.$watch("text",(function(){if(i.$scope.navigateHighlights)return setTimeout((function(){return i.scrollToFirstHighlight()}),0)})),this.editor.on("changeSession",(function(e){return null!=e.oldSession&&e.oldSession.off("changeScrollTop",o),e.session.on("changeScrollTop",o),i.redrawAnnotations()})),this.$scope.gotoHighlightBelow=function(){if(null!=i.firstHiddenHighlightAfter)return i.editor.scrollToLine(i.firstHiddenHighlightAfter.end.row,!0,!1)},this.$scope.gotoHighlightAbove=function(){if(null!=i.lastHiddenHighlightBefore)return i.editor.scrollToLine(i.lastHiddenHighlightBefore.start.row,!0,!1)}}var r,i,s;return r=e,(i=[{key:"redrawAnnotations",value:function(){var e=this;this._clearMarkers(),this._clearLabels();for(var r=0,i=Array.from(this.$scope.highlights||[]);r<i.length;r++)!function(r){var i=t.getColorScheme(r.hue,e.element);null!=r.cursor?(e.labels.push({text:r.label,range:new n(r.cursor.row,r.cursor.column,r.cursor.row,r.cursor.column+1),colorScheme:i,snapToStartOfRange:!0}),e._drawCursor(r,i)):null!=r.highlight?(e.labels.push({text:r.label,range:new n(r.highlight.start.row,r.highlight.start.column,r.highlight.end.row,r.highlight.end.column),colorScheme:i}),e._drawHighlight(r,i)):null!=r.strikeThrough&&(e.labels.push({text:r.label,range:new n(r.strikeThrough.start.row,r.strikeThrough.start.column,r.strikeThrough.end.row,r.strikeThrough.end.column),colorScheme:i}),e._drawStrikeThrough(r,i))}(i[r]);return this.updateShowMoreLabels()}},{key:"showAnnotationLabels",value:function(e){for(var t,n,r=this,i=null,o=0,s=Array.from(this.labels||[]);o<s.length;o++){var a=s[o];a.range.contains(e.row,e.column)&&(i=a)}if(null!=i){var l,c,u,h,d,f=$(this.editor.renderer.container).find(".ace_scroller");f.append(this.element.find(".annotation-label")),c=i.snapToStartOfRange?this.editor.renderer.textToScreenCoordinates(i.range.start.row,i.range.start.column):this.editor.renderer.textToScreenCoordinates(e.row,e.column);var p=f.offset(),g=f.height();c.pageX=c.pageX-p.left,c.pageY=c.pageY-p.top,c.pageY>2*this.editor.renderer.lineHeight?(d="auto",l=g-c.pageY):(d=c.pageY+this.editor.renderer.lineHeight,l="auto"),this.$scope.$apply((function(){return r.$scope.annotationLabel.text=i.text,r.$scope.annotationLabel.show=!0}));var m=this.element.find(".annotation-label");return c.pageX+m.outerWidth()<f.width()?(u=c.pageX,h="auto"):(h=0,u="auto"),this.$scope.$apply((function(){return r.$scope.annotationLabel={show:!0,left:u,right:h,bottom:l,top:d,backgroundColor:i.colorScheme.labelBackgroundColor,text:i.text}}))}if(!1!==(t=null!=this.$scope?this.$scope.annotationLabel:void 0,n=function(e){return e.show},null!=t?n(t):void 0))return this.$scope.$apply((function(){return r.$scope.annotationLabel.show=!1}))}},{key:"updateShowMoreLabels",value:function(){var e=this;if(this.$scope.navigateHighlights)return setTimeout((function(){var t=e.editor.getFirstVisibleRow(),n=e.editor.getLastVisibleRow(),r=0,i=0;e.lastHiddenHighlightBefore=null,e.firstHiddenHighlightAfter=null;for(var o=0,s=Array.from(e.$scope.highlights||[]);o<s.length;o++){var a=s[o],l=a.highlight||a.strikeThrough;null!=l&&(l.start.row<t&&(r+=1,e.lastHiddenHighlightBefore=l),l.end.row>n&&(i+=1,e.firstHiddenHighlightAfter||(e.firstHiddenHighlightAfter=l)))}return e.$scope.$apply((function(){return e.$scope.updateLabels={highlightsBefore:r,highlightsAfter:i}}))}),100)}},{key:"scrollToFirstHighlight",value:function(){var e=this;return function(){for(var t=0,n=Array.from(e.$scope.highlights||[]);t<n.length;t++){var r=n[t],i=r.highlight||r.strikeThrough;if(null!=i){e.editor.scrollToLine(i.start.row,!0,!1);break}}return[]}()}},{key:"_clearMarkers",value:function(){for(var e=0,t=Array.from(this.markerIds);e<t.length;e++){var n=t[e];this.editor.getSession().removeMarker(n)}return this.markerIds=[]}},{key:"_clearLabels",value:function(){return this.labels=[]}},{key:"_drawCursor",value:function(e,t){return this._addMarkerWithCustomStyle(new n(e.cursor.row,e.cursor.column,e.cursor.row,e.cursor.column+1),"annotation remote-cursor",!1,"border-color: ".concat(t.cursor,";"))}},{key:"_drawHighlight",value:function(e,t){return this._addMarkerWithCustomStyle(new n(e.highlight.start.row,e.highlight.start.column,e.highlight.end.row,e.highlight.end.column),"annotation highlight",!1,"background-color: ".concat(t.highlightBackgroundColor))}},{key:"_drawStrikeThrough",value:function(e,t){return this._addMarkerWithCustomStyle(new n(e.strikeThrough.start.row,e.strikeThrough.start.column,e.strikeThrough.end.row,e.strikeThrough.end.column),"annotation strike-through-background",!1,"background-color: ".concat(t.strikeThroughBackgroundColor)),this._addMarkerWithCustomStyle(new n(e.strikeThrough.start.row,e.strikeThrough.start.column,e.strikeThrough.end.row,e.strikeThrough.end.column),"annotation strike-through-foreground",!0,"color: ".concat(t.strikeThroughForegroundColor,";"))}},{key:"_addMarkerWithCustomStyle",value:function(e,t,n,r){var i;return i=n?this.editor.renderer.$markerFront:this.editor.renderer.$markerBack,this.markerIds.push(this.editor.getSession().addMarker(e,t,(function(e,n,o,s,a){return n.isMultiLine()?i.drawTextMarker(e,n,t,a,r):i.drawSingleLineMarker(e,n,"".concat(t," ace_start"),a,0,r)}),n))}}])&&o(r.prototype,i),s&&o(r,s),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(24)],void 0===(i=function(e){return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.editor=e}var n,r,i;return n=t,(r=[{key:"getCursor",value:function(){return this.editor.getCursorPosition()}},{key:"getEditorScrollPosition",value:function(){return this.editor.getFirstVisibleRow()}},{key:"setCursor",value:function(e){return e=e.cursorPosition||{row:0,column:0},this.editor.moveCursorToPosition(e)}},{key:"setEditorScrollPosition",value:function(e){return e=e.firstVisibleLine||0,this.editor.scrollToLine(e)}},{key:"clearSelection",value:function(){return this.editor.selection.clearSelection()}},{key:"gotoLine",value:function(e,t){return this.editor.gotoLine(e,t),this.editor.scrollToLine(e,!0,!0),this.editor.focus()}},{key:"gotoOffset",value:function(t){var n=this.editor.getSession().getDocument().getAllLines(),r=e.shareJsOffsetToRowColumn(t,n);return this.gotoLine(r.row+1,r.column)}}])&&o(n.prototype,r),i&&o(n,i),t}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4),n(24)],void 0===(i=function(e,t){var n=ace.require("ace/range").Range;return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.editor=t,this.changeIdToMarkerIdMap={}}var r,i,s;return r=e,(i=[{key:"tearDown",value:function(){this.changeIdToMarkerIdMap={}}},{key:"clearAnnotations",value:function(){var e=this.editor.getSession();for(var t in this.changeIdToMarkerIdMap){var n=this.changeIdToMarkerIdMap[t];for(var r in n){var i=n[r];e.removeMarker(i)}}this.changeIdToMarkerIdMap={}}},{key:"onInsertAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),r=this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length),i=this.editor.getSession(),o=new n(t.row,t.column,r.row,r.column),s=i.addMarker(o,"track-changes-marker track-changes-added-marker","text"),a=this.createCalloutMarker(t,"track-changes-added-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:s,callout_marker_id:a}}},{key:"onDeleteAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.editor.getSession(),r=this.editor.renderer.$markerBack,i="track-changes-marker track-changes-deleted-marker",o=this.makeZeroWidthRange(t),s=n.addMarker(o,i,(function(e,t,n,o,s){return r.drawSingleLineMarker(e,t,"".concat(i," ace_start"),s,0,"")})),a=this.createCalloutMarker(t,"track-changes-deleted-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:s,callout_marker_id:a}}},{key:"onInsertRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var i=this.editor.getSession();i.removeMarker(n),i.removeMarker(r)}}},{key:"onDeleteRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var i=this.editor.getSession();i.removeMarker(n),i.removeMarker(r)}}},{key:"onChangeMoved",value:function(e){var t,n=this.shareJsOffsetToRowColumn(e.op.p);t=null!=e.op.i?this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length):n,this.updateMarker(e.id,n,t)}},{key:"onCommentAdded",value:function(e){if(null==this.changeIdToMarkerIdMap[e.id]){var t=this.shareJsOffsetToRowColumn(e.op.p),r=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length),i=this.editor.getSession(),o=new n(t.row,t.column,r.row,r.column),s=i.addMarker(o,"track-changes-marker track-changes-comment-marker","text"),a=this.createCalloutMarker(t,"track-changes-comment-marker-callout");this.changeIdToMarkerIdMap[e.id]={background_marker_id:s,callout_marker_id:a}}}},{key:"onCommentMoved",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length);this.updateMarker(e.id,t,n)}},{key:"onCommentRemoved",value:function(e){if(null!=this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id],n=t.background_marker_id,r=t.callout_marker_id;delete this.changeIdToMarkerIdMap[e.id];var i=this.editor.getSession();i.removeMarker(n),i.removeMarker(r)}}},{key:"updateMarker",value:function(e,t,n){if(null!=this.changeIdToMarkerIdMap[e]){var r=this.editor.getSession().getMarkers(),i=this.changeIdToMarkerIdMap[e],o=i.background_marker_id,s=i.callout_marker_id;if(null!=o&&null!=r[o]){var a=r[o];a.range.start=t,a.range.end=n}if(null!=s&&null!=r[s]){var l=r[s];l.range.start=t,l.range.end=t}}}},{key:"shareJsOffsetToRowColumn",value:function(e){var n=this.editor.getSession().getDocument().getAllLines();return t.shareJsOffsetToRowColumn(e,n)}},{key:"createCalloutMarker",value:function(e,t){var n=this.editor.getSession(),r=this.makeZeroWidthRange(e),i=this.editor.renderer.$markerBack;return n.addMarker(r,t,(function(e,n,r,o,s){return i.drawSingleLineMarker(e,n,"track-changes-marker-callout ".concat(t," ace_start"),s,0,"width: auto; right: 0;")}))}},{key:"makeZeroWidthRange",value:function(e){var t=new n(e.row,e.column,e.row,e.column);return t.clipRows=function(e,t){return this.isEmpty=function(){return e>this.end.row||t<this.start.row},this},t}}])&&o(r.prototype,i),s&&o(r,s),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(4)],void 0===(i=function(){var e=ace.require("ace/range").Range,t=function(e){var t;return(t=e.match(/(\\[^\\]+)$/))?t[1]:null};return function(){function n(r,i,o,s){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.$scope=r,this.editor=i,this.element=o,this.Metadata=s,this.debouncer={};var l=function(n){if(!n.remote&&["remove","insert"].includes(n.action)){a.editor.getCursorPosition();var r=n.end,i=new e(r.row,0,r.row,r.column),o=a.editor.getSession().getTextRange(i);"%"!==o.trim()&&"\\"!==o.slice(0,1)||(i=new e(r.row,0,r.row,r.column+80),o=a.editor.getSession().getTextRange(i));var s=t(o),l=_.any(n.lines,(function(e){return e.match(/^\\usepackage(?:\[.{0,80}?])?{(.{0,80}?)}/)})),c=_.any(n.lines,(function(e){return e.match(/^\\RequirePackage(?:\[.{0,80}?])?{(.{0,80}?)}/)})),u=_.any(n.lines,(function(e){return e.match(/\\label{(.{0,80}?)}/)})),h=l||u||c,d="\\label{"===(null!=s?s.slice(0,7):void 0),f="\\usepackage"===(null!=s?s.slice(0,11):void 0),p="\\RequirePackage"===(null!=s?s.slice(0,15):void 0);return h||(f||d||p)?a.Metadata.scheduleLoadDocMetaFromServer(a.$scope.docId):void 0}};this.editor.on("changeSession",(function(e){return e.oldSession.off("change",l),e.session.on("change",l)}))}var r,i,s;return r=n,(i=[{key:"getAllLabels",value:function(){return this.Metadata.getAllLabels()}},{key:"getAllPackages",value:function(){return this.Metadata.getAllPackages()}}])&&o(r.prototype,i),s&&o(r,s),n}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("metadata",["$http","ide",function(e,t){var n={},r={documents:{}},i={state:r,onBroadcastDocMeta:function(e){if(null!=e.docId&&null!=e.meta)return r.documents[e.docId]=e.meta},onEntityDeleted:function(e,t){if("doc"===t.type)return delete r.documents[t.id]},onFileUploadComplete:function(e,t){if("doc"===t.entity_type)return i.loadDocMetaFromServer(t.entity_id)},getAllLabels:function(){return _.flatten(function(){var e=[];for(var t in r.documents){var n=r.documents[t];e.push(n.labels)}return e}())},getAllPackages:function(){var e={};for(var t in r.documents){var n=r.documents[t];for(var i in n.packages){var o=n.packages[i];e[i]=o}}return e},loadProjectMetaFromServer:function(){return e.get("/project/".concat(window.project_id,"/metadata")).then((function(e){var t=e.data;if(t.projectMeta)return function(){var e=[];for(var n in t.projectMeta){var i=t.projectMeta[n];e.push(r.documents[n]=i)}return e}()}))},loadDocMetaFromServer:function(t){return e.post("/project/".concat(window.project_id,"/doc/").concat(t,"/metadata"),{_csrf:window.csrfToken})},scheduleLoadDocMetaFromServer:function(e){var t=n[e];return null!=t&&(clearTimeout(t),delete n[e]),n[e]=setTimeout((function(){return i.loadDocMetaFromServer(e),delete n[e]}),1e3)}};return i}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("graphics",["ide",function(e){return{getGraphicsFiles:function(){var t=[];return e.fileTreeManager.forEachEntity((function(e,n,r){if("file"===e.type&&(o=null!=e?e.name:void 0,s="match",a=function(e){return e.match(/.*\.(png|jpg|jpeg|pdf|eps)/i)},null!=o&&"function"==typeof o[s]?a(o,s):void 0)){var i=_.clone(e);return i.path=r,t.push(i)}var o,s,a})),t}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){return e.factory("preamble",["ide",function(e){var t={getPreambleText:function(){return o(e.editorManager.getCurrentDocValue().slice(0,5e3).match(/([^]*)^\\begin\{document\}/m),(function(e){return e[1]}))||""},getGraphicsPaths:function(){for(var e,n=o(t.getPreambleText().match(/\\graphicspath\{(.*)\}/),(function(e){return e[1]}))||"",r=[],i=/\{([^}]*)\}/g;e=i.exec(n);)r.push(e[1]);return r}};return t}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("files",["ide",function(e){return{getTeXFiles:function(){var t=[];return e.fileTreeManager.forEachEntity((function(e,n,r){if("doc"===e.type&&/.*\.(tex|md|txt|tikz)/.test(e.name)){var i=_.clone(e);i.path=r,t.push(i)}})),t}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("toggleSwitch",(function(){return{restrict:"E",scope:{description:"@",labelFalse:"@",labelTrue:"@",ngModel:"="},template:'<fieldset class="toggle-switch">\n    <legend class="sr-only">{{description}}</legend>\n\n    <input\n      type="radio"\n      name="toggle-switch-{{$id}}"\n      class="toggle-switch-input"\n      id="toggle-switch-false-{{$id}}"\n      ng-value="false"\n      ng-model="ngModel"\n    >\n    <label for="toggle-switch-false-{{$id}}" class="toggle-switch-label">{{labelFalse}}</label>\n\n    <input\n      type="radio"\n      class="toggle-switch-input"\n      name="toggle-switch-{{$id}}"\n      id="toggle-switch-true-{{$id}}"\n      ng-value="true"\n      ng-model="ngModel"\n    >\n    <label for="toggle-switch-true-{{$id}}" class="toggle-switch-label">{{labelTrue}}</label>\n\n    <span class="toggle-switch-selection" aria-hidden="true"></span>\n</fieldset>'}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(64)],void 0===(i=function(e,t){return e.controller("SavingNotificationController",["$scope","$interval","ide",function(e,n,r){var i;setInterval((function(){return s()}),1e3),$(window).bind("beforeunload",(function(){return i()}));var o=null;e.docSavingStatus={};var s=function(){var n,i=e.docSavingStatus,s=e.docSavingStatusCount,a={},l=0,c=0;for(var u in t.openDocs){t.openDocs[u].pollSavedStatus()||(l++,null!=i[u]?(a[u]=i[u],(n=a[u].unsavedSeconds+=1)>c&&(c=n)):a[u]={unsavedSeconds:0,doc:r.fileTreeManager.findEntityById(u)})}if(l>0&&n>15&&!o&&(o=r.showLockEditorMessageModal("Connection lost","Sorry, the connection to the server is down.")).result.finally((function(){return o=null})),o&&0===l&&o.dismiss("connection back up"),l||s)return e.docSavingStatus=a,e.docSavingStatusCount=l,e.$apply()};return i=function(){if(t.hasUnsavedChanges())return"You have unsaved changes. If you leave now they will not be saved."}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}r=[n(7),n(9),n(184)],void 0===(i=function(e){var t;return(t=function(){function t(n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.ide=n,this.$scope=r,this.$scope.onlineUsers={},this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsersArray=[],this.$scope.$on("cursor:editor:update",(function(e,t){return i.sendCursorPositionUpdate(t)})),this.$scope.$on("project:joined",(function(){return i.ide.socket.emit("clientTracking.getConnectedUsers",(function(e,t){i.$scope.onlineUsers={};for(var n=0,r=Array.from(t||[]);n<r.length;n++){var o=r[n];o.client_id!==i.ide.socket.socket.sessionid&&(i.$scope.onlineUsers[o.client_id]={id:o.client_id,user_id:o.user_id,email:o.email,name:"".concat(o.first_name," ").concat(o.last_name),doc_id:null!=o.cursorData?o.cursorData.doc_id:void 0,row:null!=o.cursorData?o.cursorData.row:void 0,column:null!=o.cursorData?o.cursorData.column:void 0})}return i.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientUpdated",(function(e){if(e.id!==i.ide.socket.socket.sessionid)return i.$scope.$apply((function(){return i.$scope.onlineUsers[e.id]=e,i.refreshOnlineUsers()}))})),this.ide.socket.on("clientTracking.clientDisconnected",(function(e){return i.$scope.$apply((function(){return delete i.$scope.onlineUsers[e],i.refreshOnlineUsers()}))})),this.$scope.getHueForUserId=function(t){return e.getHueForUserId(t)}}return s(t,null,[{key:"initClass",value:function(){this.prototype.cursorUpdateInterval=500}}]),s(t,[{key:"refreshOnlineUsers",value:function(){for(var t in this.$scope.onlineUsersArray=[],this.$scope.onlineUsers){var n=this.$scope.onlineUsers[t];null!=n.doc_id&&(n.doc=this.ide.fileTreeManager.findEntityById(n.doc_id)),null!==n.name&&0!==n.name.trim().length||(n.email?n.name=n.email.trim():"anonymous-user"===n.user_id&&(n.name="Anonymous")),n.initial=null!=n.name?n.name[0]:void 0,n.initial&&" "!==n.initial||(n.initial="?"),this.$scope.onlineUsersArray.push(n)}for(t in this.$scope.onlineUserCursorHighlights={},this.$scope.onlineUsers){var r=this.$scope.onlineUsers[t],i=r.doc_id;null!=i&&null!=r.row&&null!=r.column&&(this.$scope.onlineUserCursorHighlights[i]||(this.$scope.onlineUserCursorHighlights[i]=[]),this.$scope.onlineUserCursorHighlights[i].push({label:r.name,cursor:{row:r.row,column:r.column},hue:e.getHueForUserId(r.user_id)}))}return this.$scope.onlineUsersArray.length>0?(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=500):(delete this.cursorUpdateTimeout,this.cursorUpdateInterval=3e5)}},{key:"sendCursorPositionUpdate",value:function(e){var t=this;if(null!=e&&(this.$scope.currentPosition=e),null==this.cursorUpdateTimeout)return this.cursorUpdateTimeout=setTimeout((function(){var e=t.$scope.editor.open_doc_id;return t.ide.socket.emit("clientTracking.updatePosition",{row:null!=t.$scope.currentPosition?t.$scope.currentPosition.row:void 0,column:null!=t.$scope.currentPosition?t.$scope.currentPosition.column:void 0,doc_id:e}),delete t.cursorUpdateTimeout}),this.cursorUpdateInterval)}}]),t}()).initClass(),t}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("OnlineUsersController",["$scope","ide",function(e,t){return e.gotoUser=function(e){if(null!=e.doc&&null!=e.row)return t.editorManager.openDoc(e.doc,{gotoLine:e.row+1})},e.userInitial=function(e){return"anonymous-user"===e.user_id?"?":e.name.slice(0,1)}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}r=[n(2),n(7),n(12),n(186),n(187),n(72)],void 0===(i=function(e,t,n){var r;return(r=function(){function r(e,t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.ide=e,this.$scope=t,this.reset(),this.$scope.toggleHistory=function(){return"history"===n.$scope.ui.view?n.hide():n.show()},this.$scope.$watch("history.selection.updates",(function(e){if(null!=e&&e.length>0)return n._selectDocFromUpdates(),n.reloadDiff()})),this.$scope.$on("entity:selected",(function(e,t){if("history"===n.$scope.ui.view&&"doc"===t.type)return n.$scope.history.selection.doc=t,n.reloadDiff()}))}return s(r,null,[{key:"initClass",value:function(){this.prototype.BATCH_SIZE=10}}]),s(r,[{key:"show",value:function(){return this.$scope.ui.view="history",this.reset()}},{key:"hide",value:function(){return this.$scope.ui.view="editor",this.$scope.$emit("entity:selected",this.ide.fileTreeManager.findSelectedEntity())}},{key:"reset",value:function(){return this.$scope.history={updates:[],nextBeforeTimestamp:null,atEnd:!1,selection:{updates:[],doc:null,range:{fromV:null,toV:null,start_ts:null,end_ts:null}},diff:null}}},{key:"autoSelectRecentUpdates",value:function(){if(0!==this.$scope.history.updates.length){this.$scope.history.updates[0].selectedTo=!0;for(var e=0,t=0;t<this.$scope.history.updates.length;t++){var n=this.$scope.history.updates[t];if(this._updateContainsUserId(n,this.$scope.user.id))break;e=t}return this.$scope.history.updates[e].selectedFrom=!0}}},{key:"fetchNextBatchOfUpdates",value:function(){var e=this,t="/project/".concat(this.ide.project_id,"/updates?min_count=").concat(this.BATCH_SIZE);return null!=this.$scope.history.nextBeforeTimestamp&&(t+="&before=".concat(this.$scope.history.nextBeforeTimestamp)),this.$scope.history.loading=!0,this.ide.$http.get(t).then((function(t){var n=t.data;return e._loadUpdates(n.updates),e.$scope.history.nextBeforeTimestamp=n.nextBeforeTimestamp,null==n.nextBeforeTimestamp&&(e.$scope.history.atEnd=!0),e.$scope.history.loading=!1}))}},{key:"reloadDiff",value:function(){var e=this,t=this.$scope.history.diff,n=this.$scope.history.selection,r=(n.updates,n.doc),i=this._calculateRangeFromSelection(),o=i.fromV,s=i.toV,a=i.start_ts,l=i.end_ts;if(null!=r&&(null==t||t.doc!==r||t.fromV!==o||t.toV!==s)){if(this.$scope.history.diff=t={fromV:o,toV:s,start_ts:a,end_ts:l,doc:r,error:!1,pathname:r.name},r.deleted)return t.deleted=!0,t.restoreInProgress=!1,t.restoreDeletedSuccess=!1,t.restoredDocNewId=null;t.loading=!0;var c="/project/".concat(this.$scope.project_id,"/doc/").concat(t.doc.id,"/diff");return null!=t.fromV&&null!=t.toV&&(c+="?from=".concat(t.fromV,"&to=").concat(t.toV)),this.ide.$http.get(c).then((function(n){var r=n.data;t.loading=!1;var i=e._parseDiff(r),o=i.text,s=i.highlights;return t.text=o,t.highlights=s})).catch((function(){return t.loading=!1,t.error=!0}))}}},{key:"restoreDeletedDoc",value:function(e){var t="/project/".concat(this.$scope.project_id,"/doc/").concat(e.id,"/restore");return this.ide.$http.post(t,{name:e.name,_csrf:window.csrfToken})}},{key:"restoreDiff",value:function(e){var t="/project/".concat(this.$scope.project_id,"/doc/").concat(e.doc.id,"/version/").concat(e.fromV,"/restore");return this.ide.$http.post(t,{_csrf:window.csrfToken})}},{key:"_parseDiff",value:function(r){for(var i=0,o=0,s=[],a="",l=r.diff||[],c=0;c<l.length;c++){var u,h,d=l[c],f=d.u||d.i||d.d;f||(f=""),a+=f;var p=f.split("\n"),g=i,m=o;p.length>1?(h=g+p.length-1,u=p[p.length-1].length):(h=g,u=m+p[0].length),i=h,o=u;var v={start:{row:g,column:m},end:{row:h,column:u}};if(null!=d.i||null!=d.d){var y=n(d.meta.user),b=e(d.meta.end_ts).format("Do MMM YYYY, h:mm a");null!=d.i?s.push({label:"Added by ".concat(y," on ").concat(b),highlight:v,hue:t.getHueForUserId(null!=d.meta.user?d.meta.user.id:void 0)}):null!=d.d&&s.push({label:"Deleted by ".concat(y," on ").concat(b),strikeThrough:v,hue:t.getHueForUserId(null!=d.meta.user?d.meta.user.id:void 0)})}}return{text:a,highlights:s}}},{key:"_loadUpdates",value:function(n){null==n&&(n=[]);for(var r=this.$scope.history.updates[this.$scope.history.updates.length-1],i=0,o=Array.from(n);i<o.length;i++){var s=o[i];s.pathnames=[];var a=s.docs||{};for(var l in a){var c=a[l];c.entity=this.ide.fileTreeManager.findEntityById(l,{includeDeleted:!0}),s.pathnames.push(c.entity.name)}for(var u=0,h=Array.from(s.meta.users||[]);u<h.length;u++){var d=h[u];null!=d&&(d.hue=t.getHueForUserId(d.id))}null!=r&&e(r.meta.end_ts).isSame(s.meta.end_ts,"day")||(s.meta.first_in_day=!0),s.selectedFrom=!1,s.selectedTo=!1,s.inSelection=!1,r=s}var f=0===this.$scope.history.updates.length;if(this.$scope.history.updates=this.$scope.history.updates.concat(n),f)return this.autoSelectRecentUpdates()}},{key:"_calculateRangeFromSelection",value:function(){for(var e,t,n,r=n=t=e=null,i=null!=this.$scope.history.selection.doc?this.$scope.history.selection.doc.id:void 0,o=0,s=Array.from(this.$scope.history.selection.updates||[]);o<s.length;o++){var a=s[o];for(var l in a.docs){var c=a.docs[l];if(l===i){null!=r&&null!=n?(r=Math.min(r,c.fromV),n=Math.max(n,c.toV),t=Math.min(t,a.meta.start_ts),e=Math.max(e,a.meta.end_ts)):(r=c.fromV,n=c.toV,t=a.meta.start_ts,e=a.meta.end_ts);break}}}return{fromV:r,toV:n,start_ts:t,end_ts:e}}},{key:"_selectDocFromUpdates",value:function(){for(var e,t,n={},r=0,i=Array.from(this.$scope.history.selection.updates);r<i.length;r++){var o=i[r];for(t in o.docs)e=o.docs[t],n[t]=e.entity}var s=this.$scope.history.selection.doc;if(null!=s&&null!=n[s.id]);else for(t in n){s=e=n[t];break}return this.$scope.history.selection.doc=s,this.ide.fileTreeManager.selectEntity(s)}},{key:"_updateContainsUserId",value:function(e,t){for(var n=0,r=Array.from(e.meta.users);n<r.length;n++){var i=r[n];if((null!=i?i.id:void 0)===t)return!0}return!1}}]),r}()).initClass(),r}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(12)],void 0===(i=function(e,t){return e.controller("HistoryListController",["$scope","$modal","ide",function(e,n,r){e.hoveringOverListSelectors=!1,e.projectUsers=[],e.$watch("project.members",(function(t){if(null!=t)return e.projectUsers=t.concat(e.project.owner)}));return e.getDisplayNameById=function(n){return t(function(t){return _.find(e.projectUsers,(function(e){return((null!=e?e._id:void 0)||(null!=e?e.id:void 0))===t}))}(n))},e.deleteLabel=function(e){return n.open({templateUrl:"historyV2DeleteLabelModalTemplate",controller:"HistoryV2DeleteLabelModalController",resolve:{labelDetails:function(){return e}}})},e.loadMore=function(){return r.historyManager.fetchNextBatchOfUpdates()},e.recalculateSelectedUpdates=function(){var t=!0,n=!1;return e.history.selection.updates=[],function(){for(var r=[],i=0,o=Array.from(e.history.updates);i<o.length;i++){var s,a=o[i];a.selectedTo&&(s=!0,t=!1),a.beforeSelection=t,a.inSelection=s,a.afterSelection=n,s&&e.history.selection.updates.push(a),a.selectedFrom?(s=!1,r.push(n=!0)):r.push(void 0)}return r}()},e.recalculateHoveredUpdates=function(){for(var t,n=!1,r=!1,i=0,o=Array.from(e.history.updates);i<o.length;i++){var s=o[i];s.hoverSelectedFrom&&(n=!0),s.hoverSelectedTo&&(r=!0)}if(n){t=!1;for(var a=0,l=Array.from(e.history.updates);a<l.length;a++)(s=l[a]).selectedTo&&(s.hoverSelectedTo=!0,t=!0),s.inHoverSelection=t,s.hoverSelectedFrom&&(t=!1)}if(r)return t=!1,function(){for(var n=[],r=0,i=Array.from(e.history.updates);r<i.length;r++)(s=i[r]).hoverSelectedTo&&(t=!0),s.inHoverSelection=t,s.selectedFrom?(s.hoverSelectedFrom=!0,n.push(t=!1)):n.push(void 0);return n}()},e.resetHoverState=function(){return function(){for(var t=[],n=0,r=Array.from(e.history.updates);n<r.length;n++){var i=r[n];delete i.hoverSelectedFrom,delete i.hoverSelectedTo,t.push(delete i.inHoverSelection)}return t}()},e.$watch("history.updates.length",(function(){return e.recalculateSelectedUpdates()}))}]),e.controller("HistoryListItemController",["$scope","eventTracking",function(e,n){return e.$watch("update.selectedFrom",(function(t,n){if(t){for(var r=0,i=Array.from(e.history.updates);r<i.length;r++){var o=i[r];o!==e.update&&(o.selectedFrom=!1)}return e.recalculateSelectedUpdates()}})),e.$watch("update.selectedTo",(function(t,n){if(t){for(var r=0,i=Array.from(e.history.updates);r<i.length;r++){var o=i[r];o!==e.update&&(o.selectedTo=!1)}return e.recalculateSelectedUpdates()}})),e.select=function(){return n.sendMB("history-view-change"),e.update.selectedTo=!0,e.update.selectedFrom=!0},e.mouseOverSelectedFrom=function(){return e.history.hoveringOverListSelectors=!0,e.update.hoverSelectedFrom=!0,e.recalculateHoveredUpdates()},e.mouseOutSelectedFrom=function(){return e.history.hoveringOverListSelectors=!1,e.resetHoverState()},e.mouseOverSelectedTo=function(){return e.history.hoveringOverListSelectors=!0,e.update.hoverSelectedTo=!0,e.recalculateHoveredUpdates()},e.mouseOutSelectedTo=function(){return e.history.hoveringOverListSelectors=!1,e.resetHoverState()},e.displayName=t}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("HistoryDiffController",["$scope","$modal","ide","eventTracking",function(e,t,n,r){return e.restoreDeletedDoc=function(){return r.sendMB("history-restore-deleted"),e.history.diff.restoreInProgress=!0,n.historyManager.restoreDeletedDoc(e.history.diff.doc).then((function(t){var n=t.data;return e.history.diff.restoredDocNewId=n.doc_id,e.history.diff.restoreInProgress=!1,e.history.diff.restoreDeletedSuccess=!0}))},e.openRestoreDiffModal=function(){return r.sendMB("history-restore-modal"),t.open({templateUrl:"historyRestoreDiffModalTemplate",controller:"HistoryRestoreDiffModalController",resolve:{diff:function(){return e.history.diff}}})},e.backToEditorAfterRestore=function(){return n.editorManager.openDoc({id:e.history.diff.restoredDocNewId})}}]),e.controller("HistoryRestoreDiffModalController",["$scope","$modalInstance","diff","ide","eventTracking",function(e,t,n,r,i){return e.state={inflight:!1},e.diff=n,e.restore=function(){return i.sendMB("history-restored"),e.state.inflight=!0,r.historyManager.restoreDiff(n).then((function(){return e.state.inflight=!1,t.close(),r.editorManager.openDoc(n.doc)}))},e.cancel=function(){return t.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}r=[n(2),n(7),n(12),n(189),n(190),n(191),n(192),n(193),n(194),n(72),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202)],void 0===(i=function(e,t,n,r){var i;return(i=function(){function i(e,t,n){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.labelCurrentVersion=this.labelCurrentVersion.bind(this),this.deleteLabel=this.deleteLabel.bind(this),this._addLabelLocally=this._addLabelLocally.bind(this),this.ide=e,this.$scope=t,this.localStorage=n,this.$scope.HistoryViewModes=r,this._localStorageViewModeProjKey="history.userPrefs.viewMode.".concat(t.project_id),this._localStorageShowOnlyLabelsProjKey="history.userPrefs.showOnlyLabels.".concat(t.project_id),this._previouslySelectedPathname=null,this._loadFileTreeRequestCanceller=null,this.hardReset(),this.$scope.toggleHistory=function(){"history"===o.$scope.ui.view?o.hide():(o.show(),o._handleHistoryUIStateChange()),o.ide.$timeout((function(){o.$scope.$broadcast("history:toggle")}),0)},this.$scope.isHistoryLoading=function(){var e=o.$scope.history.selection;return o.$scope.history.loadingFileTree||o.$scope.history.viewMode===r.POINT_IN_TIME&&e.file&&e.file.loading||o.$scope.history.viewMode===r.COMPARE&&e.diff&&e.diff.loading}}return s(i,null,[{key:"initClass",value:function(){this.prototype.MAX_RECENT_UPDATES_TO_SELECT=5,this.prototype.BATCH_SIZE=10}}]),s(i,[{key:"show",value:function(){this.$scope.ui.view="history",this.hardReset(),this.$scope.history.showOnlyLabels&&this.fetchNextBatchOfUpdates()}},{key:"hide",value:function(){this.$scope.ui.view="editor"}},{key:"_getViewModeUserPref",value:function(){return this.localStorage(this._localStorageViewModeProjKey)||r.POINT_IN_TIME}},{key:"_getShowOnlyLabelsUserPref",value:function(){return this.localStorage(this._localStorageShowOnlyLabelsProjKey)||!1}},{key:"_setViewModeUserPref",value:function(e){e!==r.POINT_IN_TIME&&e!==r.COMPARE||this.localStorage(this._localStorageViewModeProjKey,e)}},{key:"_setShowOnlyLabelsUserPref",value:function(e){this.localStorage(this._localStorageShowOnlyLabelsProjKey,!!e)}},{key:"hardReset",value:function(){var e=this;this.$scope.history={isV2:!0,updates:[],viewMode:this._getViewModeUserPref(),nextBeforeTimestamp:null,atEnd:!1,userHasFullFeature:void 0,freeHistoryLimitHit:!1,selection:{docs:{},pathname:null,range:{fromV:null,toV:null},hoveredRange:{fromV:null,toV:null},diff:null,files:[],file:null},error:null,showOnlyLabels:this._getShowOnlyLabelsUserPref(),labels:null,loadingFileTree:!0};var t=this.$scope.$watch("project.features.versioning",(function(n){null!=n&&(e.$scope.history.userHasFullFeature=n,e.$scope.user.isAdmin&&(e.$scope.history.userHasFullFeature=!0),t())}))}},{key:"softReset",value:function(){this.$scope.history.viewMode=this._getViewModeUserPref(),this.$scope.history.selection={docs:{},pathname:null,range:{fromV:null,toV:null},hoveredRange:{fromV:null,toV:null},diff:null,files:[],file:null},this.$scope.history.error=null,this.$scope.history.showOnlyLabels=this._getShowOnlyLabelsUserPref(),this.$scope.history.loadingFileTree=!0}},{key:"toggleHistoryViewMode",value:function(){var e=this;this.$scope.history.viewMode===r.COMPARE?(this.softReset(),this.$scope.history.viewMode=r.POINT_IN_TIME,this._setViewModeUserPref(r.POINT_IN_TIME)):(this.softReset(),this.$scope.history.viewMode=r.COMPARE,this._setViewModeUserPref(r.COMPARE)),this._handleHistoryUIStateChange(),this.ide.$timeout((function(){e.$scope.$broadcast("history:toggle")}),0)}},{key:"_handleHistoryUIStateChange",value:function(){this.$scope.history.viewMode===r.COMPARE?this.$scope.history.showOnlyLabels?this.autoSelectLabelsForComparison():this.autoSelectRecentUpdates():this.$scope.history.showOnlyLabels?this.autoSelectLabelForPointInTime():this.autoSelectVersionForPointInTime()}},{key:"setHoverFrom",value:function(e){var t=this.$scope.history.selection;t.hoveredRange.fromV=e,t.hoveredRange.toV=t.range.toV,this.$scope.history.hoveringOverListSelectors=!0}},{key:"setHoverTo",value:function(e){var t=this.$scope.history.selection;t.hoveredRange.toV=e,t.hoveredRange.fromV=t.range.fromV,this.$scope.history.hoveringOverListSelectors=!0}},{key:"resetHover",value:function(){var e=this.$scope.history.selection;e.hoveredRange.toV=null,e.hoveredRange.fromV=null,this.$scope.history.hoveringOverListSelectors=!1}},{key:"showAllUpdates",value:function(){this.$scope.history.showOnlyLabels&&(this.$scope.history.showOnlyLabels=!1,this._setShowOnlyLabelsUserPref(!1),this._handleHistoryUIStateChange())}},{key:"showOnlyLabels",value:function(){this.$scope.history.showOnlyLabels||(this.$scope.history.showOnlyLabels=!0,this._setShowOnlyLabelsUserPref(!0),this._handleHistoryUIStateChange())}},{key:"restoreFile",value:function(e,t){var n="/project/".concat(this.$scope.project_id,"/restore_file");return this.ide.$http.post(n,{version:e,pathname:t,_csrf:window.csrfToken})}},{key:"loadFileTreeForVersion",value:function(e){return this._loadFileTree(e,e)}},{key:"loadFileTreeDiff",value:function(e,t){return this._loadFileTree(e,t)}},{key:"_loadFileTree",value:function(e,t){var n=this,r="/project/".concat(this.$scope.project_id,"/filetree/diff"),i=this.$scope.history.selection,o=["from=".concat(t),"to=".concat(e)];return r+="?".concat(o.join("&")),this.$scope.$applyAsync((function(){return n.$scope.history.loadingFileTree=!0})),i.file=null,i.pathname=null,null!=this._loadFileTreeRequestCanceller&&this._loadFileTreeRequestCanceller.resolve(),this._loadFileTreeRequestCanceller=this.ide.$q.defer(),this.ide.$http.get(r,{timeout:this._loadFileTreeRequestCanceller.promise}).then((function(e){n.$scope.history.selection.files=e.data.diff;var t=!0,r=!1,i=void 0;try{for(var o,s=n.$scope.history.selection.files[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;null!=a.newPathname&&(a.oldPathname=a.pathname,a.pathname=a.newPathname,delete a.newPathname)}}catch(e){r=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw i}}n._loadFileTreeRequestCanceller=null,n.$scope.history.loadingFileTree=!1,n.autoSelectFile()})).catch((function(e){-1!==e.status?n._loadFileTreeRequestCanceller=null:n.$scope.history.loadingFileTree=!1}))}},{key:"selectFile",value:function(e){null!=e&&null!=e.pathname&&(this.$scope.history.selection.pathname=this._previouslySelectedPathname=e.pathname,this.$scope.history.selection.file=e,this.$scope.history.viewMode===r.POINT_IN_TIME?this.loadFileAtPointInTime():this.reloadDiff())}},{key:"autoSelectFile",value:function(){var e=this.$scope.history.selection.files,t=null,n=null,r=!1,i=this._getFilesWithOps();if(null!=this._previouslySelectedPathname&&(n=_.find(e,{pathname:this._previouslySelectedPathname}),r=_.some(i,{pathname:this._previouslySelectedPathname})),null!=n&&r)t=n;else{for(var o=0,s=["edited","added","renamed","removed"];o<s.length;o++){var a=s[o],l=_.find(i,{operation:a});if(null!=l){t=_.find(e,{pathname:l.pathname});break}}if(null==t)if(null!=n)t=n;else{var c=_.find(e,(function(e){return/main\.tex$/.test(e.pathname)}));if(null!=c)t=c;else{var u=_.find(e,(function(e){return/\.tex$/.test(e.pathname)}));t=null!=u?u:e[0]}}}this.selectFile(t)}},{key:"_getFilesWithOps",value:function(){var e;if(this.$scope.history.viewMode===r.POINT_IN_TIME){var t=this.getUpdateForVersion(this.$scope.history.selection.range.toV);if(e=[],null!=t){var n=!0,i=!1,o=void 0;try{for(var s,a=t.pathnames[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)pathname=s.value,e.push({pathname:pathname,operation:"edited"})}catch(e){i=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}var l=!0,c=!1,u=void 0;try{for(var h,d=t.project_ops[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){op=h.value;var f=void 0;null!=op.add?f={pathname:op.add.pathname,operation:"added"}:null!=op.remove?f={pathname:op.remove.pathname,operation:"removed"}:null!=op.rename&&(f={pathname:op.rename.newPathname,operation:"renamed"}),null!=f&&e.push(f)}}catch(e){c=!0,u=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}}}else e=_.reduce(this.$scope.history.selection.files,(function(e,t){return t.operation&&e.push({pathname:t.pathname,operation:t.operation}),e}),[]);return e}},{key:"autoSelectRecentUpdates",value:function(){if(0!==this.$scope.history.updates.length){for(var e,t=this.$scope.history.updates[0].toV,n=0,r=0;r<this.$scope.history.updates.length;r++){var i=this.$scope.history.updates[r];if(this._updateContainsUserId(i,this.$scope.user.id)||r>this.MAX_RECENT_UPDATES_TO_SELECT)break;n=r}e=this.$scope.history.updates[n].fromV,this.selectVersionsForCompare(t,e)}}},{key:"autoSelectVersionForPointInTime",value:function(){if(0!==this.$scope.history.updates.length){var e=this.$scope.history.updates[0].toV,t=this.$scope.history.selection.range;null!=t.toV&&null!=t.fromV&&t.toV===t.fromV&&(e=t.toV),this.selectVersionForPointInTime(e)}}},{key:"autoSelectLastLabel",value:function(){if(null!=this.$scope.history.labels&&0!==this.$scope.history.labels.length)return this.selectLabelForPointInTime(this.$scope.history.labels[0])}},{key:"expandSelectionToVersion",value:function(e){e>this.$scope.history.selection.range.toV?this.$scope.history.selection.range.toV=e:e<this.$scope.history.selection.range.fromV&&(this.$scope.history.selection.range.fromV=e)}},{key:"selectVersionForPointInTime",value:function(e){var t=this.$scope.history.selection;t.range.toV!==e&&t.range.fromV!==e&&(t.range.toV=e,t.range.fromV=e,this.loadFileTreeForVersion(e))}},{key:"selectVersionsForCompare",value:function(e,t){var n=this.$scope.history.selection.range;n.toV===e&&n.fromV===t||(n.toV=e,n.fromV=t,this.loadFileTreeDiff(e,t))}},{key:"autoSelectLabelForPointInTime",value:function(){var e=this.getUpdateForVersion(this.$scope.history.selection.range.toV),t=0;if(null!=e&&null!=e.labels&&(t=e.labels.length),0===t)this.autoSelectLastLabel();else if(1===t)this.selectLabelForPointInTime(e.labels[0]);else if(t>1){var n=this.ide.$filter("orderBy")(e.labels,"-created_at")[0];this.selectLabelForPointInTime(n)}}},{key:"selectLabelForPointInTime",value:function(e){var t=null;if(!this._isLabelSelected(e)){for(var n=0,r=Array.from(this.$scope.history.updates);n<r.length;n++){var i=r[n];if(i.toV===e.version){t=i;break}}if(null!=t)this.selectVersionForPointInTime(t.toV);else{var o=this.$scope.history.selection;o.range.toV=e.version,o.range.fromV=e.version,this.loadFileTreeForVersion(e.version)}}}},{key:"getUpdateForVersion",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=this.$scope.history.updates[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var s=i.value;if(s.toV===e)return s}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"autoSelectLabelsForComparison",value:function(){var e=this.$scope.history.labels,t=0;Array.isArray(e)&&(t=e.length),0===t||(1===t?this.selectVersionsForCompare(e[0].version,e[0].version):t>1&&this.selectVersionsForCompare(e[0].version,e[1].version))}},{key:"fetchNextBatchOfUpdates",value:function(){var e=this;if(!this.$scope.history.atEnd){var t="/project/".concat(this.ide.project_id,"/updates?min_count=").concat(this.BATCH_SIZE);null!=this.$scope.history.nextBeforeTimestamp&&(t+="&before=".concat(this.$scope.history.nextBeforeTimestamp));var n="/project/".concat(this.ide.project_id,"/labels"),r={updates:this.ide.$http.get(t)};return null==this.$scope.history.labels&&(r.labels=this.ide.$http.get(n)),this.ide.$q.all(r).then((function(t){var n=t.updates.data,r=null;n.updates.length>0&&(r=n.updates[0].toV),null!=t.labels&&(e.$scope.history.labels=e._loadLabels(t.labels.data,r)),e._loadUpdates(n.updates),e.$scope.history.nextBeforeTimestamp=n.nextBeforeTimestamp,(null==n.nextBeforeTimestamp||e.$scope.history.freeHistoryLimitHit||0===e.$scope.history.updates.length)&&(e.$scope.history.atEnd=!0),0===e.$scope.history.updates.length&&(e.$scope.history.loadingFileTree=!1)})).catch((function(t){var n=t.status,r=t.statusText;e.$scope.history.error={status:n,statusText:r},e.$scope.history.atEnd=!0,e.$scope.history.loadingFileTree=!1}))}}},{key:"_loadLabels",value:function(e,t){var n=this._sortLabelsByVersionAndDate(e),r=n.length,i=!1,o=!1;if(t)if((o=(i=r>0&&n[0].isPseudoCurrentStateLabel)?r>1&&n[1].version!==t:!(r>0)||n[0].version!==t)&&!i){var s={id:"1",isPseudoCurrentStateLabel:!0,version:t,created_at:(new Date).toISOString()};n.unshift(s)}else!o&&i&&n.shift();return n}},{key:"_sortLabelsByVersionAndDate",value:function(e){return this.ide.$filter("orderBy")(e,["isPseudoCurrentStateLabel","-version","-created_at"])}},{key:"loadFileAtPointInTime",value:function(){var e=this,t=this.$scope.history.selection.range.toV,n=this.$scope.history.selection.pathname;if(null!=t){var r="/project/".concat(this.$scope.project_id,"/diff"),i=["pathname=".concat(encodeURIComponent(n)),"from=".concat(t),"to=".concat(t)];return r+="?".concat(i.join("&")),this.$scope.history.selection.file.loading=!0,this.ide.$http.get(r).then((function(t){var n=e._parseDiff(t.data.diff),r=n.text,i=n.binary;e.$scope.history.selection.file.binary=i,e.$scope.history.selection.file.text=r,e.$scope.history.selection.file.loading=!1})).catch((function(){}))}}},{key:"reloadDiff",value:function(){var e=this,t=this.$scope.history.selection.diff,n=this.$scope.history.selection,r=n.range,i=n.pathname,o=r.fromV,s=r.toV;if(null!=i){if(null==t||t.pathname!==i||t.fromV!==o||t.toV!==s){this.$scope.history.selection.diff=t={fromV:o,toV:s,pathname:i,error:!1},t.loading=!0;var a="/project/".concat(this.$scope.project_id,"/diff"),l=["pathname=".concat(encodeURIComponent(i))];return null!=t.fromV&&null!=t.toV&&l.push("from=".concat(t.fromV),"to=".concat(t.toV)),a+="?".concat(l.join("&")),this.ide.$http.get(a).then((function(n){var r=n.data;t.loading=!1;var i=e._parseDiff(r.diff),o=i.text,s=i.highlights,a=i.binary;t.binary=a,t.text=o,t.highlights=s})).catch((function(){t.loading=!1,t.error=!0}))}}else this.$scope.history.selection.diff=null}},{key:"labelCurrentVersion",value:function(e){return this._labelVersion(e,this.$scope.history.selection.range.toV)}},{key:"deleteLabel",value:function(e){var t=this,n="/project/".concat(this.$scope.project_id,"/labels/").concat(e.id);return this.ide.$http({url:n,method:"DELETE",headers:{"X-CSRF-Token":window.csrfToken}}).then((function(n){return t._deleteLabelLocally(e)}))}},{key:"_deleteLabelLocally",value:function(e){for(var t=0;t<this.$scope.history.updates.length;t++){var n=this.$scope.history.updates[t];if(n.toV===e.version){n.labels=_.filter(n.labels,(function(t){return t.id!==e.id}));break}}this.$scope.history.labels=this._loadLabels(_.filter(this.$scope.history.labels,(function(t){return t.id!==e.id})),this.$scope.history.updates[0].toV),this._handleHistoryUIStateChange()}},{key:"_isLabelSelected",value:function(e){return!!e&&e.version<=this.$scope.history.selection.range.toV&&e.version>=this.$scope.history.selection.range.fromV}},{key:"_parseDiff",value:function(r){if(r.binary)return{binary:!0};for(var i=0,o=0,s=[],a="",l=r||[],c=0;c<l.length;c++){var u,h,d=l[c],f=d.u||d.i||d.d;f||(f=""),a+=f;var p=f.split("\n"),g=i,m=o;p.length>1?(h=g+p.length-1,u=p[p.length-1].length):(h=g,u=m+p[0].length),i=h,o=u;var v={start:{row:g,column:m},end:{row:h,column:u}};if(null!=d.i||null!=d.d){var y=null!=d.meta.users?d.meta.users[0]:void 0,b=n(y),w=e(d.meta.end_ts).format("Do MMM YYYY, h:mm a");null!=d.i?s.push({label:"Added by ".concat(b," on ").concat(w),highlight:v,hue:t.getHueForUserId(null!=y?y.id:void 0)}):null!=d.d&&s.push({label:"Deleted by ".concat(b," on ").concat(w),strikeThrough:v,hue:t.getHueForUserId(null!=y?y.id:void 0)})}}return{text:a,highlights:s}}},{key:"_loadUpdates",value:function(n){null==n&&(n=[]);for(var r=this.$scope.history.updates[this.$scope.history.updates.length-1],i=new Date,o=i.setDate(i.getDate()-1),s=null,a=n||[],l=0;l<a.length;l++){for(var c=a[l],u=0,h=Array.from(c.meta.users||[]);u<h.length;u++){var d=h[u];null!=d&&(d.hue=t.getHueForUserId(d.id))}if(null!=r&&e(r.meta.end_ts).isSame(c.meta.end_ts,"day")||(c.meta.first_in_day=!0),r=c,!this.$scope.history.userHasFullFeature&&c.meta.end_ts<o){s=l||1,this.$scope.history.freeHistoryLimitHit=!0,this.$scope.project.owner._id===this.$scope.user.id&&ga("send","event","subscription-funnel","editor-click-feature","history");break}}var f=0===this.$scope.history.updates.length;this.$scope.history.userHasFullFeature||null==s||(n=n.slice(0,s)),this.$scope.history.updates=this.$scope.history.updates.concat(n),f&&this._handleHistoryUIStateChange()}},{key:"_labelVersion",value:function(e,t){var n=this,r="/project/".concat(this.$scope.project_id,"/labels");return this.ide.$http.post(r,{comment:e,version:t,_csrf:window.csrfToken}).then((function(e){return n._addLabelLocally(e.data)}))}},{key:"_addLabelLocally",value:function(e){var t=_.find(this.$scope.history.updates,(function(t){return t.toV===e.version}));null!=t&&(t.labels=t.labels.concat(e)),this.$scope.history.labels=this._loadLabels(this.$scope.history.labels.concat(e),this.$scope.history.updates[0].toV),this._handleHistoryUIStateChange()}},{key:"_updateContainsUserId",value:function(e,t){for(var n=0,r=Array.from(e.meta.users);n<r.length;n++){var i=r[n];if((null!=i?i.id:void 0)===t)return!0}return!1}}]),i}()).initClass(),i}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){return{POINT_IN_TIME:"point_in_time",COMPARE:"compare"}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(0),n(12)],void 0===(i=function(e,t){return e.controller("HistoryV2ListController",["$scope","$modal","ide",function(e,t,n){return e.hoveringOverListSelectors=!1,e.listConfig={showOnlyLabelled:!1},e.projectUsers=[],e.$watch("project.members",(function(t){if(null!=t)return e.projectUsers=t.concat(e.project.owner)})),e.loadMore=function(){return n.historyManager.fetchNextBatchOfUpdates()},e.handleVersionSelect=function(t){return e.$applyAsync((function(){return n.historyManager.selectVersionForPointInTime(t)}))},e.handleRangeSelect=function(t,r){return e.$applyAsync((function(){return n.historyManager.selectVersionsForCompare(t,r)}))},e.handleLabelDelete=function(e){return t.open({templateUrl:"historyV2DeleteLabelModalTemplate",controller:"HistoryV2DeleteLabelModalController",resolve:{labelDetails:function(){return e}}})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("HistoryV2FileTreeController",["$scope","ide",function(e,t){e.handleFileSelection=function(e){t.historyManager.selectFile(e)}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("HistoryV2ToolbarController",["$scope","$modal","ide","eventTracking","waitFor",function(e,t,n,r,i){var o;e.currentUpdate=null,e.currentLabel=null,e.restoreState={inflight:!1,error:!1},e.toolbarUIConfig={showOnlyLabels:!1};var s=e.$watch("history.showOnlyLabels",(function(t){null!=t&&(e.toolbarUIConfig.showOnlyLabels=t,s())}));e.$watch("toolbarUIConfig.showOnlyLabels",(function(e,t){null!=e&&e!==t&&(e?n.historyManager.showOnlyLabels():n.historyManager.showAllUpdates())})),e.$watch("history.viewMode",(function(t,r){null!=t&&t!==r&&(e.currentUpdate=n.historyManager.getUpdateForVersion(t))})),e.$watch("history.selection.range.toV",(function(t,r){null!=t&&t!==r&&e.history.viewMode===e.HistoryViewModes.POINT_IN_TIME&&(e.currentUpdate=n.historyManager.getUpdateForVersion(t))})),e.toggleHistoryViewMode=function(){n.historyManager.toggleHistoryViewMode()},e.restoreDeletedFile=function(){var t=e.history.selection.file,i=t.pathname,s=t.deletedAtV;if(null!=i&&null!=s)return r.sendMB("history-v2-restore-deleted"),e.restoreState.inflight=!0,n.historyManager.restoreFile(s,i).then((function(e){var t=e.data;return o(t)})).catch((function(){return n.showGenericMessageModal("Sorry, something went wrong with the restore")})).finally((function(){return e.restoreState.inflight=!1}))},e.showAddLabelDialog=function(){t.open({templateUrl:"historyV2AddLabelModalTemplate",controller:"HistoryV2AddLabelModalController",resolve:{update:function(){return e.history.selection.update}}})},o=function(e){var t=e.id,r=e.type;return i((function(){return n.fileTreeManager.findEntityById(t)}),3e3).then((function(e){var t=this;"doc"===r?(n.editorManager.openDoc(e),this.ide.$timeout((function(){t.$scope.$broadcast("history:toggle")}),0)):"file"===r&&(n.binaryFilesManager.openFile(e),this.ide.$timeout((function(){t.$scope.$broadcast("history:toggle")}),0))})).catch((function(e){return console.warn(e)}))}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("HistoryV2AddLabelModalController",["$scope","$modalInstance","ide","update",function(e,t,n,r){return e.update=r,e.inputs={labelName:null},e.state={inflight:!1,error:!1},t.opened.then((function(){return e.$applyAsync((function(){return e.$broadcast("open")}))})),e.addLabelModalFormSubmit=function(){return e.state.inflight=!0,n.historyManager.labelCurrentVersion(e.inputs.labelName).then((function(n){return e.state.inflight=!1,t.close()})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}))}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("HistoryV2DeleteLabelModalController",["$scope","$modalInstance","ide","labelDetails",function(e,t,n,r){return e.labelDetails=r,e.state={inflight:!1,error:!1},e.deleteLabel=function(){return e.state.inflight=!0,n.historyManager.deleteLabel(r).then((function(n){return e.state.inflight=!1,t.close()})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}))}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("historyDraggableBoundary",(function(){return{scope:{historyDraggableBoundary:"@",historyDraggableBoundaryOnDragStart:"&",historyDraggableBoundaryOnDragStop:"&"},restrict:"A",link:function(e,t,n){t.data("selectionBoundary",{boundary:e.historyDraggableBoundary}),t.draggable({axis:"y",opacity:!1,helper:"clone",revert:!0,scroll:!0,cursor:"row-resize",start:function(t,n){n.helper.data("wasProperlyDropped",!1),e.historyDraggableBoundaryOnDragStart()},stop:function(t,n){e.historyDraggableBoundaryOnDragStop({isValidDrop:n.helper.data("wasProperlyDropped"),boundary:e.historyDraggableBoundary})}})}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("historyDroppableArea",(function(){return{scope:{historyDroppableAreaOnDrop:"&",historyDroppableAreaOnOver:"&",historyDroppableAreaOnOut:"&"},restrict:"A",link:function(e,t,n){t.droppable({accept:function(e){return".history-entry-toV-handle, .history-entry-fromV-handle"},drop:function(t,n){var r=n.draggable.data("selectionBoundary").boundary;n.helper.data("wasProperlyDropped",!0),e.historyDroppableAreaOnDrop({boundary:r})},over:function(t,n){var r=n.draggable.data("selectionBoundary").boundary;e.historyDroppableAreaOnOver({boundary:r})}})}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t=function(e,t,n,r){var i=this;i.$entryListViewportEl=null,i.isDragging=!1;i.onEntryLinked=function(t,n){i.rangeSelectionEnabled||t.toV!==i.selectedHistoryVersion||e.$applyAsync((function(){(function(e){var t=e.offset().top,n=t+e.outerHeight(),r=i.$entryListViewportEl.offset().top,o=r+i.$entryListViewportEl.height();return t>=r&&n<=o})(n)||i.$entryListViewportEl.scrollTop(function(e){var t=i.$entryListViewportEl.height()/2;return e.offset().top-t}(n))}))},i.handleEntrySelect=function(e){i.rangeSelectionEnabled?i.onRangeSelect({selectedToV:e.toV,selectedFromV:e.fromV}):i.onVersionSelect({version:e.toV})},i.setRangeToV=function(e){e>i.selectedHistoryRange.fromV&&i.onRangeSelect({selectedToV:e,selectedFromV:i.selectedHistoryRange.fromV})},i.setRangeFromV=function(e){e<i.selectedHistoryRange.toV&&i.onRangeSelect({selectedToV:i.selectedHistoryRange.toV,selectedFromV:e})},i.initHoveredRange=function(){i.hoveredHistoryRange={toV:i.selectedHistoryRange.toV,fromV:i.selectedHistoryRange.fromV}},i.resetHoveredRange=function(){i.hoveredHistoryRange={toV:null,fromV:null}},i.setHoveredRangeToV=function(t){t>i.hoveredHistoryRange.fromV&&e.$applyAsync((function(){return i.hoveredHistoryRange.toV=t}))},i.setHoveredRangeFromV=function(t){t<i.hoveredHistoryRange.toV&&e.$applyAsync((function(){return i.hoveredHistoryRange.fromV=t}))},i.onDraggingStart=function(){e.$applyAsync((function(){i.isDragging=!0,i.initHoveredRange()}))},i.onDraggingStop=function(t,n){e.$applyAsync((function(){i.isDragging=!1,t||("toV"===n?i.setRangeToV(i.hoveredHistoryRange.toV):"fromV"===n&&i.setRangeFromV(i.hoveredHistoryRange.fromV)),i.resetHoveredRange()}))},i.$onInit=function(){i.$entryListViewportEl=t.find("> .history-entries"),i.resetHoveredRange()}};return t.$inject=["$scope","$element","$attrs","_"],e.component("historyEntriesList",{bindings:{entries:"<",users:"<",loadEntries:"&",loadDisabled:"<",loadInitialize:"<",isLoading:"<",currentUser:"<",freeHistoryLimitHit:"<",currentUserIsOwner:"<",rangeSelectionEnabled:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",onVersionSelect:"&",onRangeSelect:"&",onLabelDelete:"&"},controller:t,templateUrl:"historyEntriesListTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(7),n(12)],void 0===(i=function(e,t,n){var r=function(e,r,i,o){var s=this;s.displayName=n,s.displayNameById=function(e){return n(function(e){return o.find(s.users,(function(t){return((null!=t?t._id:void 0)||(null!=t?t.id:void 0))===e}))}(e))},s.getProjectOpDoc=function(e){return null!=e.rename?"".concat(e.rename.pathname," → ").concat(e.rename.newPathname):null!=e.add?"".concat(e.add.pathname):null!=e.remove?"".concat(e.remove.pathname):void 0},s.getUserCSSStyle=function(e){var n=(null!=e?e._id:void 0)||(null!=e?e.id:void 0),r=t.getHueForUserId(n)||100;return s.isEntrySelected()||s.isEntryHoverSelected()?{color:"#FFF"}:{color:"hsl(".concat(r,", 70%, 50%)")}},s.isEntrySelected=function(){return s.rangeSelectionEnabled?s.entry.toV<=s.selectedHistoryRange.toV&&s.entry.fromV>=s.selectedHistoryRange.fromV:s.entry.toV===s.selectedHistoryVersion},s.isEntryHoverSelected=function(){return s.rangeSelectionEnabled&&s.entry.toV<=s.hoveredHistoryRange.toV&&s.entry.fromV>=s.hoveredHistoryRange.fromV},s.onDraggingStart=function(){s.historyEntriesList.onDraggingStart()},s.onDraggingStop=function(e,t){return s.historyEntriesList.onDraggingStop(e,t)},s.onDrop=function(t){"toV"===t?e.$applyAsync((function(){return s.historyEntriesList.setRangeToV(s.entry.toV)})):"fromV"===t&&e.$applyAsync((function(){return s.historyEntriesList.setRangeFromV(s.entry.fromV)}))},s.onOver=function(t){"toV"===t?e.$applyAsync((function(){return s.historyEntriesList.setHoveredRangeToV(s.entry.toV)})):"fromV"===t&&e.$applyAsync((function(){return s.historyEntriesList.setHoveredRangeFromV(s.entry.fromV)}))},s.$onInit=function(){s.$entryEl=r.find("> .history-entry"),s.$entryDetailsEl=r.find(".history-entry-details"),s.$toVHandleEl=r.find(".history-entry-toV-handle"),s.$fromVHandleEl=r.find(".history-entry-fromV-handle"),s.historyEntriesList.onEntryLinked(s.entry,s.$entryEl)}};return r.$inject=["$scope","$element","$attrs","_"],e.component("historyEntry",{bindings:{entry:"<",currentUser:"<",users:"<",rangeSelectionEnabled:"<",isDragging:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",hoveredHistoryRange:"<?",onSelect:"&",onLabelDelete:"&"},require:{historyEntriesList:"^historyEntriesList"},controller:r,templateUrl:"historyEntryTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(7),n(12)],void 0===(i=function(e,t,n){var r=function(e,r,i,o){var s=this;s.isDragging=!1,s.versionsWithLabels=[],e.$watchCollection("$ctrl.labels",(function(e){if(null!=e&&e.length>0){var t=o.groupBy(e,"version");s.versionsWithLabels=o.map(t,(function(e,t){return{version:parseInt(t,10),labels:e}}))}})),s.initHoveredRange=function(){s.hoveredHistoryRange={toV:s.selectedHistoryRange.toV,fromV:s.selectedHistoryRange.fromV}},s.resetHoveredRange=function(){s.hoveredHistoryRange={toV:null,fromV:null}},s.setHoveredRangeToV=function(e){e>=s.hoveredHistoryRange.fromV&&(s.hoveredHistoryRange.toV=e)},s.setHoveredRangeFromV=function(e){e<=s.hoveredHistoryRange.toV&&(s.hoveredHistoryRange.fromV=e)},s.isVersionSelected=function(e){return s.rangeSelectionEnabled?e<=s.selectedHistoryRange.toV&&e>=s.selectedHistoryRange.fromV:e===s.selectedHistoryVersion},s.isVersionHoverSelected=function(e){return s.rangeSelectionEnabled&&e<=s.hoveredHistoryRange.toV&&e>=s.hoveredHistoryRange.fromV},s.onDraggingStart=function(){e.$applyAsync((function(){s.isDragging=!0,s.initHoveredRange()}))},s.onDraggingStop=function(t,n){e.$applyAsync((function(){t||("toV"===n?s.setRangeToV(s.hoveredHistoryRange.toV):"fromV"===n&&s.setRangeFromV(s.hoveredHistoryRange.fromV)),s.isDragging=!1,s.resetHoveredRange()}))},s.onDrop=function(t,n){"toV"===t?e.$applyAsync((function(){return s.setRangeToV(n.version)})):"fromV"===t&&e.$applyAsync((function(){return s.setRangeFromV(n.version)}))},s.onOver=function(t,n){"toV"===t?e.$applyAsync((function(){return s.setHoveredRangeToV(n.version)})):"fromV"===t&&e.$applyAsync((function(){return s.setHoveredRangeFromV(n.version)}))},s.handleVersionSelect=function(e){s.rangeSelectionEnabled?s.onRangeSelect({selectedToV:e.version,selectedFromV:e.version}):s.onVersionSelect({version:e.version})},s.setRangeToV=function(e){e>=s.selectedHistoryRange.fromV&&s.onRangeSelect({selectedToV:e,selectedFromV:s.selectedHistoryRange.fromV})},s.setRangeFromV=function(e){e<=s.selectedHistoryRange.toV&&s.onRangeSelect({selectedToV:s.selectedHistoryRange.toV,selectedFromV:e})},s.getUserById=function(e){return o.find(s.users,(function(t){return((null!=t?t._id:void 0)||(null!=t?t.id:void 0))===e}))},s.displayName=n,s.getUserCSSStyle=function(e,n){var r=(null!=e?e._id:void 0)||(null!=e?e.id:void 0),i=t.getHueForUserId(r)||100;return s.isVersionSelected(n.version)||s.isVersionHoverSelected(n.version)?{color:"#FFF"}:{color:"hsl(".concat(i,", 70%, 50%)")}},s.$onInit=function(){s.resetHoveredRange()}};return r.$inject=["$scope","$element","$attrs","_"],e.component("historyLabelsList",{bindings:{labels:"<",rangeSelectionEnabled:"<",users:"<",currentUser:"<",isLoading:"<",selectedHistoryVersion:"<?",selectedHistoryRange:"<?",onVersionSelect:"&",onRangeSelect:"&",onLabelDelete:"&"},controller:r,templateUrl:"historyLabelsListTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t=function(e,t,n,r,i){var o=this;o.$onInit=function(){null==o.showTooltip&&(o.showTooltip=!0),null==o.isPseudoCurrentStateLabel&&(o.isPseudoCurrentStateLabel=!1)}};return t.$inject=["$scope","$element","$attrs","$filter","_"],e.component("historyLabel",{bindings:{labelText:"<",labelOwnerName:"<?",labelCreationDateTime:"<?",isOwnedByCurrentUser:"<",isPseudoCurrentStateLabel:"<",onLabelDelete:"&",showTooltip:"<?"},controller:t,templateUrl:"historyLabelTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t=function(e,t,n,r){var i=this;function o(e,t){for(var n=t.pathname.split("/"),i=e,o=0;o<n.length;o++){var s,a=n[o];o===n.length-1?((s=r.clone(t)).name=a,s.type="file",i.push(s)):(null==(s=r.find(i,(function(e){return e.name===a})))&&(s={name:a,type:"folder",children:[]},i.push(s)),i=s.children)}return e}i.handleEntityClick=function(e){return i.onSelectedFileChange({file:e})},i._fileTree=[],e.$watch("$ctrl.files",(function(e){null!=e&&e.length>0&&(i._fileTree=r.reduce(e,o,[]))}))};return t.$inject=["$scope","$element","$attrs","_"],e.component("historyFileTree",{bindings:{files:"<",selectedPathname:"<",onSelectedFileChange:"&",isLoading:"<"},controller:t,templateUrl:"historyFileTreeTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r=[n(0),n(63),n(203)],void 0===(i=function(e,t,n){var r=function(e,r,i){var s=this;s.hasOperation=!1,s.getRenameTooltip=function(e){var t=o(a(s.fileEntity.oldPathname,s.fileEntity.pathname),2),r=t[0],i=t[1];return"".concat(n.renamed," <strong>").concat(r,"</strong> &rarr; <strong>").concat(i,"</strong>")},s.getFileOperationName=function(){return"edited"===s.fileEntity.operation?n.edited:"renamed"===s.fileEntity.operation?n.renamed:"added"===s.fileEntity.operation?n.created:"removed"===s.fileEntity.operation?n.deleted:""};var a=function(e,t){for(var n=e.split("/"),r=t.split("/"),i=Math.min(n.length,r.length)-1,o=0;o<i&&n[o]===r[o];o++);return n.splice(0,o),r.splice(0,o),[n.join("/"),r.join("/")]},l=function(){s.isOpen=!s.isOpen,s.entityTypeIconClass=u()},c=function(){return s.historyFileTreeController.handleEntityClick(s.fileEntity)},u=function(){return s.isOpen?"fa-folder-open":"fa-folder"};s.$onInit=function(){"folder"===s.fileEntity.type?(s.isOpen=!0,s.entityTypeIconClass=u(),s.handleClick=l):(s.fileEntity.operation&&(s.hasOperation=!0),s.entityTypeIconClass="fa-".concat(t(s.fileEntity.name)),s.entityOpTextClass=s.fileEntity.operation?"history-file-entity-name-".concat(s.fileEntity.operation):null,s.handleClick=c,e.$watch((function(){return s.historyFileTreeController.selectedPathname}),(function(e){return s.isSelected=s.fileEntity.pathname===e})))}};return r.$inject=["$scope","$element","$attrs"],e.component("historyFileEntity",{require:{historyFileTreeController:"^historyFileTree"},bindings:{fileEntity:"<"},controller:r,templateUrl:"historyFileEntityTpl"})}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){return{edited:document.getElementById("file_action_edited_str").innerText,renamed:document.getElementById("file_action_renamed_str").innerText,created:document.getElementById("file_action_created_str").innerText,deleted:document.getElementById("file_action_deleted_str").innerText}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(205),n(210),n(211)],void 0===(i=function(){return function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.pdf={url:null,error:!1,timeout:!1,failure:!1,compiling:!1,uncompiled:!0,logEntries:[],logEntryAnnotations:{},rawLog:"",view:null,showRawLog:!1,highlights:[],position:null}}}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(4),n(206),n(209)],void 0===(i=function(e,t,n,r){var i=5e3,o=2e3;e.filter("trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),e.controller("PdfController",["$scope","$http","ide","$modal","synctex","eventTracking","localStorage",function(e,t,s,a,l,c,u){var h=!0;e.pdf.view=e.pdf.url?"pdf":"uncompiled",e.shouldShowLogs=!1,e.wikiEnabled=window.wikiEnabled,e.shouldDropUp=!1;var d=document.querySelector(".pdf-logs"),f=d&&d.querySelector(".files-dropdown");function p(e){var t=[];for(var n in e){var r=e[n];t.push("".concat(n,"=").concat(r))}return t.length?"?".concat(t.join("&")):""}e.$watch("shouldShowLogs",(function(t){t&&e.$applyAsync((function(){e.shouldDropUp=(null==f||null==d?0:f.getBoundingClientRect().top/d.getBoundingClientRect().height)>.65}))})),e.trackLogHintsLearnMore=function(){c.sendMB("logs-hints-learn-more")},ace.require("ace/lib/useragent").isMac?e.modifierKey="Cmd":e.modifierKey="Ctrl",e.stripHTMLFromString=function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""},e.$on("project:joined",(function(){h&&(h=!1,e.recompile({isAutoCompileOnLoad:!0}),e.hasPremiumCompile="priority"===e.project.features.compileGroup)})),e.$on("pdf:error:display",(function(){e.pdf.view="errors",e.pdf.renderingError=!0}));var g=null;function m(){if(!e.pdf.compiling&&e.autocompile_enabled&&e.pdf.uncompiled){var t=s.$scope.hasLintingError&&s.$scope.settings.syntaxValidation;if(e.autoCompileLintingError!==t&&e.$apply((function(){e.autoCompileLintingError=t,e.startedTryingAutoCompileAt=Date.now(),e.docLastChangedAt=Date.now()})),!t||!e.stop_on_validation_error){var n=Math.max(e.startedTryingAutoCompileAt,e.lastFinishedCompileAt||0),r=Date.now()-n,a=Date.now()-e.docLastChangedAt,l=!1;a>o?l=!0:r>i?l=!0:(r<0||a<0)&&(l=!0),l&&e.recompile({isAutoCompileOnChange:!0})}}}function v(){null==e.docLastChangedAt?e.pdf.uncompiled=!1:null==e.lastStartedCompileAt||e.docLastChangedAt>e.lastStartedCompileAt?e.pdf.uncompiled=!0:e.pdf.uncompiled=!1}function y(){e.docLastChangedAt=Date.now(),v()}function b(e,t){return null!=e&&null!=t&&-1!==t.indexOf("build")?"".concat(e).concat(t):t}function w(i,o){var a,l,u;function h(n,r){var i={method:"GET",params:{compileGroup:s.compileGroup,clsiserverid:s.clsiServerId}};return r&&r.url?i.url=r.url:r&&r.build?i.url="/project/".concat(e.project_id,"/build/").concat(r.build,"/output/").concat(n):i.url="/project/".concat(e.project_id,"/output/").concat(n),r&&r.build&&(i.params.cache_bust="".concat(Date.now())),i.url=b(o.pdfDownloadDomain,i.url),t(i)}(null!=o?o.validation:void 0)?l=i["output.chktex"]:(u=i["output.log"],a=i["output.blg"]);var d,f={all:[],errors:[],warnings:[]};function p(e){for(var t=0,n=["all","errors","warnings"];t<n.length;t++){var r=n[t];if(null!=e.type){var i=!0,o=!1,s=void 0;try{for(var a,l=e[r][Symbol.iterator]();!(i=(a=l.next()).done);i=!0){a.value.type=e.type}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}}f[r]=f[r].concat(e[r])}}function g(){e.pdf.logEntries=[],e.pdf.rawLog=""}if(null!=u&&(d=h("output.log",u).then((function(t){return function(t){e.pdf.rawLog=t;var r=n.parse(t,{ignoreDuplicates:!0}),i=r.errors,o=r.warnings,s=r.typesetting;p({all:[].concat(i,o,s),errors:i,warnings:o})}(t.data)})),null!=a&&(d=d.then((function(){return h("output.blg",a).then((function(e){return t=e.data,n=r.parse(t,{}),i=n.errors,o=n.warnings,void p({type:"BibTeX",all:[].concat(i,o),errors:i,warnings:o});var t,n,i,o}),(function(){return!0}))})))),null!=d?d.catch(g):g(),null!=l){var m=function(){return h("output.chktex",l).then((function(e){return function(e){var t=[],r=[],i=!0,o=!1,s=void 0;try{for(var a,l=e.split("\n")[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var u;if(u=a.value.match(/^(\S+):(\d+):(\d+): (Error|Warning): (.*)/)){var h={file:u[1],line:u[2],column:u[3],level:u[4].toLowerCase(),message:"".concat(u[4],": ").concat(u[5])};"error"===h.level?t.push(h):r.push(h)}}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}var d=[].concat(t,r),f=n.parse({type:"Syntax",all:d,errors:t,warnings:r});c.sendMB("syntax-check-return-count",{errors:t.length,warnings:r.length}),p(f)}(e.data)}))};d=null!=d?d.then(m,m):m()}null!=d&&d.finally((function(){e.pdf.logEntries=f,e.pdf.logEntryAnnotations={};var t=!0,n=!1,r=void 0;try{for(var i,o=f.all[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(null!=a.file){a.file=_(a.file);var l=s.fileTreeManager.findEntityByPath(a.file);null!=l&&(e.pdf.logEntryAnnotations[l.id]||(e.pdf.logEntryAnnotations[l.id]=[]),e.pdf.logEntryAnnotations[l.id].push({row:a.line-1,type:"error"===a.level?"error":"warning",text:a.message}))}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}))}function _(e){e=(e=e.replace(/^(.*)\/compiles\/[0-9a-f]{24}(-[0-9a-f]{24})?\/(\.\/)?/,"")).replace(/^\/compile\//,"");var t=s.fileTreeManager.getRootDocDirname();return null!=t&&(e=e.replace(/^\.\//,t+"/")),e}e.changesToAutoCompile=!1,e.$watch("pdf.uncompiled",(function(t){e.pdf.uncompiled&&e.autocompile_enabled&&!e.ui.pdfHidden?(e.changesToAutoCompile=!0,null==g&&(e.startedTryingAutoCompileAt=Date.now(),g=setInterval(m,200))):(e.changesToAutoCompile=!1,clearInterval(g),g=null)})),s.$scope.$on("doc:changed",(function(){e.autoCompileLintingError=!1,y()})),s.$scope.$on("doc:saved",(function(){y()})),e.$watch("pdf.compiling",(function(e){v()})),e.autocompile_enabled=u("autocompile_enabled:".concat(e.project_id))||!1,e.$watch("autocompile_enabled",(function(t,n){null!=t&&n!==t&&(!0===t&&m(),u("autocompile_enabled:".concat(e.project_id),t),c.sendMB("autocompile-setting-changed",{value:t}))})),e.stop_on_validation_error=u("stop_on_validation_error:".concat(e.project_id)),null==e.stop_on_validation_error&&(e.stop_on_validation_error=!0),e.$watch("stop_on_validation_error",(function(t,n){null!=t&&n!==t&&u("stop_on_validation_error:".concat(e.project_id),t)})),e.draft=u("draft:".concat(e.project_id))||!1,e.$watch("draft",(function(t,n){null!=t&&n!==t&&u("draft:".concat(e.project_id),t)})),e.recompile=function(n){null==n&&(n={}),e.pdf.compiling||(c.sendMBSampled("editor-recompile-sampled",n),e.lastStartedCompileAt=Date.now(),e.pdf.compiling=!0,e.pdf.isAutoCompileOnLoad=null!=n?n.isAutoCompileOnLoad:void 0,(null!=n?n.force:void 0)&&(e.stop_on_validation_error=!1,e.shouldShowLogs=!1,c.sendMB("syntax-check-turn-off-checking")),(null!=n?n.try:void 0)&&(e.shouldShowLogs=!1,c.sendMB("syntax-check-try-compile-anyway")),s.$scope.$broadcast("flush-changes"),n.rootDocOverride_id=function(){var e=s.editorManager.getCurrentDocValue();if(null==e)return null;var t=!0,n=!1,r=void 0;try{for(var i,o=e.split("\n")[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(/^[^%]*\\documentclass/.test(a))return s.editorManager.getCurrentDocId()}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null}(),function(n){null==n&&(n={});var r,i="/project/".concat(e.project_id,"/compile"),o={};return(n.isAutoCompileOnLoad||n.isAutoCompileOnChange)&&(o.auto_compile=!0),e.check&&(e.pdf.logEntries=[]),e.check=!!n.check,n.check&&c.sendMB("syntax-check-request"),"error"===(r=e.check?"validate":n.try?"silent":e.stop_on_validation_error?"error":"silent")&&(r="silent"),t.post(i,{rootDoc_id:n.rootDocOverride_id||null,draft:e.draft,check:r,incrementalCompilesEnabled:!e.pdf.error,_csrf:window.csrfToken},{params:o})}(n).then((function(t){var n=t.data;e.pdf.view="pdf",e.pdf.compiling=!1,function(t){var n=e.pdf.url,r=t.pdfDownloadDomain;e.pdf.error=!1,e.pdf.timedout=!1,e.pdf.failure=!1,e.pdf.url=null,e.pdf.clsiMaintenance=!1,e.pdf.tooRecentlyCompiled=!1,e.pdf.renderingError=!1,e.pdf.projectTooLarge=!1,e.pdf.compileTerminated=!1,e.pdf.compileExited=!1,e.pdf.failedCheck=!1,e.pdf.compileInProgress=!1,e.pdf.autoCompileDisabled=!1;var i={};if(null!=t.outputFiles){var o=!0,a=!1,l=void 0;try{for(var u,h=t.outputFiles[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var d=u.value;i[d.path]=d}}catch(e){a=!0,l=e}finally{try{o||null==h.return||h.return()}finally{if(a)throw l}}}var f={};if(null!=t.compileGroup&&(s.compileGroup=f.compileGroup=t.compileGroup),null!=t.clsiServerId&&(s.clsiServerId=f.clsiserverid=t.clsiServerId),"timedout"===t.status)e.pdf.view="errors",e.pdf.timedout=!0,w(i,{pdfDownloadDomain:r}),e.hasPremiumCompile||s.$scope.project.owner._id!==s.$scope.user.id||c.send("subscription-funnel","editor-click-feature","compile-timeout");else if("terminated"===t.status)e.pdf.view="errors",e.pdf.compileTerminated=!0,w(i,{pdfDownloadDomain:r});else if(["validation-fail","validation-pass"].includes(t.status))e.pdf.view="pdf",e.pdf.url=b(r,n),e.shouldShowLogs=!0,"validation-fail"===t.status&&(e.pdf.failedCheck=!0),c.sendMB("syntax-check-".concat(t.status)),w(i,{validation:!0,pdfDownloadDomain:r});else if("exited"===t.status)e.pdf.view="pdf",e.pdf.compileExited=!0,e.pdf.url=b(r,n),e.shouldShowLogs=!0,w(i,{pdfDownloadDomain:r});else if("autocompile-backoff"===t.status)e.pdf.isAutoCompileOnLoad?e.pdf.view="uncompiled":(e.pdf.view="errors",e.pdf.autoCompileDisabled=!0,e.autocompile_enabled=!1,c.sendMB("autocompile-rate-limited",{hasPremiumCompile:e.hasPremiumCompile}));else if("project-too-large"===t.status)e.pdf.view="errors",e.pdf.projectTooLarge=!0;else if("failure"===t.status)e.pdf.view="errors",e.pdf.failure=!0,e.shouldShowLogs=!0,w(i,{pdfDownloadDomain:r});else if("clsi-maintenance"===t.status)e.pdf.view="errors",e.pdf.clsiMaintenance=!0;else if("too-recently-compiled"===t.status)e.pdf.view="errors",e.pdf.tooRecentlyCompiled=!0;else if("validation-problems"===t.status)e.pdf.view="validation-problems",e.pdf.validation=t.validationProblems,e.shouldShowLogs=!1;else if("compile-in-progress"===t.status)e.pdf.view="errors",e.pdf.compileInProgress=!0;else if("success"===t.status){if(e.pdf.view="pdf",e.shouldShowLogs=!1,i["output.pdf"]&&i["output.pdf"].url)e.pdf.url=b(r,i["output.pdf"].url);else if(i["output.pdf"]&&i["output.pdf"].build){var g=i["output.pdf"].build;e.pdf.url=b(r,"/project/".concat(e.project_id,"/build/").concat(g,"/output/output.pdf"))}else e.pdf.url=b(r,"/project/".concat(e.project_id,"/output/output.pdf"));i["output.pdf"]&&i["output.pdf"].build&&(f.cache_bust="".concat(Date.now())),e.pdf.url+=p(f),f.popupDownload=!0;var m=null;i["output.pdf"]&&i["output.pdf"].build&&(m=i["output.pdf"].build),e.pdf.downloadUrl="/download/project/".concat(e.project_id).concat(m?"/build/"+m:"","/output/output.pdf")+p(f),w(i,{pdfDownloadDomain:r})}var v=["output.fls","output.fdb_latexmk"];if(e.pdf.outputFiles=[],null!=t.outputFiles){f={},null!=t.clsiServerId&&(f.clsiserverid=t.clsiServerId);var y=!0,_=!1,C=void 0;try{for(var S,k=t.outputFiles[Symbol.iterator]();!(y=(S=k.next()).done);y=!0){var A=S.value;if(-1===v.indexOf(A.path)){var x=/^output\./.test(A.path);e.pdf.outputFiles.push({name:x?"".concat(A.path.replace(/^output\./,"")," file"):A.path,url:"/project/".concat(e.project_id,"/output/").concat(A.path)+p(f),main:!!x})}}}catch(e){_=!0,C=e}finally{try{y||null==k.return||k.return()}finally{if(_)throw C}}e.pdf.outputFiles.sort((function(e,t){return t.main-e.main||e.name.localeCompare(t.name)}))}}(n)})).catch((function(t){429===t.status&&(e.pdf.rateLimited=!0),e.pdf.compiling=!1,e.pdf.renderingError=!1,e.pdf.error=!0,e.pdf.view="errors"})).finally((function(){e.lastFinishedCompileAt=Date.now()})))},s.$scope.recompile=e.recompile,s.$scope.recompileViaKey=function(){e.recompile({keyShortcut:!0})},e.stop=function(){if(e.pdf.compiling)return t({url:"/project/".concat(e.project_id,"/compile/stop"),method:"POST",params:{clsiserverid:s.clsiServerId},headers:{"X-Csrf-Token":window.csrfToken}})},e.clearCache=function(){return t({url:"/project/".concat(e.project_id,"/output"),method:"DELETE",params:{clsiserverid:s.clsiServerId},headers:{"X-Csrf-Token":window.csrfToken}})},e.toggleLogs=function(){e.shouldShowLogs=!e.shouldShowLogs,e.shouldShowLogs&&c.sendMBOnce("ide-open-logs-once")},e.showPdf=function(){e.pdf.view="pdf",e.shouldShowLogs=!1},e.toggleRawLog=function(){e.pdf.showRawLog=!e.pdf.showRawLog,e.pdf.showRawLog&&c.sendMB("logs-view-raw")},e.openClearCacheModal=function(){a.open({templateUrl:"clearCacheModalTemplate",controller:"ClearCacheModalController",scope:e})},e.syncToCode=function(e){l.syncToCode(e).then((function(e){var t=e.doc,n=e.line;s.editorManager.openDoc(t,{gotoLine:n})}))}}]),e.factory("synctex",["ide","$http","$q",function(e,t,n){return{syncToPdf:function(r){var i=n.defer(),o=e.editorManager.getCurrentDocId();if(null==o)return i.reject(),i.promise;var s=e.fileTreeManager.findEntityById(o);if(null==s)return i.reject(),i.promise;var a=e.fileTreeManager.getEntityPath(s);if(null==a)return i.reject(),i.promise;var l=e.fileTreeManager.getRootDocDirname();null!=l&&""!==l&&(a=a.replace(RegExp("^".concat(l)),"".concat(l,"/.")));var c=r.row,u=r.column;return t({url:"/project/".concat(e.project_id,"/sync/code"),method:"GET",params:{file:a,line:c+1,column:u,clsiserverid:e.clsiServerId}}).then((function(e){var t=e.data;return i.resolve(t.pdf||[])})).catch((function(e){var t=e.data;return i.reject(t)})),i.promise},syncToCode:function(r,i){null==i&&(i={});var o=n.defer();if(null==r)return o.reject(),o.promise;var s,a=r.offset.left;return s=i.fromPdfPosition&&null!=(null!=r.pageSize?r.pageSize.height:void 0)?r.pageSize.height-r.offset.top||0:r.offset.top||0,i.includeVisualOffset&&(s+=72),t({url:"/project/".concat(e.project_id,"/sync/pdf"),method:"GET",params:{page:r.page+1,h:a.toFixed(2),v:s.toFixed(2),clsiserverid:e.clsiServerId}}).then((function(t){var n=t.data;if(null!=n.code&&n.code.length>0&&""!==n.code[0].file){var r=e.fileTreeManager.findEntityByPath(n.code[0].file);if(null==r)return;return o.resolve({doc:r,line:n.code[0].line})}""===n.code[0].file&&(e.$scope.sync_tex_error=!0,setTimeout((function(){return e.$scope.sync_tex_error=!1}),4e3))})).catch((function(e){var t=e.data;return o.reject(t)})),o.promise}}}]),e.controller("PdfSynctexController",["$scope","synctex","ide",function(e,t,n){var r=this;this.cursorPosition=null,n.$scope.$on("cursor:editor:update",(function(e,t){r.cursorPosition=t})),e.syncToPdf=function(){null!=r.cursorPosition&&t.syncToPdf(r.cursorPosition).then((function(t){e.pdf.highlights=t}))},n.$scope.$on("cursor:editor:syncToPdf",e.syncToPdf),e.syncToCode=function(){t.syncToCode(e.pdf.position,{includeVisualOffset:!0,fromPdfPosition:!0}).then((function(e){var t=e.doc,r=e.line;n.editorManager.openDoc(t,{gotoLine:r})}))}}]),e.controller("PdfLogEntryController",["$scope","ide","eventTracking",function(e,t,n){e.openInEditor=function(e){var r,i;n.sendMBOnce("logs-jump-to-location-once");var o=t.fileTreeManager.findEntityByPath(e.file);null!=o&&"doc"===o.type&&(null!=e.line&&(i=e.line),null!=e.column&&(r=e.column),t.editorManager.openDoc(o,{gotoLine:i,gotoColumn:r}))}}]),e.controller("ClearCacheModalController",["$scope","$modalInstance",function(e,t){e.state={inflight:!1},e.clear=function(){e.state.inflight=!0,e.clearCache().then((function(){e.state.inflight=!1,t.close()}))},e.cancel=function(){return t.dismiss("cancel")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r=[n(207),n(208)],void 0===(i=function(e,t){return{parse:function(n,r){var i;i="string"==typeof n?e.parse(n,r):n;for(var s=function(e){for(var n=0,r=Array.from(t);n<r.length;n++){var i=r[n];if(i.regexToMatch.test(e))return i}},a={},l=0,c=Array.from(i.all);l<c.length;l++){var u=c[l],h=s(u.message);if(null!=h){if(null!=h.ruleId?u.ruleId=h.ruleId:null!=h.regexToMatch&&(u.ruleId="hint_".concat(h.regexToMatch.toString().replace(/\s/g,"_").slice(1,-1))),null!=h.newMessage&&(u.message=u.message.replace(h.regexToMatch,h.newMessage)),null!=h.cascadesFrom)for(var d=0,f=Array.from(h.cascadesFrom);d<f.length;d++)a[f[d]]&&(u.suppressed=!0);if(null!=h.types)for(var p=0,g=Array.from(h.types);p<g.length;p++)a[g[p]]=!0;null!=h.humanReadableHint&&(u.humanReadableHint=h.humanReadableHint),null!=h.extraInfoURL&&(u.extraInfoURL=h.extraInfoURL)}}for(var m in i){var v=i[m];"object"===o(v)&&v.length>0&&(i[m]=Array.from(v).filter((function(e){return!e.suppressed})))}return i}}}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){var e,t,n,r,i,o,s,a;return 79,t=/^LaTeX Warning: (.*)$/,e=/^(Over|Under)full \\(v|h)box/,s=/^(Package \b.+\b Warning:.*)$/,n=/lines? ([0-9]+)/,o=/^Package (\b.+\b) Warning/,function(){this.nextLine=function(){return this.row++,!(this.row>=this.lines.length)&&this.lines[this.row]},this.rewindLine=function(){this.row--},this.linesUpToNextWhitespaceLine=function(){return this.linesUpToNextMatchingLine(/^ *$/)},this.linesUpToNextMatchingLine=function(e){var t,n;for(t=[],!1!==(n=this.nextLine())&&t.push(n);!1!==n&&!n.match(e)&&!1!==n;)!1!==(n=this.nextLine())&&t.push(n);return t}}.call((i=function(e){var t,n;for(this.text=e.replace(/(\r\n)|\r/g,"\n"),n=this.text.split("\n"),this.lines=[n[0]],t=1;t<n.length;)79===n[t-1].length&&"..."!==n[t-1].slice(-3)?this.lines[this.lines.length-1]+=n[t]:this.lines.push(n[t]),t++;this.row=0}).prototype),a={NORMAL:0,ERROR:1},function(){return this.parse=function(){for(var e;!1!==(this.currentLine=this.log.nextLine());)this.state===a.NORMAL&&(this.currentLineIsError()?(this.state=a.ERROR,this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine.slice(2),content:"",raw:this.currentLine+"\n"}):this.currentLineIsRunawayArgument()?this.parseRunawayArgumentError():this.currentLineIsWarning()?this.parseSingleWarningLine(t):this.currentLineIsHboxWarning()?this.parseHboxLine():this.currentLineIsPackageWarning()?this.parseMultipleWarningLine():this.parseParensForFilenames()),this.state===a.ERROR&&(this.currentError.content+=this.log.linesUpToNextMatchingLine(/^l\.[0-9]+/).join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.raw+=this.currentError.content,(e=this.currentError.raw.match(/l\.([0-9]+)/))&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError),this.state=a.NORMAL);return this.postProcess(this.data)},this.currentLineIsError=function(){return"!"===this.currentLine[0]},this.currentLineIsRunawayArgument=function(){return this.currentLine.match(/^Runaway argument/)},this.currentLineIsWarning=function(){return!!this.currentLine.match(t)},this.currentLineIsPackageWarning=function(){return!!this.currentLine.match(s)},this.currentLineIsHboxWarning=function(){return!!this.currentLine.match(e)},this.parseRunawayArgumentError=function(){var e;return this.currentError={line:null,file:this.currentFilePath,level:"error",message:this.currentLine,content:"",raw:this.currentLine+"\n"},this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.content+="\n",this.currentError.content+=this.log.linesUpToNextWhitespaceLine().join("\n"),this.currentError.raw+=this.currentError.content,(e=this.currentError.raw.match(/l\.([0-9]+)/))&&(this.currentError.line=parseInt(e[1],10)),this.data.push(this.currentError)},this.parseSingleWarningLine=function(e){var t,r,i,o;(o=this.currentLine.match(e))&&(t=(r=(i=o[1]).match(n))?parseInt(r[1],10):null,this.data.push({line:t,file:this.currentFilePath,level:"warning",message:i,raw:i}))},this.parseMultipleWarningLine=function(){var e,t,r,i,a,l,c;if(l=this.currentLine.match(s)){for(c=[l[1]],e=(t=this.currentLine.match(n))?parseInt(t[1],10):null,r=this.currentLine.match(o)[1],i=new RegExp("(?:\\("+r+"\\))*[\\s]*(.*)","i");this.currentLine=this.log.nextLine();)e=(t=this.currentLine.match(n))?parseInt(t[1],10):e,l=this.currentLine.match(i),c.push(l[1]);a=c.join(" "),this.data.push({line:e,file:this.currentFilePath,level:"warning",message:a,raw:a})}},this.parseHboxLine=function(){var e,t;e=(t=this.currentLine.match(n))?parseInt(t[1],10):null,this.data.push({line:e,file:this.currentFilePath,level:"typesetting",message:this.currentLine,raw:this.currentLine})},this.parseParensForFilenames=function(){var e,t,n,r,i;-1!==(n=this.currentLine.search(/\(|\)/))&&(i=this.currentLine[n],this.currentLine=this.currentLine.slice(n+1),"("===i?(e=this.consumeFilePath())?(this.currentFilePath=e,t={path:e,files:[]},this.fileStack.push(t),this.currentFileList.push(t),this.currentFileList=t.files):this.openParens++:")"===i&&(this.openParens>0?this.openParens--:this.fileStack.length>1&&(this.fileStack.pop(),r=this.fileStack[this.fileStack.length-1],this.currentFilePath=r.path,this.currentFileList=r.files)),this.parseParensForFilenames())},this.consumeFilePath=function(){var e,t;return!!this.currentLine.match(/^\/?([^ \)]+\/)+/)&&(t=void 0,-1===(e=this.currentLine.search(RegExp(" |\\)")))?(t=this.currentLine,this.currentLine=""):(t=this.currentLine.slice(0,e),this.currentLine=this.currentLine.slice(e)),t)},this.postProcess=function(e){var t,n,r,i,o,s,a;for(t=[],n=[],a=[],s=[],i=[],r=function(e){return e.raw},o=0;o<e.length;)this.ignoreDuplicates&&i.indexOf(r(e[o]))>-1?o++:("error"===e[o].level?n.push(e[o]):"typesetting"===e[o].level?s.push(e[o]):"warning"===e[o].level&&a.push(e[o]),t.push(e[o]),i.push(r(e[o])),o++);return{errors:n,warnings:a,typesetting:s,all:t,files:this.rootFileList}}}.call((r=function(e,t){this.log=new i(e),this.state=a.NORMAL,t=t||{},this.fileBaseNames=t.fileBaseNames||[/compiles/,/\/usr\/local/],this.ignoreDuplicates=t.ignoreDuplicates,this.data=[],this.fileStack=[],this.currentFileList=this.rootFileList=[],this.openParens=0}).prototype),r.parse=function(e,t){return new r(e,t).parse()},r}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(){return[{regexToMatch:/Misplaced alignment tab character \&/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Misplaced_alignment_tab_character_%26",humanReadableHint:"You have placed an alignment tab character '&' in the wrong place. If you want to align something, you must write it inside an align environment such as \\begin{align} … \\end{align}, \\begin{tabular} … \\end{tabular}, etc. If you want to write an ampersand '&' in text, you must write \\& instead."},{regexToMatch:/Extra alignment tab has been changed to \\cr/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Extra_alignment_tab_has_been_changed_to_%5Ccr",humanReadableHint:'You have written too many alignment tabs in a table, causing one of them to be turned into a line break. Make sure you have specified the correct number of columns in your <a target="_blank" href="https://www.sharelatex.com/learn/Tables">table</a>.'},{regexToMatch:/Display math should end with \$\$/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Display_math_should_end_with_$$",humanReadableHint:"You have forgotten a $ sign at the end of 'display math' mode. When writing in display math mode, you must always math write inside $$ … $$. Check that the number of $s match around each math expression."},{regexToMatch:/Missing [{$] inserted./,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Missing_$_inserted",humanReadableHint:"Check that your $'s match around math expressions. If they do, then you've probably used a symbol in normal text that needs to be in math mode. Symbols such as subscripts ( _ ), integrals ( \\int ), Greek letters ( \\alpha, \\beta, \\delta ), and modifiers (\\vec{x}, \\tilde{x} ) must be written in math mode. See the full list <a target=\"_blank\" href=\"https://www.sharelatex.com/learn/Errors/Missing_$_inserted \">here</a>.If you intended to use mathematics mode, then use $ … $ for 'inline math mode', $$ … $$ for 'display math mode' or alternatively \\begin{math} … \\end{math}."},{regexToMatch:/(undefined )?[rR]eference(s)?.+(undefined)?/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/There_were_undefined_references",humanReadableHint:"You have referenced something which has not yet been labelled. If you have labelled it already, make sure that what is written inside \\ref{...} is the same as what is written inside \\label{...}."},{regexToMatch:/Citation .+ on page .+ undefined on input line .+/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Citation_XXX_on_page_XXX_undefined_on_input_line_XXX",humanReadableHint:"You have cited something which is not included in your bibliography. Make sure that the citation (\\cite{...}) has a corresponding key in your bibliography, and that both are spelled the same way."},{regexToMatch:/(Label .+)? multiply[ -]defined( labels)?/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/There_were_multiply-defined_labels",humanReadableHint:"You have used the same label more than once. Check that each \\label{...} labels only one item."},{regexToMatch:/`!?h' float specifier changed to `!?ht'/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/%60!h%27_float_specifier_changed_to_%60!ht%27",humanReadableHint:"The float specifier 'h' is too strict of a demand for LaTeX to place your float in a nice way here. Try relaxing it by using 'ht', or even 'htbp' if necessary. If you want to try keep the float here anyway, check out the <a target=\"_blank\" href=\"https://www.sharelatex.com/learn/Positioning_of_Figures\">float package</a>."},{regexToMatch:/No positions in optional float specifier/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/No_positions_in_optional_float_specifier",humanReadableHint:'You have forgotten to include a float specifier, which tells LaTeX where to position your figure. To fix this, either insert a float specifier inside the square brackets (e.g. \\begin{figure}[h]), or remove the square brackets (e.g. \\begin{figure}). Find out more about float specifiers <a target="_blank" href="https://www.sharelatex.com/learn/Positioning_of_Figures">here</a>.'},{regexToMatch:/Undefined control sequence/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Undefined_control_sequence",humanReadableHint:"The compiler is having trouble understanding a command you have used. Check that the command is spelled correctly. If the command is part of a package, make sure you have included the package in your preamble using \\usepackage{...}."},{regexToMatch:/File .+ not found/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/File_XXX_not_found_on_input_line_XXX",humanReadableHint:'The compiler cannot find the file you want to include. Make sure that you have <a target="_blank" href="https://www.sharelatex.com/learn/Including_images_in_ShareLaTeX">uploaded the file</a> and <a target="_blank" href="https://www.sharelatex.com/learn/Errors/File_XXX_not_found_on_input_line_XXX.">specified the file location correctly</a>.'},{regexToMatch:/LaTeX Error: Unknown graphics extension: \..+/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.XXX",humanReadableHint:'The compiler does not recognise the file type of one of your images. Make sure you are using a <a target="_blank" href="https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Unknown_graphics_extension:_.gif.">supported image format</a> for your choice of compiler, and check that there are no periods (.) in the name of your image.'},{regexToMatch:/LaTeX Error: Unknown float option `H'/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60H%27",humanReadableHint:"The compiler isn't recognizing the float option 'H'. Include \\usepackage{float} in your preamble to fix this."},{regexToMatch:/LaTeX Error: Unknown float option `q'/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Unknown_float_option_%60q%27",humanReadableHint:'You have used a float specifier which the compiler does not understand. You can learn more about the different float options available for placing figures <a target="_blank" href="https://www.sharelatex.com/learn/Positioning_of_Figures">here</a>.'},{regexToMatch:/LaTeX Error: \\math.+ allowed only in math mode/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_%5Cmathrm_allowed_only_in_math_mode",humanReadableHint:"You have used a font command which is only available in math mode. To use this command, you must be in maths mode (E.g. $ … $ or \\begin{math} … \\end{math}). If you want to use it outside of math mode, use the text version instead: \\textrm, \\textit, etc."},{ruleId:"hint_mismatched_environment",types:["environment"],regexToMatch:/Error: `([^']{2,})' expected, found `([^']{2,})'.*/,newMessage:"Error: environment does not match \\begin{$1} ... \\end{$2}",humanReadableHint:"You have used \\begin{...} without a corresponding \\end{...}."},{ruleId:"hint_mismatched_brackets",types:["environment"],regexToMatch:/Error: `([^a-zA-Z0-9])' expected, found `([^a-zA-Z0-9])'.*/,newMessage:"Error: brackets do not match, found '$2' instead of '$1'",humanReadableHint:"You have used an open bracket without a corresponding close bracket."},{regexToMatch:/LaTeX Error: Can be used only in preamble/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Can_be_used_only_in_preamble",humanReadableHint:"You have used a command in the main body of your document which should be used in the preamble. Make sure that \\documentclass[…]{…} and all \\usepackage{…} commands are written before \\begin{document}."},{regexToMatch:/Missing \\right inserted/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Missing_%5Cright_insertede",humanReadableHint:'You have started an expression with a \\left command, but have not included a corresponding \\right command. Make sure that your \\left and \\right commands balance everywhere, or else try using \\Biggl and \\Biggr commands instead as shown <a target="_blank" href="https://www.sharelatex.com/learn/Errors/Missing_%5Cright_inserted">here</a>.'},{regexToMatch:/Double superscript/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Double_superscript",humanReadableHint:"You have written a double superscript incorrectly as a^b^c, or else you have written a prime with a superscript. Remember to include { and } when using multiple superscripts. Try a^{b^c} instead."},{regexToMatch:/Double subscript/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Double_subscript",humanReadableHint:"You have written a double subscript incorrectly as a_b_c. Remember to include { and } when using multiple subscripts. Try a_{b_c} instead."},{regexToMatch:/No \\author given/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/No_%5Cauthor_given",humanReadableHint:"You have used the \\maketitle command, but have not specified any \\author. To fix this, include an author in your preamble using the \\author{…} command."},{regexToMatch:/LaTeX Error: Environment .+ undefined/,extraInfoURL:"https://www.sharelatex.com/learn/Errors%2FLaTeX%20Error%3A%20Environment%20XXX%20undefined",humanReadableHint:"You have created an environment (using \\begin{…} and \\end{…} commands) which is not recognized. Make sure you have included the required package for that environment in your preamble, and that the environment is spelled correctly."},{regexToMatch:/LaTeX Error: Something's wrong--perhaps a missing \\item/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_Something%27s_wrong--perhaps_a_missing_%5Citem",humanReadableHint:"There are no entries found in a list you have created. Make sure you label list entries using the \\item command, and that you have not used a list inside a table."},{regexToMatch:/Misplaced \\noalign/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Misplaced_%5Cnoalign",humanReadableHint:"You have used a \\hline command in the wrong place, probably outside a table. If the \\hline command is written inside a table, try including \\\\ before it."},{regexToMatch:/LaTeX Error: There's no line here to end/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_There%27s_no_line_here_to_end",humanReadableHint:"You have used a \\\\ or \\newline command where LaTeX was not expecting one. Make sure that you only use line breaks after blocks of text, and be careful using linebreaks inside lists and other environments."},{regexToMatch:/LaTeX Error: \\verb ended by end of line/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/LaTeX_Error:_%5Cverb_ended_by_end_of_line",humanReadableHint:"You have used a \\verb command incorrectly. Try replacling the \\verb command with \\begin{verbatim}…\\end{verbatim}."},{regexToMatch:/Illegal unit of measure (pt inserted)/,extraInfoURL:"https://www.sharelatex.com/learn/Errors%2FIllegal%20unit%20of%20measure%20(pt%20inserted)",humanReadableHint:"You have written a length, but have not specified the appropriate units (pt, mm, cm etc.). If you have not written a length, check that you have not witten a linebreak \\\\ followed by square brackets […] anywhere."},{regexToMatch:/Extra \\right/,extraInfoURL:"https://www.sharelatex.com/learn/Errors/Extra_%5Cright",humanReadableHint:"You have written a \\right command without a corresponding \\left command. Check that all \\left and \\right commands balance everywhere. "},{regexToMatch:/Missing \\begin{document}/,extraInfoURL:"https://www.sharelatex.com/learn/Errors%2FLaTeX%20Error%3A%20Missing%20%5Cbegin%20document",humanReadableHint:"No \\begin{document} command was found. Make sure you have included \\begin{document} in your preamble, and that your main document is set correctly."},{ruleId:"hint_mismatched_environment2",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: `\\end\{([^\}]+)\}' expected but found `\\end\{([^\}]+)\}'.*/,newMessage:"Error: environments do not match: \\begin{$1} ... \\end{$2}",humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."},{ruleId:"hint_mismatched_environment3",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Warning: No matching \\end found for `\\begin\{([^\}]+)\}'.*/,newMessage:"Warning: No matching \\end found for \\begin{$1}",humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."},{ruleId:"hint_mismatched_environment4",types:["environment"],cascadesFrom:["environment"],regexToMatch:/Error: Found `\\end\{([^\}]+)\}' without corresponding \\begin.*/,newMessage:"Error: found \\end{$1} without a corresponding \\begin{$1}",humanReadableHint:"You have used \\begin{} without a corresponding \\end{}."}]}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(){var e,t,n,r,i,o;return t=/^\[(\d+)].*>\s(INFO|WARN|ERROR)\s-\s(.*)$/,n={INFO:"info",WARN:"warning",ERROR:"error"},r=function(e,t,n){var r,i,o,s,a,l;for(l=e,a=[],s=t,r=0;i=s.exec(l);){if((r+=1)>=1e4)return a;o=n(i),a.push(o),l=i.input.slice(0,i.index)+i.input.slice(i.index+i[0].length+1,i.input.length)}return[a,l]},o=[[/^Warning--(.+)\n--line (\d+) of file (.+)$/m,function(e){var t,n,r;return t=e[0],r=e[1],n=e[2],{file:e[3],level:"warning",message:r,line:n,raw:t}}],[/^Warning--(.+)$/m,function(e){var t;return t=e[0],{file:"",level:"warning",message:e[1],line:"",raw:t}}]],i=[[/^(.*)---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this entry$/m,function(e){var t,n,r;return n=e[0],t=e[1],r=e[2],{file:e[3],level:"error",message:t+"\n"+e[4],line:r,raw:n}}],[/^(A bad cross reference---entry ".+?"\nrefers to entry.+?, which doesn't exist)$/m,function(e){var t;return t=e[0],{file:"",level:"error",message:e[1],line:"",raw:t}}],[/^(.*)\n---line (\d+) of file (.*)\n([^]+?)\nI'm skipping whatever remains of this command$/m,function(e){var t,n,r;return n=e[0],t=e[1],r=e[2],{file:e[3],level:"error",message:t+"\n"+e[4],line:r,raw:n}}]],function(){return this.parseBibtex=function(){var e,t,n,s,a,l;return l={all:[],errors:[],warnings:[],files:[],typesetting:[]},t=(n=o.reduce((function(e,t){var n,i,o,s,a,l,c;return i=e[0],l=e[1],a=t[0],o=t[1],c=(s=r(l,a,o))[0],n=s[1],[i.concat(c),n]}),[[],this.text]))[0],a=n[1],e=(s=i.reduce((function(e,t){var n,i,o,s,a,l,c;return i=e[0],c=e[1],l=t[0],s=t[1],o=(a=r(c,l,s))[0],n=a[1],[i.concat(o),n]}),[[],a]))[0],a=s[1],l.warnings=t,l.errors=e,l.all=t.concat(e),l},this.parseBiber=function(){var e;return e={all:[],errors:[],warnings:[],files:[],typesetting:[]},this.lines.forEach((function(r){var i,o,s,a,l,c,u,h,d;if(l=r.match(t))switch(o=l[0],a=l[1],u=l[2],c=l[3],(s=(h={file:"",level:n[u]||"INFO",message:c,line:"",raw:o}).message.match(/^BibTeX subsystem: \/.+\/(\w+\.\w+)_.+, line (\d+), (.+)$/))&&4===s.length&&(s[0],i=s[1],a=s[2],d=s[3],h.file=i,h.line=a,h.message=d),e.all.push(h),h.level){case"error":return e.errors.push(h);case"warning":return e.warnings.push(h)}})),e},this.parse=function(){var e;if((e=this.lines[0]).match(/^.*INFO - This is Biber.*$/))return this.parseBiber();if(e.match(/^This is BibTeX, Version.+$/))return this.parseBibtex();throw new Error("BibLogParser Error: cannot determine whether text is biber or bibtex output")}}.call((e=function(e,t){if("string"!=typeof e)throw new Error("BibLogParser Error: text parameter must be a string");this.text=e.replace(/(\r\n)|\r/g,"\n"),this.options=t||{},this.lines=e.split("\n")}).prototype),e.parse=function(t,n){return new e(t,n).parse()},e}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("PdfViewToggleController",["$scope",function(e){return e.togglePdfView=function(){return"pdf"===e.ui.view?e.ui.view="editor":e.ui.view="pdf"},e.fileTreeClosed=!1,e.$on("layout:main:resize",(function(t,n){return n.west.initClosed?e.fileTreeClosed=!0:e.fileTreeClosed=!1,e.$apply()}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(212)],void 0===(i=function(e,t){return e.directive("pdfng",["$timeout","localStorage",function(e,t){return{scope:{pdfSrc:"=",highlights:"=",position:"=",dblClickCallback:"="},link:function(n,r,i){n.loading=!1,n.pleaseJumpTo=null,n.scale=null;var o=!1,s=function(){return n.$evalAsync((function(){return n.flashControls=!0,e((function(){return n.flashControls=!1}),1e3)}))};if(n.$on("pdfDoubleClick",(function(e,t){return"function"==typeof n.dblClickCallback?n.dblClickCallback({page:t.page-1,offset:{top:t.y,left:t.x}}):void 0})),n.$on("flash-controls",(function(){return s()})),n.$watch("pdfSrc",(function(e){if(e)return n.loading=!0,n.loaded=!1,n.progress=1,function(){var e,r;if(!o)o=!0,null!=(r=t("pdf.scale"))?n.scale={scaleMode:r.scaleMode,scale:+r.scale}:n.scale={scaleMode:"scale_mode_fit_width"},(e=t("pdf.position.".concat(i.key)))&&(n.position={page:+e.page,offset:{top:+e.offset.top,left:+e.offset.left}}),n.$on("$destroy",(function(){return t("pdf.scale",n.scale),t("pdf.position.".concat(i.key),n.position)})),$(window).unload((function(){return t("pdf.scale",n.scale),t("pdf.position.".concat(i.key),n.position)}))}(),s()})),n.$on("loaded",(function(){return n.loaded=!0,n.progress=100,e((function(){return n.loading=!1,delete n.progress}),500)})),n.fitToHeight=function(){var e=angular.copy(n.scale);return e.scaleMode="scale_mode_fit_height",n.scale=e},n.fitToWidth=function(){var e=angular.copy(n.scale);return e.scaleMode="scale_mode_fit_width",n.scale=e},n.zoomIn=function(){var e=angular.copy(n.scale);return e.scaleMode="scale_mode_value",e.scale=1.2*e.scale,n.scale=e},n.zoomOut=function(){var e=angular.copy(n.scale);return e.scaleMode="scale_mode_value",e.scale=e.scale/1.2,n.scale=e},null!=i.resizeOn)for(var a=0,l=Array.from(i.resizeOn.split(","));a<l.length;a++){var c=l[a];n.$on(c,(function(e){}))}return n.$on("progress",(function(e,t){return n.$apply((function(){if(!n.loaded)return n.progress=Math.floor(t.loaded/t.total*100),n.progress>100&&(n.progress=100),n.progress<0?n.progress=0:void 0}))})),n.$on("$destroy",(function(){}))},template:'<div data-pdf-viewer class="pdfjs-viewer" pdf-src=\'pdfSrc\' position=\'position\' scale=\'scale\' highlights=\'highlights\' please-jump-to=\'pleaseJumpTo\'></div>\n<div class="pdfjs-controls" ng-class="{\'flash\': flashControls }">\n\t<div class="btn-group">\n\t\t<a href\n\t\t\tclass="btn btn-info btn-lg"\n\t\t\tng-click="fitToWidth()"\n\t\t\ttooltip="Fit to Width"\n\t\t\ttooltip-append-to-body="true"\n\t\t\ttooltip-placement="bottom"\n\t\t>\n\t\t\t<i class="fa fa-fw fa-arrows-h"></i>\n\t\t</a>\n\t\t<a href\n\t\t\tclass="btn btn-info btn-lg"\n\t\t\tng-click="fitToHeight()"\n\t\t\ttooltip="Fit to Height"\n\t\t\ttooltip-append-to-body="true"\n\t\t\ttooltip-placement="bottom"\n\t\t>\n\t\t\t<i class="fa fa-fw fa-arrows-v"></i>\n\t\t</a>\n\t\t<a href\n\t\t\tclass="btn btn-info btn-lg"\n\t\t\tng-click="zoomIn()"\n\t\t\ttooltip="Zoom In"\n\t\t\ttooltip-append-to-body="true"\n\t\t\ttooltip-placement="bottom"\n\t\t>\n\t\t\t<i class="fa fa-fw fa-search-plus"></i>\n\t\t</a>\n\t\t<a href\n\t\t\tclass="btn btn-info btn-lg"\n\t\t\tng-click="zoomOut()"\n\t\t\ttooltip="Zoom Out"\n\t\t\ttooltip-append-to-body="true"\n\t\t\ttooltip-placement="bottom"\n\t\t>\n\t\t\t<i class="fa fa-fw fa-search-minus"></i>\n\t\t</a>\n\t</div>\n</div>\n<div class="progress-thin" ng-show="loading">\n\t<div class="progress-bar" ng-style="{ \'width\': progress + \'%\' }"></div>\n</div>'}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){return null!=e?t(e):void 0}r=[n(0),n(213),n(214),n(230),n(231),n(232),n(233)],void 0===(i=function(e,t,n,r,i,a,l,c){return e.controller("pdfViewerController",["$scope","$q","$timeout","PDFRenderer","$element","pdfHighlights","pdfSpinner",function(e,t,n,r,i,a,l){return this.load=function(){return(null!=e.document?e.document.destroy():Promise.resolve()).then((function(){e.loadCount=null!=e.loadCount?e.loadCount+1:1;var n=e.pdfSrc;n=n+(/\?/.test(n)?"&":"?")+"pdfng=true";return e.document=new r(n,{scale:1,disableAutoFetch:!0,navigateFn:function(t){return e.navigateTo=t,e.$apply()},progressCallback:function(t){return e.$emit("progress",t)},loadedCallback:function(){return e.$emit("loaded")},errorCallback:function(t){var n,r,i;return n=window.Raven,r="captureMessage",i=function(e){return e.captureMessage("pdfng error ".concat(t))},null!=n&&"function"==typeof n[r]&&i(n,r),e.$emit("pdf:error",t)},pageSizeChangeCallback:function(t,n){return e.$broadcast("pdf:page:size-change",t,n)}}),e.loaded=t.all({numPages:e.document.getNumPages(),pdfViewport:e.document.getPdfViewport(1,1)}).then((function(t){return e.pdfViewport=t.pdfViewport,e.pdfPageSize=[t.pdfViewport.height,t.pdfViewport.width],e.$emit("loaded"),e.numPages=t.numPages})).catch((function(n){return e.$emit("pdf:error",n),t.reject(n)})),e.loaded}))},this.setScale=function(n,r,i){return e.loaded.then((function(){var t;return null==n&&(n={}),0===r||0===i?t=1:"scale_mode_fit_width"===n.scaleMode?t=(i-40)/e.pdfPageSize[1]:"scale_mode_fit_height"===n.scaleMode?t=(r-20)/e.pdfPageSize[0]:"scale_mode_value"===n.scaleMode?t=n.scale:"scale_mode_auto"===n.scaleMode||(n.scaleMode="scale_mode_fit_width",t=(i-40)/e.pdfPageSize[1]),e.scale.scale=t,e.document.setScale(t),e.defaultPageSize=[t*e.pdfPageSize[0],t*e.pdfPageSize[1]]})).catch((function(n){return e.$emit("pdf:error",n),t.reject(n)}))},this.redraw=function(t){if(e.pages=function(e,t,n){for(var r=[],i=e<t,o=n?i?t+1:t-1:t,s=e;i?s<o:s>o;i?s++:s--)r.push(s);return r}(0,e.numPages-1,!0).map((function(e){return{pageNum:e+1}})),null!=t&&null!=t.page){var n=t.page;return n>e.numPages-1&&(n=e.numPages-1),e.pages[n].current=!0,e.pages[n].position=t}},this.zoomIn=function(){var t=1.2*e.scale.scale;return e.forceScale={scaleMode:"scale_mode_value",scale:t}},this.zoomOut=function(){var t=e.scale.scale/1.2;return e.forceScale={scaleMode:"scale_mode_value",scale:t}},this.fitWidth=function(){return e.forceScale={scaleMode:"scale_mode_fit_width"}},this.fitHeight=function(){return e.forceScale={scaleMode:"scale_mode_fit_height"}},this.checkPosition=function(){return e.forceCheck=(e.forceCheck||0)+1},this.showRandomHighlights=function(){return e.highlights=[{page:3,h:100,v:100,height:30,width:200}]},this.getPdfPosition=function(){var t,n,r,s=0,a=e.pages[0];if(e.pages.some((function(e,t){var n,r;if(e.visible)return n=o(Array.from(r=[t,e]),2),s=n[0],a=n[1],r}))&&null!=a.element){var l=a.element.offset().top,c=l+a.element.innerHeight(),u=i.offset().top,h=u+i.height();if(t=l>=u&&l<h?0:l<u&&c>u?u-l:null,a.viewport){n=(r=a.viewport).convertToPdfPoint(0,t)}else{r=e.pdfViewport;var d=t/e.scale.scale;n=r.convertToPdfPoint(0,d)}return{page:s,offset:{top:n[1],left:0},pageSize:{height:r.viewBox[3],width:r.viewBox[2]}}}},this.computeOffset=function(n,r){var i=n.element,o=s($(i).offset(),(function(e){return e.top})),a=s($(i).parent().offset(),(function(e){return e.top}));if(null==o||null==a)return t((function(e,t){return t("elements destroyed")}));var l=$(i).offset().top-$(i).parent().offset().top,c=$(i).parent().scrollTop(),u=r.offset;return e.document.getPdfViewport(n.pageNum).then((function(e){n.viewport=e;var t=e.convertToViewportPoint(u.left,u.top);return null==r.pageSize&&(r.pageSize={height:e.viewBox[3],width:e.viewBox[2]}),Math.round(l+t[1]+c)}))},this.setPdfPosition=function(t,n){return this.computeOffset(t,n).then((function(t){return e.pleaseScrollTo=t,e.position=n}))},this}]),e.directive("pdfViewer",["$q","$timeout","pdfSpinner",function(e,t,n){return{controller:"pdfViewerController",controllerAs:"ctrl",scope:{pdfSrc:"=",highlights:"=",position:"=",scale:"=",pleaseJumpTo:"="},template:"<div data-pdf-page class='pdf-page-container page-container' ng-repeat='page in pages'></div>",link:function(r,i,s,a){var l=new n,c=e.defer();c.notify("waiting for layout"),c.promise.then((function(){}));var u=function(){var e=h(),t=d(e);return r.document.renderPages(t)},h=function(){var e=i[0].scrollTop,t=e+i[0].clientHeight;return _.filter(r.pages,(function(n){if(null==n.element)return!1;var r=n.element[0],i=r.offsetTop,o=i+r.clientHeight;return n.visible=i<t&&o>e,n.visible}))},d=function(e){var t=[];if(e.length>0){var n=e[0].pageNum-1,i=e[e.length-1].pageNum-1;i+1<r.pages.length&&t.push(r.pages[i+1]),n>0&&t.push(r.pages[n-1]),i+2<r.pages.length&&t.push(r.pages[i+2])}return e.concat(t)},f=null,p=function(e){if(null==f&&null==y&&null==v)return f=setTimeout((function(){return m(e),f=null}),0)},g=null,m=function(e){if(null!=e){var n=angular.copy(r.position);return null==g&&(g=setTimeout((function(){return l.add(i),g=null}),100)),c.promise.then((function(s){var c=o(Array.from(s),2),h=c[0],d=c[1];return a.setScale(e,h,d).then((function(){return r.$evalAsync((function(){return g?clearTimeout(g):l.remove(i),i.removeClass("pdfjs-viewer-show-text"),a.redraw(n),t(u),r.loadSuccess=!0}))})).catch((function(e){return r.$emit("pdf:error",e)}))}))}},v=null,y=null,b=function(){if(null==y)return c=e.defer(),y=setTimeout((function(){return function e(){if(0===i.height()||0===i.width()){if(null!=v)return;return v=setTimeout((function(){return v=null,e()}),1e3)}return r.parentSize=[i.innerHeight(),i.innerWidth()],t((function(){return c.resolve(r.parentSize),r.$emit("flash-controls")}))}(),y=null}),0)};b(),r.$on("layout:main:resize",(function(){return b()})),r.$on("layout:pdf:resize",(function(){return b()})),r.$on("pdf:error",(function(e,t){if("RenderingCancelledException"!==t.name){var n=(null!=t?t.message:void 0)||t;if(!(r.loadCount>3||/^Missing PDF/i.test(n)||/^loading/i.test(n)))return r.loadSuccess?a.load().then((function(){return r.scale=angular.copy(r.scale)})).catch((function(e){return r.$emit("pdf:error:display")})):void r.$emit("pdf:error:display");r.$emit("pdf:error:display")}})),r.$on("pdf:page:size-change",(function(e,t,n){var o=angular.copy(r.position);if(null!=o&&t-1<o.page&&0!==n){var s=i.scrollTop();return r.adjustingScroll=!0,i.scrollTop(s+n)}})),i.on("mousedown",(function(e){if(e.target!==i[0]&&!A())return i.addClass("pdfjs-viewer-show-text"),C()}));var w=null,C=function(){if(null==w)return w=$(document.body).one("mouseup",S)},S=function(){return w=null,window.setTimeout((function(){if(!k())return C()}),10),!0},k=function(){return!A()&&(i.removeClass("pdfjs-viewer-show-text"),!0)},A=function(){var e="function"==typeof window.getSelection?window.getSelection():void 0;return null!=e&&x(e)&&!e.isCollapsed},x=function(e){if(0===e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return i.find(t).length>0||i.is(t)};i.on("scroll",(function(){return r.adjustingScroll?(u(),void(r.adjustingScroll=!1)):(r.scrollHandlerTimeout&&clearTimeout(r.scrollHandlerTimeout),r.scrollHandlerTimeout=setTimeout(T,25))}));var T=function(){u();var e=a.getPdfPosition();return null!=e&&(r.position=e),r.scrollHandlerTimeout=null};return r.$watch("pdfSrc",(function(e,t){if(null!=e)return r.loadCount=0,r.loadSuccess=!1,a.load().then((function(){return r.scale=angular.copy(r.scale)})).catch((function(e){return r.$emit("pdf:error",e)}))})),r.$watch("scale",(function(e,t){if(e!==t)return p(e)})),r.$watch("forceScale",(function(e,t){if(null!=e)return p(e)})),r.$watch("forceCheck",(function(e,t){if(null!=e)return r.adjustingScroll=!0,p(r.scale)})),r.$watch("parentSize",(function(e,t){if(null!=e)return p(r.scale)}),!0),r.$watch("pleaseScrollTo",(function(e,t){if(null!=e)return r.adjustingScroll=!0,$(i).scrollTop(e),r.pleaseScrollTo=void 0})),r.$watch("pleaseJumpTo",(function(e,t){if(null!=e)return a.setPdfPosition(r.pages[e.page-1],e)})),r.$watch("navigateTo",(function(e,t){if(null!=e)return r.navigateTo=void 0,r.document.getDestination(e.dest).then((function(e){return r.document.getPageIndex(e[0]).then((function(t){var n=r.pages[t];return r.document.getPdfViewport(n.pageNum).then((function(n){n.convertToViewportPoint(e[2],e[3]);if("XYZ"===e[1].name){var i={page:t,offset:{top:e[3],left:e[2]}};return a.setPdfPosition(r.pages[t],i)}}))}))}))})),r.$watch("highlights",(function(e){if(null!=e){var t=Array.from(e||[]).map((function(e){return{page:e.page-1,highlight:{left:e.h,top:e.v,height:e.height,width:e.width}}}));if(t.length){r.$broadcast("pdf:highlights",e);var n=t[0];if(r.pages){var i=null!=r.pages[n.page]?r.pages[n.page].pageNum:void 0;if(null!=i)return r.document.getPdfViewport(i).then((function(e){var t={page:n.page,offset:{left:n.highlight.left,top:e.viewBox[3]-n.highlight.top+n.highlight.height+72}};return a.setPdfPosition(r.pages[n.page],t)}))}}}})),r.$on("$destroy",(function(){if(null!=v&&clearTimeout(v),null!=y&&clearTimeout(y),null!=f&&clearTimeout(f),null!=g)return clearTimeout(g)}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(0)],void 0===(i=function(e){return e.factory("pdfTextLayer",(function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.textLayerDiv=t.textLayerDiv,this.divContentDone=!1,this.viewport=t.viewport,this.textDivs=[],this.renderer=t.renderer,this.renderingDone=!1}var t,n,r;return t=e,(n=[{key:"render",value:function(e){var t=this;if(!this.renderingDone&&this.divContentDone){null!=this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.textDivs=[];var n=document.createDocumentFragment();return this.textLayerRenderTask=this.renderer({textContent:this.textContent,container:n,viewport:this.viewport,textDivs:this.textDivs,timeout:e,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then((function(){return t.textLayerDiv.appendChild(n),t.renderingDone=!0}),(function(){}))}}},{key:"setTextContent",value:function(e){return this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.textContent=e,this.divContentDone=!0}}])&&o(t.prototype,n),r&&o(t,r),e}()}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(0),n(43)],void 0===(i=function(e,t){e.factory("pdfAnnotations",(function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.annotationsLayerDiv=t.annotations,this.viewport=t.viewport,this.navigateFn=t.navigateFn}var n,r,i;return n=e,(r=[{key:"setAnnotations",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;switch(a.subtype){case"Link":t.push(this.addLink(a));break;case"Text":continue;default:t.push(void 0)}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"addLink",value:function(e){var t=this.buildLinkElementFromRect(e.rect);this.setLinkTarget(t,e),this.annotationsLayerDiv.appendChild(t)}},{key:"buildLinkElementFromRect",value:function(e){e=this.viewport.convertToViewportRectangle(e),e=t.Util.normalizeRect(e);var n=document.createElement("a");return n.style.left=Math.floor(e[0])+"px",n.style.top=Math.floor(e[1])+"px",n.style.width=Math.ceil(e[2]-e[0])+"px",n.style.height=Math.ceil(e[3]-e[1])+"px",n}},{key:"setLinkTarget",value:function(e,t){var n=this;t.url?(e.href=t.url,e.target="_blank",e.rel="noreferrer noopener"):t.dest&&(e.href="#".concat(t.dest),e.onclick=function(){return n.navigateFn(t),!1})}}])&&o(n.prototype,r),i&&o(n,i),e}()}))}.apply(t,r))||(e.exports=i)},function(e,t,n){(function(t,r,i){var o;o=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=n(1),i=n(129),o=n(145),s=n(146),a=n(130),l=n(147),c=n(135),u=n(132);if(n(4)()){var h=n(148).PDFNodeStream;i.setPDFNetworkStreamFactory((function(e){return new h(e)}))}else if("undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream){var d=n(151).PDFFetchStream;i.setPDFNetworkStreamFactory((function(e){return new d(e)}))}else{var f=n(152).PDFNetworkStream;i.setPDFNetworkStreamFactory((function(e){return new f(e)}))}t.build=i.build,t.version=i.version,t.getDocument=i.getDocument,t.LoopbackPort=i.LoopbackPort,t.PDFDataRangeTransport=i.PDFDataRangeTransport,t.PDFWorker=i.PDFWorker,t.renderTextLayer=o.renderTextLayer,t.AnnotationLayer=s.AnnotationLayer,t.createPromiseCapability=r.createPromiseCapability,t.PasswordResponses=r.PasswordResponses,t.InvalidPDFException=r.InvalidPDFException,t.MissingPDFException=r.MissingPDFException,t.SVGGraphics=l.SVGGraphics,t.NativeImageDecoding=r.NativeImageDecoding,t.CMapCompressionType=r.CMapCompressionType,t.PermissionFlag=r.PermissionFlag,t.UnexpectedResponseException=r.UnexpectedResponseException,t.OPS=r.OPS,t.VerbosityLevel=r.VerbosityLevel,t.UNSUPPORTED_FEATURES=r.UNSUPPORTED_FEATURES,t.createValidAbsoluteUrl=r.createValidAbsoluteUrl,t.createObjectURL=r.createObjectURL,t.removeNullCharacters=r.removeNullCharacters,t.shadow=r.shadow,t.Util=r.Util,t.ReadableStream=r.ReadableStream,t.URL=r.URL,t.RenderingCancelledException=a.RenderingCancelledException,t.getFilenameFromUrl=a.getFilenameFromUrl,t.LinkTarget=a.LinkTarget,t.addLinkAttributes=a.addLinkAttributes,t.loadScript=a.loadScript,t.GlobalWorkerOptions=c.GlobalWorkerOptions,t.apiCompatibilityParams=u.apiCompatibilityParams},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unreachable=t.warn=t.utf8StringToString=t.stringToUTF8String=t.stringToPDFString=t.stringToBytes=t.string32=t.shadow=t.setVerbosityLevel=t.URL=t.ReadableStream=t.removeNullCharacters=t.readUint32=t.readUint16=t.readInt8=t.log2=t.isEvalSupported=t.isLittleEndian=t.createValidAbsoluteUrl=t.isSameOrigin=t.isSpace=t.isString=t.isNum=t.isEmptyObj=t.isBool=t.isArrayBuffer=t.info=t.getVerbosityLevel=t.getLookupTableFactory=t.getInheritableProperty=t.deprecated=t.createObjectURL=t.createPromiseCapability=t.bytesToString=t.assert=t.arraysToBytes=t.arrayByteLength=t.FormatError=t.XRefParseException=t.toRomanNumerals=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.NativeImageDecoding=t.MissingPDFException=t.MissingDataException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(2);var i=n(125),o=n(127),s={ERRORS:0,WARNINGS:1,INFOS:5},a=s.WARNINGS;function l(e){a>=s.WARNINGS&&console.log("Warning: "+e)}function c(e){throw new Error(e)}function u(e,t){e||c(t)}var h=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}(),d=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}(),f=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),p=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),g=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}(),m=function(){function e(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return e.prototype=new Error,e.prototype.name="MissingDataException",e.constructor=e,e}(),v=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefParseException",e.constructor=e,e}(),y=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="FormatError",e.constructor=e,e}(),b=function(){function e(e){this.name="AbortException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),w=/\x00/g;function _(e){u("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,n=new Uint8Array(t),r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n}function C(e){return void 0!==e.length?e.length:(u(void 0!==e.byteLength),e.byteLength)}var S,k=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"];return e.makeCssRgb=function(e,n,r){return t[1]=e,t[3]=n,t[5]=r,t.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},e.applyInverseTransform=function(e,t){var n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]},e.getAxialAlignedBoundingBox=function(t,n){var r=e.applyTransform(t,n),i=e.applyTransform(t.slice(2,4),n),o=e.applyTransform([t[0],t[3]],n),s=e.applyTransform([t[2],t[1]],n);return[Math.min(r[0],i[0],o[0],s[0]),Math.min(r[1],i[1],o[1],s[1]),Math.max(r[0],i[0],o[0],s[0]),Math.max(r[1],i[1],o[1],s[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],s=(n+o)/2,a=Math.sqrt((n+o)*(n+o)-4*(n*o-i*r))/2,l=s+a||1,c=s-a||1;return[Math.sqrt(l),Math.sqrt(c)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,n){function r(e,t){return e-t}var i=[t[0],t[2],n[0],n[2]].sort(r),o=[t[1],t[3],n[1],n[3]].sort(r),s=[];return t=e.normalizeRect(t),n=e.normalizeRect(n),(i[0]===t[0]&&i[1]===n[0]||i[0]===n[0]&&i[1]===t[0])&&(s[0]=i[1],s[2]=i[2],(o[0]===t[1]&&o[1]===n[1]||o[0]===n[1]&&o[1]===t[1])&&(s[1]=o[1],s[3]=o[2],s))},e}(),A=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],$=(S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!n&&o.URL.createObjectURL){var r=new Blob([e],{type:t});return o.URL.createObjectURL(r)}for(var i="data:"+t+";base64,",s=0,a=e.length;s<a;s+=3){var l=255&e[s],c=255&e[s+1],u=255&e[s+2],h=l>>2,d=(3&l)<<4|c>>4,f=s+1<a?(15&c)<<2|u>>6:64,p=s+2<a?63&u:64;i+=S[h]+S[d]+S[f]+S[p]}return i});t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.VerbosityLevel=s,t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.AbortException=b,t.InvalidPDFException=f,t.MissingDataException=m,t.MissingPDFException=p,t.NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"},t.PasswordException=h,t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.UnexpectedResponseException=g,t.UnknownErrorException=d,t.Util=k,t.toRomanNumerals=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u(Number.isInteger(e)&&e>0,"The number should be a positive integer.");for(var n=void 0,r=[];e>=1e3;)e-=1e3,r.push("M");n=e/100|0,e%=100,r.push(A[n]),n=e/10|0,e%=10,r.push(A[10+n]),r.push(A[20+e]);var i=r.join("");return t?i.toLowerCase():i},t.XRefParseException=v,t.FormatError=y,t.arrayByteLength=C,t.arraysToBytes=function(e){if(1===e.length&&e[0]instanceof Uint8Array)return e[0];var t,n,r,i=0,o=e.length;for(t=0;t<o;t++)i+=r=C(n=e[t]);var s=0,a=new Uint8Array(i);for(t=0;t<o;t++)(n=e[t])instanceof Uint8Array||(n="string"==typeof n?_(n):new Uint8Array(n)),r=n.byteLength,a.set(n,s),s+=r;return a},t.assert=u,t.bytesToString=function(e){u(null!==e&&"object"===(void 0===e?"undefined":r(e))&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length;if(t<8192)return String.fromCharCode.apply(null,e);for(var n=[],i=0;i<t;i+=8192){var o=Math.min(i+8192,t),s=e.subarray(i,o);n.push(String.fromCharCode.apply(null,s))}return n.join("")},t.createPromiseCapability=function(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e},t.createObjectURL=$,t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getInheritableProperty=function(e){for(var t=e.dict,n=e.key,r=e.getArray,i=void 0!==r&&r,o=e.stopWhenFound,s=void 0===o||o,a=0,c=void 0;t;){var u=i?t.getArray(n):t.get(n);if(void 0!==u){if(s)return u;c||(c=[]),c.push(u)}if(++a>100){l('getInheritableProperty: maximum loop count exceeded for "'+n+'"');break}t=t.get("Parent")}return c},t.getLookupTableFactory=function(e){var t;return function(){return e&&(t=Object.create(null),e(t),e=null),t}},t.getVerbosityLevel=function(){return a},t.info=function(e){a>=s.INFOS&&console.log("Info: "+e)},t.isArrayBuffer=function(e){return"object"===(void 0===e?"undefined":r(e))&&null!==e&&void 0!==e.byteLength},t.isBool=function(e){return"boolean"==typeof e},t.isEmptyObj=function(e){for(var t in e)return!1;return!0},t.isNum=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSpace=function(e){return 32===e||9===e||13===e||10===e},t.isSameOrigin=function(e,t){try{var n=new o.URL(e);if(!n.origin||"null"===n.origin)return!1}catch(e){return!1}var r=new o.URL(t,n);return n.origin===r.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{var n=t?new o.URL(e,t):new o.URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(e){}return null},t.isLittleEndian=function(){var e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]},t.isEvalSupported=function(){try{return new Function(""),!0}catch(e){return!1}},t.log2=function(e){return e<=0?0:Math.ceil(Math.log2(e))},t.readInt8=function(e,t){return e[t]<<24>>24},t.readUint16=function(e,t){return e[t]<<8|e[t+1]},t.readUint32=function(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0},t.removeNullCharacters=function(e){return"string"!=typeof e?(l("The argument for removeNullCharacters must be a string."),e):e.replace(w,"")},t.ReadableStream=i.ReadableStream,t.URL=o.URL,t.setVerbosityLevel=function(e){Number.isInteger(e)&&(a=e)},t.shadow=function(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n},t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=_,t.stringToPDFString=function(e){var t,n=e.length,r=[];if("þ"===e[0]&&"ÿ"===e[1])for(t=2;t<n;t+=2)r.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;t<n;++t){var i=x[e.charCodeAt(t)];r.push(i?String.fromCharCode(i):e.charAt(t))}return r.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=l,t.unreachable=c},function(e,n,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(3);if(!o._pdfjsCompatibilityChecked){o._pdfjsCompatibilityChecked=!0;var s=r(4),a="object"===("undefined"==typeof window?"undefined":i(window))&&"object"===("undefined"==typeof document?"undefined":i(document));!o.btoa&&s()&&(o.btoa=function(e){return t.from(e,"binary").toString("base64")}),!o.atob&&s()&&(o.atob=function(e){return t.from(e,"base64").toString("binary")}),a&&("currentScript"in document||Object.defineProperty(document,"currentScript",{get:function(){var e=document.getElementsByTagName("script");return e[e.length-1]},enumerable:!0,configurable:!0})),a&&void 0===Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){if(a&&!s()&&!1!==document.createElement("div").classList.toggle("test",0)){var e=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t){if(arguments.length>1){var n=!!arguments[1];return this[n?"add":"remove"](t),n}return e(t)}}}(),String.prototype.includes||r(5),Array.prototype.includes||r(33),Object.assign||r(42),Math.log2||(Math.log2=r(52)),Number.isNaN||(Number.isNaN=r(54)),Number.isInteger||(Number.isInteger=r(56)),o.Promise||(o.Promise=r(59)),o.WeakMap||(o.WeakMap=r(94)),String.codePointAt||(String.codePointAt=r(111)),String.fromCodePoint||(String.fromCodePoint=r(113)),o.Symbol||r(115),Object.values||(Object.values=r(122))}},function(e,t,n){"use strict";e.exports="undefined"!=typeof window&&window.Math===Math?window:void 0!==r&&r.Math===Math?r:"undefined"!=typeof self&&self.Math===Math?self:{}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(){return"object"===(void 0===i?"undefined":r(i))&&i+""=="[object process]"}},function(e,t,n){"use strict";n(6),e.exports=n(9).String.includes},function(e,t,n){"use strict";var r=n(7),i=n(25);r(r.P+r.F*n(32)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";var r=n(8),i=n(9),o=n(10),s=n(20),a=n(23),l=function e(t,n,l){var c,u,h,d,f=t&e.F,p=t&e.G,g=t&e.P,m=t&e.B,v=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{}).prototype,y=p?i:i[n]||(i[n]={}),b=y.prototype||(y.prototype={});for(c in p&&(l=n),l)h=((u=!f&&v&&void 0!==v[c])?v:l)[c],d=m&&u?a(h,r):g&&"function"==typeof h?a(Function.call,h):h,v&&s(v,c,h,t&e.U),y[c]!=h&&o(y,c,d),g&&b[c]!=h&&(b[c]=h)};r.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t,n){"use strict";var r=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(e,t,n){"use strict";var r=n(11),i=n(19);e.exports=n(15)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var r=n(12),i=n(14),o=n(18),s=Object.defineProperty;t.f=n(15)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":r(e))?null!==e:"function"==typeof e}},function(e,t,n){"use strict";e.exports=!n(15)&&!n(16)((function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";e.exports=!n(16)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var r=n(13),i=n(8).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(8),i=n(10),o=n(21),s=n(22)("src"),a=Function.toString,l=(""+a).split("toString");n(9).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var c="function"==typeof n;c&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(c&&(o(n,s)||i(n,s,e[t]?""+e[t]:l.join(String(t)))),e===r?e[t]=n:a?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[s]||a.call(this)}))},function(e,t,n){"use strict";var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,n){"use strict";var r=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},function(e,t,n){"use strict";var r=n(24);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var r=n(26),i=n(31);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){"use strict";var r=n(13),i=n(27),o=n(28)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,n){"use strict";var r=n(29)("wks"),i=n(22),o=n(8).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r},function(e,t,n){"use strict";var r=n(9),i=n(8),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(30)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){"use strict";e.exports=!1},function(e,t,n){"use strict";e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var r=n(28)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";n(34),e.exports=n(9).Array.includes},function(e,t,n){"use strict";var r=n(7),i=n(35)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(41)("includes")},function(e,t,n){"use strict";var r=n(36),i=n(38),o=n(40);e.exports=function(e){return function(t,n,s){var a,l=r(t),c=i(l.length),u=o(s,c);if(e&&n!=n){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},function(e,t,n){"use strict";var r=n(37),i=n(31);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";var r=n(27);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(39),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:r)(e)}},function(e,t,n){"use strict";var r=n(39),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){"use strict";var r=n(28)("unscopables"),i=Array.prototype;null==i[r]&&n(10)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){"use strict";n(43),e.exports=n(9).Object.assign},function(e,t,n){"use strict";var r=n(7);r(r.S+r.F,"Object",{assign:n(44)})},function(e,t,n){"use strict";var r=n(45),i=n(49),o=n(50),s=n(51),a=n(37),l=Object.assign;e.exports=!l||n(16)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=r}))?function(e,t){for(var n=s(e),l=arguments.length,c=1,u=i.f,h=o.f;l>c;)for(var d,f=a(arguments[c++]),p=u?r(f).concat(u(f)):r(f),g=p.length,m=0;g>m;)h.call(f,d=p[m++])&&(n[d]=f[d]);return n}:l},function(e,t,n){"use strict";var r=n(46),i=n(48);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(21),i=n(36),o=n(35)(!1),s=n(47)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),l=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>l;)r(a,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){"use strict";var r=n(29)("keys"),i=n(22);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){"use strict";e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";var r=n(31);e.exports=function(e){return Object(r(e))}},function(e,t,n){"use strict";n(53),e.exports=n(9).Math.log2},function(e,t,n){"use strict";var r=n(7);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){"use strict";n(55),e.exports=n(9).Number.isNaN},function(e,t,n){"use strict";var r=n(7);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){"use strict";n(57),e.exports=n(9).Number.isInteger},function(e,t,n){"use strict";var r=n(7);r(r.S,"Number",{isInteger:n(58)})},function(e,t,n){"use strict";var r=n(13),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){"use strict";n(60),n(62),n(72),n(75),n(92),n(93),e.exports=n(9).Promise},function(e,t,n){"use strict";var r=n(61),i={};i[n(28)("toStringTag")]="z",i+""!="[object z]"&&n(20)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){"use strict";var r=n(27),i=n(28)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(s=r(t))&&"function"==typeof t.callee?"Arguments":s}},function(e,t,n){"use strict";var r=n(63)(!0);n(64)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(39),i=n(31);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),l=r(n),c=a.length;return l<0||l>=c?e?"":void 0:(o=a.charCodeAt(l))<55296||o>56319||l+1===c||(s=a.charCodeAt(l+1))<56320||s>57343?e?a.charAt(l):o:e?a.slice(l,l+2):s-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(30),i=n(7),o=n(20),s=n(10),a=n(65),l=n(66),c=n(70),u=n(71),h=n(28)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,p,g,m,v){l(n,t,p);var y,b,w,_=function(e){if(!d&&e in A)return A[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},C=t+" Iterator",S="values"==g,k=!1,A=e.prototype,x=A[h]||A["@@iterator"]||g&&A[g],$=x||_(g),T=g?S?_("entries"):$:void 0,E="Array"==t&&A.entries||x;if(E&&(w=u(E.call(new e)))!==Object.prototype&&w.next&&(c(w,C,!0),r||"function"==typeof w[h]||s(w,h,f)),S&&x&&"values"!==x.name&&(k=!0,$=function(){return x.call(this)}),r&&!v||!d&&!k&&A[h]||s(A,h,$),a[t]=$,a[C]=f,g)if(y={values:S?$:_("values"),keys:m?$:_("keys"),entries:T},v)for(b in y)b in A||o(A,b,y[b]);else i(i.P+i.F*(d||k),t,y);return y}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var r=n(67),i=n(19),o=n(70),s={};n(10)(s,n(28)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(12),i=n(68),o=n(48),s=n(47)("IE_PROTO"),a=function(){},l=function(){var e,t=n(17)("iframe"),r=o.length;for(t.style.display="none",n(69).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;r--;)delete l.prototype[o[r]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){"use strict";var r=n(11),i=n(12),o=n(45);e.exports=n(15)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,l=0;a>l;)r.f(e,n=s[l++],t[n]);return e}},function(e,t,n){"use strict";var r=n(8).document;e.exports=r&&r.documentElement},function(e,t,n){"use strict";var r=n(11).f,i=n(21),o=n(28)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(21),i=n(51),o=n(47)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){"use strict";for(var r=n(73),i=n(45),o=n(20),s=n(8),a=n(10),l=n(65),c=n(28),u=c("iterator"),h=c("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(f),g=0;g<p.length;g++){var m,v=p[g],y=f[v],b=s[v],w=b&&b.prototype;if(w&&(w[u]||a(w,u,d),w[h]||a(w,h,v),l[v]=d,y))for(m in r)w[m]||o(w,m,r[m],!0)}},function(e,t,n){"use strict";var r=n(41),i=n(74),o=n(65),s=n(36);e.exports=n(64)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,i,o,s,a=n(30),l=n(8),c=n(23),u=n(61),h=n(7),d=n(13),f=n(24),p=n(76),g=n(77),m=n(81),v=n(82).set,y=n(84)(),b=n(85),w=n(86),_=n(87),C=n(88),S=l.TypeError,k=l.process,A=k&&k.versions,x=A&&A.v8||"",$=l.Promise,T="process"==u(k),E=function(){},R=i=b.f,M=!!function(){try{var e=$.resolve(1),t=(e.constructor={})[n(28)("species")]=function(e){e(E,E)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(E)instanceof t&&0!==x.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),L=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},P=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,l=t.resolve,c=t.reject,u=t.domain;try{a?(i||(2==e._h&&I(e),e._h=1),!0===a?n=r:(u&&u.enter(),n=a(r),u&&(u.exit(),s=!0)),n===t.promise?c(S("Promise-chain cycle")):(o=L(n))?o.call(n,l,c):l(n)):c(r)}catch(e){u&&!s&&u.exit(),c(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&O(e)}))}},O=function(e){v.call(l,(function(){var t,n,r,i=e._v,o=D(e);if(o&&(t=w((function(){T?k.emit("unhandledRejection",i,e):(n=l.onunhandledrejection)?n({promise:e,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=T||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},I=function(e){v.call(l,(function(){var t;T?k.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),P(t,!0))},j=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw S("Promise can't be resolved itself");(n=L(t))?y((function(){var i={_w:r,_d:!1};try{n.call(t,c(e,i,1),c(F,i,1))}catch(e){F.call(i,e)}})):(r._v=t,r._s=1,P(r,!1))}catch(e){F.call({_w:r,_d:!1},e)}}};M||($=function(e){p(this,$,"Promise","_h"),f(e),r.call(this);try{e(c(j,this,1),c(F,this,1))}catch(e){F.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(89)($.prototype,{then:function(e,t){var n=R(m(this,$));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=T?k.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=c(j,e,1),this.reject=c(F,e,1)},b.f=R=function(e){return e===$||e===s?new o(e):i(e)}),h(h.G+h.W+h.F*!M,{Promise:$}),n(70)($,"Promise"),n(90)("Promise"),s=n(9).Promise,h(h.S+h.F*!M,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(a||!M),"Promise",{resolve:function(e){return C(a&&this===s?$:this,e)}}),h(h.S+h.F*!(M&&n(91)((function(e){$.all(e).catch(E)}))),"Promise",{all:function(e){var t=this,n=R(t),r=n.resolve,i=n.reject,o=w((function(){var n=[],o=0,s=1;g(e,!1,(function(e){var a=o++,l=!1;n.push(void 0),s++,t.resolve(e).then((function(e){l||(l=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=R(t),r=n.reject,i=w((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var r=n(23),i=n(78),o=n(79),s=n(12),a=n(38),l=n(80),c={},u={},h=e.exports=function(e,t,n,h,d){var f,p,g,m,v=d?function(){return e}:l(e),y=r(n,h,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(f=a(e.length);f>b;b++)if((m=t?y(s(p=e[b])[0],p[1]):y(e[b]))===c||m===u)return m}else for(g=v.call(e);!(p=g.next()).done;)if((m=i(g,y,p.value,t))===c||m===u)return m};h.BREAK=c,h.RETURN=u},function(e,t,n){"use strict";var r=n(12);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){"use strict";var r=n(65),i=n(28)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(61),i=n(28)("iterator"),o=n(65);e.exports=n(9).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(12),i=n(24),o=n(28)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},function(e,t,n){"use strict";var r,i,o,s=n(23),a=n(83),l=n(69),c=n(17),u=n(8),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,g=u.Dispatch,m=0,v={},y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){y.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++m]=function(){a("function"==typeof e?e:Function(e),t)},r(m),m},f=function(e){delete v[e]},"process"==n(27)(h)?r=function(e){h.nextTick(s(y,e,1))}:g&&g.now?r=function(e){g.now(s(y,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=b,r=s(o.postMessage,o,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(r=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(s(y,e,1),0)}),e.exports={set:d,clear:f}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var r=n(8),i=n(82).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,l="process"==n(27)(s);e.exports=function(){var e,t,n,c=function(){var r,i;for(l&&(r=s.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(l)n=function(){s.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);n=function(){u.then(c)}}else n=function(){i.call(r,c)};else{var h=!0,d=document.createTextNode("");new o(c).observe(d,{characterData:!0}),n=function(){d.data=h=!h}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){"use strict";var r=n(24);function i(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(8).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(12),i=n(13),o=n(85);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(20);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(8),i=n(11),o=n(15),s=n(28)("species");e.exports=function(e){var t=r[e];o&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(28)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(7),i=n(9),o=n(8),s=n(81),a=n(88);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(7),i=n(85),o=n(86);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";n(60),n(72),n(95),n(107),n(109),e.exports=n(9).WeakMap},function(e,t,n){"use strict";var r,i=n(96)(0),o=n(20),s=n(100),a=n(44),l=n(101),c=n(13),u=n(16),h=n(102),d=s.getWeak,f=Object.isExtensible,p=l.ufstore,g={},m=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(e){if(c(e)){var t=d(e);return!0===t?p(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(h(this,"WeakMap"),e,t)}},y=e.exports=n(103)("WeakMap",m,v,l,!0,!0);u((function(){return 7!=(new y).set((Object.freeze||Object)(g),7).get(g)}))&&(a((r=l.getConstructor(m,"WeakMap")).prototype,v),s.NEED=!0,i(["delete","has","get","set"],(function(e){var t=y.prototype,n=t[e];o(t,e,(function(t,i){if(c(t)&&!f(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(23),i=n(37),o=n(51),s=n(38),a=n(97);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,h=6==e,d=5==e||h,f=t||a;return function(t,a,p){for(var g,m,v=o(t),y=i(v),b=r(a,p,3),w=s(y.length),_=0,C=n?f(t,w):l?f(t,0):void 0;w>_;_++)if((d||_ in y)&&(m=b(g=y[_],_,v),e))if(n)C[_]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return _;case 2:C.push(g)}else if(u)return!1;return h?-1:c||u?u:C}}},function(e,t,n){"use strict";var r=n(98);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(13),i=n(99),o=n(28)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(27);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(22)("meta"),o=n(13),s=n(21),a=n(11).f,l=0,c=Object.isExtensible||function(){return!0},u=!n(16)((function(){return c(Object.preventExtensions({}))})),h=function(e){a(e,i,{value:{i:"O"+ ++l,w:{}}})},d=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==(void 0===e?"undefined":r(e))?e:("string"==typeof e?"S":"P")+e;if(!s(e,i)){if(!c(e))return"F";if(!t)return"E";h(e)}return e[i].i},getWeak:function(e,t){if(!s(e,i)){if(!c(e))return!0;if(!t)return!1;h(e)}return e[i].w},onFreeze:function(e){return u&&d.NEED&&c(e)&&!s(e,i)&&h(e),e}}},function(e,t,n){"use strict";var r=n(89),i=n(100).getWeak,o=n(12),s=n(13),a=n(76),l=n(77),c=n(96),u=n(21),h=n(102),d=c(5),f=c(6),p=0,g=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},v=function(e,t){return d(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=f(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var c=e((function(e,r){a(e,c,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&l(r,n,e[o],e)}));return r(c.prototype,{delete:function(e){if(!s(e))return!1;var n=i(e);return!0===n?g(h(this,t)).delete(e):n&&u(n,this._i)&&delete n[this._i]},has:function(e){if(!s(e))return!1;var n=i(e);return!0===n?g(h(this,t)).has(e):n&&u(n,this._i)}}),c},def:function(e,t,n){var r=i(o(t),!0);return!0===r?g(e).set(t,n):r[e._i]=n,e},ufstore:g}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";var r=n(8),i=n(7),o=n(20),s=n(89),a=n(100),l=n(77),c=n(76),u=n(13),h=n(16),d=n(91),f=n(70),p=n(104);e.exports=function(e,t,n,g,m,v){var y=r[e],b=y,w=m?"set":"add",_=b&&b.prototype,C={},S=function(e){var t=_[e];o(_,e,"delete"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof b&&(v||_.forEach&&!h((function(){(new b).entries().next()})))){var k=new b,A=k[w](v?{}:-0,1)!=k,x=h((function(){k.has(1)})),$=d((function(e){new b(e)})),T=!v&&h((function(){for(var e=new b,t=5;t--;)e[w](t,t);return!e.has(-0)}));$||((b=t((function(t,n){c(t,b,e);var r=p(new y,t,b);return null!=n&&l(n,m,r[w],r),r}))).prototype=_,_.constructor=b),(x||T)&&(S("delete"),S("has"),m&&S("get")),(T||A)&&S(w),v&&_.clear&&delete _.clear}else b=g.getConstructor(t,e,m,w),s(b.prototype,n),a.NEED=!0;return f(b,e),C[e]=b,i(i.G+i.W+i.F*(b!=y),C),v||g.setStrong(b,e,m),b}},function(e,t,n){"use strict";var r=n(13),i=n(105).set;e.exports=function(e,t,n){var o,s=t.constructor;return s!==n&&"function"==typeof s&&(o=s.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(13),i=n(12),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(23)(Function.call,n(106).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){"use strict";var r=n(50),i=n(19),o=n(36),s=n(18),a=n(21),l=n(14),c=Object.getOwnPropertyDescriptor;t.f=n(15)?c:function(e,t){if(e=o(e),t=s(t,!0),l)try{return c(e,t)}catch(e){}if(a(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){"use strict";n(108)("WeakMap")},function(e,t,n){"use strict";var r=n(7);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";n(110)("WeakMap")},function(e,t,n){"use strict";var r=n(7),i=n(24),o=n(23),s=n(77);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,a,l=arguments[1];return i(this),(t=void 0!==l)&&i(l),null==e?new this:(n=[],t?(r=0,a=o(l,arguments[2],2),s(e,!1,(function(e){n.push(a(e,r++))}))):s(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";n(112),e.exports=n(9).String.codePointAt},function(e,t,n){"use strict";var r=n(7),i=n(63)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";n(114),e.exports=n(9).String.fromCodePoint},function(e,t,n){"use strict";var r=n(7),i=n(40),o=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,s=0;r>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";n(116),n(60),e.exports=n(9).Symbol},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(8),o=n(21),s=n(15),a=n(7),l=n(20),c=n(100).KEY,u=n(16),h=n(29),d=n(70),f=n(22),p=n(28),g=n(117),m=n(118),v=n(119),y=n(99),b=n(12),w=n(13),_=n(36),C=n(18),S=n(19),k=n(67),A=n(120),x=n(106),$=n(11),T=n(45),E=x.f,R=$.f,M=A.f,L=i.Symbol,P=i.JSON,O=P&&P.stringify,D=p("_hidden"),I=p("toPrimitive"),F={}.propertyIsEnumerable,j=h("symbol-registry"),N=h("symbols"),B=h("op-symbols"),H=Object.prototype,z="function"==typeof L,W=i.QObject,U=!W||!W.prototype||!W.prototype.findChild,V=s&&u((function(){return 7!=k(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=E(H,t);r&&delete H[t],R(e,t,n),r&&e!==H&&R(H,t,r)}:R,q=function(e){var t=N[e]=k(L.prototype);return t._k=e,t},G=z&&"symbol"==r(L.iterator)?function(e){return"symbol"==(void 0===e?"undefined":r(e))}:function(e){return e instanceof L},K=function(e,t,n){return e===H&&K(B,t,n),b(e),t=C(t,!0),b(n),o(N,t)?(n.enumerable?(o(e,D)&&e[D][t]&&(e[D][t]=!1),n=k(n,{enumerable:S(0,!1)})):(o(e,D)||R(e,D,S(1,{})),e[D][t]=!0),V(e,t,n)):R(e,t,n)},X=function(e,t){b(e);for(var n,r=v(t=_(t)),i=0,o=r.length;o>i;)K(e,n=r[i++],t[n]);return e},Y=function(e){var t=F.call(this,e=C(e,!0));return!(this===H&&o(N,e)&&!o(B,e))&&(!(t||!o(this,e)||!o(N,e)||o(this,D)&&this[D][e])||t)},J=function(e,t){if(e=_(e),t=C(t,!0),e!==H||!o(N,t)||o(B,t)){var n=E(e,t);return!n||!o(N,t)||o(e,D)&&e[D][t]||(n.enumerable=!0),n}},Q=function(e){for(var t,n=M(_(e)),r=[],i=0;n.length>i;)o(N,t=n[i++])||t==D||t==c||r.push(t);return r},Z=function(e){for(var t,n=e===H,r=M(n?B:_(e)),i=[],s=0;r.length>s;)!o(N,t=r[s++])||n&&!o(H,t)||i.push(N[t]);return i};z||(l((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function t(n){this===H&&t.call(B,n),o(this,D)&&o(this[D],e)&&(this[D][e]=!1),V(this,e,S(1,n))};return s&&U&&V(H,e,{configurable:!0,set:t}),q(e)}).prototype,"toString",(function(){return this._k})),x.f=J,$.f=K,n(121).f=A.f=Q,n(50).f=Y,n(49).f=Z,s&&!n(30)&&l(H,"propertyIsEnumerable",Y,!0),g.f=function(e){return q(p(e))}),a(a.G+a.W+a.F*!z,{Symbol:L});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)p(ee[te++]);for(var ne=T(p.store),re=0;ne.length>re;)m(ne[re++]);a(a.S+a.F*!z,"Symbol",{for:function(e){return o(j,e+="")?j[e]:j[e]=L(e)},keyFor:function(e){if(!G(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){U=!0},useSimple:function(){U=!1}}),a(a.S+a.F*!z,"Object",{create:function(e,t){return void 0===t?k(e):X(k(e),t)},defineProperty:K,defineProperties:X,getOwnPropertyDescriptor:J,getOwnPropertyNames:Q,getOwnPropertySymbols:Z}),P&&a(a.S+a.F*(!z||u((function(){var e=L();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(w(t)||void 0!==e)&&!G(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!G(t))return t}),r[1]=t,O.apply(P,r)}}),L.prototype[I]||n(10)(L.prototype,I,L.prototype.valueOf),d(L,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},function(e,t,n){"use strict";t.f=n(28)},function(e,t,n){"use strict";var r=n(8),i=n(9),o=n(30),s=n(117),a=n(11).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},function(e,t,n){"use strict";var r=n(45),i=n(49),o=n(50);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var s,a=n(e),l=o.f,c=0;a.length>c;)l.call(e,s=a[c++])&&t.push(s);return t}},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(36),o=n(121).f,s={}.toString,a="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==s.call(e)?function(e){try{return o(e)}catch(e){return a.slice()}}(e):o(i(e))}},function(e,t,n){"use strict";var r=n(46),i=n(48).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){"use strict";n(123),e.exports=n(9).Object.values},function(e,t,n){"use strict";var r=n(7),i=n(124)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){"use strict";var r=n(45),i=n(36),o=n(50).f;e.exports=function(e){return function(t){for(var n,s=i(t),a=r(s),l=a.length,c=0,u=[];l>c;)o.call(s,n=a[c++])&&u.push(e?[n,s[n]]:s[n]);return u}}},function(e,t,n){"use strict";var r=!1;if("undefined"!=typeof ReadableStream)try{new ReadableStream({start:function(e){e.close()}}),r=!0}catch(e){}t.ReadableStream=r?ReadableStream:n(126).ReadableStream},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){for(var n in t)e[n]=t[n]}(t,function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){var i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},o=n(1).assert;function s(e){return"string"==typeof e||"symbol"===(void 0===e?"undefined":i(e))}function a(e,t,n){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}t.typeIsObject=function(e){return"object"===(void 0===e?"undefined":i(e))&&null!==e||"function"==typeof e},t.createDataProperty=function(e,n,r){o(t.typeIsObject(e)),Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!0,configurable:!0})},t.createArrayFromList=function(e){return e.slice()},t.ArrayBufferCopy=function(e,t,n,r,i){new Uint8Array(e).set(new Uint8Array(n,r,i),t)},t.CreateIterResultObject=function(e,t){o("boolean"==typeof t);var n={};return Object.defineProperty(n,"value",{value:e,enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(n,"done",{value:t,enumerable:!0,writable:!0,configurable:!0}),n},t.IsFiniteNonNegativeNumber=function(e){return!(Number.isNaN(e)||e===1/0||e<0)},t.InvokeOrNoop=function(e,t,n){o(void 0!==e),o(s(t)),o(Array.isArray(n));var r=e[t];if(void 0!==r)return a(r,e,n)},t.PromiseInvokeOrNoop=function(e,n,r){o(void 0!==e),o(s(n)),o(Array.isArray(r));try{return Promise.resolve(t.InvokeOrNoop(e,n,r))}catch(e){return Promise.reject(e)}},t.PromiseInvokeOrPerformFallback=function(e,t,n,r,i){o(void 0!==e),o(s(t)),o(Array.isArray(n)),o(Array.isArray(i));var l=void 0;try{l=e[t]}catch(e){return Promise.reject(e)}if(void 0===l)return r.apply(null,i);try{return Promise.resolve(a(l,e,n))}catch(e){return Promise.reject(e)}},t.TransferArrayBuffer=function(e){return e.slice()},t.ValidateAndNormalizeHighWaterMark=function(e){if(e=Number(e),Number.isNaN(e)||e<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return e},t.ValidateAndNormalizeQueuingStrategy=function(e,n){if(void 0!==e&&"function"!=typeof e)throw new TypeError("size property of a queuing strategy must be a function");return{size:e,highWaterMark:n=t.ValidateAndNormalizeHighWaterMark(n)}}},function(e,t,n){function r(e){this.name="AssertionError",this.message=e||"",this.stack=(new Error).stack}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,e.exports={rethrowAssertionErrorRejection:function(e){e&&e.constructor===r&&setTimeout((function(){throw e}),0)},AssertionError:r,assert:function(e,t){if(!e)throw new r(t)}}},function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(0),s=o.InvokeOrNoop,a=o.PromiseInvokeOrNoop,l=o.ValidateAndNormalizeQueuingStrategy,c=o.typeIsObject,u=n(1),h=u.assert,d=u.rethrowAssertionErrorRejection,f=n(3),p=f.DequeueValue,g=f.EnqueueValueWithSize,m=f.PeekQueueValue,v=f.ResetQueue,y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.size,o=n.highWaterMark,s=void 0===o?1:o;if(i(this,e),this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=[],this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1,void 0!==t.type)throw new RangeError("Invalid type is specified");this._writableStreamController=new j(this,t,r,s),this._writableStreamController.__startSteps()}return r(e,[{key:"abort",value:function(e){return!1===w(this)?Promise.reject(U("abort")):!0===_(this)?Promise.reject(new TypeError("Cannot abort a stream that already has a writer")):C(this,e)}},{key:"getWriter",value:function(){if(!1===w(this))throw U("getWriter");return b(this)}},{key:"locked",get:function(){if(!1===w(this))throw U("locked");return _(this)}}]),e}();function b(e){return new M(e)}function w(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function _(e){return h(!0===w(e),"IsWritableStreamLocked should only be used on known writable streams"),void 0!==e._writer}function C(e,t){var n=e._state;if("closed"===n)return Promise.resolve(void 0);if("errored"===n)return Promise.reject(e._storedError);var r=new TypeError("Requested to abort");if(void 0!==e._pendingAbortRequest)return Promise.reject(r);h("writable"===n||"erroring"===n,"state must be writable or erroring");var i=!1;"erroring"===n&&(i=!0,t=void 0);var o=new Promise((function(n,r){e._pendingAbortRequest={_resolve:n,_reject:r,_reason:t,_wasAlreadyErroring:i}}));return!1===i&&k(e,r),o}function S(e,t){var n=e._state;"writable"!==n?(h("erroring"===n),A(e)):k(e,t)}function k(e,t){h(void 0===e._storedError,"stream._storedError === undefined"),h("writable"===e._state,"state must be writable");var n=e._writableStreamController;h(void 0!==n,"controller must not be undefined"),e._state="erroring",e._storedError=t;var r=e._writer;void 0!==r&&D(r,t),!1===T(e)&&!0===n._started&&A(e)}function A(e){h("erroring"===e._state,"stream._state === erroring"),h(!1===T(e),"WritableStreamHasOperationMarkedInFlight(stream) === false"),e._state="errored",e._writableStreamController.__errorSteps();for(var t=e._storedError,n=0;n<e._writeRequests.length;n++)e._writeRequests[n]._reject(t);if(e._writeRequests=[],void 0!==e._pendingAbortRequest){var r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,!0===r._wasAlreadyErroring)return r._reject(t),void E(e);e._writableStreamController.__abortSteps(r._reason).then((function(){r._resolve(),E(e)}),(function(t){r._reject(t),E(e)}))}else E(e)}function x(e){h(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0;var t=e._state;h("writable"===t||"erroring"===t),"erroring"===t&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var n=e._writer;void 0!==n&&function(e){h(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),h(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),h("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(n),h(void 0===e._pendingAbortRequest,"stream._pendingAbortRequest === undefined"),h(void 0===e._storedError,"stream._storedError === undefined")}function $(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function T(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function E(e){h("errored"===e._state,'_stream_.[[state]] is `"errored"`'),void 0!==e._closeRequest&&(h(void 0===e._inFlightCloseRequest),e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var t=e._writer;void 0!==t&&(K(t,e._storedError),t._closedPromise.catch((function(){})))}function R(e,t){h("writable"===e._state),h(!1===$(e));var n=e._writer;void 0!==n&&t!==e._backpressure&&(!0===t?function(e){h(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),h(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=new Promise((function(t,n){e._readyPromise_resolve=t,e._readyPromise_reject=n})),e._readyPromiseState="pending"}(n):(h(!1===t),J(n))),e._backpressure=t}e.exports={AcquireWritableStreamDefaultWriter:b,IsWritableStream:w,IsWritableStreamLocked:_,WritableStream:y,WritableStreamAbort:C,WritableStreamDefaultControllerError:W,WritableStreamDefaultWriterCloseWithErrorPropagation:function(e){var t=e._ownerWritableStream;h(void 0!==t);var n=t._state;return!0===$(t)||"closed"===n?Promise.resolve():"errored"===n?Promise.reject(t._storedError):(h("writable"===n||"erroring"===n),P(e))},WritableStreamDefaultWriterRelease:I,WritableStreamDefaultWriterWrite:F,WritableStreamCloseQueuedOrInFlight:$};var M=function(){function e(t){if(i(this,e),!1===w(t))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===_(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;var n,r=t._state;if("writable"===r)!1===$(t)&&!0===t._backpressure?((n=this)._readyPromise=new Promise((function(e,t){n._readyPromise_resolve=e,n._readyPromise_reject=t})),n._readyPromiseState="pending"):Y(this),G(this);else if("erroring"===r)X(this,t._storedError),this._readyPromise.catch((function(){})),G(this);else if("closed"===r)Y(this),function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(this);else{h("errored"===r,"state must be errored");var o=t._storedError;X(this,o),this._readyPromise.catch((function(){})),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}(this,o),this._closedPromise.catch((function(){}))}}return r(e,[{key:"abort",value:function(e){return!1===L(this)?Promise.reject(V("abort")):void 0===this._ownerWritableStream?Promise.reject(q("abort")):function(e,t){var n=e._ownerWritableStream;return h(void 0!==n),C(n,t)}(this,e)}},{key:"close",value:function(){if(!1===L(this))return Promise.reject(V("close"));var e=this._ownerWritableStream;return void 0===e?Promise.reject(q("close")):!0===$(e)?Promise.reject(new TypeError("cannot close an already-closing stream")):P(this)}},{key:"releaseLock",value:function(){if(!1===L(this))throw V("releaseLock");var e=this._ownerWritableStream;void 0!==e&&(h(void 0!==e._writer),I(this))}},{key:"write",value:function(e){return!1===L(this)?Promise.reject(V("write")):void 0===this._ownerWritableStream?Promise.reject(q("write to")):F(this,e)}},{key:"closed",get:function(){return!1===L(this)?Promise.reject(V("closed")):this._closedPromise}},{key:"desiredSize",get:function(){if(!1===L(this))throw V("desiredSize");if(void 0===this._ownerWritableStream)throw q("desiredSize");return e=this._ownerWritableStream,"errored"===(t=e._state)||"erroring"===t?null:"closed"===t?0:N(e._writableStreamController);var e,t}},{key:"ready",get:function(){return!1===L(this)?Promise.reject(V("ready")):this._readyPromise}}]),e}();function L(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function P(e){var t=e._ownerWritableStream;h(void 0!==t);var n=t._state;if("closed"===n||"errored"===n)return Promise.reject(new TypeError("The stream (in "+n+" state) is not in the writable state and cannot be closed"));h("writable"===n||"erroring"===n),h(!1===$(t));var r,i=new Promise((function(e,n){var r={_resolve:e,_reject:n};t._closeRequest=r}));return!0===t._backpressure&&"writable"===n&&J(e),r=t._writableStreamController,g(r,"close",0),B(r),i}function O(e,t){"pending"===e._closedPromiseState?K(e,t):function(e,t){h(void 0===e._closedPromise_resolve,"writer._closedPromise_resolve === undefined"),h(void 0===e._closedPromise_reject,"writer._closedPromise_reject === undefined"),h("pending"!==e._closedPromiseState,"writer._closedPromiseState is not pending"),e._closedPromise=Promise.reject(t),e._closedPromiseState="rejected"}(e,t),e._closedPromise.catch((function(){}))}function D(e,t){"pending"===e._readyPromiseState?function(e,t){h(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),h(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}(e,t):function(e,t){h(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),h(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=Promise.reject(t),e._readyPromiseState="rejected"}(e,t),e._readyPromise.catch((function(){}))}function I(e){var t=e._ownerWritableStream;h(void 0!==t),h(t._writer===e);var n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");D(e,n),O(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function F(e,t){var n=e._ownerWritableStream;h(void 0!==n);var r=n._writableStreamController,i=function(e,t){var n=e._strategySize;if(void 0===n)return 1;try{return n(t)}catch(t){return H(e,t),1}}(r,t);if(n!==e._ownerWritableStream)return Promise.reject(q("write to"));var o=n._state;if("errored"===o)return Promise.reject(n._storedError);if(!0===$(n)||"closed"===o)return Promise.reject(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return Promise.reject(n._storedError);h("writable"===o);var s=function(e){return h(!0===_(e)),h("writable"===e._state),new Promise((function(t,n){var r={_resolve:t,_reject:n};e._writeRequests.push(r)}))}(n);return function(e,t,n){var r={chunk:t};try{g(e,r,n)}catch(t){return void H(e,t)}var i=e._controlledWritableStream;if(!1===$(i)&&"writable"===i._state){var o=z(e);R(i,o)}B(e)}(r,t,i),s}var j=function(){function e(t,n,r,o){if(i(this,e),!1===w(t))throw new TypeError("WritableStreamDefaultController can only be constructed with a WritableStream instance");if(void 0!==t._writableStreamController)throw new TypeError("WritableStreamDefaultController instances can only be created by the WritableStream constructor");this._controlledWritableStream=t,this._underlyingSink=n,this._queue=void 0,this._queueTotalSize=void 0,v(this),this._started=!1;var s=l(r,o);this._strategySize=s.size,this._strategyHWM=s.highWaterMark,R(t,z(this))}return r(e,[{key:"error",value:function(e){if(!1==(!!c(t=this)&&!!Object.prototype.hasOwnProperty.call(t,"_underlyingSink")))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");var t;"writable"===this._controlledWritableStream._state&&W(this,e)}},{key:"__abortSteps",value:function(e){return a(this._underlyingSink,"abort",[e])}},{key:"__errorSteps",value:function(){v(this)}},{key:"__startSteps",value:function(){var e=this,t=s(this._underlyingSink,"start",[this]),n=this._controlledWritableStream;Promise.resolve(t).then((function(){h("writable"===n._state||"erroring"===n._state),e._started=!0,B(e)}),(function(t){h("writable"===n._state||"erroring"===n._state),e._started=!0,S(n,t)})).catch(d)}}]),e}();function N(e){return e._strategyHWM-e._queueTotalSize}function B(e){var t=e._controlledWritableStream;if(!1!==e._started&&void 0===t._inFlightWriteRequest){var n=t._state;if("closed"!==n&&"errored"!==n)if("erroring"!==n){if(0!==e._queue.length){var r=m(e);"close"===r?function(e){var t=e._controlledWritableStream;(function(e){h(void 0===e._inFlightCloseRequest),h(void 0!==e._closeRequest),e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),p(e),h(0===e._queue.length,"queue must be empty once the final write record is dequeued"),a(e._underlyingSink,"close",[]).then((function(){x(t)}),(function(e){!function(e,t){h(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,h("writable"===e._state||"erroring"===e._state),void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),S(e,t)}(t,e)})).catch(d)}(e):function(e,t){var n=e._controlledWritableStream;(function(e){h(void 0===e._inFlightWriteRequest,"there must be no pending write request"),h(0!==e._writeRequests.length,"writeRequests must not be empty"),e._inFlightWriteRequest=e._writeRequests.shift()})(n),a(e._underlyingSink,"write",[t,e]).then((function(){!function(e){h(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(n);var t=n._state;if(h("writable"===t||"erroring"===t),p(e),!1===$(n)&&"writable"===t){var r=z(e);R(n,r)}B(e)}),(function(e){!function(e,t){h(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,h("writable"===e._state||"erroring"===e._state),S(e,t)}(n,e)})).catch(d)}(e,r.chunk)}}else A(t)}}function H(e,t){"writable"===e._controlledWritableStream._state&&W(e,t)}function z(e){return N(e)<=0}function W(e,t){var n=e._controlledWritableStream;h("writable"===n._state),k(n,t)}function U(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function V(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function q(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function G(e){e._closedPromise=new Promise((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"}))}function K(e,t){h(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),h(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),h("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function X(e,t){e._readyPromise=Promise.reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function Y(e){e._readyPromise=Promise.resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function J(e){h(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),h(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}},function(e,t,n){var r=n(0).IsFiniteNonNegativeNumber,i=n(1).assert;t.DequeueValue=function(e){i("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: DequeueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),i(e._queue.length>0,"Spec-level failure: should never dequeue from an empty queue.");var t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value},t.EnqueueValueWithSize=function(e,t,n){if(i("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: EnqueueValueWithSize should only be used on containers with [[queue]] and [[queueTotalSize]]."),n=Number(n),!r(n))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n},t.PeekQueueValue=function(e){return i("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: PeekQueueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),i(e._queue.length>0,"Spec-level failure: should never peek at an empty queue."),e._queue[0].value},t.ResetQueue=function(e){i("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: ResetQueue should only be used on containers with [[queue]] and [[queueTotalSize]]."),e._queue=[],e._queueTotalSize=0}},function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(0),s=o.ArrayBufferCopy,a=o.CreateIterResultObject,l=o.IsFiniteNonNegativeNumber,c=o.InvokeOrNoop,u=o.PromiseInvokeOrNoop,h=o.TransferArrayBuffer,d=o.ValidateAndNormalizeQueuingStrategy,f=o.ValidateAndNormalizeHighWaterMark,p=n(0),g=p.createArrayFromList,m=p.createDataProperty,v=p.typeIsObject,y=n(1),b=y.assert,w=y.rethrowAssertionErrorRejection,_=n(3),C=_.DequeueValue,S=_.EnqueueValueWithSize,k=_.ResetQueue,A=n(2),x=A.AcquireWritableStreamDefaultWriter,$=A.IsWritableStream,T=A.IsWritableStreamLocked,E=A.WritableStreamAbort,R=A.WritableStreamDefaultWriterCloseWithErrorPropagation,M=A.WritableStreamDefaultWriterRelease,L=A.WritableStreamDefaultWriterWrite,P=A.WritableStreamCloseQueuedOrInFlight,O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.size,o=n.highWaterMark;i(this,e),this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,this._readableStreamController=void 0;var s=t.type;if("bytes"===String(s))void 0===o&&(o=0),this._readableStreamController=new fe(this,t,o);else{if(void 0!==s)throw new RangeError("Invalid type is specified");void 0===o&&(o=1),this._readableStreamController=new ie(this,t,r,o)}}return r(e,[{key:"cancel",value:function(e){return!1===F(this)?Promise.reject(Re("cancel")):!0===j(this)?Promise.reject(new TypeError("Cannot cancel a stream that already has a reader")):z(this,e)}},{key:"getReader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mode;if(!1===F(this))throw Re("getReader");if(void 0===t)return I(this);if("byob"===(t=String(t)))return D(this);throw new RangeError("Invalid mode is specified")}},{key:"pipeThrough",value:function(e,t){var n=e.writable,r=e.readable;return function(e){try{Promise.prototype.then.call(e,void 0,(function(){}))}catch(e){}}(this.pipeTo(n,t)),r}},{key:"pipeTo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.preventClose,i=n.preventAbort,o=n.preventCancel;if(!1===F(this))return Promise.reject(Re("pipeTo"));if(!1===$(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));if(r=Boolean(r),i=Boolean(i),o=Boolean(o),!0===j(this))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"));if(!0===T(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"));var s=I(this),a=x(e),l=!1,c=Promise.resolve();return new Promise((function(n,u){var h,d,f;if(m(t,s._closedPromise,(function(t){!1===i?v((function(){return E(e,t)}),!0,t):y(!0,t)})),m(e,a._closedPromise,(function(e){!1===o?v((function(){return z(t,e)}),!0,e):y(!0,e)})),h=t,d=s._closedPromise,f=function(){!1===r?v((function(){return R(a)})):y()},"closed"===h._state?f():d.then(f).catch(w),!0===P(e)||"closed"===e._state){var p=new TypeError("the destination writable stream closed before all data could be piped to it");!1===o?v((function(){return z(t,p)}),!0,p):y(!0,p)}function g(){var e=c;return c.then((function(){return e!==c?g():void 0}))}function m(e,t,n){"errored"===e._state?n(e._storedError):t.catch(n).catch(w)}function v(t,n,r){function i(){t().then((function(){return b(n,r)}),(function(e){return b(!0,e)})).catch(w)}!0!==l&&(l=!0,"writable"===e._state&&!1===P(e)?g().then(i):i())}function y(t,n){!0!==l&&(l=!0,"writable"===e._state&&!1===P(e)?g().then((function(){return b(t,n)})).catch(w):b(t,n))}function b(e,t){M(a),ne(s),e?u(t):n(void 0)}(function e(){return c=Promise.resolve(),!0===l?Promise.resolve():a._readyPromise.then((function(){return re(s).then((function(e){var t=e.value;!0!==e.done&&(c=L(a,t).catch((function(){})))}))})).then(e)})().catch((function(e){c=Promise.resolve(),w(e)}))}))}},{key:"tee",value:function(){if(!1===F(this))throw Re("tee");var e=N(this,!1);return g(e)}},{key:"locked",get:function(){if(!1===F(this))throw Re("locked");return j(this)}}]),e}();function D(e){return new J(e)}function I(e){return new Y(e)}function F(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function j(e){return b(!0===F(e),"IsReadableStreamLocked should only be used on known readable streams"),void 0!==e._reader}function N(e,t){b(!0===F(e)),b("boolean"==typeof t);var n=I(e),r={closedOrErrored:!1,canceled1:!1,canceled2:!1,reason1:void 0,reason2:void 0};r.promise=new Promise((function(e){r._resolve=e}));var i=function e(){var t=e._branch1,n=e._branch2,r=e._teeState;return re(e._reader).then((function(e){b(v(e));var i=e.value,o=e.done;if(b("boolean"==typeof o),!0===o&&!1===r.closedOrErrored&&(!1===r.canceled1&&ae(t),!1===r.canceled2&&ae(n),r.closedOrErrored=!0),!0!==r.closedOrErrored){var s=i,a=i;!1===r.canceled1&&le(t,s),!1===r.canceled2&&le(n,a)}}))};i._reader=n,i._teeState=r,i._cloneForBranch2=t;var o=function e(t){var n=e._stream,r=e._teeState;if(r.canceled1=!0,r.reason1=t,!0===r.canceled2){var i=z(n,g([r.reason1,r.reason2]));r._resolve(i)}return r.promise};o._stream=e,o._teeState=r;var s=function e(t){var n=e._stream,r=e._teeState;if(r.canceled2=!0,r.reason2=t,!0===r.canceled1){var i=z(n,g([r.reason1,r.reason2]));r._resolve(i)}return r.promise};s._stream=e,s._teeState=r;var a=Object.create(Object.prototype);m(a,"pull",i),m(a,"cancel",o);var l=new O(a),c=Object.create(Object.prototype);m(c,"pull",i),m(c,"cancel",s);var u=new O(c);return i._branch1=l._readableStreamController,i._branch2=u._readableStreamController,n._closedPromise.catch((function(e){!0!==r.closedOrErrored&&(ce(i._branch1,e),ce(i._branch2,e),r.closedOrErrored=!0)})),[l,u]}function B(e){return b(!0===Q(e._reader)),b("readable"===e._state||"closed"===e._state),new Promise((function(t,n){var r={_resolve:t,_reject:n};e._reader._readIntoRequests.push(r)}))}function H(e){return b(!0===Z(e._reader)),b("readable"===e._state),new Promise((function(t,n){var r={_resolve:t,_reject:n};e._reader._readRequests.push(r)}))}function z(e,t){return e._disturbed=!0,"closed"===e._state?Promise.resolve(void 0):"errored"===e._state?Promise.reject(e._storedError):(W(e),e._readableStreamController.__cancelSteps(t).then((function(){})))}function W(e){b("readable"===e._state),e._state="closed";var t=e._reader;if(void 0!==t){if(!0===Z(t)){for(var n=0;n<t._readRequests.length;n++)(0,t._readRequests[n]._resolve)(a(void 0,!0));t._readRequests=[]}!function(e){b(void 0!==e._closedPromise_resolve),b(void 0!==e._closedPromise_reject),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(t)}}function U(e,t){b(!0===F(e),"stream must be ReadableStream"),b("readable"===e._state,"state must be readable"),e._state="errored",e._storedError=t;var n=e._reader;if(void 0!==n){if(!0===Z(n)){for(var r=0;r<n._readRequests.length;r++)n._readRequests[r]._reject(t);n._readRequests=[]}else{b(Q(n),"reader must be ReadableStreamBYOBReader");for(var i=0;i<n._readIntoRequests.length;i++)n._readIntoRequests[i]._reject(t);n._readIntoRequests=[]}Pe(n,t),n._closedPromise.catch((function(){}))}}function V(e,t,n){var r=e._reader;b(r._readRequests.length>0),r._readRequests.shift()._resolve(a(t,n))}function q(e){return e._reader._readIntoRequests.length}function G(e){return e._reader._readRequests.length}function K(e){var t=e._reader;return void 0!==t&&!1!==Q(t)}function X(e){var t=e._reader;return void 0!==t&&!1!==Z(t)}e.exports={ReadableStream:O,IsReadableStreamDisturbed:function(e){return b(!0===F(e),"IsReadableStreamDisturbed should only be used on known readable streams"),e._disturbed},ReadableStreamDefaultControllerClose:ae,ReadableStreamDefaultControllerEnqueue:le,ReadableStreamDefaultControllerError:ce,ReadableStreamDefaultControllerGetDesiredSize:he};var Y=function(){function e(t){if(i(this,e),!1===F(t))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===j(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ee(this,t),this._readRequests=[]}return r(e,[{key:"cancel",value:function(e){return!1===Z(this)?Promise.reject(Le("cancel")):void 0===this._ownerReadableStream?Promise.reject(Me("cancel")):te(this,e)}},{key:"read",value:function(){return!1===Z(this)?Promise.reject(Le("read")):void 0===this._ownerReadableStream?Promise.reject(Me("read from")):re(this)}},{key:"releaseLock",value:function(){if(!1===Z(this))throw Le("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}},{key:"closed",get:function(){return!1===Z(this)?Promise.reject(Le("closed")):this._closedPromise}}]),e}(),J=function(){function e(t){if(i(this,e),!F(t))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===pe(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(j(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ee(this,t),this._readIntoRequests=[]}return r(e,[{key:"cancel",value:function(e){return Q(this)?void 0===this._ownerReadableStream?Promise.reject(Me("cancel")):te(this,e):Promise.reject(Oe("cancel"))}},{key:"read",value:function(e){return Q(this)?void 0===this._ownerReadableStream?Promise.reject(Me("read from")):ArrayBuffer.isView(e)?0===e.byteLength?Promise.reject(new TypeError("view must have non-zero byteLength")):function(e,t){var n=e._ownerReadableStream;return b(void 0!==n),n._disturbed=!0,"errored"===n._state?Promise.reject(n._storedError):function(e,t){var n=e._controlledReadableStream,r=1;t.constructor!==DataView&&(r=t.constructor.BYTES_PER_ELEMENT);var i=t.constructor,o={buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:r,ctor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return o.buffer=h(o.buffer),e._pendingPullIntos.push(o),B(n);if("closed"===n._state){var s=new t.constructor(o.buffer,o.byteOffset,0);return Promise.resolve(a(s,!0))}if(e._queueTotalSize>0){if(!0===_e(e,o)){var l=be(o);return Se(e),Promise.resolve(a(l,!1))}if(!0===e._closeRequested){var c=new TypeError("Insufficient bytes to fill elements in the given buffer");return Te(e,c),Promise.reject(c)}}o.buffer=h(o.buffer),e._pendingPullIntos.push(o);var u=B(n);return me(e),u}(n._readableStreamController,t)}(this,e):Promise.reject(new TypeError("view must be an array buffer view")):Promise.reject(Oe("read"))}},{key:"releaseLock",value:function(){if(!Q(this))throw Oe("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ne(this)}}},{key:"closed",get:function(){return Q(this)?this._closedPromise:Promise.reject(Oe("closed"))}}]),e}();function Q(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function Z(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function ee(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?function(e){e._closedPromise=new Promise((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n}))}(e):"closed"===t._state?function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e):(b("errored"===t._state,"state must be errored"),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e,t._storedError),e._closedPromise.catch((function(){})))}function te(e,t){var n=e._ownerReadableStream;return b(void 0!==n),z(n,t)}function ne(e){b(void 0!==e._ownerReadableStream),b(e._ownerReadableStream._reader===e),"readable"===e._ownerReadableStream._state?Pe(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){b(void 0===e._closedPromise_resolve),b(void 0===e._closedPromise_reject),e._closedPromise=Promise.reject(t)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._closedPromise.catch((function(){})),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function re(e){var t=e._ownerReadableStream;return b(void 0!==t),t._disturbed=!0,"closed"===t._state?Promise.resolve(a(void 0,!0)):"errored"===t._state?Promise.reject(t._storedError):(b("readable"===t._state),t._readableStreamController.__pullSteps())}var ie=function(){function e(t,n,r,o){if(i(this,e),!1===F(t))throw new TypeError("ReadableStreamDefaultController can only be constructed with a ReadableStream instance");if(void 0!==t._readableStreamController)throw new TypeError("ReadableStreamDefaultController instances can only be created by the ReadableStream constructor");this._controlledReadableStream=t,this._underlyingSource=n,this._queue=void 0,this._queueTotalSize=void 0,k(this),this._started=!1,this._closeRequested=!1,this._pullAgain=!1,this._pulling=!1;var s=d(r,o);this._strategySize=s.size,this._strategyHWM=s.highWaterMark;var a=this,l=c(n,"start",[this]);Promise.resolve(l).then((function(){a._started=!0,b(!1===a._pulling),b(!1===a._pullAgain),se(a)}),(function(e){ue(a,e)})).catch(w)}return r(e,[{key:"close",value:function(){if(!1===oe(this))throw De("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");ae(this)}},{key:"enqueue",value:function(e){if(!1===oe(this))throw De("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");return le(this,e)}},{key:"error",value:function(e){if(!1===oe(this))throw De("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");ce(this,e)}},{key:"__cancelSteps",value:function(e){return k(this),u(this._underlyingSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(this._queue.length>0){var t=C(this);return!0===this._closeRequested&&0===this._queue.length?W(e):se(this),Promise.resolve(a(t,!1))}var n=H(e);return se(this),n}},{key:"desiredSize",get:function(){if(!1===oe(this))throw De("desiredSize");return he(this)}}]),e}();function oe(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingSource")}function se(e){!1!==function(e){var t=e._controlledReadableStream;return"closed"!==t._state&&"errored"!==t._state&&(!0!==e._closeRequested&&(!1!==e._started&&(!0===j(t)&&G(t)>0||he(e)>0)))}(e)&&(!0!==e._pulling?(b(!1===e._pullAgain),e._pulling=!0,u(e._underlyingSource,"pull",[e]).then((function(){if(e._pulling=!1,!0===e._pullAgain)return e._pullAgain=!1,se(e)}),(function(t){ue(e,t)})).catch(w)):e._pullAgain=!0)}function ae(e){var t=e._controlledReadableStream;b(!1===e._closeRequested),b("readable"===t._state),e._closeRequested=!0,0===e._queue.length&&W(t)}function le(e,t){var n=e._controlledReadableStream;if(b(!1===e._closeRequested),b("readable"===n._state),!0===j(n)&&G(n)>0)V(n,t,!1);else{var r=1;if(void 0!==e._strategySize){var i=e._strategySize;try{r=i(t)}catch(t){throw ue(e,t),t}}try{S(e,t,r)}catch(t){throw ue(e,t),t}}se(e)}function ce(e,t){var n=e._controlledReadableStream;b("readable"===n._state),k(e),U(n,t)}function ue(e,t){"readable"===e._controlledReadableStream._state&&ce(e,t)}function he(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}var de=function(){function e(t,n){i(this,e),this._associatedReadableByteStreamController=t,this._view=n}return r(e,[{key:"respond",value:function(e){if(!1===ge(this))throw Ie("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");!function(e,t){if(t=Number(t),!1===l(t))throw new RangeError("bytesWritten must be a finite");b(e._pendingPullIntos.length>0),xe(e,t)}(this._associatedReadableByteStreamController,e)}},{key:"respondWithNewView",value:function(e){if(!1===ge(this))throw Ie("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");!function(e,t){b(e._pendingPullIntos.length>0);var n=e._pendingPullIntos[0];if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=t.buffer,xe(e,t.byteLength)}(this._associatedReadableByteStreamController,e)}},{key:"view",get:function(){return this._view}}]),e}(),fe=function(){function e(t,n,r){if(i(this,e),!1===F(t))throw new TypeError("ReadableByteStreamController can only be constructed with a ReadableStream instance given a byte source");if(void 0!==t._readableStreamController)throw new TypeError("ReadableByteStreamController instances can only be created by the ReadableStream constructor given a byte source");this._controlledReadableStream=t,this._underlyingByteSource=n,this._pullAgain=!1,this._pulling=!1,ve(this),this._queue=this._queueTotalSize=void 0,k(this),this._closeRequested=!1,this._started=!1,this._strategyHWM=f(r);var o=n.autoAllocateChunkSize;if(void 0!==o&&(!1===Number.isInteger(o)||o<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");this._autoAllocateChunkSize=o,this._pendingPullIntos=[];var s=this,a=c(n,"start",[this]);Promise.resolve(a).then((function(){s._started=!0,b(!1===s._pulling),b(!1===s._pullAgain),me(s)}),(function(e){"readable"===t._state&&Te(s,e)})).catch(w)}return r(e,[{key:"close",value:function(){if(!1===pe(this))throw Fe("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");!function(e){var t=e._controlledReadableStream;if(b(!1===e._closeRequested),b("readable"===t._state),e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos[0].bytesFilled>0){var n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Te(e,n),n}W(t)}}(this)}},{key:"enqueue",value:function(e){if(!1===pe(this))throw Fe("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(e))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");!function(e,t){var n=e._controlledReadableStream;b(!1===e._closeRequested),b("readable"===n._state);var r=t.buffer,i=t.byteOffset,o=t.byteLength,s=h(r);if(!0===X(n))if(0===G(n))we(e,s,i,o);else{b(0===e._queue.length);var a=new Uint8Array(s,i,o);V(n,a,!1)}else!0===K(n)?(we(e,s,i,o),Ae(e)):(b(!1===j(n),"stream must not be locked"),we(e,s,i,o))}(this,e)}},{key:"error",value:function(e){if(!1===pe(this))throw Fe("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");Te(this,e)}},{key:"__cancelSteps",value:function(e){return this._pendingPullIntos.length>0&&(this._pendingPullIntos[0].bytesFilled=0),k(this),u(this._underlyingByteSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(b(!0===X(e)),this._queueTotalSize>0){b(0===G(e));var t=this._queue.shift();this._queueTotalSize-=t.byteLength,Se(this);var n=void 0;try{n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}catch(e){return Promise.reject(e)}return Promise.resolve(a(n,!1))}var r=this._autoAllocateChunkSize;if(void 0!==r){var i=void 0;try{i=new ArrayBuffer(r)}catch(e){return Promise.reject(e)}var o={buffer:i,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}var s=H(e);return me(this),s}},{key:"byobRequest",get:function(){if(!1===pe(this))throw Fe("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){var e=this._pendingPullIntos[0],t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled);this._byobRequest=new de(this,t)}return this._byobRequest}},{key:"desiredSize",get:function(){if(!1===pe(this))throw Fe("desiredSize");return Ee(this)}}]),e}();function pe(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingByteSource")}function ge(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function me(e){!1!==function(e){var t=e._controlledReadableStream;return"readable"===t._state&&(!0!==e._closeRequested&&(!1!==e._started&&(!0===X(t)&&G(t)>0||(!0===K(t)&&q(t)>0||Ee(e)>0))))}(e)&&(!0!==e._pulling?(b(!1===e._pullAgain),e._pulling=!0,u(e._underlyingByteSource,"pull",[e]).then((function(){e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,me(e))}),(function(t){"readable"===e._controlledReadableStream._state&&Te(e,t)})).catch(w)):e._pullAgain=!0)}function ve(e){ke(e),e._pendingPullIntos=[]}function ye(e,t){b("errored"!==e._state,"state must not be errored");var n=!1;"closed"===e._state&&(b(0===t.bytesFilled),n=!0);var r=be(t);"default"===t.readerType?V(e,r,n):(b("byob"===t.readerType),function(e,t,n){var r=e._reader;b(r._readIntoRequests.length>0),r._readIntoRequests.shift()._resolve(a(t,n))}(e,r,n))}function be(e){var t=e.bytesFilled,n=e.elementSize;return b(t<=e.byteLength),b(t%n==0),new e.ctor(e.buffer,e.byteOffset,t/n)}function we(e,t,n,r){e._queue.push({buffer:t,byteOffset:n,byteLength:r}),e._queueTotalSize+=r}function _e(e,t){var n=t.elementSize,r=t.bytesFilled-t.bytesFilled%n,i=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),o=t.bytesFilled+i,a=o-o%n,l=i,c=!1;a>r&&(l=a-t.bytesFilled,c=!0);for(var u=e._queue;l>0;){var h=u[0],d=Math.min(l,h.byteLength),f=t.byteOffset+t.bytesFilled;s(t.buffer,f,h.buffer,h.byteOffset,d),h.byteLength===d?u.shift():(h.byteOffset+=d,h.byteLength-=d),e._queueTotalSize-=d,Ce(e,d,t),l-=d}return!1===c&&(b(0===e._queueTotalSize,"queue must be empty"),b(t.bytesFilled>0),b(t.bytesFilled<t.elementSize)),c}function Ce(e,t,n){b(0===e._pendingPullIntos.length||e._pendingPullIntos[0]===n),ke(e),n.bytesFilled+=t}function Se(e){b("readable"===e._controlledReadableStream._state),0===e._queueTotalSize&&!0===e._closeRequested?W(e._controlledReadableStream):me(e)}function ke(e){void 0!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function Ae(e){for(b(!1===e._closeRequested);e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;var t=e._pendingPullIntos[0];!0===_e(e,t)&&($e(e),ye(e._controlledReadableStream,t))}}function xe(e,t){var n=e._pendingPullIntos[0],r=e._controlledReadableStream;if("closed"===r._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(e,t){t.buffer=h(t.buffer),b(0===t.bytesFilled,"bytesFilled must be 0");var n=e._controlledReadableStream;if(!0===K(n))for(;q(n)>0;)ye(n,$e(e))}(e,n)}else b("readable"===r._state),function(e,t,n){if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range");if(Ce(e,t,n),!(n.bytesFilled<n.elementSize)){$e(e);var r=n.bytesFilled%n.elementSize;if(r>0){var i=n.byteOffset+n.bytesFilled,o=n.buffer.slice(i-r,i);we(e,o,0,o.byteLength)}n.buffer=h(n.buffer),n.bytesFilled-=r,ye(e._controlledReadableStream,n),Ae(e)}}(e,t,n)}function $e(e){var t=e._pendingPullIntos.shift();return ke(e),t}function Te(e,t){var n=e._controlledReadableStream;b("readable"===n._state),ve(e),k(e),U(n,t)}function Ee(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Re(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}function Me(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Le(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}function Pe(e,t){b(void 0!==e._closedPromise_resolve),b(void 0!==e._closedPromise_reject),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function Oe(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}function De(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function Ie(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function Fe(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}},function(e,t,n){var r=n(6),i=n(4),o=n(2);t.TransformStream=r.TransformStream,t.ReadableStream=i.ReadableStream,t.IsReadableStreamDisturbed=i.IsReadableStreamDisturbed,t.ReadableStreamDefaultControllerClose=i.ReadableStreamDefaultControllerClose,t.ReadableStreamDefaultControllerEnqueue=i.ReadableStreamDefaultControllerEnqueue,t.ReadableStreamDefaultControllerError=i.ReadableStreamDefaultControllerError,t.ReadableStreamDefaultControllerGetDesiredSize=i.ReadableStreamDefaultControllerGetDesiredSize,t.AcquireWritableStreamDefaultWriter=o.AcquireWritableStreamDefaultWriter,t.IsWritableStream=o.IsWritableStream,t.IsWritableStreamLocked=o.IsWritableStreamLocked,t.WritableStream=o.WritableStream,t.WritableStreamAbort=o.WritableStreamAbort,t.WritableStreamDefaultControllerError=o.WritableStreamDefaultControllerError,t.WritableStreamDefaultWriterCloseWithErrorPropagation=o.WritableStreamDefaultWriterCloseWithErrorPropagation,t.WritableStreamDefaultWriterRelease=o.WritableStreamDefaultWriterRelease,t.WritableStreamDefaultWriterWrite=o.WritableStreamDefaultWriterWrite},function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(1).assert,s=n(0),a=s.InvokeOrNoop,l=s.PromiseInvokeOrPerformFallback,c=s.PromiseInvokeOrNoop,u=s.typeIsObject,h=n(4),d=h.ReadableStream,f=h.ReadableStreamDefaultControllerClose,p=h.ReadableStreamDefaultControllerEnqueue,g=h.ReadableStreamDefaultControllerError,m=h.ReadableStreamDefaultControllerGetDesiredSize,v=n(2),y=v.WritableStream,b=v.WritableStreamDefaultControllerError;function w(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");var n=e._readableController;try{p(n,t)}catch(t){throw e._readableClosed=!0,C(e,t),e._storedError}!0==m(n)<=0&&!1===e._backpressure&&A(e,!0)}function _(e){o(!1===e._errored),o(!1===e._readableClosed);try{f(e._readableController)}catch(e){o(!1)}e._readableClosed=!0}function C(e,t){!1===e._errored&&S(e,t)}function S(e,t){o(!1===e._errored),e._errored=!0,e._storedError=t,!1===e._writableDone&&b(e._writableController,t),!1===e._readableClosed&&g(e._readableController,t)}function k(e){return o(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!1===e._backpressure?Promise.resolve():(o(!0===e._backpressure,"_backpressure should have been initialized"),e._backpressureChangePromise)}function A(e,t){o(e._backpressure!==t,"TransformStreamSetBackpressure() should be called only when backpressure is changed"),void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(t),e._backpressureChangePromise=new Promise((function(t){e._backpressureChangePromise_resolve=t})),e._backpressureChangePromise.then((function(e){o(e!==t,"_backpressureChangePromise should be fulfilled only when backpressure is changed")})),e._backpressure=t}function x(e,t){return w(t._controlledTransformStream,e),Promise.resolve()}function $(e){return!!u(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function T(e){return!!u(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}var E=function(){function e(t,n){i(this,e),this._transformStream=t,this._startPromise=n}return r(e,[{key:"start",value:function(e){var t=this._transformStream;return t._writableController=e,this._startPromise.then((function(){return k(t)}))}},{key:"write",value:function(e){return function(e,t){o(!1===e._errored),o(!1===e._transforming),o(!1===e._backpressure),e._transforming=!0;var n=e._transformer,r=e._transformStreamController;return l(n,"transform",[t,r],x,[t,r]).then((function(){return e._transforming=!1,k(e)}),(function(t){return C(e,t),Promise.reject(t)}))}(this._transformStream,e)}},{key:"abort",value:function(){var e=this._transformStream;e._writableDone=!0,S(e,new TypeError("Writable side aborted"))}},{key:"close",value:function(){var e=this._transformStream;return o(!1===e._transforming),e._writableDone=!0,c(e._transformer,"flush",[e._transformStreamController]).then((function(){return!0===e._errored?Promise.reject(e._storedError):(!1===e._readableClosed&&_(e),Promise.resolve())})).catch((function(t){return C(e,t),Promise.reject(e._storedError)}))}}]),e}(),R=function(){function e(t,n){i(this,e),this._transformStream=t,this._startPromise=n}return r(e,[{key:"start",value:function(e){var t=this._transformStream;return t._readableController=e,this._startPromise.then((function(){return o(void 0!==t._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!0===t._backpressure?Promise.resolve():(o(!1===t._backpressure,"_backpressure should have been initialized"),t._backpressureChangePromise)}))}},{key:"pull",value:function(){var e=this._transformStream;return o(!0===e._backpressure,"pull() should be never called while _backpressure is false"),o(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),A(e,!1),e._backpressureChangePromise}},{key:"cancel",value:function(){var e=this._transformStream;e._readableClosed=!0,S(e,new TypeError("Readable side canceled"))}}]),e}(),M=function(){function e(t){if(i(this,e),!1===T(t))throw new TypeError("TransformStreamDefaultController can only be constructed with a TransformStream instance");if(void 0!==t._transformStreamController)throw new TypeError("TransformStreamDefaultController instances can only be created by the TransformStream constructor");this._controlledTransformStream=t}return r(e,[{key:"enqueue",value:function(e){if(!1===$(this))throw P("enqueue");w(this._controlledTransformStream,e)}},{key:"close",value:function(){if(!1===$(this))throw P("close");!function(e){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");_(e)}(this._controlledTransformStream)}},{key:"error",value:function(e){if(!1===$(this))throw P("error");!function(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");S(e,t)}(this._controlledTransformStream,e)}},{key:"desiredSize",get:function(){if(!1===$(this))throw P("desiredSize");var e=this._controlledTransformStream._readableController;return m(e)}}]),e}(),L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this._transformer=t;var n=t.readableStrategy,r=t.writableStrategy;this._transforming=!1,this._errored=!1,this._storedError=void 0,this._writableController=void 0,this._readableController=void 0,this._transformStreamController=void 0,this._writableDone=!1,this._readableClosed=!1,this._backpressure=void 0,this._backpressureChangePromise=void 0,this._backpressureChangePromise_resolve=void 0,this._transformStreamController=new M(this);var s=void 0,l=new Promise((function(e){s=e})),c=new R(this,l);this._readable=new d(c,n);var u=new E(this,l);this._writable=new y(u,r),o(void 0!==this._writableController),o(void 0!==this._readableController),A(this,m(this._readableController)<=0);var h=this,f=a(t,"start",[h._transformStreamController]);s(f),l.catch((function(e){!1===h._errored&&(h._errored=!0,h._storedError=e)}))}return r(e,[{key:"readable",get:function(){if(!1===T(this))throw O("readable");return this._readable}},{key:"writable",get:function(){if(!1===T(this))throw O("writable");return this._writable}}]),e}();function P(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function O(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}e.exports={TransformStream:L}},function(e,t,n){e.exports=n(5)}]))},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=!1;try{if("function"==typeof URL&&"object"===r(URL.prototype)&&"origin"in URL.prototype){var o=new URL("b","http://a");o.pathname="c%20d",i="http://a/c%20d"===o.href}}catch(e){}if(i)t.URL=URL;else{var s=n(128).URL,a=n(3).URL;a&&(s.createObjectURL=function(e){return a.createObjectURL.apply(a,arguments)},s.revokeObjectURL=function(e){a.revokeObjectURL(e)}),t.URL=s}},function(e,t,n){"use strict";!function(){var e=Object.create(null);e.ftp=21,e.file=0,e.gopher=70,e.http=80,e.https=443,e.ws=80,e.wss=443;var n=Object.create(null);function r(t){return void 0!==e[t]}function i(){d.call(this),this._isInvalid=!0}function o(e){return""===e&&i.call(this),e.toLowerCase()}function s(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function a(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}n["%2e"]=".",n[".%2e"]="..",n["%2e."]="..",n["%2e%2e"]="..";var l,c=/[a-zA-Z]/,u=/[a-zA-Z0-9\+\-\.]/;function h(t,h,d){function f(e){b.push(e)}var p=h||"scheme start",g=0,m="",v=!1,y=!1,b=[];e:for(;(t[g-1]!==l||0===g)&&!this._isInvalid;){var w=t[g];switch(p){case"scheme start":if(!w||!c.test(w)){if(h){f("Invalid scheme.");break e}m="",p="no scheme";continue}m+=w.toLowerCase(),p="scheme";break;case"scheme":if(w&&u.test(w))m+=w.toLowerCase();else{if(":"!==w){if(h){if(w===l)break e;f("Code point not allowed in scheme: "+w);break e}m="",g=0,p="no scheme";continue}if(this._scheme=m,m="",h)break e;r(this._scheme)&&(this._isRelative=!0),p="file"===this._scheme?"relative":this._isRelative&&d&&d._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"===w?(this._query="?",p="query"):"#"===w?(this._fragment="#",p="fragment"):w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._schemeData+=s(w));break;case"no scheme":if(d&&r(d._scheme)){p="relative";continue}f("Missing scheme."),i.call(this);break;case"relative or authority":if("/"!==w||"/"!==t[g+1]){f("Expected /, got: "+w),p="relative";continue}p="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!==this._scheme&&(this._scheme=d._scheme),w===l){this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._username=d._username,this._password=d._password;break e}if("/"===w||"\\"===w)"\\"===w&&f("\\ is an invalid code point."),p="relative slash";else if("?"===w)this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query="?",this._username=d._username,this._password=d._password,p="query";else{if("#"!==w){var _=t[g+1],C=t[g+2];("file"!==this._scheme||!c.test(w)||":"!==_&&"|"!==_||C!==l&&"/"!==C&&"\\"!==C&&"?"!==C&&"#"!==C)&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password,this._path=d._path.slice(),this._path.pop()),p="relative path";continue}this._host=d._host,this._port=d._port,this._path=d._path.slice(),this._query=d._query,this._fragment="#",this._username=d._username,this._password=d._password,p="fragment"}break;case"relative slash":if("/"!==w&&"\\"!==w){"file"!==this._scheme&&(this._host=d._host,this._port=d._port,this._username=d._username,this._password=d._password),p="relative path";continue}"\\"===w&&f("\\ is an invalid code point."),p="file"===this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!==w){f("Expected '/', got: "+w),p="authority ignore slashes";continue}p="authority second slash";break;case"authority second slash":if(p="authority ignore slashes","/"!==w){f("Expected '/', got: "+w);continue}break;case"authority ignore slashes":if("/"!==w&&"\\"!==w){p="authority";continue}f("Expected authority, got: "+w);break;case"authority":if("@"===w){v&&(f("@ already seen."),m+="%40"),v=!0;for(var S=0;S<m.length;S++){var k=m[S];if("\t"!==k&&"\n"!==k&&"\r"!==k)if(":"!==k||null!==this._password){var A=s(k);null!==this._password?this._password+=A:this._username+=A}else this._password="";else f("Invalid whitespace in authority.")}m=""}else{if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){g-=m.length,m="",p="host";continue}m+=w}break;case"file host":if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){2!==m.length||!c.test(m[0])||":"!==m[1]&&"|"!==m[1]?0===m.length?p="relative path start":(this._host=o.call(this,m),m="",p="relative path start"):p="relative path";continue}"\t"===w||"\n"===w||"\r"===w?f("Invalid whitespace in file host."):m+=w;break;case"host":case"hostname":if(":"!==w||y){if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){if(this._host=o.call(this,m),m="",p="relative path start",h)break e;continue}"\t"!==w&&"\n"!==w&&"\r"!==w?("["===w?y=!0:"]"===w&&(y=!1),m+=w):f("Invalid code point in host/hostname: "+w)}else if(this._host=o.call(this,m),m="",p="port","hostname"===h)break e;break;case"port":if(/[0-9]/.test(w))m+=w;else{if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w||h){if(""!==m){var x=parseInt(m,10);x!==e[this._scheme]&&(this._port=x+""),m=""}if(h)break e;p="relative path start";continue}"\t"===w||"\n"===w||"\r"===w?f("Invalid code point in port: "+w):i.call(this)}break;case"relative path start":if("\\"===w&&f("'\\' not allowed in path."),p="relative path","/"!==w&&"\\"!==w)continue;break;case"relative path":var $;w!==l&&"/"!==w&&"\\"!==w&&(h||"?"!==w&&"#"!==w)?"\t"!==w&&"\n"!==w&&"\r"!==w&&(m+=s(w)):("\\"===w&&f("\\ not allowed in relative path."),($=n[m.toLowerCase()])&&(m=$),".."===m?(this._path.pop(),"/"!==w&&"\\"!==w&&this._path.push("")):"."===m&&"/"!==w&&"\\"!==w?this._path.push(""):"."!==m&&("file"===this._scheme&&0===this._path.length&&2===m.length&&c.test(m[0])&&"|"===m[1]&&(m=m[0]+":"),this._path.push(m)),m="","?"===w?(this._query="?",p="query"):"#"===w&&(this._fragment="#",p="fragment"));break;case"query":h||"#"!==w?w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._query+=a(w)):(this._fragment="#",p="fragment");break;case"fragment":w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._fragment+=w)}g++}}function d(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function f(e,t){void 0===t||t instanceof f||(t=new f(String(t))),this._url=e,d.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");h.call(this,n,null,t)}f.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return""===this._username&&null===this._password||(e=this._username+(null!==this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){d.call(this),h.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||h.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&h.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&h.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&h.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],h.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"===this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"===e[0]&&(e=e.slice(1)),h.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"===this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"===e[0]&&(e=e.slice(1)),h.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null";case"blob":try{return new f(this._schemeData).origin||"null"}catch(e){}return"null"}return(e=this.host)?this._scheme+"://"+e:""}},t.URL=f}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.build=t.version=t.setPDFNetworkStreamFactory=t.PDFPageProxy=t.PDFDocumentProxy=t.PDFWorker=t.PDFDataRangeTransport=t.LoopbackPort=t.getDocument=void 0;var i,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=r(1),c=r(130),u=r(131),h=r(132),d=r(133),f=r(3),p=(i=f)&&i.__esModule?i:{default:i},g=r(135),m=r(136),v=r(141),y=r(143),b=r(144);function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _=65536,C=!1,S=void 0,k=null,A=!1;"undefined"==typeof window?(C=!0,A=!0):A=!0,"undefined"!=typeof requirejs&&requirejs.toUrl&&(S=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var x,$="undefined"!=typeof requirejs&&requirejs.load;if(k=A?function(){return new Promise((function(e,t){Promise.resolve().then(function(){try{var r;r=n(73),e(r.WorkerMessageHandler)}catch(e){t(e)}}.bind(null,n)).catch(t)}))}:$?function(){return new Promise((function(e,t){requirejs(["pdfjs-dist/build/pdf.worker"],(function(n){try{e(n.WorkerMessageHandler)}catch(e){t(e)}}),t)}))}:null,!S&&"undefined"!=typeof document){var T=document.currentScript&&document.currentScript.src;T&&(S=T.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}var E=function(){var e=0;function t(){this._capability=(0,l.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+e++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return t.prototype={get promise(){return this._capability.promise},destroy:function(){var e=this;return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then((function(){e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)}))},then:function(e,t){return this.promise.then.apply(this.promise,arguments)}},t}(),R=function(){function e(t,n){w(this,e),this.length=t,this.initialData=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._readyCapability=(0,l.createPromiseCapability)()}return s(e,[{key:"addRangeListener",value:function(e){this._rangeListeners.push(e)}},{key:"addProgressListener",value:function(e){this._progressListeners.push(e)}},{key:"addProgressiveReadListener",value:function(e){this._progressiveReadListeners.push(e)}},{key:"onDataRange",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,s=this._rangeListeners[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)(0,o.value)(e,t)}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}},{key:"onDataProgress",value:function(e){var t=this;this._readyCapability.promise.then((function(){var n=!0,r=!1,i=void 0;try{for(var o,s=t._progressListeners[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)(0,o.value)(e)}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}))}},{key:"onDataProgressiveRead",value:function(e){var t=this;this._readyCapability.promise.then((function(){var n=!0,r=!1,i=void 0;try{for(var o,s=t._progressiveReadListeners[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)(0,o.value)(e)}catch(e){r=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw i}}}))}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(e,t){(0,l.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),e}(),M=function(){function e(t,n,r){w(this,e),this.loadingTask=r,this._pdfInfo=t,this._transport=n}return s(e,[{key:"getPage",value:function(e){return this._transport.getPage(e)}},{key:"getPageIndex",value:function(e){return this._transport.getPageIndex(e)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(e){return this._transport.getDestination(e)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"getStats",value:function(){return this._transport.getStats()}},{key:"cleanup",value:function(){this._transport.startCleanup()}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprint",get:function(){return this._pdfInfo.fingerprint}},{key:"loadingParams",get:function(){return this._transport.loadingParams}}]),e}(),L=function(){function e(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.pageIndex=e,this._pageInfo=t,this.transport=n,this._stats=r?new c.StatTimer:c.DummyStatTimer,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new I,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return e.prototype={get pageNumber(){return this.pageIndex+1},get rotate(){return this._pageInfo.rotate},get ref(){return this._pageInfo.ref},get userUnit(){return this._pageInfo.userUnit},get view(){return this._pageInfo.view},getViewport:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rotate,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new c.PageViewport({viewBox:this.view,scale:e,rotation:t,dontFlip:n})},getAnnotations:function(e){var t=e&&e.intent||null;return this.annotationsPromise&&this.annotationsIntent===t||(this.annotationsPromise=this.transport.getAnnotations(this.pageIndex,t),this.annotationsIntent=t),this.annotationsPromise},render:function(e){var t=this,n=this._stats;n.time("Overall"),this.pendingCleanup=!1;var r="print"===e.intent?"print":"display",i=e.canvasFactory||new c.DOMCanvasFactory,o=new b.WebGLContext({enable:e.enableWebGL});this.intentStates[r]||(this.intentStates[r]=Object.create(null));var s=this.intentStates[r];s.displayReadyCapability||(s.receivingOperatorList=!0,s.displayReadyCapability=(0,l.createPromiseCapability)(),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1},n.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:r,renderInteractiveForms:!0===e.renderInteractiveForms}));var a=function(e){var r=s.renderTasks.indexOf(u);r>=0&&s.renderTasks.splice(r,1),t.cleanupAfterRender&&(t.pendingCleanup=!0),t._tryCleanup(),e?u.capability.reject(e):u.capability.resolve(),n.timeEnd("Rendering"),n.timeEnd("Overall")},u=new j(a,e,this.objs,this.commonObjs,s.operatorList,this.pageNumber,i,o,this._pdfBug);u.useRequestAnimationFrame="print"!==r,s.renderTasks||(s.renderTasks=[]),s.renderTasks.push(u);var h=u.task;return s.displayReadyCapability.promise.then((function(e){t.pendingCleanup?a():(n.time("Rendering"),u.initializeGraphics(e),u.operatorListChanged())})).catch(a),h},getOperatorList:function(){this.intentStates.oplist||(this.intentStates.oplist=Object.create(null));var e,t=this.intentStates.oplist;return t.opListReadCapability||((e={}).operatorListChanged=function(){if(t.operatorList.lastChunk){t.opListReadCapability.resolve(t.operatorList);var n=t.renderTasks.indexOf(e);n>=0&&t.renderTasks.splice(n,1)}},t.receivingOperatorList=!0,t.opListReadCapability=(0,l.createPromiseCapability)(),t.renderTasks=[],t.renderTasks.push(e),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats.time("Page Request"),this.transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:"oplist"})),t.opListReadCapability.promise},streamTextContent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=100;return this.transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:!0===e.normalizeWhitespace,combineTextItems:!0!==e.disableCombineTextItems},{highWaterMark:t,size:function(e){return e.items.length}})},getTextContent:function(e){e=e||{};var t=this.streamTextContent(e);return new Promise((function(e,n){var r=t.getReader(),i={items:[],styles:Object.create(null)};!function t(){r.read().then((function(n){var r,o=n.value;n.done?e(i):(Object.assign(i.styles,o.styles),(r=i.items).push.apply(r,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o.items)),t())}),n)}()}))},_destroy:function(){this.destroyed=!0,this.transport.pageCache[this.pageIndex]=null;var e=[];return Object.keys(this.intentStates).forEach((function(t){"oplist"!==t&&this.intentStates[t].renderTasks.forEach((function(t){var n=t.capability.promise.catch((function(){}));e.push(n),t.cancel()}))}),this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)},cleanup:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup=!0,this._tryCleanup(e)},_tryCleanup:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup&&!Object.keys(this.intentStates).some((function(e){var t=this.intentStates[e];return 0!==t.renderTasks.length||t.receivingOperatorList}),this)&&(Object.keys(this.intentStates).forEach((function(e){delete this.intentStates[e]}),this),this.objs.clear(),this.annotationsPromise=null,e&&this._stats instanceof c.StatTimer&&(this._stats=new c.StatTimer),this.pendingCleanup=!1)},_startRenderPage:function(e,t){var n=this.intentStates[t];n.displayReadyCapability&&n.displayReadyCapability.resolve(e)},_renderPageChunk:function(e,t){var n,r,i=this.intentStates[t];for(n=0,r=e.length;n<r;n++)i.operatorList.fnArray.push(e.fnArray[n]),i.operatorList.argsArray.push(e.argsArray[n]);for(i.operatorList.lastChunk=e.lastChunk,n=0;n<i.renderTasks.length;n++)i.renderTasks[n].operatorListChanged();e.lastChunk&&(i.receivingOperatorList=!1,this._tryCleanup())},get stats(){return this._stats instanceof c.StatTimer?this._stats:null}},e}(),P=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];w(this,e),this._listeners=[],this._defer=t,this._deferred=Promise.resolve(void 0)}return s(e,[{key:"postMessage",value:function(e,t){var n=this;if(this._defer){var r=new WeakMap,i={data:function e(n){if("object"!==(void 0===n?"undefined":a(n))||null===n)return n;if(r.has(n))return r.get(n);var i,o;if((o=n.buffer)&&(0,l.isArrayBuffer)(o)){var s=t&&t.includes(o);return i=n===o?n:s?new n.constructor(o,n.byteOffset,n.byteLength):new n.constructor(n),r.set(n,i),i}for(var c in i=Array.isArray(n)?[]:{},r.set(n,i),n){for(var u,h=n;!(u=Object.getOwnPropertyDescriptor(h,c));)h=Object.getPrototypeOf(h);void 0!==u.value&&"function"!=typeof u.value&&(i[c]=e(u.value))}return i}(e)};this._deferred.then((function(){n._listeners.forEach((function(e){e.call(this,i)}),n)}))}else this._listeners.forEach((function(t){t.call(this,{data:e})}),this)}},{key:"addEventListener",value:function(e,t){this._listeners.push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)}},{key:"terminate",value:function(){this._listeners=[]}}]),e}(),O=function(){var e=0;function t(){if(g.GlobalWorkerOptions.workerSrc)return g.GlobalWorkerOptions.workerSrc;if(void 0!==S)return S;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function n(){try{if("undefined"!=typeof window)return window.pdfjsWorker&&window.pdfjsWorker.WorkerMessageHandler}catch(e){}return null}var r=void 0,i=new WeakMap;function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=void 0===t?null:t,r=e.port,o=void 0===r?null:r,s=e.postMessageTransfers,a=void 0===s||s,c=e.verbosity,u=void 0===c?(0,l.getVerbosityLevel)():c;if(o&&i.has(o))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=n,this.destroyed=!1,this.postMessageTransfers=!1!==a,this.verbosity=u,this._readyCapability=(0,l.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,o)return i.set(o,this),void this._initializeFromPort(o);this._initialize()}return o.prototype={get promise(){return this._readyCapability.promise},get port(){return this._port},get messageHandler(){return this._messageHandler},_initializeFromPort:function(e){this._port=e,this._messageHandler=new m.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()},_initialize:function(){var e,r,i=this;if("undefined"!=typeof Worker&&!C&&!n()){var o=t();try{(0,l.isSameOrigin)(window.location.href,o)||(e=new l.URL(o,window.location).href,r="importScripts('"+e+"');",o=l.URL.createObjectURL(new Blob([r])));var s=new Worker(o),a=new m.MessageHandler("main","worker",s),c=function(){s.removeEventListener("error",u),a.destroy(),s.terminate(),i.destroyed?i._readyCapability.reject(new Error("Worker was destroyed")):i._setupFakeWorker()},u=function(){i._webWorker||c()};s.addEventListener("error",u),a.on("test",(function(e){s.removeEventListener("error",u),i.destroyed?c():e&&e.supportTypedArray?(i._messageHandler=a,i._port=s,i._webWorker=s,e.supportTransfers||(i.postMessageTransfers=!1),i._readyCapability.resolve(),a.send("configure",{verbosity:i.verbosity})):(i._setupFakeWorker(),a.destroy(),s.terminate())})),a.on("ready",(function(e){if(s.removeEventListener("error",u),i.destroyed)c();else try{h()}catch(e){i._setupFakeWorker()}}));var h=function(){var e=new Uint8Array([i.postMessageTransfers?255:0]);try{a.send("test",e,[e.buffer])}catch(t){(0,l.info)("Cannot use postMessage transfers"),e[0]=0,a.send("test",e)}};return void h()}catch(e){(0,l.info)("The worker has been disabled.")}}this._setupFakeWorker()},_setupFakeWorker:function(){var i=this;C||((0,l.warn)("Setting up fake worker."),C=!0),function(){if(r)return r.promise;r=(0,l.createPromiseCapability)();var e=n();return e?(r.resolve(e),r.promise):((k||function(){return(0,c.loadScript)(t()).then((function(){return window.pdfjsWorker.WorkerMessageHandler}))})().then(r.resolve,r.reject),r.promise)}().then((function(t){if(i.destroyed)i._readyCapability.reject(new Error("Worker was destroyed"));else{var n=new P;i._port=n;var r="fake"+e++,o=new m.MessageHandler(r+"_worker",r,n);t.setup(o,n);var s=new m.MessageHandler(r,r+"_worker",n);i._messageHandler=s,i._readyCapability.resolve()}})).catch((function(e){i._readyCapability.reject(new Error('Setting up fake worker failed: "'+e.message+'".'))}))},destroy:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),i.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},o.fromPort=function(e){if(!e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return i.has(e.port)?i.get(e.port):new o(e)},o.getWorkerSrc=function(){return t()},o}(),D=function(){function e(t,n,r,i){w(this,e),this.messageHandler=t,this.loadingTask=n,this.commonObjs=new I,this.fontLoader=new u.FontLoader(n.docId),this._params=i,this.CMapReaderFactory=new i.CMapReaderFactory({baseUrl:i.cMapUrl,isCompressed:i.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,l.createPromiseCapability)(),this.setupMessageHandler()}return s(e,[{key:"destroy",value:function(){var e=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,l.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach((function(e){e&&t.push(e._destroy())})),this.pageCache=[],this.pagePromises=[];var n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then((function(){e.fontLoader.clear(),e._networkStream&&e._networkStream.cancelAllRequests(),e.messageHandler&&(e.messageHandler.destroy(),e.messageHandler=null),e.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var e=this.messageHandler,t=this.loadingTask;e.on("GetReader",(function(e,t){var n=this;(0,l.assert)(this._networkStream),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=function(e){n._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=function(){n._fullReader.read().then((function(e){var n=e.value;e.done?t.close():((0,l.assert)((0,l.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))})).catch((function(e){t.error(e)}))},t.onCancel=function(e){n._fullReader.cancel(e)}}),this),e.on("ReaderHeadersReady",(function(e){var n=this,r=(0,l.createPromiseCapability)(),i=this._fullReader;return i.headersReady.then((function(){i.isStreamingSupported&&i.isRangeSupported||(n._lastProgress&&t.onProgress&&t.onProgress(n._lastProgress),i.onProgress=function(e){t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),r.resolve({isStreamingSupported:i.isStreamingSupported,isRangeSupported:i.isRangeSupported,contentLength:i.contentLength})}),r.reject),r.promise}),this),e.on("GetRangeReader",(function(e,t){(0,l.assert)(this._networkStream);var n=this._networkStream.getRangeReader(e.begin,e.end);t.onPull=function(){n.read().then((function(e){var n=e.value;e.done?t.close():((0,l.assert)((0,l.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))})).catch((function(e){t.error(e)}))},t.onCancel=function(e){n.cancel(e)}}),this),e.on("GetDoc",(function(e){var n=e.pdfInfo;this.numPages=n.numPages,this.pdfDocument=new M(n,this,t),t._capability.resolve(this.pdfDocument)}),this),e.on("PasswordRequest",(function(e){var n=this;if(this._passwordCapability=(0,l.createPromiseCapability)(),t.onPassword)try{t.onPassword((function(e){n._passwordCapability.resolve({password:e})}),e.code)}catch(e){this._passwordCapability.reject(e)}else this._passwordCapability.reject(new l.PasswordException(e.message,e.code));return this._passwordCapability.promise}),this),e.on("PasswordException",(function(e){t._capability.reject(new l.PasswordException(e.message,e.code))}),this),e.on("InvalidPDF",(function(e){t._capability.reject(new l.InvalidPDFException(e.message))}),this),e.on("MissingPDF",(function(e){t._capability.reject(new l.MissingPDFException(e.message))}),this),e.on("UnexpectedResponse",(function(e){t._capability.reject(new l.UnexpectedResponseException(e.message,e.status))}),this),e.on("UnknownError",(function(e){t._capability.reject(new l.UnknownErrorException(e.message,e.details))}),this),e.on("DataLoaded",(function(e){t.onProgress&&t.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),this),e.on("StartRenderPage",(function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex];t._stats.timeEnd("Page Request"),t._startRenderPage(e.transparency,e.intent)}}),this),e.on("RenderPageChunk",(function(e){this.destroyed||this.pageCache[e.pageIndex]._renderPageChunk(e.operatorList,e.intent)}),this),e.on("commonobj",(function(e){var t=this;if(!this.destroyed){var n=o(e,3),r=n[0],i=n[1],s=n[2];if(!this.commonObjs.hasData(r))switch(i){case"Font":var a=this._params;if("error"in s){var c=s.error;(0,l.warn)("Error during font loading: "+c),this.commonObjs.resolve(r,c);break}var h=null;a.pdfBug&&p.default.FontInspector&&p.default.FontInspector.enabled&&(h={registerFont:function(e,t){p.default.FontInspector.fontAdded(e,t)}});var d=new u.FontFaceObject(s,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:h});this.fontLoader.bind([d],(function(e){t.commonObjs.resolve(r,d)}));break;case"FontPath":this.commonObjs.resolve(r,s);break;default:throw new Error("Got unknown common object type "+i)}}}),this),e.on("obj",(function(e){if(!this.destroyed){var t=o(e,4),n=t[0],r=t[1],i=t[2],s=t[3],a=this.pageCache[r];if(!a.objs.hasData(n))switch(i){case"JpegStream":return new Promise((function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t(new Error("Error during JPEG image loading"))},n.src=s})).then((function(e){a.objs.resolve(n,e)}));case"Image":a.objs.resolve(n,s),s&&"data"in s&&s.data.length>8e6&&(a.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type "+i)}}}),this),e.on("DocProgress",(function(e){this.destroyed||t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),this),e.on("PageError",(function(e){if(!this.destroyed){var t=this.pageCache[e.pageNum-1].intentStates[e.intent];if(!t.displayReadyCapability)throw new Error(e.error);if(t.displayReadyCapability.reject(e.error),t.operatorList){t.operatorList.lastChunk=!0;for(var n=0;n<t.renderTasks.length;n++)t.renderTasks[n].operatorListChanged()}}}),this),e.on("UnsupportedFeature",this._onUnsupportedFeature,this),e.on("JpegDecode",(function(e){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));if("undefined"==typeof document)return Promise.reject(new Error('"document" is not defined.'));var t=o(e,2),n=t[0],r=t[1];return 3!==r&&1!==r?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise((function(e,t){var i=new Image;i.onload=function(){var t=i.width,n=i.height,o=t*n,s=4*o,a=new Uint8ClampedArray(o*r),l=document.createElement("canvas");l.width=t,l.height=n;var c=l.getContext("2d");c.drawImage(i,0,0);var u=c.getImageData(0,0,t,n).data;if(3===r)for(var h=0,d=0;h<s;h+=4,d+=3)a[d]=u[h],a[d+1]=u[h+1],a[d+2]=u[h+2];else if(1===r)for(var f=0,p=0;f<s;f+=4,p++)a[p]=u[f];e({data:a,width:t,height:n})},i.onerror=function(){t(new Error("JpegDecode failed to load image"))},i.src=n}))}),this),e.on("FetchBuiltInCMap",(function(e){return this.destroyed?Promise.reject(new Error("Worker was destroyed")):this.CMapReaderFactory.fetch({name:e.name})}),this)}},{key:"_onUnsupportedFeature",value:function(e){var t=e.featureId;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(e){var t=this;if(!Number.isInteger(e)||e<=0||e>this.numPages)return Promise.reject(new Error("Invalid page request"));var n=e-1;if(n in this.pagePromises)return this.pagePromises[n];var r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then((function(e){if(t.destroyed)throw new Error("Transport destroyed");var r=new L(n,e,t,t._params.pdfBug);return t.pageCache[n]=r,r}));return this.pagePromises[n]=r,r}},{key:"getPageIndex",value:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch((function(e){return Promise.reject(new Error(e))}))}},{key:"getAnnotations",value:function(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var e=this;return this.messageHandler.sendWithPromise("GetMetadata",null).then((function(t){return{info:t[0],metadata:t[1]?new v.Metadata(t[1]):null,contentDispositionFilename:e._fullReader?e._fullReader.filename:null}}))}},{key:"getStats",value:function(){return this.messageHandler.sendWithPromise("GetStats",null)}},{key:"startCleanup",value:function(){var e=this;this.messageHandler.sendWithPromise("Cleanup",null).then((function(){for(var t=0,n=e.pageCache.length;t<n;t++){var r=e.pageCache[t];r&&r.cleanup()}e.commonObjs.clear(),e.fontLoader.clear()}))}},{key:"loadingParams",get:function(){var e=this._params;return(0,l.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableCreateObjectURL:e.disableCreateObjectURL,disableFontFace:e.disableFontFace,nativeImageDecoderSupport:e.nativeImageDecoderSupport})}}]),e}(),I=function(){function e(){this.objs=Object.create(null)}return e.prototype={ensureObj:function(e){if(this.objs[e])return this.objs[e];var t={capability:(0,l.createPromiseCapability)(),data:null,resolved:!1};return this.objs[e]=t,t},get:function(e,t){if(t)return this.ensureObj(e).capability.promise.then(t),null;var n=this.objs[e];if(!n||!n.resolved)throw new Error("Requesting object that isn't resolved yet "+e);return n.data},resolve:function(e,t){var n=this.ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)},isResolved:function(e){var t=this.objs;return!!t[e]&&t[e].resolved},hasData:function(e){return this.isResolved(e)},getData:function(e){var t=this.objs;return t[e]&&t[e].resolved?t[e].data:null},clear:function(){this.objs=Object.create(null)}},e}(),F=function(){function e(e){this._internalRenderTask=e,this.onContinue=null}return e.prototype={get promise(){return this._internalRenderTask.capability.promise},cancel:function(){this._internalRenderTask.cancel()},then:function(e,t){return this.promise.then.apply(this.promise,arguments)}},e}(),j=function(){var e=new WeakMap;function t(e,t,n,r,i,o,s,a){var c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.operatorListIdx=null,this.operatorList=i,this.pageNumber=o,this.canvasFactory=s,this.webGLContext=a,this._pdfBug=c,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this.useRequestAnimationFrame=!1,this.cancelled=!1,this.capability=(0,l.createPromiseCapability)(),this.task=new F(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}return t.prototype={initializeGraphics:function(t){if(!this.cancelled){if(this._canvas){if(e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");e.set(this._canvas,this)}this._pdfBug&&p.default.StepperManager&&p.default.StepperManager.enabled&&(this.stepper=p.default.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var n=this.params;this.gfx=new d.CanvasGraphics(n.canvasContext,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,n.imageLayer),this.gfx.beginDrawing({transform:n.transform,viewport:n.viewport,transparency:t,background:n.background}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}},cancel:function(){this.running=!1,this.cancelled=!0,this._canvas&&e.delete(this._canvas),this.callback(new c.RenderingCancelledException("Rendering cancelled, page "+this.pageNumber,"canvas"))},operatorListChanged:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)},_continue:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())},_scheduleNext:function(){var e=this;this.useRequestAnimationFrame&&"undefined"!=typeof window?window.requestAnimationFrame((function(){e._nextBound().catch(e.callback)})):Promise.resolve().then(this._nextBound).catch(this.callback)},_next:function(){var t=this;return new Promise((function(){t.cancelled||(t.operatorListIdx=t.gfx.executeOperatorList(t.operatorList,t.operatorListIdx,t._continueBound,t.stepper),t.operatorListIdx===t.operatorList.argsArray.length&&(t.running=!1,t.operatorList.lastChunk&&(t.gfx.endDrawing(),t._canvas&&e.delete(t._canvas),t.callback())))}))}},t}();t.version="2.0.943",t.build="dc98bf76",t.getDocument=function(e){var t,n=new E;if("string"==typeof e)t={url:e};else if((0,l.isArrayBuffer)(e))t={data:e};else if(e instanceof R)t={range:e};else{if("object"!==(void 0===e?"undefined":a(e)))throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=e}var r=Object.create(null),i=null,o=null;for(var s in t)if("url"!==s||"undefined"==typeof window)if("range"!==s)if("worker"!==s)if("data"!==s||t[s]instanceof Uint8Array)r[s]=t[s];else{var u=t[s];if("string"==typeof u)r[s]=(0,l.stringToBytes)(u);else if("object"!==(void 0===u?"undefined":a(u))||null===u||isNaN(u.length)){if(!(0,l.isArrayBuffer)(u))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");r[s]=new Uint8Array(u)}else r[s]=new Uint8Array(u)}else o=t[s];else i=t[s];else r[s]=new l.URL(t[s],window.location).href;r.rangeChunkSize=r.rangeChunkSize||_,r.CMapReaderFactory=r.CMapReaderFactory||c.DOMCMapReaderFactory,r.ignoreErrors=!0!==r.stopAtErrors,r.pdfBug=!0===r.pdfBug;var d=Object.values(l.NativeImageDecoding);if(void 0!==r.nativeImageDecoderSupport&&d.includes(r.nativeImageDecoderSupport)||(r.nativeImageDecoderSupport=h.apiCompatibilityParams.nativeImageDecoderSupport||l.NativeImageDecoding.DECODE),Number.isInteger(r.maxImageSize)||(r.maxImageSize=-1),"boolean"!=typeof r.isEvalSupported&&(r.isEvalSupported=!0),"boolean"!=typeof r.disableFontFace&&(r.disableFontFace=h.apiCompatibilityParams.disableFontFace||!1),"boolean"!=typeof r.disableRange&&(r.disableRange=!1),"boolean"!=typeof r.disableStream&&(r.disableStream=!1),"boolean"!=typeof r.disableAutoFetch&&(r.disableAutoFetch=!1),"boolean"!=typeof r.disableCreateObjectURL&&(r.disableCreateObjectURL=h.apiCompatibilityParams.disableCreateObjectURL||!1),(0,l.setVerbosityLevel)(r.verbosity),!o){var f={postMessageTransfers:r.postMessageTransfers,verbosity:r.verbosity},p=g.GlobalWorkerOptions.workerPort;p?(f.port=p,o=O.fromPort(f)):o=new O(f),n._worker=o}var v=n.docId;return o.promise.then((function(){if(n.destroyed)throw new Error("Loading aborted");return function(e,t,n,r){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(n&&(t.length=n.length,t.initialData=n.initialData),e.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"2.0.943",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,disableCreateObjectURL:t.disableCreateObjectURL,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,nativeImageDecoderSupport:t.nativeImageDecoderSupport,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported}).then((function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t})))}(o,r,i,v).then((function(e){if(n.destroyed)throw new Error("Loading aborted");var t=void 0;i?t=new y.PDFDataTransportStream({length:r.length,initialData:r.initialData,disableRange:r.disableRange,disableStream:r.disableStream},i):r.data||(t=x({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream}));var s=new m.MessageHandler(v,e,o.port);s.postMessageTransfers=o.postMessageTransfers;var a=new D(s,n,t,r);n._transport=a,s.send("Ready",null)}))})).catch(n._capability.reject),n},t.LoopbackPort=P,t.PDFDataRangeTransport=R,t.PDFWorker=O,t.PDFDocumentProxy=M,t.PDFPageProxy=L,t.setPDFNetworkStreamFactory=function(e){x=e},t.version="2.0.943",t.build="dc98bf76"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=t.DummyStatTimer=t.StatTimer=t.DOMSVGFactory=t.DOMCMapReaderFactory=t.DOMCanvasFactory=t.DEFAULT_LINK_REL=t.LinkTarget=t.getFilenameFromUrl=t.addLinkAttributes=t.RenderingCancelledException=t.PageViewport=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s="noopener noreferrer nofollow",a="http://www.w3.org/2000/svg",l=function(){function e(){o(this,e)}return r(e,[{key:"create",value:function(e,t){if(e<=0||t<=0)throw new Error("invalid canvas size");var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=e,n.height=t,{canvas:n,context:r}}},{key:"reset",value:function(e,t,n){if(!e.canvas)throw new Error("canvas is not specified");if(t<=0||n<=0)throw new Error("invalid canvas size");e.canvas.width=t,e.canvas.height=n}},{key:"destroy",value:function(e){if(!e.canvas)throw new Error("canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}]),e}(),c=function(){function e(t){var n=t.baseUrl,r=void 0===n?null:n,i=t.isCompressed,s=void 0!==i&&i;o(this,e),this.baseUrl=r,this.isCompressed=s}return r(e,[{key:"fetch",value:function(e){var t=this,n=e.name;return this.baseUrl?n?new Promise((function(e,r){var o=t.baseUrl+n+(t.isCompressed?".bcmap":""),s=new XMLHttpRequest;s.open("GET",o,!0),t.isCompressed&&(s.responseType="arraybuffer"),s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE){if(200===s.status||0===s.status){var n=void 0;if(t.isCompressed&&s.response?n=new Uint8Array(s.response):!t.isCompressed&&s.responseText&&(n=(0,i.stringToBytes)(s.responseText)),n)return void e({cMapData:n,compressionType:t.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE})}r(new Error("Unable to load "+(t.isCompressed?"binary ":"")+"CMap at: "+o))}},s.send(null)})):Promise.reject(new Error("CMap name must be specified.")):Promise.reject(new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.'))}}]),e}(),u=function(){function e(){o(this,e)}return r(e,[{key:"create",value:function(e,t){(0,i.assert)(e>0&&t>0,"Invalid SVG dimensions");var n=document.createElementNS(a,"svg:svg");return n.setAttribute("version","1.1"),n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+e+" "+t),n}},{key:"createElement",value:function(e){return(0,i.assert)("string"==typeof e,"Invalid SVG element type"),document.createElementNS(a,e)}}]),e}(),h=function(){function e(t){var n=t.viewBox,r=t.scale,i=t.rotation,s=t.offsetX,a=void 0===s?0:s,l=t.offsetY,c=void 0===l?0:l,u=t.dontFlip,h=void 0!==u&&u;o(this,e),this.viewBox=n,this.scale=r,this.rotation=i,this.offsetX=a,this.offsetY=c;var d=(n[2]+n[0])/2,f=(n[3]+n[1])/2,p=void 0,g=void 0,m=void 0,v=void 0;switch(i=(i%=360)<0?i+360:i){case 180:p=-1,g=0,m=0,v=1;break;case 90:p=0,g=1,m=1,v=0;break;case 270:p=0,g=-1,m=-1,v=0;break;default:p=1,g=0,m=0,v=-1}h&&(m=-m,v=-v);var y=void 0,b=void 0,w=void 0,_=void 0;0===p?(y=Math.abs(f-n[1])*r+a,b=Math.abs(d-n[0])*r+c,w=Math.abs(n[3]-n[1])*r,_=Math.abs(n[2]-n[0])*r):(y=Math.abs(d-n[0])*r+a,b=Math.abs(f-n[1])*r+c,w=Math.abs(n[2]-n[0])*r,_=Math.abs(n[3]-n[1])*r),this.transform=[p*r,g*r,m*r,v*r,y-p*r*d-m*r*f,b-g*r*d-v*r*f],this.width=w,this.height=_}return r(e,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,r=void 0===n?this.scale:n,i=t.rotation,o=void 0===i?this.rotation:i,s=t.dontFlip,a=void 0!==s&&s;return new e({viewBox:this.viewBox.slice(),scale:r,rotation:o,offsetX:this.offsetX,offsetY:this.offsetY,dontFlip:a})}},{key:"convertToViewportPoint",value:function(e,t){return i.Util.applyTransform([e,t],this.transform)}},{key:"convertToViewportRectangle",value:function(e){var t=i.Util.applyTransform([e[0],e[1]],this.transform),n=i.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}},{key:"convertToPdfPoint",value:function(e,t){return i.Util.applyInverseTransform([e,t],this.transform)}}]),e}(),d=function(){function e(e,t){this.message=e,this.type=t}return e.prototype=new Error,e.prototype.name="RenderingCancelledException",e.constructor=e,e}(),f={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4},p=["","_self","_blank","_parent","_top"],g=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];o(this,e),this.enabled=!!t,this.started=Object.create(null),this.times=[]}return r(e,[{key:"time",value:function(e){this.enabled&&(e in this.started&&(0,i.warn)("Timer is already running for "+e),this.started[e]=Date.now())}},{key:"timeEnd",value:function(e){this.enabled&&(e in this.started||(0,i.warn)("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e])}},{key:"toString",value:function(){for(var e=this.times,t="",n=0,r=0,i=e.length;r<i;++r){var o=e[r].name;o.length>n&&(n=o.length)}for(var s=0,a=e.length;s<a;++s){var l=e[s],c=l.end-l.start;t+=l.name.padEnd(n)+" "+c+"ms\n"}return t}}]),e}(),m=function(){function e(){o(this,e),(0,i.unreachable)("Cannot initialize DummyStatTimer.")}return r(e,null,[{key:"time",value:function(e){}},{key:"timeEnd",value:function(e){}},{key:"toString",value:function(){return""}}]),e}();t.PageViewport=h,t.RenderingCancelledException=d,t.addLinkAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,r=t.target,o=t.rel;if(e.href=e.title=n?(0,i.removeNullCharacters)(n):"",n){var a=Object.values(f).includes(r)?r:f.NONE;e.target=p[a],e.rel="string"==typeof o?o:s}},t.getFilenameFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("?"),r=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",r)+1,r)},t.LinkTarget=f,t.DEFAULT_LINK_REL=s,t.DOMCanvasFactory=l,t.DOMCMapReaderFactory=c,t.DOMSVGFactory=u,t.StatTimer=g,t.DummyStatTimer=m,t.loadScript=function(e){return new Promise((function(t,n){var r=document.createElement("script");r.src=e,r.onload=t,r.onerror=function(){n(new Error("Cannot load script at: "+r.src))},(document.head||document.documentElement).appendChild(r)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1);function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s,a=function(){function e(t){o(this,e),this.constructor===e&&(0,i.unreachable)("Cannot initialize BaseFontLoader."),this.docId=t,this.nativeFontFaces=[],this.styleElement=null,this.loadingContext={requests:[],nextRequestId:0}}return r(e,[{key:"addNativeFontFace",value:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)}},{key:"insertRule",value:function(e){var t=this.styleElement;t||((t=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_"+this.docId,document.documentElement.getElementsByTagName("head")[0].appendChild(t));var n=t.sheet;n.insertRule(e,n.cssRules.length)}},{key:"clear",value:function(){this.nativeFontFaces.forEach((function(e){document.fonts.delete(e)})),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:function(e,t){var n=[],r=[],o=[],s=function(e){return e.loaded.catch((function(t){(0,i.warn)('Failed to load font "'+e.family+'": '+t)}))},a=!0,l=!1,c=void 0;try{for(var u,h=e[Symbol.iterator]();!(a=(u=h.next()).done);a=!0){var d=u.value;if(!d.attached&&!d.missingFile)if(d.attached=!0,this.isFontLoadingAPISupported){var f=d.createNativeFontFace();f&&(this.addNativeFontFace(f),o.push(s(f)))}else{var p=d.createFontFaceRule();p&&(this.insertRule(p),n.push(p),r.push(d))}}}catch(e){l=!0,c=e}finally{try{!a&&h.return&&h.return()}finally{if(l)throw c}}var g=this._queueLoadingCallback(t);this.isFontLoadingAPISupported?Promise.all(o).then(g.complete):n.length>0&&!this.isSyncFontLoadingSupported?this._prepareFontLoadEvent(n,r,g):g.complete()}},{key:"_queueLoadingCallback",value:function(e){var t=this.loadingContext,n={id:"pdfjs-font-loading-"+t.nextRequestId++,done:!1,complete:function(){for((0,i.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.requests.length>0&&t.requests[0].done;){var e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(n),n}},{key:"_prepareFontLoadEvent",value:function(e,t,n){(0,i.unreachable)("Abstract method `_prepareFontLoadEvent`.")}},{key:"isFontLoadingAPISupported",get:function(){(0,i.unreachable)("Abstract method `isFontLoadingAPISupported`.")}},{key:"isSyncFontLoadingSupported",get:function(){(0,i.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,i.unreachable)("Abstract method `_loadTestFont`.")}}]),e}();t.FontLoader=s=function(e){function t(e){o(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadTestFontId=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"_prepareFontLoadEvent",value:function(e,t,n){function r(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function o(e,t,n,r){return e.substring(0,t)+r+e.substring(t+n)}var s=void 0,a=void 0,l=document.createElement("canvas");l.width=1,l.height=1;var c=l.getContext("2d"),u=0,h="lt"+Date.now()+this.loadTestFontId++,d=this._loadTestFont,f=r(d=o(d,976,h.length,h),16);for(s=0,a=h.length-3;s<a;s+=4)f=f-1482184792+r(h,s)|0;s<h.length&&(f=f-1482184792+r(h+"XXX",s)|0),d=o(d,16,4,(0,i.string32)(f));var p='@font-face {font-family:"'+h+'";src:url(data:font/opentype;base64,'+btoa(d)+");}";this.insertRule(p);var g=[];for(s=0,a=t.length;s<a;s++)g.push(t[s].loadedName);g.push(h);var m=document.createElement("div");for(m.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),s=0,a=g.length;s<a;++s){var v=document.createElement("span");v.textContent="Hi",v.style.fontFamily=g[s],m.appendChild(v)}document.body.appendChild(m),function e(t,n){if(++u>30)return(0,i.warn)("Load test font never loaded."),void n();c.font="30px "+t,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(h,(function(){document.body.removeChild(m),n.complete()}))}},{key:"isFontLoadingAPISupported",get:function(){var e="undefined"!=typeof document&&!!document.fonts;if(e&&"undefined"!=typeof navigator){var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]<63&&(e=!1)}return(0,i.shadow)(this,"isFontLoadingAPISupported",e)}},{key:"isSyncFontLoadingSupported",get:function(){var e=!1;if("undefined"==typeof navigator)e=!0;else{var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,i.shadow)(this,"isSyncFontLoadingSupported",e)}},{key:"_loadTestFont",get:function(){return(0,i.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}}]),t}(a);var l={get value(){return(0,i.shadow)(this,"value",(0,i.isEvalSupported)())}},c=function(){function e(t,n){var r=n.isEvalSupported,i=void 0===r||r,s=n.disableFontFace,a=void 0!==s&&s,l=n.ignoreErrors,c=void 0!==l&&l,u=n.onUnsupportedFeature,h=void 0===u?null:u,d=n.fontRegistry,f=void 0===d?null:d;for(var p in o(this,e),this.compiledGlyphs=Object.create(null),t)this[p]=t[p];this.isEvalSupported=!1!==i,this.disableFontFace=!0===a,this.ignoreErrors=!0===c,this._onUnsupportedFeature=h,this.fontRegistry=f}return r(e,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var e=(0,i.bytesToString)(new Uint8Array(this.data)),t="url(data:"+this.mimetype+";base64,"+btoa(e)+");",n='@font-face {font-family:"'+this.loadedName+'";src:'+t+"}";return this.fontRegistry&&this.fontRegistry.registerFont(this,t),n}},{key:"getPathGenerator",value:function(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];var n=void 0,r=void 0;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.font}),(0,i.warn)('getPathGenerator - ignoring character: "'+e+'".'),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&l.value){for(var o=void 0,s="",a=0,c=n.length;a<c;a++)o=void 0!==(r=n[a]).args?r.args.join(","):"",s+="c."+r.cmd+"("+o+");\n";return this.compiledGlyphs[t]=new Function("c","size",s)}return this.compiledGlyphs[t]=function(e,t){for(var i=0,o=n.length;i<o;i++)"scale"===(r=n[i]).cmd&&(r.args=[t,-t]),e[r.cmd].apply(e,r.args)}}}]),e}();t.FontFaceObject=c,t.FontLoader=s},function(e,t,n){"use strict";var r=Object.create(null),i=n(4),o="undefined"!=typeof navigator&&navigator.userAgent||"",s=/Trident/.test(o),a=/CriOS/.test(o);(s||a)&&(r.disableCreateObjectURL=!0),i()&&(r.disableFontFace=!0,r.nativeImageDecoderSupport="none"),t.apiCompatibilityParams=Object.freeze(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var r=n(1),i=n(134),o=16,s={get value(){return(0,r.shadow)(s,"value",(0,r.isLittleEndian)())}};function a(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=t*i-n*r,l=n*r-t*i;return[i/a,n/l,r/l,t/a,(i*o-r*s)/l,(n*o-t*s)/a]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,r,i,o,s){var a=this._transformMatrix;this._transformMatrix=[a[0]*t+a[2]*n,a[1]*t+a[3]*n,a[0]*r+a[2]*i,a[1]*r+a[3]*i,a[0]*o+a[2]*s+a[4],a[1]*o+a[3]*s+a[5]],e._originalTransform(t,n,r,i,o,s)},e.setTransform=function(t,n,r,i,o,s){this._transformMatrix=[t,n,r,i,o,s],e._originalSetTransform(t,n,r,i,o,s)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this._transformMatrix;this._transformMatrix=[r[0]*t+r[2]*n,r[1]*t+r[3]*n,r[0]*-n+r[2]*t,r[1]*-n+r[3]*t,r[4],r[5]],this._originalRotate(e)})}var l=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,r){var i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n),i.context.setTransform(1,0,0,1,0,0)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),r&&a(i.context),i},clear:function(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}(),c=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),u=function(){function e(e,t,n,r,i,o){this.ctx=e,this.current=new c,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.webGLContext=i,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new l(this.canvasFactory),e&&a(e),this._cachedGetSinglePixelWidth=null}function t(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)e.putImageData(t,0,0);else{var n,i,a,l,c,u=t.height,h=t.width,d=u%o,f=(u-d)/o,p=0===d?f:f+1,g=e.createImageData(h,o),m=0,v=t.data,y=g.data;if(t.kind===r.ImageKind.GRAYSCALE_1BPP){var b=v.byteLength,w=new Uint32Array(y.buffer,0,y.byteLength>>2),_=w.length,C=h+7>>3,S=4294967295,k=s.value?4278190080:255;for(i=0;i<p;i++){for(l=i<f?o:d,n=0,a=0;a<l;a++){for(var A=b-m,x=0,$=A>C?h:8*A-7,T=-8&$,E=0,R=0;x<T;x+=8)R=v[m++],w[n++]=128&R?S:k,w[n++]=64&R?S:k,w[n++]=32&R?S:k,w[n++]=16&R?S:k,w[n++]=8&R?S:k,w[n++]=4&R?S:k,w[n++]=2&R?S:k,w[n++]=1&R?S:k;for(;x<$;x++)0===E&&(R=v[m++],E=128),w[n++]=R&E?S:k,E>>=1}for(;n<_;)w[n++]=0;e.putImageData(g,0,i*o)}}else if(t.kind===r.ImageKind.RGBA_32BPP){for(a=0,c=h*o*4,i=0;i<f;i++)y.set(v.subarray(m,m+c)),m+=c,e.putImageData(g,0,a),a+=o;i<p&&(c=h*d*4,y.set(v.subarray(m,m+c)),e.putImageData(g,0,a))}else{if(t.kind!==r.ImageKind.RGB_24BPP)throw new Error("bad image kind: "+t.kind);for(c=h*(l=o),i=0;i<p;i++){for(i>=f&&(c=h*(l=d)),n=0,a=c;a--;)y[n++]=v[m++],y[n++]=v[m++],y[n++]=v[m++],y[n++]=255;e.putImageData(g,0,i*o)}}}}function n(e,t){for(var n=t.height,r=t.width,i=n%o,s=(n-i)/o,a=0===i?s:s+1,l=e.createImageData(r,o),c=0,u=t.data,h=l.data,d=0;d<a;d++){for(var f=d<s?o:i,p=3,g=0;g<f;g++)for(var m=0,v=0;v<r;v++){if(!m){var y=u[c++];m=128}h[p]=y&m?0:255,p+=4,m>>=1}e.putImageData(l,0,d*o)}}function u(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],r=0,i=n.length;r<i;r++){var o=n[r];void 0!==e[o]&&(t[o]=e[o])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function h(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function d(e,t,n,r){for(var i=e.length,o=3;o<i;o+=4){var s=e[o];if(0===s)e[o-3]=t,e[o-2]=n,e[o-1]=r;else if(s<255){var a=255-s;e[o-3]=e[o-3]*s+t*a>>8,e[o-2]=e[o-2]*s+n*a>>8,e[o-1]=e[o-1]*s+r*a>>8}}}function f(e,t,n){for(var r=e.length,i=3;i<r;i+=4){var o=n?n[e[i]]:e[i];t[i]=t[i]*o*(1/255)|0}}function p(e,t,n){for(var r=e.length,i=3;i<r;i+=4){var o=77*e[i-3]+152*e[i-2]+28*e[i-1];t[i]=n?t[i]*n[o>>8]>>8:t[i]*o>>16}}function g(e,t,n,r){var i=t.canvas,o=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var s=t.backdrop||null;if(!t.transferMap&&r.isEnabled){var a=r.composeSMask({layer:n.canvas,mask:i,properties:{subtype:t.subtype,backdrop:s}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(a,t.offsetX,t.offsetY)}!function(e,t,n,r,i,o,s){var a,l=!!o,c=l?o[0]:0,u=l?o[1]:0,h=l?o[2]:0;a="Luminosity"===i?p:f;for(var g=Math.min(r,Math.ceil(1048576/n)),m=0;m<r;m+=g){var v=Math.min(g,r-m),y=e.getImageData(0,m,n,v),b=t.getImageData(0,m,n,v);l&&d(y.data,c,u,h),a(y.data,b.data,s),e.putImageData(b,0,m)}}(o,n,i.width,i.height,t.subtype,s,t.transferMap),e.drawImage(i,0,0)}var m=["butt","round","square"],v=["miter","round","bevel"],y={},b={};for(var w in e.prototype={beginDrawing:function(e){var t=e.transform,n=e.viewport,r=e.transparency,i=e.background,o=void 0===i?null:i,s=this.ctx.canvas.width,a=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=o||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,s,a),this.ctx.restore(),r){var l=this.cachedCanvases.getCanvas("transparent",s,a,!0);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),h(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,n.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,i){var o=e.argsArray,s=e.fnArray,a=t||0,l=o.length;if(l===a)return a;for(var c,u=l-a>10&&"function"==typeof n,h=u?Date.now()+15:0,d=0,f=this.commonObjs,p=this.objs;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,n),a;if((c=s[a])!==r.OPS.dependency)this[c].apply(this,o[a]);else for(var g=o[a],m=0,v=g.length;m<v;m++){var y=g[m],b="g"===y[0]&&"_"===y[1]?f:p;if(!b.isResolved(y))return b.get(y,n),a}if(++a===l)return a;if(u&&++d>10){if(Date.now()>h)return n(),a;d=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=m[e]},setLineJoin:function(e){this.ctx.lineJoin=v[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)},setRenderingIntent:function(e){},setFlatness:function(e){},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i=r[0],o=r[1];switch(i){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=r[1];break;case"ca":this.current.fillAlpha=r[1],this.ctx.globalAlpha=r[1];break;case"BM":this.ctx.globalCompositeOperation=o;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,n,!0),o=this.ctx,s=o.mozCurrentTransform;this.ctx.save();var a=i.context;a.scale(1/e.scaleX,1/e.scaleY),a.translate(-e.offsetX,-e.offsetY),a.transform.apply(a,s),e.startTransformInverse=a.mozCurrentTransformInverse,u(o,a),this.ctx=a,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),g(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),u(e,this.ctx),this.current.resumeSMaskCtx=e;var t=r.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),g(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),u(e,this.ctx);var t=r.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,n,r,i,o){this.ctx.transform(e,t,n,r,i,o),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,i=this.current,o=i.x,s=i.y,a=0,l=0,c=e.length;a<c;a++)switch(0|e[a]){case r.OPS.rectangle:o=t[l++],s=t[l++];var u=t[l++],h=t[l++];0===u&&(u=this.getSinglePixelWidth()),0===h&&(h=this.getSinglePixelWidth());var d=o+u,f=s+h;this.ctx.moveTo(o,s),this.ctx.lineTo(d,s),this.ctx.lineTo(d,f),this.ctx.lineTo(o,f),this.ctx.lineTo(o,s),this.ctx.closePath();break;case r.OPS.moveTo:o=t[l++],s=t[l++],n.moveTo(o,s);break;case r.OPS.lineTo:o=t[l++],s=t[l++],n.lineTo(o,s);break;case r.OPS.curveTo:o=t[l+4],s=t[l+5],n.bezierCurveTo(t[l],t[l+1],t[l+2],t[l+3],o,s),l+=6;break;case r.OPS.curveTo2:n.bezierCurveTo(o,s,t[l],t[l+1],t[l+2],t[l+3]),o=t[l+2],s=t[l+3],l+=4;break;case r.OPS.curveTo3:o=t[l+2],s=t[l+3],n.bezierCurveTo(t[l],t[l+1],o,s,o,s),l+=4;break;case r.OPS.closePath:n.closePath()}i.setCurrentPoint(o,s)},closePath:function(){this.ctx.closePath()},stroke:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.strokeColor;t.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth),t.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type?(t.save(),t.strokeStyle=n.getPattern(t,this),t.stroke(),t.restore()):t.stroke(),e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.fillColor,r=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),r=!0),this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill(),r&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=y},eoClip:function(){this.pendingClip=b},beginText:function(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var n=0;n<e.length;n++){var r=e[n];t.setTransform.apply(t,r.transform),t.translate(r.x,r.y),r.addToPath(t,r.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),i=this.current;if(!n)throw new Error("Can't find font for "+e);if(i.fontMatrix=n.fontMatrix?n.fontMatrix:r.FONT_IDENTITY_MATRIX,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,r.warn)("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,!n.isType3Font){var o=n.loadedName||"sans-serif",s=n.black?"900":n.bold?"bold":"normal",a=n.italic?"italic":"normal",l='"'+o+'", '+n.fallbackName,c=t<16?16:t>100?100:t;this.current.fontSizeScale=t/c;var u=a+" "+s+" "+c+"px "+l;this.ctx.font=u}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,r,i,o){this.current.textMatrix=[e,t,n,r,i,o],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,n,i){var o,s=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,h=c&r.TextRenderingMode.FILL_STROKE_MASK,d=!!(c&r.TextRenderingMode.ADD_TO_PATH_FLAG),f=a.patternFill&&l.data;(l.disableFontFace||d||f)&&(o=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||f?(s.save(),s.translate(t,n),s.beginPath(),o(s,u),i&&s.setTransform.apply(s,i),h!==r.TextRenderingMode.FILL&&h!==r.TextRenderingMode.FILL_STROKE||s.fill(),h!==r.TextRenderingMode.STROKE&&h!==r.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(h!==r.TextRenderingMode.FILL&&h!==r.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n),h!==r.TextRenderingMode.STROKE&&h!==r.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n)),d&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:s.mozCurrentTransform,x:t,y:n,fontSize:u,addToPath:o})},get isFontSubpixelAAEnabled(){var e=this.canvasFactory.create(10,10).context;e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);var i=t.fontSize;if(0!==i){var o=this.ctx,s=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,h=e.length,d=n.vertical,f=d?1:-1,p=n.defaultVMetrics,g=i*t.fontMatrix[0],m=t.textRenderingMode===r.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;o.save();var v=void 0;if(t.patternFill){o.save();var y=t.fillColor.getPattern(o,this);v=o.mozCurrentTransform,o.restore(),o.fillStyle=y}o.transform.apply(o,t.textMatrix),o.translate(t.x,t.y+t.textRise),c>0?o.scale(u,-1):o.scale(u,1);var b=t.lineWidth,w=t.textMatrixScale;if(0===w||0===b){var _=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;_!==r.TextRenderingMode.STROKE&&_!==r.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,b=.65*this.getSinglePixelWidth())}else b/=w;1!==s&&(o.scale(s,s),b/=s),o.lineWidth=b;var C,S=0;for(C=0;C<h;++C){var k=e[C];if((0,r.isNum)(k))S+=f*k*i/1e3;else{var A,x,$,T,E,R,M,L=!1,P=(k.isSpace?l:0)+a,O=k.fontChar,D=k.accent,I=k.width;if(d?(E=k.vmetric||p,R=-(R=k.vmetric?E[1]:.5*I)*g,M=E[2]*g,I=E?-E[0]:I,A=R/s,x=(S+M)/s):(A=S/s,x=0),n.remeasure&&I>0){var F=1e3*o.measureText(O).width/i*s;if(I<F&&this.isFontSubpixelAAEnabled){var j=I/F;L=!0,o.save(),o.scale(j,1),A/=j}else I!==F&&(A+=(I-F)/2e3*i/s)}(k.isInFont||n.missingFile)&&(m&&!D?o.fillText(O,A,x):(this.paintChar(O,A,x,v),D&&($=A+D.offset.x/s,T=x-D.offset.y/s,this.paintChar(D.fontChar,$,T,v)))),S+=I*g+P*c,L&&o.restore()}}d?t.y-=S*u:t.x+=S*u,o.restore()}},showType3Text:function(e){var t,n,i,o,s=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,h=l.vertical?1:-1,d=a.charSpacing,f=a.wordSpacing,p=a.textHScale*u,g=a.fontMatrix||r.FONT_IDENTITY_MATRIX,m=e.length;if(a.textRenderingMode!==r.TextRenderingMode.INVISIBLE&&0!==c){for(this._cachedGetSinglePixelWidth=null,s.save(),s.transform.apply(s,a.textMatrix),s.translate(a.x,a.y),s.scale(p,u),t=0;t<m;++t)if(n=e[t],(0,r.isNum)(n))o=h*n*c/1e3,this.ctx.translate(o,0),a.x+=o*p;else{var v=(n.isSpace?f:0)+d,y=l.charProcOperatorList[n.operatorListId];y?(this.processingType3=n,this.save(),s.scale(c,c),s.transform.apply(s,g),this.executeOperatorList(y),this.restore(),i=r.Util.applyTransform([n.width,0],g)[0]*c+v,s.translate(i,0),a.x+=i*p):(0,r.warn)('Type3 character "'+n.operatorListId+'" is not available.')}s.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,n,r,i,o){this.ctx.rect(n,r,i-n,o-r),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n,r=this;if("TilingPattern"===t[0]){var o=t[1],s=this.baseTransform||this.ctx.mozCurrentTransform.slice(),a={createCanvasGraphics:function(t){return new e(t,r.commonObjs,r.objs,r.canvasFactory,r.webGLContext)}};n=new i.TilingPattern(t,o,this.ctx,a,s)}else n=(0,i.getShadingPatternFromIR)(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var i=r.Util.makeCssRgb(e,t,n);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(e,t,n){var i=r.Util.makeCssRgb(e,t,n);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var n=(0,i.getShadingPatternFromIR)(e);t.fillStyle=n.getPattern(t,this,!0);var o=t.mozCurrentTransformInverse;if(o){var s=t.canvas,a=s.width,l=s.height,c=r.Util.applyTransform([0,0],o),u=r.Util.applyTransform([0,l],o),h=r.Util.applyTransform([a,0],o),d=r.Util.applyTransform([a,l],o),f=Math.min(c[0],u[0],h[0],d[0]),p=Math.min(c[1],u[1],h[1],d[1]),g=Math.max(c[0],u[0],h[0],d[0]),m=Math.max(c[1],u[1],h[1],d[1]);this.ctx.fillRect(f,p,g-f,m-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,r.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,r.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,Array.isArray(t)&&4===t.length){var n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(e){this.save();var t=this.ctx;e.isolated||(0,r.info)("TODO: Support non-isolated groups."),e.knockout&&(0,r.warn)("Knockout groups not supported.");var n=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var i=r.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),o=[0,0,t.canvas.width,t.canvas.height];i=r.Util.intersect(i,o)||[0,0,0,0];var s=Math.floor(i[0]),a=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-s,1),c=Math.max(Math.ceil(i[3])-a,1),h=1,d=1;l>4096&&(h=l/4096,l=4096),c>4096&&(d=c/4096,c=4096);var f="groupAt"+this.groupLevel;e.smask&&(f+="_smask_"+this.smaskCounter++%2);var p=this.cachedCanvases.getCanvas(f,l,c,!0),g=p.context;g.scale(1/h,1/d),g.translate(-s,-a),g.transform.apply(g,n),e.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:s,offsetY:a,scaleX:h,scaleY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(s,a),t.scale(h,d)),u(t,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),h(this.ctx),this.current=new c,Array.isArray(e)&&4===e.length){var r=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],r,i),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,t,n){var i=this.objs.get(e);if(i){this.save();var o=this.ctx;if(o.scale(1/t,-1/n),o.drawImage(i,0,0,i.width,i.height,0,-n,t,n),this.imageLayer){var s=o.mozCurrentTransformInverse,a=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:a[0],top:a[1],width:t/s[0],height:n/s[3]})}this.restore()}else(0,r.warn)("Dependent image isn't ready yet")},paintImageMaskXObject:function(e){var t=this.ctx,r=e.width,i=e.height,o=this.current.fillColor,s=this.current.patternFill,a=this.processingType3;if(a&&void 0===a.compiled&&(a.compiled=r<=1e3&&i<=1e3?function(e){var t,n,r,i,o=e.width,s=e.height,a=o+1,l=new Uint8Array(a*(s+1)),c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),u=o+7&-8,h=e.data,d=new Uint8Array(u*s),f=0;for(t=0,i=h.length;t<i;t++)for(var p=128,g=h[t];p>0;)d[f++]=g&p?0:255,p>>=1;var m=0;for(0!==d[f=0]&&(l[0]=1,++m),n=1;n<o;n++)d[f]!==d[f+1]&&(l[n]=d[f]?2:1,++m),f++;for(0!==d[f]&&(l[n]=2,++m),t=1;t<s;t++){r=t*a,d[(f=t*u)-u]!==d[f]&&(l[r]=d[f]?1:8,++m);var v=(d[f]?4:0)+(d[f-u]?8:0);for(n=1;n<o;n++)c[v=(v>>2)+(d[f+1]?4:0)+(d[f-u+1]?8:0)]&&(l[r+n]=c[v],++m),f++;if(d[f-u]!==d[f]&&(l[r+n]=d[f]?2:4,++m),m>1e3)return null}for(r=t*a,0!==d[f=u*(s-1)]&&(l[r]=8,++m),n=1;n<o;n++)d[f]!==d[f+1]&&(l[r+n]=d[f]?4:8,++m),f++;if(0!==d[f]&&(l[r+n]=4,++m),m>1e3)return null;var y=new Int32Array([0,a,-1,0,-a,0,0,0,1]),b=[];for(t=0;m&&t<=s;t++){for(var w=t*a,_=w+o;w<_&&!l[w];)w++;if(w!==_){var C,S=[w%a,t],k=l[w],A=w;do{var x=y[k];do{w+=x}while(!l[w]);5!==(C=l[w])&&10!==C?(k=C,l[w]=0):(k=C&51*k>>4,l[w]&=k>>2|k<<2),S.push(w%a),S.push(w/a|0),--m}while(A!==w);b.push(S),--t}}return function(e){e.save(),e.scale(1/o,-1/s),e.translate(0,-s),e.beginPath();for(var t=0,n=b.length;t<n;t++){var r=b[t];e.moveTo(r[0],r[1]);for(var i=2,a=r.length;i<a;i+=2)e.lineTo(r[i],r[i+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:r,height:i}):null),a&&a.compiled)a.compiled(t);else{var l=this.cachedCanvases.getCanvas("maskCanvas",r,i),c=l.context;c.save(),n(c,e),c.globalCompositeOperation="source-in",c.fillStyle=s?o.getPattern(c,this):o,c.fillRect(0,0,r,i),c.restore(),this.paintInlineImageXObject(l.canvas)}},paintImageMaskXObjectRepeat:function(e,t,r,i){var o=e.width,s=e.height,a=this.current.fillColor,l=this.current.patternFill,c=this.cachedCanvases.getCanvas("maskCanvas",o,s),u=c.context;u.save(),n(u,e),u.globalCompositeOperation="source-in",u.fillStyle=l?a.getPattern(u,this):a,u.fillRect(0,0,o,s),u.restore();for(var h=this.ctx,d=0,f=i.length;d<f;d+=2)h.save(),h.transform(t,0,0,r,i[d],i[d+1]),h.scale(1,-1),h.drawImage(c.canvas,0,0,o,s,0,-1,1,1),h.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,r=this.current.fillColor,i=this.current.patternFill,o=0,s=e.length;o<s;o++){var a=e[o],l=a.width,c=a.height,u=this.cachedCanvases.getCanvas("maskCanvas",l,c),h=u.context;h.save(),n(h,a),h.globalCompositeOperation="source-in",h.fillStyle=i?r.getPattern(h,this):r,h.fillRect(0,0,l,c),h.restore(),t.save(),t.transform.apply(t,a.transform),t.scale(1,-1),t.drawImage(u.canvas,0,0,l,c,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,r.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,i){var o=this.objs.get(e);if(o){for(var s=o.width,a=o.height,l=[],c=0,u=i.length;c<u;c+=2)l.push({transform:[t,0,0,n,i[c],i[c+1]],x:0,y:0,w:s,h:a});this.paintInlineImageXObjectGroup(o,l)}else(0,r.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){var n=e.width,r=e.height,i=this.ctx;this.save(),i.scale(1/n,-1/r);var o,s,a=i.mozCurrentTransformInverse,l=a[0],c=a[1],u=Math.max(Math.sqrt(l*l+c*c),1),h=a[2],d=a[3],f=Math.max(Math.sqrt(h*h+d*d),1);if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)o=e;else{var p=(s=this.cachedCanvases.getCanvas("inlineImage",n,r)).context;t(p,e),o=s.canvas}for(var g=n,m=r,v="prescale1";u>2&&g>1||f>2&&m>1;){var y=g,b=m;u>2&&g>1&&(u/=g/(y=Math.ceil(g/2))),f>2&&m>1&&(f/=m/(b=Math.ceil(m/2))),(p=(s=this.cachedCanvases.getCanvas(v,y,b)).context).clearRect(0,0,y,b),p.drawImage(o,0,0,g,m,0,0,y,b),o=s.canvas,g=y,m=b,v="prescale1"===v?"prescale2":"prescale1"}if(i.drawImage(o,0,0,g,m,0,-r,n,r),this.imageLayer){var w=this.getCanvasPosition(0,-r);this.imageLayer.appendImage({imgData:e,left:w[0],top:w[1],width:n/a[0],height:r/a[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,n){var r=this.ctx,i=e.width,o=e.height,s=this.cachedCanvases.getCanvas("inlineImage",i,o);t(s.context,e);for(var a=0,l=n.length;a<l;a++){var c=n[a];if(r.save(),r.transform.apply(r,c.transform),r.scale(1,-1),r.drawImage(s.canvas,c.x,c.y,c.w,c.h,0,-1,1,1),this.imageLayer){var u=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:e,left:u[0],top:u[1],width:i,height:o})}r.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){(0,r.warn)("Unsupported 'paintXObject' command.")},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){},beginMarkedContentProps:function(e,t){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===b?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth:function(e){if(null===this._cachedGetSinglePixelWidth){var t=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1],t[2]*t[2]+t[3]*t[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]}},r.OPS)e.prototype[r.OPS[w]]=e.prototype[w];return e}();t.CanvasGraphics=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.getShadingPatternFromIR=void 0;var r=n(1),i={RadialAxial:{fromIR:function(e){var t=e[1],n=e[2],r=e[3],i=e[4],o=e[5],s=e[6];return{type:"Pattern",getPattern:function(e){var a;"axial"===t?a=e.createLinearGradient(r[0],r[1],i[0],i[1]):"radial"===t&&(a=e.createRadialGradient(r[0],r[1],o,i[0],i[1],s));for(var l=0,c=n.length;l<c;++l){var u=n[l];a.addColorStop(u[0],u[1])}return a}}}}},o=function(){function e(e,t,n,r,i,o,s,a){var l,c=t.coords,u=t.colors,h=e.data,d=4*e.width;c[n+1]>c[r+1]&&(l=n,n=r,r=l,l=o,o=s,s=l),c[r+1]>c[i+1]&&(l=r,r=i,i=l,l=s,s=a,a=l),c[n+1]>c[r+1]&&(l=n,n=r,r=l,l=o,o=s,s=l);var f=(c[n]+t.offsetX)*t.scaleX,p=(c[n+1]+t.offsetY)*t.scaleY,g=(c[r]+t.offsetX)*t.scaleX,m=(c[r+1]+t.offsetY)*t.scaleY,v=(c[i]+t.offsetX)*t.scaleX,y=(c[i+1]+t.offsetY)*t.scaleY;if(!(p>=y))for(var b,w,_,C,S,k,A,x,$,T=u[o],E=u[o+1],R=u[o+2],M=u[s],L=u[s+1],P=u[s+2],O=u[a],D=u[a+1],I=u[a+2],F=Math.round(p),j=Math.round(y),N=F;N<=j;N++){N<m?(b=f-(f-g)*($=N<p?0:p===m?1:(p-N)/(p-m)),w=T-(T-M)*$,_=E-(E-L)*$,C=R-(R-P)*$):(b=g-(g-v)*($=N>y?1:m===y?0:(m-N)/(m-y)),w=M-(M-O)*$,_=L-(L-D)*$,C=P-(P-I)*$),S=f-(f-v)*($=N<p?0:N>y?1:(p-N)/(p-y)),k=T-(T-O)*$,A=E-(E-D)*$,x=R-(R-I)*$;for(var B=Math.round(Math.min(b,S)),H=Math.round(Math.max(b,S)),z=d*N+4*B,W=B;W<=H;W++)$=($=(b-W)/(b-S))<0?0:$>1?1:$,h[z++]=w-(w-k)*$|0,h[z++]=_-(_-A)*$|0,h[z++]=C-(C-x)*$|0,h[z++]=255}}function t(t,n,r){var i,o,s=n.coords,a=n.colors;switch(n.type){case"lattice":var l=n.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(i=0;i<c;i++)for(var h=i*l,d=0;d<u;d++,h++)e(t,r,s[h],s[h+1],s[h+l],a[h],a[h+1],a[h+l]),e(t,r,s[h+l+1],s[h+1],s[h+l],a[h+l+1],a[h+1],a[h+l]);break;case"triangles":for(i=0,o=s.length;i<o;i+=3)e(t,r,s[i],s[i+1],s[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}return function(e,n,r,i,o,s,a,l){var c,u,h,d,f=Math.floor(e[0]),p=Math.floor(e[1]),g=Math.ceil(e[2])-f,m=Math.ceil(e[3])-p,v=Math.min(Math.ceil(Math.abs(g*n[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(m*n[1]*1.1)),3e3),b=g/v,w=m/y,_={coords:r,colors:i,offsetX:-f,offsetY:-p,scaleX:1/b,scaleY:1/w},C=v+4,S=y+4;if(l.isEnabled)c=l.drawFigures({width:v,height:y,backgroundColor:s,figures:o,context:_}),(u=a.getCanvas("mesh",C,S,!1)).context.drawImage(c,2,2),c=u.canvas;else{var k=(u=a.getCanvas("mesh",C,S,!1)).context,A=k.createImageData(v,y);if(s){var x=A.data;for(h=0,d=x.length;h<d;h+=4)x[h]=s[0],x[h+1]=s[1],x[h+2]=s[2],x[h+3]=255}for(h=0;h<o.length;h++)t(A,o[h],_);k.putImageData(A,2,2),c=u.canvas}return{canvas:c,offsetX:f-2*b,offsetY:p-2*w,scaleX:b,scaleY:w}}}();i.Mesh={fromIR:function(e){var t=e[2],n=e[3],i=e[4],s=e[5],a=e[6],l=e[8];return{type:"Pattern",getPattern:function(e,c,u){var h;if(u)h=r.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(h=r.Util.singularValueDecompose2dScale(c.baseTransform),a){var d=r.Util.singularValueDecompose2dScale(a);h=[h[0]*d[0],h[1]*d[1]]}var f=o(s,h,t,n,i,u?null:l,c.cachedCanvases,c.webGLContext);return u||(e.setTransform.apply(e,c.baseTransform),a&&e.transform.apply(e,a)),e.translate(f.offsetX,f.offsetY),e.scale(f.scaleX,f.scaleY),e.createPattern(f.canvas,"no-repeat")}}}},i.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var s=function(){var e=1,t=2;function n(e,t,n,r,i){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=r,this.baseTransform=i,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(e){var t=this.operatorList,n=this.bbox,i=this.xstep,o=this.ystep,s=this.paintType,a=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+a);var u=n[0],h=n[1],d=n[2],f=n[3],p=[u,h],g=[u+i,h+o],m=g[0]-p[0],v=g[1]-p[1],y=r.Util.singularValueDecompose2dScale(this.matrix),b=r.Util.singularValueDecompose2dScale(this.baseTransform),w=[y[0]*b[0],y[1]*b[1]];m=Math.min(Math.ceil(Math.abs(m*w[0])),3e3),v=Math.min(Math.ceil(Math.abs(v*w[1])),3e3);var _=e.cachedCanvases.getCanvas("pattern",m,v,!0),C=_.context,S=c.createCanvasGraphics(C);S.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(S,s,l),this.setScale(m,v,i,o),this.transformToScale(S);var k=[1,0,0,1,-p[0],-p[1]];return S.transform.apply(S,k),this.clipBbox(S,n,u,h,d,f),S.executeOperatorList(t),_.canvas},setScale:function(e,t,n,r){this.scale=[e/n,t/r]},transformToScale:function(e){var t=this.scale,n=[t[0],0,0,t[1],0,0];e.transform.apply(e,n)},scaleToContext:function(){var e=this.scale;this.ctx.scale(1/e[0],1/e[1])},clipBbox:function(e,t,n,r,i,o){if(Array.isArray(t)&&4===t.length){var s=i-n,a=o-r;e.ctx.rect(n,r,s,a),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(n,i,o){var s=n.ctx,a=n.current;switch(i){case e:var l=this.ctx;s.fillStyle=l.fillStyle,s.strokeStyle=l.strokeStyle,a.fillColor=l.fillStyle,a.strokeColor=l.strokeStyle;break;case t:var c=r.Util.makeCssRgb(o[0],o[1],o[2]);s.fillStyle=c,s.strokeStyle=c,a.fillColor=c,a.strokeColor=c;break;default:throw new r.FormatError("Unsupported paint type: "+i)}},getPattern:function(e,t){var n=this.createPatternCanvas(t);return(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix),this.scaleToContext(),e.createPattern(n,"repeat")}},n}();t.getShadingPatternFromIR=function(e){var t=i[e[0]];if(!t)throw new Error("Unknown IR type: "+e[0]);return t.fromIR(e)},t.TilingPattern=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.create(null);r.workerPort=void 0===r.workerPort?null:r.workerPort,r.workerSrc=void 0===r.workerSrc?"":r.workerSrc,t.GlobalWorkerOptions=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var r,i,o=n(137),s=(r=o)&&r.__esModule?r:{default:r},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=(i=function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var s=t[i](o),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}}(s.default.mark((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",t.apply(r,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)}),c=n(1);function u(e){if("object"!==(void 0===e?"undefined":a(e)))return e;switch(e.name){case"AbortException":return new c.AbortException(e.message);case"MissingPDFException":return new c.MissingPDFException(e.message);case"UnexpectedResponseException":return new c.UnexpectedResponseException(e.message,e.status);default:return new c.UnknownErrorException(e.message,e.details)}}function h(e){return!(e instanceof Error)||e instanceof c.AbortException||e instanceof c.MissingPDFException||e instanceof c.UnexpectedResponseException||e instanceof c.UnknownErrorException?e:new c.UnknownErrorException(e.message,e.toString())}function d(e,t,n){t?e.resolve():e.reject(n)}function f(e,t,n){var r=this;this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null);var i=this.callbacksCapabilities=Object.create(null),o=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(e){var t=e.data;if(t.targetName===r.sourceName)if(t.stream)r._processStreamMessage(t);else if(t.isReply){var s=t.callbackId;if(!(t.callbackId in i))throw new Error("Cannot resolve callback "+s);var a=i[s];delete i[s],"error"in t?a.reject(u(t.error)):a.resolve(t.data)}else{if(!(t.action in o))throw new Error("Unknown action from worker: "+t.action);var l=o[t.action];if(t.callbackId){var c=r.sourceName,d=t.sourceName;Promise.resolve().then((function(){return l[0].call(l[1],t.data)})).then((function(e){n.postMessage({sourceName:c,targetName:d,isReply:!0,callbackId:t.callbackId,data:e})}),(function(e){n.postMessage({sourceName:c,targetName:d,isReply:!0,callbackId:t.callbackId,error:h(e)})}))}else t.streamId?r._createStreamSink(t):l[0].call(l[1],t.data)}},n.addEventListener("message",this._onComObjOnMessage)}f.prototype={on:function(e,t,n){var r=this.actionHandler;if(r[e])throw new Error('There is already an actionName called "'+e+'"');r[e]=[t,n]},send:function(e,t,n){var r={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t};this.postMessage(r,n)},sendWithPromise:function(e,t,n){var r=this.callbackId++,i={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t,callbackId:r},o=(0,c.createPromiseCapability)();this.callbacksCapabilities[r]=o;try{this.postMessage(i,n)}catch(e){o.reject(e)}return o.promise},sendWithStream:function(e,t,n,r){var i=this,o=this.streamId++,s=this.sourceName,a=this.targetName;return new c.ReadableStream({start:function(n){var r=(0,c.createPromiseCapability)();return i.streamControllers[o]={controller:n,startCall:r,isClosed:!1},i.postMessage({sourceName:s,targetName:a,action:e,streamId:o,data:t,desiredSize:n.desiredSize}),r.promise},pull:function(e){var t=(0,c.createPromiseCapability)();return i.streamControllers[o].pullCall=t,i.postMessage({sourceName:s,targetName:a,stream:"pull",streamId:o,desiredSize:e.desiredSize}),t.promise},cancel:function(e){var t=(0,c.createPromiseCapability)();return i.streamControllers[o].cancelCall=t,i.streamControllers[o].isClosed=!0,i.postMessage({sourceName:s,targetName:a,stream:"cancel",reason:e,streamId:o}),t.promise}},n)},_createStreamSink:function(e){var t=this,n=this,r=this.actionHandler[e.action],i=e.streamId,o=e.desiredSize,s=this.sourceName,a=e.sourceName,u=(0,c.createPromiseCapability)(),h=function(e){var n=e.stream,r=e.chunk,o=e.transfers,l=e.success,c=e.reason;t.postMessage({sourceName:s,targetName:a,stream:n,streamId:i,chunk:r,success:l,reason:c},o)},d={enqueue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2];if(!this.isCancelled){var r=this.desiredSize;this.desiredSize-=t,r>0&&this.desiredSize<=0&&(this.sinkCapability=(0,c.createPromiseCapability)(),this.ready=this.sinkCapability.promise),h({stream:"enqueue",chunk:e,transfers:n})}},close:function(){this.isCancelled||(this.isCancelled=!0,h({stream:"close"}),delete n.streamSinks[i])},error:function(e){this.isCancelled||(this.isCancelled=!0,h({stream:"error",reason:e}))},sinkCapability:u,onPull:null,onCancel:null,isCancelled:!1,desiredSize:o,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[i]=d,l(r[0],[e.data,d],r[1]).then((function(){h({stream:"start_complete",success:!0})}),(function(e){h({stream:"start_complete",success:!1,reason:e})}))},_processStreamMessage:function(e){var t=this,n=this.sourceName,r=e.sourceName,i=e.streamId,o=function(e){var o=e.stream,s=e.success,a=e.reason;t.comObj.postMessage({sourceName:n,targetName:r,stream:o,success:s,streamId:i,reason:a})},s=function(){Promise.all([t.streamControllers[e.streamId].startCall,t.streamControllers[e.streamId].pullCall,t.streamControllers[e.streamId].cancelCall].map((function(e){return e&&(t=e.promise,Promise.resolve(t).catch((function(){})));var t}))).then((function(){delete t.streamControllers[e.streamId]}))};switch(e.stream){case"start_complete":d(this.streamControllers[e.streamId].startCall,e.success,u(e.reason));break;case"pull_complete":d(this.streamControllers[e.streamId].pullCall,e.success,u(e.reason));break;case"pull":if(!this.streamSinks[e.streamId]){o({stream:"pull_complete",success:!0});break}this.streamSinks[e.streamId].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[e.streamId].sinkCapability.resolve(),this.streamSinks[e.streamId].desiredSize=e.desiredSize,l(this.streamSinks[e.streamId].onPull).then((function(){o({stream:"pull_complete",success:!0})}),(function(e){o({stream:"pull_complete",success:!1,reason:e})}));break;case"enqueue":(0,c.assert)(this.streamControllers[e.streamId],"enqueue should have stream controller"),this.streamControllers[e.streamId].isClosed||this.streamControllers[e.streamId].controller.enqueue(e.chunk);break;case"close":if((0,c.assert)(this.streamControllers[e.streamId],"close should have stream controller"),this.streamControllers[e.streamId].isClosed)break;this.streamControllers[e.streamId].isClosed=!0,this.streamControllers[e.streamId].controller.close(),s();break;case"error":(0,c.assert)(this.streamControllers[e.streamId],"error should have stream controller"),this.streamControllers[e.streamId].controller.error(u(e.reason)),s();break;case"cancel_complete":d(this.streamControllers[e.streamId].cancelCall,e.success,u(e.reason)),s();break;case"cancel":if(!this.streamSinks[e.streamId])break;l(this.streamSinks[e.streamId].onCancel,[u(e.reason)]).then((function(){o({stream:"cancel_complete",success:!0})}),(function(e){o({stream:"cancel_complete",success:!1,reason:e})})),this.streamSinks[e.streamId].sinkCapability.reject(u(e.reason)),this.streamSinks[e.streamId].isCancelled=!0,delete this.streamSinks[e.streamId];break;default:throw new Error("Unexpected stream case")}},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}},t.MessageHandler=f},function(e,t,n){"use strict";e.exports=n(138)},function(e,t,n){"use strict";var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,e.exports=n(139),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}},function(e,t,n){"use strict";(function(e){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n){var r,i=Object.prototype,o=i.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag",u="object"===t(e),h=n.regeneratorRuntime;if(h)u&&(e.exports=h);else{(h=n.regeneratorRuntime=u?e.exports:{}).wrap=_;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={},v={};v[a]=function(){return this};var y=Object.getPrototypeOf,b=y&&y(y(L([])));b&&b!==i&&o.call(b,a)&&(v=b);var w=A.prototype=S.prototype=Object.create(v);k.prototype=w.constructor=A,A.constructor=k,A[c]=k.displayName="GeneratorFunction",h.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},h.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,A):(e.__proto__=A,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(w),e},h.awrap=function(e){return{__await:e}},x($.prototype),$.prototype[l]=function(){return this},h.AsyncIterator=$,h.async=function(e,t,n,r){var i=new $(_(e,t,n,r));return h.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},x(w),w[c]="Generator",w[a]=function(){return this},w.toString=function(){return"[object Generator]"},h.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},h.values=L,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=r),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var l=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;R(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:L(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=r),m}}}function _(e,t,n,r){var i=t&&t.prototype instanceof S?t:S,o=Object.create(i.prototype),s=new M(r||[]);return o._invoke=function(e,t,n){var r=d;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=T(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var l=C(e,t,n);if("normal"===l.type){if(r=n.done?g:f,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=g,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function C(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function S(){}function k(){}function A(){}function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function $(e){var n;this._invoke=function(r,i){function s(){return new Promise((function(n,s){!function n(r,i,s,a){var l=C(e[r],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"===(void 0===u?"undefined":t(u))&&o.call(u,"__await")?Promise.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):Promise.resolve(u).then((function(e){c.value=e,s(c)}),a)}a(l.arg)}(r,i,n,s)}))}return n=n?n.then(s,s):s()}}function T(e,t){var n=e.iterator[t.method];if(n===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,T(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=C(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function L(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=r,t.done=!0,t};return i.next=i}}return{next:P}}function P(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())}).call(this,n(140)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=n(142),s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,i.assert)("string"==typeof t,"Metadata: input is not a string"),t=this._repair(t);var n=(new o.SimpleXMLParser).parseFromString(t);this._metadata=Object.create(null),n&&this._parse(n)}return r(e,[{key:"_repair",value:function(e){return e.replace(/>\\376\\377([^<]+)/g,(function(e,t){for(var n=t.replace(/\\([0-3])([0-7])([0-7])/g,(function(e,t,n,r){return String.fromCharCode(64*t+8*n+1*r)})).replace(/&(amp|apos|gt|lt|quot);/g,(function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error("_repair: "+t+" isn't defined.")})),r="",i=0,o=n.length;i<o;i+=2){var s=256*n.charCodeAt(i)+n.charCodeAt(i+1);r+=s>=32&&s<127&&60!==s&&62!==s&&38!==s?String.fromCharCode(s):"&#x"+(65536+s).toString(16).substring(1)+";"}return">"+r}))}},{key:"_parse",value:function(e){var t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var n=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===n&&t.hasChildNodes())for(var r=t.childNodes,i=0,o=r.length;i<o;i++){var s=r[i];if("rdf:description"===s.nodeName.toLowerCase())for(var a=0,l=s.childNodes.length;a<l;a++)if("#text"!==s.childNodes[a].nodeName.toLowerCase()){var c=s.childNodes[a],u=c.nodeName.toLowerCase();this._metadata[u]=c.textContent.trim()}}}},{key:"get",value:function(e){return this._metadata[e]||null}},{key:"getAll",value:function(){return this._metadata}},{key:"has",value:function(e){return void 0!==this._metadata[e]}}]),e}();t.Metadata=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function a(e,t){var n=e[t];return" "===n||"\n"===n||"\r"===n||"\t"===n}var l=function(){function e(){o(this,e)}return i(e,[{key:"_resolveEntities",value:function(e){return e.replace(/&([^;]+);/g,(function(e,t){if("#x"===t.substring(0,2))return String.fromCharCode(parseInt(t.substring(2),16));if("#"===t.substring(0,1))return String.fromCharCode(parseInt(t.substring(1),10));switch(t){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return this.onResolveEntity(t)}))}},{key:"_parseContent",value:function(e,t){var n,r=t,i=[];function o(){for(;r<e.length&&a(e,r);)++r}for(;r<e.length&&!a(e,r)&&">"!==e[r]&&"/"!==e[r];)++r;for(n=e.substring(t,r),o();r<e.length&&">"!==e[r]&&"/"!==e[r]&&"?"!==e[r];){o();for(var s,l="";r<e.length&&!a(e,r)&&"="!==e[r];)l+=e[r],++r;if(o(),"="!==e[r])return null;++r,o();var c=e[r];if('"'!==c&&"'"!==c)return null;var u=e.indexOf(c,++r);if(u<0)return null;s=e.substring(r,u),i.push({name:l,value:this._resolveEntities(s)}),r=u+1,o()}return{name:n,attributes:i,parsed:r-t}}},{key:"_parseProcessingInstruction",value:function(e,t){for(var n,r=t;r<e.length&&!a(e,r)&&">"!==e[r]&&"/"!==e[r];)++r;n=e.substring(t,r),function(){for(;r<e.length&&a(e,r);)++r}();for(var i=r;r<e.length&&("?"!==e[r]||">"!==e[r+1]);)++r;return{name:n,value:e.substring(i,r),parsed:r-t}}},{key:"parseXml",value:function(e){for(var t=0;t<e.length;){var n=t;if("<"===e[t]){var r=void 0;switch(e[++n]){case"/":if(++n,(r=e.indexOf(">",n))<0)return void this.onError(s.UnterminatedElement);this.onEndElement(e.substring(n,r)),n=r+1;break;case"?":++n;var i=this._parseProcessingInstruction(e,n);if("?>"!==e.substring(n+i.parsed,n+i.parsed+2))return void this.onError(s.UnterminatedXmlDeclaration);this.onPi(i.name,i.value),n+=i.parsed+2;break;case"!":if("--"===e.substring(n+1,n+3)){if((r=e.indexOf("--\x3e",n+3))<0)return void this.onError(s.UnterminatedComment);this.onComment(e.substring(n+3,r)),n=r+3}else if("[CDATA["===e.substring(n+1,n+8)){if((r=e.indexOf("]]>",n+8))<0)return void this.onError(s.UnterminatedCdat);this.onCdata(e.substring(n+8,r)),n=r+3}else{if("DOCTYPE"!==e.substring(n+1,n+8))return void this.onError(s.MalformedElement);var o=e.indexOf("[",n+8),a=!1;if((r=e.indexOf(">",n+8))<0)return void this.onError(s.UnterminatedDoctypeDeclaration);if(o>0&&r>o){if((r=e.indexOf("]>",n+8))<0)return void this.onError(s.UnterminatedDoctypeDeclaration);a=!0}var l=e.substring(n+8,r+(a?1:0));this.onDoctype(l),n=r+(a?2:1)}break;default:var c=this._parseContent(e,n);if(null===c)return void this.onError(s.MalformedElement);var u=!1;if("/>"===e.substring(n+c.parsed,n+c.parsed+2))u=!0;else if(">"!==e.substring(n+c.parsed,n+c.parsed+1))return void this.onError(s.UnterminatedElement);this.onBeginElement(c.name,c.attributes,u),n+=c.parsed+(u?2:1)}}else{for(;n<e.length&&"<"!==e[n];)n++;var h=e.substring(t,n);this.onText(this._resolveEntities(h))}t=n}}},{key:"onResolveEntity",value:function(e){return"&"+e+";"}},{key:"onPi",value:function(e,t){}},{key:"onComment",value:function(e){}},{key:"onCdata",value:function(e){}},{key:"onDoctype",value:function(e){}},{key:"onText",value:function(e){}},{key:"onBeginElement",value:function(e,t,n){}},{key:"onEndElement",value:function(e){}},{key:"onError",value:function(e){}}]),e}(),c=function(){function e(t,n){o(this,e),this.nodeName=t,this.nodeValue=n,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}return i(e,[{key:"hasChildNodes",value:function(){return this.childNodes&&this.childNodes.length>0}},{key:"firstChild",get:function(){return this.childNodes[0]}},{key:"nextSibling",get:function(){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]}},{key:"textContent",get:function(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}}]),e}(),u=function(e){function t(){o(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e._currentFragment=null,e._stack=null,e._errorCode=s.NoError,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"parseFromString",value:function(e){if(this._currentFragment=[],this._stack=[],this._errorCode=s.NoError,this.parseXml(e),this._errorCode===s.NoError){var t=r(this._currentFragment,1)[0];if(t)return{documentElement:t}}}},{key:"onResolveEntity",value:function(e){switch(e){case"apos":return"'"}return function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onResolveEntity",this).call(this,e)}},{key:"onText",value:function(e){if(!function(e){for(var t=0,n=e.length;t<n;t++)if(!a(e,t))return!1;return!0}(e)){var t=new c("#text",e);this._currentFragment.push(t)}}},{key:"onCdata",value:function(e){var t=new c("#text",e);this._currentFragment.push(t)}},{key:"onBeginElement",value:function(e,t,n){var r=new c(e);r.childNodes=[],this._currentFragment.push(r),n||(this._stack.push(this._currentFragment),this._currentFragment=r.childNodes)}},{key:"onEndElement",value:function(e){this._currentFragment=this._stack.pop();for(var t=this._currentFragment[this._currentFragment.length-1],n=0,r=t.childNodes.length;n<r;n++)t.childNodes[n].parentNode=t}},{key:"onError",value:function(e){this._errorCode=e}}]),t}(l);t.SimpleXMLParser=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var r,i=n(137),o=(r=i)&&r.__esModule?r:{default:r},s=n(1);function a(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var s=t[i](o),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}}var l=function(){function e(e,t){var n=this;(0,s.assert)(t),this._queuedChunks=[];var r=e.initialData;if(r&&r.length>0){var i=new Uint8Array(r).buffer;this._queuedChunks.push(i)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._contentLength=e.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((function(e,t){n._onReceiveData({begin:e,chunk:t})})),this._pdfDataRangeTransport.addProgressListener((function(e){n._onProgress({loaded:e})})),this._pdfDataRangeTransport.addProgressiveReadListener((function(e){n._onReceiveData({chunk:e})})),this._pdfDataRangeTransport.transportReady()}function t(e,t){this._stream=e,this._done=!1,this._filename=null,this._queuedChunks=t||[],this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}var n,r;function i(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}return e.prototype={_onReceiveData:function(e){var t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{var n=this._rangeReaders.some((function(n){return n._begin===e.begin&&(n._enqueue(t),!0)}));(0,s.assert)(n)}},_onProgress:function(e){if(this._rangeReaders.length>0){var t=this._rangeReaders[0];t.onProgress&&t.onProgress({loaded:e.loaded})}},_removeRangeReader:function(e){var t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)},getFullReader:function(){(0,s.assert)(!this._fullRequestReader);var e=this._queuedChunks;return this._queuedChunks=null,new t(this,e)},getRangeReader:function(e,t){var n=new i(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n},cancelAllRequests:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach((function(t){t.cancel(e)})),this._pdfDataRangeTransport.abort()}},t.prototype={_enqueue:function(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e))},get headersReady(){return this._headersReady},get filename(){return this._filename},get isRangeSupported(){return this._stream._isRangeSupported},get isStreamingSupported(){return this._stream._isStreamingSupported},get contentLength(){return this._stream._contentLength},read:(n=a(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._queuedChunks.length>0)){e.next=3;break}return t=this._queuedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 3:if(!this._done){e.next=5;break}return e.abrupt("return",{value:void 0,done:!0});case 5:return n=(0,s.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]}},i.prototype={_enqueue:function(e){this._done||(0===this._requests.length?this._queuedChunk=e:(this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))},get isStreamingSupported(){return!1},read:(r=a(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,s.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._stream._removeRangeReader(this)}},e}();t.PDFDataTransportStream=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),o=function(){function e(t){var n=t.enable,r=void 0!==n&&n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!0===r}return r(e,[{key:"composeSMask",value:function(e){var t=e.layer,n=e.mask,r=e.properties;return s.composeSMask(t,n,r)}},{key:"drawFigures",value:function(e){var t=e.width,n=e.height,r=e.backgroundColor,i=e.figures,o=e.context;return s.drawFigures(t,n,r,i,o)}},{key:"clear",value:function(){s.cleanup()}},{key:"isEnabled",get:function(){var e=this._enabled;return e&&(e=s.tryInitGL()),(0,i.shadow)(this,"isEnabled",e)}}]),e}(),s=function(){function e(e,t,n){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);throw new Error("Error during shader compilation: "+i)}return r}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function n(t,n){return e(t,n,t.FRAGMENT_SHADER)}function r(e,t){for(var n=e.createProgram(),r=0,i=t.length;r<i;++r)e.attachShader(n,t[r]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var o=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+o)}return n}function i(e,t,n){e.activeTexture(n);var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r}var o,s;function a(){o||(s=document.createElement("canvas"),o=s.getContext("webgl",{premultipliedalpha:!1}))}var l="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",c="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",u=null,h="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",d="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",f=null;return{tryInitGL:function(){try{return a(),!!o}catch(e){}return!1},composeSMask:function(e,h,d){var f=e.width,p=e.height;u||function(){var e,i;a(),e=s,s=null,i=o,o=null;var h=r(i,[t(i,l),n(i,c)]);i.useProgram(h);var d={};d.gl=i,d.canvas=e,d.resolutionLocation=i.getUniformLocation(h,"u_resolution"),d.positionLocation=i.getAttribLocation(h,"a_position"),d.backdropLocation=i.getUniformLocation(h,"u_backdrop"),d.subtypeLocation=i.getUniformLocation(h,"u_subtype");var f=i.getAttribLocation(h,"a_texCoord"),p=i.getUniformLocation(h,"u_image"),g=i.getUniformLocation(h,"u_mask"),m=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,m),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),i.STATIC_DRAW),i.enableVertexAttribArray(f),i.vertexAttribPointer(f,2,i.FLOAT,!1,0,0),i.uniform1i(p,0),i.uniform1i(g,1),u=d}();var g=u,m=g.canvas,v=g.gl;m.width=f,m.height=p,v.viewport(0,0,v.drawingBufferWidth,v.drawingBufferHeight),v.uniform2f(g.resolutionLocation,f,p),d.backdrop?v.uniform4f(g.resolutionLocation,d.backdrop[0],d.backdrop[1],d.backdrop[2],1):v.uniform4f(g.resolutionLocation,0,0,0,0),v.uniform1i(g.subtypeLocation,"Luminosity"===d.subtype?1:0);var y=i(v,e,v.TEXTURE0),b=i(v,h,v.TEXTURE1),w=v.createBuffer();return v.bindBuffer(v.ARRAY_BUFFER,w),v.bufferData(v.ARRAY_BUFFER,new Float32Array([0,0,f,0,0,p,0,p,f,0,f,p]),v.STATIC_DRAW),v.enableVertexAttribArray(g.positionLocation),v.vertexAttribPointer(g.positionLocation,2,v.FLOAT,!1,0,0),v.clearColor(0,0,0,0),v.enable(v.BLEND),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.clear(v.COLOR_BUFFER_BIT),v.drawArrays(v.TRIANGLES,0,6),v.flush(),v.deleteTexture(y),v.deleteTexture(b),v.deleteBuffer(w),m},drawFigures:function(e,i,l,c,u){f||function(){var e,i;a(),e=s,s=null,i=o,o=null;var l=r(i,[t(i,h),n(i,d)]);i.useProgram(l);var c={};c.gl=i,c.canvas=e,c.resolutionLocation=i.getUniformLocation(l,"u_resolution"),c.scaleLocation=i.getUniformLocation(l,"u_scale"),c.offsetLocation=i.getUniformLocation(l,"u_offset"),c.positionLocation=i.getAttribLocation(l,"a_position"),c.colorLocation=i.getAttribLocation(l,"a_color"),f=c}();var p=f,g=p.canvas,m=p.gl;g.width=e,g.height=i,m.viewport(0,0,m.drawingBufferWidth,m.drawingBufferHeight),m.uniform2f(p.resolutionLocation,e,i);var v,y,b,w=0;for(v=0,y=c.length;v<y;v++)switch(c[v].type){case"lattice":w+=((b=c[v].coords.length/c[v].verticesPerRow|0)-1)*(c[v].verticesPerRow-1)*6;break;case"triangles":w+=c[v].coords.length}var _=new Float32Array(2*w),C=new Uint8Array(3*w),S=u.coords,k=u.colors,A=0,x=0;for(v=0,y=c.length;v<y;v++){var $=c[v],T=$.coords,E=$.colors;switch($.type){case"lattice":var R=$.verticesPerRow;b=T.length/R|0;for(var M=1;M<b;M++)for(var L=M*R+1,P=1;P<R;P++,L++)_[A]=S[T[L-R-1]],_[A+1]=S[T[L-R-1]+1],_[A+2]=S[T[L-R]],_[A+3]=S[T[L-R]+1],_[A+4]=S[T[L-1]],_[A+5]=S[T[L-1]+1],C[x]=k[E[L-R-1]],C[x+1]=k[E[L-R-1]+1],C[x+2]=k[E[L-R-1]+2],C[x+3]=k[E[L-R]],C[x+4]=k[E[L-R]+1],C[x+5]=k[E[L-R]+2],C[x+6]=k[E[L-1]],C[x+7]=k[E[L-1]+1],C[x+8]=k[E[L-1]+2],_[A+6]=_[A+2],_[A+7]=_[A+3],_[A+8]=_[A+4],_[A+9]=_[A+5],_[A+10]=S[T[L]],_[A+11]=S[T[L]+1],C[x+9]=C[x+3],C[x+10]=C[x+4],C[x+11]=C[x+5],C[x+12]=C[x+6],C[x+13]=C[x+7],C[x+14]=C[x+8],C[x+15]=k[E[L]],C[x+16]=k[E[L]+1],C[x+17]=k[E[L]+2],A+=12,x+=18;break;case"triangles":for(var O=0,D=T.length;O<D;O++)_[A]=S[T[O]],_[A+1]=S[T[O]+1],C[x]=k[E[O]],C[x+1]=k[E[O]+1],C[x+2]=k[E[O]+2],A+=2,x+=3}}l?m.clearColor(l[0]/255,l[1]/255,l[2]/255,1):m.clearColor(0,0,0,0),m.clear(m.COLOR_BUFFER_BIT);var I=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,I),m.bufferData(m.ARRAY_BUFFER,_,m.STATIC_DRAW),m.enableVertexAttribArray(p.positionLocation),m.vertexAttribPointer(p.positionLocation,2,m.FLOAT,!1,0,0);var F=m.createBuffer();return m.bindBuffer(m.ARRAY_BUFFER,F),m.bufferData(m.ARRAY_BUFFER,C,m.STATIC_DRAW),m.enableVertexAttribArray(p.colorLocation),m.vertexAttribPointer(p.colorLocation,3,m.UNSIGNED_BYTE,!1,0,0),m.uniform2f(p.scaleLocation,u.scaleX,u.scaleY),m.uniform2f(p.offsetLocation,u.offsetX,u.offsetY),m.drawArrays(m.TRIANGLES,0,w),m.flush(),m.deleteBuffer(I),m.deleteBuffer(F),g},cleanup:function(){u&&u.canvas&&(u.canvas.width=0,u.canvas.height=0),f&&f.canvas&&(f.canvas.width=0,f.canvas.height=0),u=null,f=null}}}();t.WebGLContext=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var r,i=n(1),o=n(3),s=(r=o)&&r.__esModule?r:{default:r},a=function(){var e=1e5,t=/\S/,n=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];function r(e,r,o){var s,a=document.createElement("div"),l={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(e._textDivs.push(a),s=r.str,!t.test(s))return l.isWhitespace=!0,void e._textDivProperties.set(a,l);var c=i.Util.transform(e._viewport.transform,r.transform),u=Math.atan2(c[1],c[0]),h=o[r.fontName];h.vertical&&(u+=Math.PI/2);var d,f,p=Math.sqrt(c[2]*c[2]+c[3]*c[3]),g=p;if(h.ascent?g=h.ascent*g:h.descent&&(g=(1+h.descent)*g),0===u?(d=c[4],f=c[5]-g):(d=c[4]+g*Math.sin(u),f=c[5]-g*Math.cos(u)),n[1]=d,n[3]=f,n[5]=p,n[7]=h.fontFamily,l.style=n.join(""),a.setAttribute("style",l.style),a.textContent=r.str,e._fontInspectorEnabled&&(a.dataset.fontName=r.fontName),0!==u&&(l.angle=u*(180/Math.PI)),r.str.length>1&&(h.vertical?l.canvasWidth=r.height*e._viewport.scale:l.canvasWidth=r.width*e._viewport.scale),e._textDivProperties.set(a,l),e._textContentStream&&e._layoutText(a),e._enhanceTextSelection){var m=1,v=0;0!==u&&(m=Math.cos(u),v=Math.sin(u));var y,b,w=(h.vertical?r.height:r.width)*e._viewport.scale,_=p;0!==u?(y=[m,v,-v,m,d,f],b=i.Util.getAxialAlignedBoundingBox([0,0,w,_],y)):b=[d,f,d+w,f+_],e._bounds.push({left:b[0],top:b[1],right:b[2],bottom:b[3],div:a,size:[w,_],m:y})}}function o(t){if(!t._canceled){var n=t._textDivs,r=t._capability,i=n.length;if(i>e)return t._renderingDone=!0,void r.resolve();if(!t._textContentStream)for(var o=0;o<i;o++)t._layoutText(n[o]);t._renderingDone=!0,r.resolve()}}function a(e){for(var t=e._bounds,n=e._viewport,r=function(e,t,n){var r=n.map((function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}}));l(e,r);var i=new Array(n.length);return r.forEach((function(e){var t=e.index;i[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}})),n.map((function(t,n){var o=i[n],s=r[n];s.x1=t.top,s.y1=e-o.right,s.x2=t.bottom,s.y2=e-o.left,s.index=n,s.x1New=void 0,s.x2New=void 0})),l(t,r),r.forEach((function(e){var t=e.index;i[t].top=e.x1New,i[t].bottom=e.x2New})),i}(n.width,n.height,t),o=0;o<r.length;o++){var s=t[o].div,a=e._textDivProperties.get(s);if(0!==a.angle){var c=r[o],u=t[o],h=u.m,d=h[0],f=h[1],p=[[0,0],[0,u.size[1]],[u.size[0],0],u.size],g=new Float64Array(64);p.forEach((function(e,t){var n=i.Util.applyTransform(e,h);g[t+0]=d&&(c.left-n[0])/d,g[t+4]=f&&(c.top-n[1])/f,g[t+8]=d&&(c.right-n[0])/d,g[t+12]=f&&(c.bottom-n[1])/f,g[t+16]=f&&(c.left-n[0])/-f,g[t+20]=d&&(c.top-n[1])/d,g[t+24]=f&&(c.right-n[0])/-f,g[t+28]=d&&(c.bottom-n[1])/d,g[t+32]=d&&(c.left-n[0])/-d,g[t+36]=f&&(c.top-n[1])/-f,g[t+40]=d&&(c.right-n[0])/-d,g[t+44]=f&&(c.bottom-n[1])/-f,g[t+48]=f&&(c.left-n[0])/f,g[t+52]=d&&(c.top-n[1])/-d,g[t+56]=f&&(c.right-n[0])/f,g[t+60]=d&&(c.bottom-n[1])/-d}));var m=function(e,t,n){for(var r=0,i=0;i<n;i++){var o=e[t++];o>0&&(r=r?Math.min(o,r):o)}return r},v=1+Math.min(Math.abs(d),Math.abs(f));a.paddingLeft=m(g,32,16)/v,a.paddingTop=m(g,48,16)/v,a.paddingRight=m(g,0,16)/v,a.paddingBottom=m(g,16,16)/v,e._textDivProperties.set(s,a)}else a.paddingLeft=t[o].left-r[o].left,a.paddingTop=t[o].top-r[o].top,a.paddingRight=r[o].right-t[o].right,a.paddingBottom=r[o].bottom-t[o].bottom,e._textDivProperties.set(s,a)}}function l(e,t){t.sort((function(e,t){return e.x1-t.x1||e.index-t.index}));var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach((function(e){for(var t=0;t<n.length&&n[t].end<=e.y1;)t++;for(var r,i,o=n.length-1;o>=0&&n[o].start>=e.y2;)o--;var s,a,l=-1/0;for(s=t;s<=o;s++){var c;(c=(i=(r=n[s]).boundary).x2>e.x1?i.index>e.index?i.x1New:e.x1:void 0===i.x2New?(i.x2+e.x1)/2:i.x2New)>l&&(l=c)}for(e.x1New=l,s=t;s<=o;s++)void 0===(i=(r=n[s]).boundary).x2New?i.x2>e.x1?i.index>e.index&&(i.x2New=i.x2):i.x2New=l:i.x2New>l&&(i.x2New=Math.max(l,i.x2));var u=[],h=null;for(s=t;s<=o;s++){var d=(i=(r=n[s]).boundary).x2>e.x2?i:e;h===d?u[u.length-1].end=r.end:(u.push({start:r.start,end:r.end,boundary:d}),h=d)}for(n[t].start<e.y1&&(u[0].start=e.y1,u.unshift({start:n[t].start,end:e.y1,boundary:n[t].boundary})),e.y2<n[o].end&&(u[u.length-1].end=e.y2,u.push({start:e.y2,end:n[o].end,boundary:n[o].boundary})),s=t;s<=o;s++)if(void 0===(i=(r=n[s]).boundary).x2New){var f=!1;for(a=t-1;!f&&a>=0&&n[a].start>=i.y1;a--)f=n[a].boundary===i;for(a=o+1;!f&&a<n.length&&n[a].end<=i.y2;a++)f=n[a].boundary===i;for(a=0;!f&&a<u.length;a++)f=u[a].boundary===i;f||(i.x2New=l)}Array.prototype.splice.apply(n,[t,o-t+1].concat(u))})),n.forEach((function(t){var n=t.boundary;void 0===n.x2New&&(n.x2New=Math.max(e,n.x2))}))}function c(e){var t=e.textContent,n=e.textContentStream,r=e.container,o=e.viewport,a=e.textDivs,l=e.textContentItemsStr,c=e.enhanceTextSelection;this._textContent=t,this._textContentStream=n,this._container=r,this._viewport=o,this._textDivs=a||[],this._textContentItemsStr=l||[],this._enhanceTextSelection=!!c,this._fontInspectorEnabled=!(!s.default.FontInspector||!s.default.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._renderTimer=null,this._bounds=[]}return c.prototype={get promise(){return this._capability.promise},cancel:function(){this._reader&&(this._reader.cancel(new i.AbortException("text layer task cancelled")),this._reader=null),this._canceled=!0,null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject("canceled")},_processItems:function(e,t){for(var n=0,i=e.length;n<i;n++)this._textContentItemsStr.push(e[n].str),r(this,e[n],t)},_layoutText:function(e){var t=this._container,n=this._textDivProperties.get(e);if(!n.isWhitespace){var r=e.style.fontSize,i=e.style.fontFamily;r===this._layoutTextLastFontSize&&i===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=r+" "+i,this._layoutTextLastFontSize=r,this._layoutTextLastFontFamily=i);var o=this._layoutTextCtx.measureText(e.textContent).width,s="";0!==n.canvasWidth&&o>0&&(n.scale=n.canvasWidth/o,s="scaleX("+n.scale+")"),0!==n.angle&&(s="rotate("+n.angle+"deg) "+s),""!==s&&(n.originalTransform=s,e.style.transform=s),this._textDivProperties.set(e,n),t.appendChild(e)}},_render:function(e){var t=this,n=(0,i.createPromiseCapability)(),r=Object.create(null),s=document.createElement("canvas");if(s.mozOpaque=!0,this._layoutTextCtx=s.getContext("2d",{alpha:!1}),this._textContent){var a=this._textContent.items,l=this._textContent.styles;this._processItems(a,l),n.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function e(){t._reader.read().then((function(i){var o=i.value;i.done?n.resolve():(Object.assign(r,o.styles),t._processItems(o.items,r),e())}),n.reject)}()}n.promise.then((function(){r=null,e?t._renderTimer=setTimeout((function(){o(t),t._renderTimer=null}),e):o(t)}),this._capability.reject)},expandTextDivs:function(e){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(a(this),this._bounds=null);for(var t=0,n=this._textDivs.length;t<n;t++){var r=this._textDivs[t],i=this._textDivProperties.get(r);if(!i.isWhitespace)if(e){var o="",s="";1!==i.scale&&(o="scaleX("+i.scale+")"),0!==i.angle&&(o="rotate("+i.angle+"deg) "+o),0!==i.paddingLeft&&(s+=" padding-left: "+i.paddingLeft/i.scale+"px;",o+=" translateX("+-i.paddingLeft/i.scale+"px)"),0!==i.paddingTop&&(s+=" padding-top: "+i.paddingTop+"px;",o+=" translateY("+-i.paddingTop+"px)"),0!==i.paddingRight&&(s+=" padding-right: "+i.paddingRight/i.scale+"px;"),0!==i.paddingBottom&&(s+=" padding-bottom: "+i.paddingBottom+"px;"),""!==s&&r.setAttribute("style",i.style+s),""!==o&&(r.style.transform=o)}else r.style.padding=0,r.style.transform=i.originalTransform||""}}}},function(e){var t=new c({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(130),o=n(1);function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=function(){function e(){l(this,e)}return r(e,null,[{key:"create",value:function(e){switch(e.data.annotationType){case o.AnnotationType.LINK:return new h(e);case o.AnnotationType.TEXT:return new d(e);case o.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new p(e);case"Btn":return e.data.radioButton?new m(e):e.data.checkBox?new g(e):new v(e);case"Ch":return new y(e)}return new f(e);case o.AnnotationType.POPUP:return new b(e);case o.AnnotationType.LINE:return new _(e);case o.AnnotationType.SQUARE:return new C(e);case o.AnnotationType.CIRCLE:return new S(e);case o.AnnotationType.POLYLINE:return new k(e);case o.AnnotationType.INK:return new x(e);case o.AnnotationType.POLYGON:return new A(e);case o.AnnotationType.HIGHLIGHT:return new $(e);case o.AnnotationType.UNDERLINE:return new T(e);case o.AnnotationType.SQUIGGLY:return new E(e);case o.AnnotationType.STRIKEOUT:return new R(e);case o.AnnotationType.STAMP:return new M(e);case o.AnnotationType.FILEATTACHMENT:return new L(e);default:return new u(e)}}}]),e}(),u=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l(this,e),this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,this.svgFactory=t.svgFactory,n&&(this.container=this._createContainer(r))}return r(e,[{key:"_createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data,n=this.page,r=this.viewport,i=document.createElement("section"),s=t.rect[2]-t.rect[0],a=t.rect[3]-t.rect[1];i.setAttribute("data-annotation-id",t.id);var l=o.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(i.style.transform="matrix("+r.transform.join(",")+")",i.style.transformOrigin=-l[0]+"px "+-l[1]+"px",!e&&t.borderStyle.width>0){i.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==o.AnnotationBorderStyleType.UNDERLINE&&(s-=2*t.borderStyle.width,a-=2*t.borderStyle.width);var c=t.borderStyle.horizontalCornerRadius,u=t.borderStyle.verticalCornerRadius;if(c>0||u>0){var h=c+"px / "+u+"px";i.style.borderRadius=h}switch(t.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:i.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:i.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:i.style.borderBottomStyle="solid"}t.color?i.style.borderColor=o.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):i.style.borderWidth=0}return i.style.left=l[0]+"px",i.style.top=l[1]+"px",i.style.width=s+"px",i.style.height=a+"px",i}},{key:"_createPopup",value:function(e,t,n){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));var r=new w({container:e,trigger:t,color:n.color,title:n.title,contents:n.contents,hideWrapper:!0}).render();r.style.left=e.style.width,e.appendChild(r)}},{key:"render",value:function(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}}]),e}(),h=function(e){function t(e){l(this,t);var n=!!(e.data.url||e.data.dest||e.data.action);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="linkAnnotation";var e=this.data,t=this.linkService,n=document.createElement("a");return(0,i.addLinkAttributes)(n,{url:e.url,target:e.newWindow?i.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel}),e.url||(e.action?this._bindNamedAction(n,e.action):this._bindLink(n,e.dest)),this.container.appendChild(n),this.container}},{key:"_bindLink",value:function(e,t){var n=this;e.href=this.linkService.getDestinationHash(t),e.onclick=function(){return t&&n.linkService.navigateTo(t),!1},t&&(e.className="internalLink")}},{key:"_bindNamedAction",value:function(e,t){var n=this;e.href=this.linkService.getAnchorUrl(""),e.onclick=function(){return n.linkService.executeNamedAction(t),!1},e.className="internalLink"}}]),t}(u),d=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="textAnnotation";var e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}]),t}(u),f=function(e){function t(){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),r(t,[{key:"render",value:function(){return this.container}}]),t}(u),p=function(e){function t(e){l(this,t);var n=e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue;return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="textWidgetAnnotation";var e=null;if(this.renderInteractiveForms){if(this.data.multiLine?(e=document.createElement("textarea")).textContent=this.data.fieldValue:((e=document.createElement("input")).type="text",e.setAttribute("value",this.data.fieldValue)),e.disabled=this.data.readOnly,null!==this.data.maxLen&&(e.maxLength=this.data.maxLen),this.data.comb){var t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;e.classList.add("comb"),e.style.letterSpacing="calc("+t+"px - 1ch)"}}else{(e=document.createElement("div")).textContent=this.data.fieldValue,e.style.verticalAlign="middle",e.style.display="table-cell";var n=null;this.data.fontRefName&&(n=this.page.commonObjs.getData(this.data.fontRefName)),this._setTextStyle(e,n)}return null!==this.data.textAlignment&&(e.style.textAlign=["left","center","right"][this.data.textAlignment]),this.container.appendChild(e),this.container}},{key:"_setTextStyle",value:function(e,t){var n=e.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",t){n.fontWeight=t.black?t.bold?"900":"bold":t.bold?"bold":"normal",n.fontStyle=t.italic?"italic":"normal";var r=t.loadedName?'"'+t.loadedName+'", ':"",i=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=r+i}}}]),t}(f),g=function(e){function t(e){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.renderInteractiveForms))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation checkBox";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(f),m=function(e){function t(e){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.renderInteractiveForms))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation radioButton";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="radio",e.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(f),v=function(e){function t(){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),r(t,[{key:"render",value:function(){var e=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this);return e.className="buttonWidgetAnnotation pushButton",e}}]),t}(h),y=function(e){function t(e){return l(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,e.renderInteractiveForms))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="choiceWidgetAnnotation";var e=document.createElement("select");e.disabled=this.data.readOnly,this.data.combo||(e.size=this.data.options.length,this.data.multiSelect&&(e.multiple=!0));for(var t=0,n=this.data.options.length;t<n;t++){var r=this.data.options[t],i=document.createElement("option");i.textContent=r.displayValue,i.value=r.exportValue,this.data.fieldValue.includes(r.displayValue)&&i.setAttribute("selected",!0),e.appendChild(i)}return this.container.appendChild(e),this.container}}]),t}(f),b=function(e){function t(e){l(this,t);var n=!(!e.data.title&&!e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return a(t,e),r(t,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var e='[data-annotation-id="'+this.data.parentId+'"]',t=this.layer.querySelector(e);if(!t)return this.container;var n=new w({container:this.container,trigger:t,color:this.data.color,title:this.data.title,contents:this.data.contents}),r=parseFloat(t.style.left),i=parseFloat(t.style.width);return this.container.style.transformOrigin=-(r+i)+"px -"+t.style.top,this.container.style.left=r+i+"px",this.container.appendChild(n.render()),this.container}}]),t}(u),w=function(){function e(t){l(this,e),this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}return r(e,[{key:"render",value:function(){var e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);var t=document.createElement("div");t.className="popup";var n=this.color;if(n){var r=.7*(255-n[0])+n[0],i=.7*(255-n[1])+n[1],s=.7*(255-n[2])+n[2];t.style.backgroundColor=o.Util.makeCssRgb(0|r,0|i,0|s)}var a=this._formatContents(this.contents),l=document.createElement("h1");return l.textContent=this.title,this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),t.appendChild(l),t.appendChild(a),e.appendChild(t),e}},{key:"_formatContents",value:function(e){for(var t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/),r=0,i=n.length;r<i;++r){var o=n[r];t.appendChild(document.createTextNode(o)),r<i-1&&t.appendChild(document.createElement("br"))}return t}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}},{key:"_hide",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}]),e}(),_=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="lineAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width),i.setAttribute("stroke","transparent"),r.appendChild(i),this.container.append(r),this._createPopup(this.container,i,e),this.container}}]),t}(u),C=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="squareAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",n-i),o.setAttribute("stroke-width",i),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),r.appendChild(o),this.container.append(r),this._createPopup(this.container,o,e),this.container}}]),t}(u),S=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="circleAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",n/2-i/2),o.setAttribute("stroke-width",i),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),r.appendChild(o),this.container.append(r),this._createPopup(this.container,o,e),this.container}}]),t}(u),k=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents),r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0));return r.containerClassName="polylineAnnotation",r.svgElementName="svg:polyline",r}return a(t,e),r(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.vertices,o=[],s=0,a=i.length;s<a;s++){var l=i[s].x-e.rect[0],c=e.rect[3]-i[s].y;o.push(l+","+c)}o=o.join(" ");var u=e.borderStyle.width,h=this.svgFactory.createElement(this.svgElementName);return h.setAttribute("points",o),h.setAttribute("stroke-width",u),h.setAttribute("stroke","transparent"),h.setAttribute("fill","none"),r.appendChild(h),this.container.append(r),this._createPopup(this.container,h,e),this.container}}]),t}(u),A=function(e){function t(e){l(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.containerClassName="polygonAnnotation",n.svgElementName="svg:polygon",n}return a(t,e),t}(k),x=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents),r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0));return r.containerClassName="inkAnnotation",r.svgElementName="svg:polyline",r}return a(t,e),r(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.inkLists,o=0,s=i.length;o<s;o++){for(var a=i[o],l=[],c=0,u=a.length;c<u;c++){var h=a[c].x-e.rect[0],d=e.rect[3]-a[c].y;l.push(h+","+d)}l=l.join(" ");var f=e.borderStyle.width,p=this.svgFactory.createElement(this.svgElementName);p.setAttribute("points",l),p.setAttribute("stroke-width",f),p.setAttribute("stroke","transparent"),p.setAttribute("fill","none"),this._createPopup(this.container,p,e),r.appendChild(p)}return this.container.append(r),this.container}}]),t}(u),$=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(u),T=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(u),E=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(u),R=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(u),M=function(e){function t(e){l(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,!0))}return a(t,e),r(t,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(u),L=function(e){function t(e){l(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,!0)),r=n.data.file,a=r.filename,c=r.content;return n.filename=(0,i.getFilenameFromUrl)(a),n.content=c,n.linkService.eventBus&&n.linkService.eventBus.dispatch("fileattachmentannotation",{source:n,id:(0,o.stringToPDFString)(a),filename:a,content:c}),n}return a(t,e),r(t,[{key:"render",value:function(){this.container.className="fileAttachmentAnnotation";var e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}},{key:"_download",value:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,o.warn)("Download cannot be started due to unavailable download manager")}}]),t}(u),P=function(){function e(){l(this,e)}return r(e,null,[{key:"render",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var r=e.annotations[t];if(r){var o=c.create({data:r,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:e.renderInteractiveForms||!1,svgFactory:new i.DOMSVGFactory});o.isRenderable&&e.div.appendChild(o.render())}}}},{key:"update",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var r=e.annotations[t],i=e.div.querySelector('[data-annotation-id="'+r.id+'"]');i&&(i.style.transform="matrix("+e.viewport.transform.join(",")+")")}e.div.removeAttribute("hidden")}}]),e}();t.AnnotationLayer=P},function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var s,a,l=o(1),c=o(130),u=o(4),h=(s=u)&&s.__esModule?s:{default:s},d={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},f=function(){for(var e=new Uint8Array([137,80,78,71,13,10,26,10]),r=12,o=new Int32Array(256),s=0;s<256;s++){for(var a=s,c=0;c<8;c++)a=1&a?3988292384^a>>1&2147483647:a>>1&2147483647;o[s]=a}function u(e,t,n,r){var i=r,s=t.length;n[i]=s>>24&255,n[i+1]=s>>16&255,n[i+2]=s>>8&255,n[i+3]=255&s,n[i+=4]=255&e.charCodeAt(0),n[i+1]=255&e.charCodeAt(1),n[i+2]=255&e.charCodeAt(2),n[i+3]=255&e.charCodeAt(3),i+=4,n.set(t,i);var a=function(e,t,n){for(var r=-1,i=t;i<n;i++){var s=255&(r^e[i]);r=r>>>8^o[s]}return-1^r}(n,r+4,i+=t.length);n[i]=a>>24&255,n[i+1]=a>>16&255,n[i+2]=a>>8&255,n[i+3]=255&a}function d(e){var t=e.length,n=Math.ceil(t/65535),r=new Uint8Array(2+t+5*n+4),i=0;r[i++]=120,r[i++]=156;for(var o=0;t>65535;)r[i++]=0,r[i++]=255,r[i++]=255,r[i++]=0,r[i++]=0,r.set(e.subarray(o,o+65535),i),i+=65535,o+=65535,t-=65535;r[i++]=1,r[i++]=255&t,r[i++]=t>>8&255,r[i++]=255&~t,r[i++]=(65535&~t)>>8&255,r.set(e.subarray(o),i),i+=e.length-o;var s=function(e,t,n){for(var r=1,i=0,o=t;o<n;++o)i=(i+(r=(r+(255&e[o]))%65521))%65521;return i<<16|r}(e,0,e.length);return r[i++]=s>>24&255,r[i++]=s>>16&255,r[i++]=s>>8&255,r[i++]=255&s,r}function f(o,s,a,c){var f,p,g,m=o.width,v=o.height,y=o.data;switch(s){case l.ImageKind.GRAYSCALE_1BPP:p=0,f=1,g=m+7>>3;break;case l.ImageKind.RGB_24BPP:p=2,f=8,g=3*m;break;case l.ImageKind.RGBA_32BPP:p=6,f=8,g=4*m;break;default:throw new Error("invalid format")}var b,w,_=new Uint8Array((1+g)*v),C=0,S=0;for(b=0;b<v;++b)_[C++]=0,_.set(y.subarray(S,S+g),C),S+=g,C+=g;if(s===l.ImageKind.GRAYSCALE_1BPP&&c)for(C=0,b=0;b<v;b++)for(C++,w=0;w<g;w++)_[C++]^=255;var k=new Uint8Array([m>>24&255,m>>16&255,m>>8&255,255&m,v>>24&255,v>>16&255,v>>8&255,255&v,f,p,0,0,0]),A=function(e){if(!(0,h.default)())return d(e);try{var r;r=parseInt(i.versions.node)>=8?e:new t(e);var o=n(220).deflateSync(r,{level:9});return o instanceof Uint8Array?o:new Uint8Array(o)}catch(e){(0,l.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return d(e)}(_),x=e.length+3*r+k.length+A.length,$=new Uint8Array(x),T=0;return $.set(e,T),u("IHDR",k,$,T+=e.length),u("IDATA",A,$,T+=r+k.length),T+=r+A.length,u("IEND",new Uint8Array(0),$,T),(0,l.createObjectURL)($,"image/png",a)}return function(e,t,n){return f(e,void 0===e.kind?l.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}(),p=function(){function e(){this.fontSizeScale=1,this.fontWeight=d.fontWeight,this.fontSize=0,this.textMatrix=l.IDENTITY_MATRIX,this.fontMatrix=l.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=l.TextRenderingMode.FILL,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=d.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}();r.SVGGraphics=a=function(){function e(e){if(Number.isInteger(e))return e.toString();var t=e.toFixed(10),n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function t(t){if(0===t[4]&&0===t[5]){if(0===t[1]&&0===t[2])return 1===t[0]&&1===t[3]?"":"scale("+e(t[0])+" "+e(t[3])+")";if(t[0]===t[3]&&t[1]===-t[2])return"rotate("+e(180*Math.acos(t[0])/Math.PI)+")"}else if(1===t[0]&&0===t[1]&&0===t[2]&&1===t[3])return"translate("+e(t[4])+" "+e(t[5])+")";return"matrix("+e(t[0])+" "+e(t[1])+" "+e(t[2])+" "+e(t[3])+" "+e(t[4])+" "+e(t[5])+")"}function n(e,t,n){this.svgFactory=new c.DOMSVGFactory,this.current=new p,this.transformMatrix=l.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n}var r="http://www.w3.org/1999/xlink",i=["butt","round","square"],o=["miter","round","bevel"],s=0,a=0;return n.prototype={save:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()},restore:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null},group:function(e){this.save(),this.executeOpTree(e),this.restore()},loadDependencies:function(e){for(var t=this,n=e.fnArray,r=n.length,i=e.argsArray,o=0;o<r;o++)if(l.OPS.dependency===n[o])for(var s=i[o],a=0,c=s.length;a<c;a++){var u,h=s[a],d="g_"===h.substring(0,2);u=new Promise(d?function(e){t.commonObjs.get(h,e)}:function(e){t.objs.get(h,e)}),this.current.dependencies.push(u)}return Promise.all(this.current.dependencies)},transform:function(e,t,n,r,i,o){var s=[e,t,n,r,i,o];this.transformMatrix=l.Util.transform(this.transformMatrix,s),this.tgrp=null},getSVG:function(e,t){var n=this;this.viewport=t;var r=this._initialize(t);return this.loadDependencies(e).then((function(){n.transformMatrix=l.IDENTITY_MATRIX;var t=n.convertOpList(e);return n.executeOpTree(t),r}))},convertOpList:function(e){var t=e.argsArray,n=e.fnArray,r=n.length,i=[],o=[];for(var s in l.OPS)i[l.OPS[s]]=s;for(var a=0;a<r;a++){var c=n[a];o.push({fnId:c,fn:i[c],args:t[a]})}return function(e){for(var t=[],n=[],r=e.length,i=0;i<r;i++)"save"!==e[i].fn?"restore"===e[i].fn?t=n.pop():t.push(e[i]):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items);return t}(o)},executeOpTree:function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n].fn,i=e[n].fnId,o=e[n].args;switch(0|i){case l.OPS.beginText:this.beginText();break;case l.OPS.dependency:break;case l.OPS.setLeading:this.setLeading(o);break;case l.OPS.setLeadingMoveText:this.setLeadingMoveText(o[0],o[1]);break;case l.OPS.setFont:this.setFont(o);break;case l.OPS.showText:case l.OPS.showSpacedText:this.showText(o[0]);break;case l.OPS.endText:this.endText();break;case l.OPS.moveText:this.moveText(o[0],o[1]);break;case l.OPS.setCharSpacing:this.setCharSpacing(o[0]);break;case l.OPS.setWordSpacing:this.setWordSpacing(o[0]);break;case l.OPS.setHScale:this.setHScale(o[0]);break;case l.OPS.setTextMatrix:this.setTextMatrix(o[0],o[1],o[2],o[3],o[4],o[5]);break;case l.OPS.setTextRise:this.setTextRise(o[0]);break;case l.OPS.setTextRenderingMode:this.setTextRenderingMode(o[0]);break;case l.OPS.setLineWidth:this.setLineWidth(o[0]);break;case l.OPS.setLineJoin:this.setLineJoin(o[0]);break;case l.OPS.setLineCap:this.setLineCap(o[0]);break;case l.OPS.setMiterLimit:this.setMiterLimit(o[0]);break;case l.OPS.setFillRGBColor:this.setFillRGBColor(o[0],o[1],o[2]);break;case l.OPS.setStrokeRGBColor:this.setStrokeRGBColor(o[0],o[1],o[2]);break;case l.OPS.setDash:this.setDash(o[0],o[1]);break;case l.OPS.setGState:this.setGState(o[0]);break;case l.OPS.fill:this.fill();break;case l.OPS.eoFill:this.eoFill();break;case l.OPS.stroke:this.stroke();break;case l.OPS.fillStroke:this.fillStroke();break;case l.OPS.eoFillStroke:this.eoFillStroke();break;case l.OPS.clip:this.clip("nonzero");break;case l.OPS.eoClip:this.clip("evenodd");break;case l.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case l.OPS.paintJpegXObject:this.paintJpegXObject(o[0],o[1],o[2]);break;case l.OPS.paintImageXObject:this.paintImageXObject(o[0]);break;case l.OPS.paintInlineImageXObject:this.paintInlineImageXObject(o[0]);break;case l.OPS.paintImageMaskXObject:this.paintImageMaskXObject(o[0]);break;case l.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(o[0],o[1]);break;case l.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case l.OPS.closePath:this.closePath();break;case l.OPS.closeStroke:this.closeStroke();break;case l.OPS.closeFillStroke:this.closeFillStroke();break;case l.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case l.OPS.nextLine:this.nextLine();break;case l.OPS.transform:this.transform(o[0],o[1],o[2],o[3],o[4],o[5]);break;case l.OPS.constructPath:this.constructPath(o[0],o[1]);break;case l.OPS.endPath:this.endPath();break;case 92:this.group(e[n].items);break;default:(0,l.warn)("Unimplemented operator "+r)}}},setWordSpacing:function(e){this.current.wordSpacing=e},setCharSpacing:function(e){this.current.charSpacing=e},nextLine:function(){this.moveText(0,this.current.leading)},setTextMatrix:function(t,n,r,i,o,s){var a=this.current;this.current.textMatrix=this.current.lineMatrix=[t,n,r,i,o,s],this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,a.xcoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",e(a.fontSize)+"px"),a.tspan.setAttributeNS(null,"y",e(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.appendChild(a.tspan)},beginText:function(){this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.current.textMatrix=l.IDENTITY_MATRIX,this.current.lineMatrix=l.IDENTITY_MATRIX,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.txtElement=this.svgFactory.createElement("svg:text"),this.current.txtgrp=this.svgFactory.createElement("svg:g"),this.current.xcoords=[]},moveText:function(t,n){var r=this.current;this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n,r.xcoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",e(r.fontSize)+"px"),r.tspan.setAttributeNS(null,"y",e(-r.y))},showText:function(n){var r=this.current,i=r.font,o=r.fontSize;if(0!==o){var s,a=r.charSpacing,c=r.wordSpacing,u=r.fontDirection,h=r.textHScale*u,f=n.length,p=i.vertical,g=o*r.fontMatrix[0],m=0;for(s=0;s<f;++s){var v=n[s];if(null!==v)if((0,l.isNum)(v))m+=-v*o*.001;else{var y=v.width,b=v.fontChar,w=y*g+((v.isSpace?c:0)+a)*u;v.isInFont||i.missingFile?(r.xcoords.push(r.x+m*h),r.tspan.textContent+=b,m+=w):m+=w}else m+=u*c}p?r.y-=m*h:r.x+=m*h,r.tspan.setAttributeNS(null,"x",r.xcoords.map(e).join(" ")),r.tspan.setAttributeNS(null,"y",e(-r.y)),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",e(r.fontSize)+"px"),r.fontStyle!==d.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==d.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);var _=r.textRenderingMode&l.TextRenderingMode.FILL_STROKE_MASK;_===l.TextRenderingMode.FILL||_===l.TextRenderingMode.FILL_STROKE?(r.fillColor!==d.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===l.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),_!==l.TextRenderingMode.STROKE&&_!==l.TextRenderingMode.FILL_STROKE||this._setStrokeAttributes(r.tspan);var C=r.textMatrix;0!==r.textRise&&((C=C.slice())[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",t(C)+" scale(1, -1)"),r.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),r.txtElement.appendChild(r.tspan),r.txtgrp.appendChild(r.txtElement),this._ensureTransformGroup().appendChild(r.txtElement)}},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},addFontStyle:function(e){this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=(0,l.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'+e.loadedName+'"; src: url('+t+"); }\n"},setFont:function(t){var n=this.current,r=this.commonObjs.get(t[0]),i=t[1];this.current.font=r,this.embedFonts&&r.data&&!this.embeddedFonts[r.loadedName]&&(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),n.fontMatrix=r.fontMatrix?r.fontMatrix:l.FONT_IDENTITY_MATRIX;var o=r.black?r.bold?"bolder":"bold":r.bold?"bold":"normal",s=r.italic?"italic":"normal";i<0?(i=-i,n.fontDirection=-1):n.fontDirection=1,n.fontSize=i,n.fontFamily=r.loadedName,n.fontWeight=o,n.fontStyle=s,n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"y",e(-n.y)),n.xcoords=[]},endText:function(){var e=this.current;e.textRenderingMode&l.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())},setLineWidth:function(e){this.current.lineWidth=e},setLineCap:function(e){this.current.lineCap=i[e]},setLineJoin:function(e){this.current.lineJoin=o[e]},setMiterLimit:function(e){this.current.miterLimit=e},setStrokeAlpha:function(e){this.current.strokeAlpha=e},setStrokeRGBColor:function(e,t,n){var r=l.Util.makeCssRgb(e,t,n);this.current.strokeColor=r},setFillAlpha:function(e){this.current.fillAlpha=e},setFillRGBColor:function(e,t,n){var r=l.Util.makeCssRgb(e,t,n);this.current.fillColor=r,this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[]},setDash:function(e,t){this.current.dashArray=e,this.current.dashPhase=t},constructPath:function(t,n){var r=this.current,i=r.x,o=r.y;r.path=this.svgFactory.createElement("svg:path");for(var s=[],a=t.length,c=0,u=0;c<a;c++)switch(0|t[c]){case l.OPS.rectangle:i=n[u++],o=n[u++];var h=i+n[u++],d=o+n[u++];s.push("M",e(i),e(o),"L",e(h),e(o),"L",e(h),e(d),"L",e(i),e(d),"Z");break;case l.OPS.moveTo:i=n[u++],o=n[u++],s.push("M",e(i),e(o));break;case l.OPS.lineTo:i=n[u++],o=n[u++],s.push("L",e(i),e(o));break;case l.OPS.curveTo:i=n[u+4],o=n[u+5],s.push("C",e(n[u]),e(n[u+1]),e(n[u+2]),e(n[u+3]),e(i),e(o)),u+=6;break;case l.OPS.curveTo2:i=n[u+2],o=n[u+3],s.push("C",e(i),e(o),e(n[u]),e(n[u+1]),e(n[u+2]),e(n[u+3])),u+=4;break;case l.OPS.curveTo3:i=n[u+2],o=n[u+3],s.push("C",e(n[u]),e(n[u+1]),e(i),e(o),e(i),e(o)),u+=4;break;case l.OPS.closePath:s.push("Z")}r.path.setAttributeNS(null,"d",s.join(" ")),r.path.setAttributeNS(null,"fill","none"),this._ensureTransformGroup().appendChild(r.path),r.element=r.path,r.setCurrentPoint(i,o)},endPath:function(){if(this.pendingClip){var e=this.current,n="clippath"+s;s++;var r=this.svgFactory.createElement("svg:clipPath");r.setAttributeNS(null,"id",n),r.setAttributeNS(null,"transform",t(this.transformMatrix));var i=e.element.cloneNode(!0);"evenodd"===this.pendingClip?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,r.appendChild(i),this.defs.appendChild(r),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach((function(e){e.clipGroup=null})),r.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl="url(#"+n+")",this.tgrp=null}},clip:function(e){this.pendingClip=e},closePath:function(){var e=this.current;if(e.path){var t=e.path.getAttributeNS(null,"d");t+="Z",e.path.setAttributeNS(null,"d",t)}},setLeading:function(e){this.current.leading=-e},setTextRise:function(e){this.current.textRise=e},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setHScale:function(e){this.current.textHScale=e/100},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i=r[0],o=r[1];switch(i){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"Font":this.setFont(o);break;case"CA":this.setStrokeAlpha(o);break;case"ca":this.setFillAlpha(o);break;default:(0,l.warn)("Unimplemented graphic state "+i)}}},fill:function(){var e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())},stroke:function(){var e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())},_setStrokeAttributes:function(t){var n=this.current;t.setAttributeNS(null,"stroke",n.strokeColor),t.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",e(n.miterLimit)),t.setAttributeNS(null,"stroke-linecap",n.lineCap),t.setAttributeNS(null,"stroke-linejoin",n.lineJoin),t.setAttributeNS(null,"stroke-width",e(n.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",n.dashArray.map(e).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",e(n.dashPhase)+"px")},eoFill:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()},fillStroke:function(){this.stroke(),this.fill()},eoFillStroke:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()},closeStroke:function(){this.closePath(),this.stroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.closePath(),this.eoFillStroke()},paintSolidColorImageMask:function(){var e=this.current,t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",e.fillColor),this._ensureTransformGroup().appendChild(t)},paintJpegXObject:function(t,n,i){var o=this.objs.get(t),s=this.svgFactory.createElement("svg:image");s.setAttributeNS(r,"xlink:href",o.src),s.setAttributeNS(null,"width",e(n)),s.setAttributeNS(null,"height",e(i)),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",e(-i)),s.setAttributeNS(null,"transform","scale("+e(1/n)+" "+e(-1/i)+")"),this._ensureTransformGroup().appendChild(s)},paintImageXObject:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,l.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(t,n){var i=t.width,o=t.height,s=f(t,this.forceDataSchema,!!n),a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",e(i)),a.setAttributeNS(null,"height",e(o)),this.current.element=a,this.clip("nonzero");var l=this.svgFactory.createElement("svg:image");l.setAttributeNS(r,"xlink:href",s),l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y",e(-o)),l.setAttributeNS(null,"width",e(i)+"px"),l.setAttributeNS(null,"height",e(o)+"px"),l.setAttributeNS(null,"transform","scale("+e(1/i)+" "+e(-1/o)+")"),n?n.appendChild(l):this._ensureTransformGroup().appendChild(l)},paintImageMaskXObject:function(t){var n=this.current,r=t.width,i=t.height,o=n.fillColor;n.maskId="mask"+a++;var s=this.svgFactory.createElement("svg:mask");s.setAttributeNS(null,"id",n.maskId);var l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",e(r)),l.setAttributeNS(null,"height",e(i)),l.setAttributeNS(null,"fill",o),l.setAttributeNS(null,"mask","url(#"+n.maskId+")"),this.defs.appendChild(s),this._ensureTransformGroup().appendChild(l),this.paintInlineImageXObject(t,s)},paintFormXObjectBegin:function(t,n){if(Array.isArray(t)&&6===t.length&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),Array.isArray(n)&&4===n.length){var r=n[2]-n[0],i=n[3]-n[1],o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x",n[0]),o.setAttributeNS(null,"y",n[1]),o.setAttributeNS(null,"width",e(r)),o.setAttributeNS(null,"height",e(i)),this.current.element=o,this.clip("nonzero"),this.endPath()}},paintFormXObjectEnd:function(){},_initialize:function(e){var n=this.svgFactory.create(e.width,e.height),r=this.svgFactory.createElement("svg:defs");n.appendChild(r),this.defs=r;var i=this.svgFactory.createElement("svg:g");return i.setAttributeNS(null,"transform",t(e.transform)),n.appendChild(i),this.svg=i,n},_ensureClipGroup:function(){if(!this.current.clipGroup){var e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup},_ensureTransformGroup:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",t(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}},n}(),r.SVGGraphics=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var i,o=r(137),s=(i=o)&&i.__esModule?i:{default:i},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=r(1),c=r(149);function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function d(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var s=t[i](o),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var p=n(221),g=n(222),m=n(223),v=n(224),y=/^file:\/\/\/[a-zA-Z]:\//,b=function(){function e(t){var n,r;f(this,e),this.source=t,this.url=(n=t.url,"file:"===(r=v.parse(n)).protocol||r.host?r:/^[a-z]:[/\\]/i.test(n)?v.parse("file:///"+n):(r.host||(r.protocol="file:"),r)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequest=null,this._rangeRequestReaders=[]}return a(e,[{key:"getFullReader",value:function(){return(0,l.assert)(!this._fullRequest),this._fullRequest=this.isFsUrl?new A(this):new S(this),this._fullRequest}},{key:"getRangeReader",value:function(e,t){var n=this.isFsUrl?new x(this,e,t):new k(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequest&&this._fullRequest.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}(),w=function(){function e(t){f(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;var n=t.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=(0,l.createPromiseCapability)(),this._headersCapability=(0,l.createPromiseCapability)()}var t;return a(e,[{key:"read",value:(t=d(s.default.mark((function e(){var t,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,l.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new l.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),_=function(){function e(t){f(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,l.createPromiseCapability)();var n=t.source;this._isStreamingSupported=!n.disableStream}var t;return a(e,[{key:"read",value:(t=d(s.default.mark((function e(){var t,n;return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,l.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}();function C(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}var S=function(e){function t(e){f(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=function(t){if(404===t.statusCode){var r=new l.MissingPDFException('Missing PDF "'+n._url+'".');return n._storedError=r,void n._headersCapability.reject(r)}n._headersCapability.resolve(),n._setReadableStream(t);var i=function(e){return n._readableStream.headers[e.toLowerCase()]},o=(0,c.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:e.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),s=o.allowRangeRequests,a=o.suggestedLength;n._isRangeSupported=s,n._contentLength=a||n._contentLength,n._filename=(0,c.extractFilenameFromHeader)(i)};return n._request=null,"http:"===n._url.protocol?n._request=g.request(C(n._url,e.httpHeaders),r):n._request=m.request(C(n._url,e.httpHeaders),r),n._request.on("error",(function(e){n._storedError=e,n._headersCapability.reject(e)})),n._request.end(),n}return h(t,e),t}(w),k=function(e){function t(e,n,r){f(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));for(var o in i._httpHeaders={},e.httpHeaders){var s=e.httpHeaders[o];void 0!==s&&(i._httpHeaders[o]=s)}i._httpHeaders.Range="bytes="+n+"-"+(r-1);var a=function(e){if(404!==e.statusCode)i._setReadableStream(e);else{var t=new l.MissingPDFException('Missing PDF "'+i._url+'".');i._storedError=t}};return i._request=null,"http:"===i._url.protocol?i._request=g.request(C(i._url,i._httpHeaders),a):i._request=m.request(C(i._url,i._httpHeaders),a),i._request.on("error",(function(e){i._storedError=e})),i._request.end(),i}return h(t,e),t}(_),A=function(e){function t(e){f(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=decodeURIComponent(n._url.path);return y.test(n._url.href)&&(r=r.replace(/^\//,"")),p.lstat(r,(function(e,t){if(e)return"ENOENT"===e.code&&(e=new l.MissingPDFException('Missing PDF "'+r+'".')),n._storedError=e,void n._headersCapability.reject(e);n._contentLength=t.size,n._setReadableStream(p.createReadStream(r)),n._headersCapability.resolve()})),n}return h(t,e),t}(w),x=function(e){function t(e,n,r){f(this,t);var i=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=decodeURIComponent(i._url.path);return y.test(i._url.href)&&(o=o.replace(/^\//,"")),i._setReadableStream(p.createReadStream(o,{start:n,end:r-1})),i}return h(t,e),t}(_);t.PDFNodeStream=b},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateResponseStatus=t.validateRangeRequestCapabilities=t.extractFilenameFromHeader=t.createResponseStatusError=void 0;var r=n(1),i=n(150);t.createResponseStatusError=function(e,t){return 404===e||0===e&&/^file:/.test(t)?new r.MissingPDFException('Missing PDF "'+t+'".'):new r.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){var t=e("Content-Disposition");if(t){var n=(0,i.getFilenameFromContentDispositionHeader)(t);if(/\.pdf$/i.test(n))return n}return null},t.validateRangeRequestCapabilities=function(e){var t=e.getResponseHeader,n=e.isHttp,i=e.rangeChunkSize,o=e.disableRange;(0,r.assert)(i>0,"Range chunk size must be larger than zero");var s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(t("Content-Length"),10);return Number.isInteger(a)?(s.suggestedLength=a,a<=2*i?s:o||!n?s:"bytes"!==t("Accept-Ranges")?s:"identity"!==(t("Content-Encoding")||"identity")?s:(s.allowRangeRequests=!0,s)):s},t.validateResponseStatus=function(e){return 200===e||206===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.getFilenameFromContentDispositionHeader=function(e){var t=!0,n=s("filename\\*","i").exec(e);if(n){var i=c(n=n[1]);return l(i=h(i=u(i=unescape(i))))}if(n=function(e){for(var t=[],n=void 0,i=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(n=i.exec(e));){var o=r(n,4),a=o[1],l=o[2],h=o[3];if((a=parseInt(a,10))in t){if(0===a)break}else t[a]=[l,h]}for(var d=[],f=0;f<t.length&&f in t;++f){var p=r(t[f],2),g=p[0],m=p[1];m=c(m),g&&(m=unescape(m),0===f&&(m=u(m))),d.push(m)}return d.join("")}(e))return l(h(n));if(n=s("filename","i").exec(e)){var o=c(n=n[1]);return l(o=h(o))}function s(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function a(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{for(var r=new TextDecoder(e,{fatal:!0}),i=new Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);n=r.decode(new Uint8Array(i)),t=!1}catch(r){if(/^utf-?8$/i.test(e))try{n=decodeURIComponent(escape(n)),t=!1}catch(e){}}}return n}function l(e){return t&&/[\x80-\xff]/.test(e)&&(e=a("utf-8",e),t&&(e=a("iso-8859-1",e))),e}function c(e){if('"'===e.charAt(0)){for(var t=e.slice(1).split('\\"'),n=0;n<t.length;++n){var r=t[n].indexOf('"');-1!==r&&(t[n]=t[n].slice(0,r),t.length=n+1),t[n]=t[n].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function u(e){var t=e.indexOf("'");return-1===t?e:a(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function h(e){return"=?"!==e.slice(0,2)||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,n,r){if("q"===n||"Q"===n)return a(t,r=(r=r.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{r=atob(r)}catch(e){}return a(t,r)}))}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var r,i=n(137),o=(r=i)&&r.__esModule?r:{default:r},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),l=n(149);function c(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var s=t[i](o),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t,n){return{method:"GET",headers:e,signal:n&&n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}var d=function(){function e(t){u(this,e),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return s(e,[{key:"getFullReader",value:function(){return(0,a.assert)(!this._fullRequestReader),this._fullRequestReader=new f(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){var n=new p(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}(),f=function(){function e(t){var n=this;u(this,e),this._stream=t,this._reader=null,this._loaded=0,this._filename=null;var r=t.source;for(var i in this._withCredentials=r.withCredentials,this._contentLength=r.length,this._headersCapability=(0,a.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._headers=new Headers,this._stream.httpHeaders){var o=this._stream.httpHeaders[i];void 0!==o&&this._headers.append(i,o)}var s=r.url;fetch(s,h(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,l.validateResponseStatus)(e.status))throw(0,l.createResponseStatusError)(e.status,s);n._reader=e.body.getReader(),n._headersCapability.resolve();var t=function(t){return e.headers.get(t)},r=(0,l.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:n._stream.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),i=r.allowRangeRequests,o=r.suggestedLength;n._isRangeSupported=i,n._contentLength=o||n._contentLength,n._filename=(0,l.extractFilenameFromHeader)(t),!n._isStreamingSupported&&n._isRangeSupported&&n.cancel(new a.AbortException("streaming is disabled"))})).catch(this._headersCapability.reject),this.onProgress=null}var t;return s(e,[{key:"read",value:(t=c(o.default.mark((function e(){var t,n,r,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._headersCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(r=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:r});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),i=new Uint8Array(n).buffer,e.abrupt("return",{value:i,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),p=function(){function e(t,n,r){var i=this;u(this,e),this._stream=t,this._reader=null,this._loaded=0;var o=t.source;for(var s in this._withCredentials=o.withCredentials,this._readCapability=(0,a.createPromiseCapability)(),this._isStreamingSupported=!o.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=new Headers,this._stream.httpHeaders){var c=this._stream.httpHeaders[s];void 0!==c&&this._headers.append(s,c)}var d=n+"-"+(r-1);this._headers.append("Range","bytes="+d);var f=o.url;fetch(f,h(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,l.validateResponseStatus)(e.status))throw(0,l.createResponseStatusError)(e.status,f);i._readCapability.resolve(),i._reader=e.body.getReader()})),this.onProgress=null}var t;return s(e,[{key:"read",value:(t=c(o.default.mark((function e(){var t,n,r,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(r=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:r});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),i=new Uint8Array(n).buffer,e.abrupt("return",{value:i,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}();t.PDFFetchStream=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=t.PDFNetworkStream=void 0;var r=a(n(137)),i=n(1),o=n(149),s=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function r(i,o){try{var s=t[i](o),a=s.value}catch(e){return void n(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}}function c(e,t){this.url=e,t=t||{},this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this.withCredentials=t.withCredentials||!1,this.getXhr=t.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null),this.loadedRequests=Object.create(null)}function u(e){var t=e.response;return"string"!=typeof t?t:(0,i.stringToBytes)(t).buffer}var h,d,f=function(){try{var e=new XMLHttpRequest;return e.open("GET",s.default.location.href),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return!1}}();function p(e){this._source=e,this._manager=new c(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}function g(e,t){this._manager=e;var n={onHeadersReceived:this._onHeadersReceived.bind(this),onProgressiveData:t.disableStream?null:this._onProgressiveData.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}function m(e,t,n){this._manager=e;var r={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=e.requestRange(t,n,r),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}c.prototype={requestRange:function(e,t,n){var r={begin:e,end:t};for(var i in n)r[i]=n[i];return this.request(r)},requestFull:function(e){return this.request(e)},request:function(e){var t=this.getXhr(),n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};for(var i in t.open("GET",this.url),t.withCredentials=this.withCredentials,this.httpHeaders){var o=this.httpHeaders[i];void 0!==o&&t.setRequestHeader(i,o)}if(this.isHttp&&"begin"in e&&"end"in e){var s=e.begin+"-"+(e.end-1);t.setRequestHeader("Range","bytes="+s),r.expectedStatus=206}else r.expectedStatus=200;return f&&e.onProgressiveData?(t.responseType="moz-chunked-arraybuffer",r.onProgressiveData=e.onProgressiveData,r.mozChunked=!0):t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n},onProgress:function(e,t){var n=this.pendingRequests[e];if(n){if(n.mozChunked){var r=u(n.xhr);n.onProgressiveData(r)}var i=n.onProgress;i&&i(t)}},onStateChange:function(e,t){var n=this.pendingRequests[e];if(n){var r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4===r.readyState&&e in this.pendingRequests)if(delete this.pendingRequests[e],0===r.status&&this.isHttp)n.onError&&n.onError(r.status);else{var i=r.status||200;if(200===i&&206===n.expectedStatus||i===n.expectedStatus){this.loadedRequests[e]=!0;var o=u(r);if(206===i){var s=r.getResponseHeader("Content-Range"),a=/bytes (\d+)-(\d+)\/(\d+)/.exec(s),l=parseInt(a[1],10);n.onDone({begin:l,chunk:o})}else n.onProgressiveData?n.onDone(null):o?n.onDone({begin:0,chunk:o}):n.onError&&n.onError(r.status)}else n.onError&&n.onError(r.status)}}},hasPendingRequests:function(){for(var e in this.pendingRequests)return!0;return!1},getRequestXhr:function(e){return this.pendingRequests[e].xhr},isStreamingRequest:function(e){return!!this.pendingRequests[e].onProgressiveData},isPendingRequest:function(e){return e in this.pendingRequests},isLoadedRequest:function(e){return e in this.loadedRequests},abortAllRequests:function(){for(var e in this.pendingRequests)this.abortRequest(0|e)},abortRequest:function(e){var t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},p.prototype={_onRangeRequestReaderClosed:function(e){var t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)},getFullReader:function(){return(0,i.assert)(!this._fullRequestReader),this._fullRequestReader=new g(this._manager,this._source),this._fullRequestReader},getRangeReader:function(e,t){var n=new m(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n},cancelAllRequests:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}},g.prototype={_onHeadersReceived:function(){var e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=function(e){return t.getResponseHeader(e)},r=(0,o.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),i=r.allowRangeRequests,s=r.suggestedLength;i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=(0,o.extractFilenameFromHeader)(n);var a=this._manager;a.isStreamingRequest(e)?this._isStreamingSupported=!0:this._isRangeSupported&&a.abortRequest(e),this._headersReceivedCapability.resolve()},_onProgressiveData:function(e){this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._cachedChunks.push(e)},_onDone:function(e){e&&this._onProgressiveData(e.chunk),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[])},_onError:function(e){var t=this._url,n=(0,o.createResponseStatusError)(e,t);this._storedError=n,this._headersReceivedCapability.reject(n),this._requests.forEach((function(e){e.reject(n)})),this._requests=[],this._cachedChunks=[]},_onProgress:function(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})},get filename(){return this._filename},get isRangeSupported(){return this._isRangeSupported},get isStreamingSupported(){return this._isStreamingSupported},get contentLength(){return this._contentLength},get headersReady(){return this._headersReceivedCapability.promise},read:(h=l(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._storedError){e.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){e.next=5;break}return t=this._cachedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 5:if(!this._done){e.next=7;break}return e.abrupt("return",{value:void 0,done:!0});case 7:return n=(0,i.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 10:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)}),cancel:function(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},m.prototype={_close:function(){this.onClosed&&this.onClosed(this)},_onDone:function(e){var t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._close()},_onProgress:function(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})},get isStreamingSupported(){return!1},read:(d=l(r.default.mark((function e(){var t,n;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,i.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)}),cancel:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},t.PDFNetworkStream=p,t.NetworkManager=c}])},e.exports=o()}).call(this,n(216).Buffer,n(6),n(45))},function(e,t,n){"use strict";(function(e){var r=n(217),i=n(218),o=n(219);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=d(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):d(e,t);if("Buffer"===t.type&&o(t.data))return d(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=a(e,t<0?0:0|f(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function d(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return E(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,s=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){for(var h=!0,d=0;d<l;d++)if(c(e,o+d)!==c(t,d)){h=!1;break}if(h)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return W(H(t,e.length-n),e,n,r)}function _(e,t,n,r){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function C(e,t,n,r){return _(e,t,n,r)}function S(e,t,n,r){return W(z(t),e,n,r)}function k(e,t,n,r){return W(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,l,c=e[i],u=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=h}return function(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=$));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return h(null,e)},l.allocUnsafeSlow=function(e){return h(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):g.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(r,i),u=e.slice(t,n),h=0;h<a;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return C(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=B(e[o]);return i}function M(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function L(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function I(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||I(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,o){return o||I(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;n=new l(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUInt8=function(e,t){return t||L(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||L(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||L(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||L(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||L(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||L(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||L(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||L(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||L(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||L(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=l.isBuffer(e)?e:H(new l(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(6))},function(e,t,n){"use strict";t.byteLength=function(e){return 3*e.length/4-c(e)},t.toByteArray=function(e){var t,n,r,s,a,l=e.length;s=c(e),a=new o(3*l/4-s),n=s>0?l-4:l;var u=0;for(t=0;t<n;t+=4)r=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)],a[u++]=r>>16&255,a[u++]=r>>8&255,a[u++]=255&r;2===s?(r=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4,a[u++]=255&r):1===s&&(r=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2,a[u++]=r>>8&255,a[u++]=255&r);return a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o="",s=[],a=0,l=n-i;a<l;a+=16383)s.push(u(e,a,a+16383>l?l:a+16383));1===i?(t=e[n-1],o+=r[t>>2],o+=r[t<<4&63],o+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],o+=r[t>>10],o+=r[t>>4&63],o+=r[t<<2&63],o+="=");return s.push(o),s.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function u(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16)+(e[a+1]<<8)+e[a+2],s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+h],h+=d,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+h],h+=d,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,l,c=8*o-i-1,u=(1<<c)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(t*l-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+f]=255&s,f+=p,s/=256,c-=8);e[n+f-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";var r=n(225),i=n(226);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=b(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),h=["%","/","?",";","#"].concat(u),d=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(227);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(a);if(b=b.trim(),!n&&1===e.split("#").length){var w=l.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=s.exec(b);if(_){var C=(_=_[0]).toLowerCase();this.protocol=C,b=b.substr(_.length)}if(n||_||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===b.substr(0,2);!S||_&&m[_]||(b=b.substr(2),this.slashes=!0)}if(!m[_]&&(S||_&&!v[_])){for(var k,A,x=-1,$=0;$<d.length;$++){-1!==(T=b.indexOf(d[$]))&&(-1===x||T<x)&&(x=T)}-1!==(A=-1===x?b.lastIndexOf("@"):b.lastIndexOf("@",x))&&(k=b.slice(0,A),b=b.slice(A+1),this.auth=decodeURIComponent(k)),x=-1;for($=0;$<h.length;$++){var T;-1!==(T=b.indexOf(h[$]))&&(-1===x||T<x)&&(x=T)}-1===x&&(x=b.length),this.host=b.slice(0,x),b=b.slice(x),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var R=this.hostname.split(/\./),M=($=0,R.length);$<M;$++){var L=R[$];if(L&&!L.match(f)){for(var P="",O=0,D=L.length;O<D;O++)L.charCodeAt(O)>127?P+="x":P+=L[O];if(!P.match(f)){var I=R.slice(0,$),F=R.slice($+1),j=L.match(p);j&&(I.push(j[1]),F.unshift(j[2])),F.length&&(b="/"+F.join(".")+b),this.hostname=I.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=r.toASCII(this.hostname));var N=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+N,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!g[C])for($=0,M=u.length;$<M;$++){var H=u[$];if(-1!==b.indexOf(H)){var z=encodeURIComponent(H);z===H&&(z=escape(H)),b=b.split(H).join(z)}}var W=b.indexOf("#");-1!==W&&(this.hash=b.substr(W),b=b.slice(0,W));var U=b.indexOf("?");if(-1!==U?(this.search=b.substr(U),this.query=b.substr(U+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,U)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){N=this.pathname||"";var V=this.search||"";this.path=N+V}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var u=l[c];"protocol"!==u&&(n[u]=e[u])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var h=Object.keys(e),d=0;d<h.length;d++){var f=h[d];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||m[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var g=n.pathname||"",y=n.search||"";n.path=g+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=w||b||n.host&&e.pathname,C=_,S=n.pathname&&n.pathname.split("/")||[],k=(p=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(k&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),_=_&&(""===p[0]||""===S[0])),w)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=p;else if(p.length)S||(S=[]),S.pop(),S=S.concat(p),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(k)n.hostname=n.host=S.shift(),(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=S.slice(-1)[0],x=(n.host||e.host||S.length>1)&&("."===A||".."===A)||""===A,$=0,T=S.length;T>=0;T--)"."===(A=S[T])?S.splice(T,1):".."===A?(S.splice(T,1),$++):$&&(S.splice(T,1),$--);if(!_&&!C)for(;$--;$)S.unshift("..");!_||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),x&&"/"!==S.join("/").substr(-1)&&S.push("");var E,R=""===S[0]||S[0]&&"/"===S[0].charAt(0);k&&(n.hostname=n.host=R?"":S.length?S.shift():"",(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(_=_||n.host&&S.length)&&!R&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var i;!function(o){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof r&&r;s.global!==s&&s.window!==s&&s.self;var a,l=2147483647,c=36,u=1,h=26,d=38,f=700,p=72,g=128,m="-",v=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=c-u,C=Math.floor,S=String.fromCharCode;function k(e){throw new RangeError(w[e])}function A(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function x(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+A((e=e.replace(b,".")).split("."),t).join(".")}function $(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function T(e){return A(e,(function(e){var t="";return e>65535&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=S(e)})).join("")}function E(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,n){var r=0;for(e=n?C(e/f):e>>1,e+=C(e/t);e>_*h>>1;r+=c)e=C(e/_);return C(r+(_+1)*e/(e+d))}function M(e){var t,n,r,i,o,s,a,d,f,v,y,b=[],w=e.length,_=0,S=g,A=p;for((n=e.lastIndexOf(m))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&k("not-basic"),b.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<w;){for(o=_,s=1,a=c;i>=w&&k("invalid-input"),((d=(y=e.charCodeAt(i++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||d>C((l-_)/s))&&k("overflow"),_+=d*s,!(d<(f=a<=A?u:a>=A+h?h:a-A));a+=c)s>C(l/(v=c-f))&&k("overflow"),s*=v;A=R(_-o,t=b.length+1,0==o),C(_/t)>l-S&&k("overflow"),S+=C(_/t),_%=t,b.splice(_++,0,S)}return T(b)}function L(e){var t,n,r,i,o,s,a,d,f,v,y,b,w,_,A,x=[];for(b=(e=$(e)).length,t=g,n=0,o=p,s=0;s<b;++s)(y=e[s])<128&&x.push(S(y));for(r=i=x.length,i&&x.push(m);r<b;){for(a=l,s=0;s<b;++s)(y=e[s])>=t&&y<a&&(a=y);for(a-t>C((l-n)/(w=r+1))&&k("overflow"),n+=(a-t)*w,t=a,s=0;s<b;++s)if((y=e[s])<t&&++n>l&&k("overflow"),y==t){for(d=n,f=c;!(d<(v=f<=o?u:f>=o+h?h:f-o));f+=c)A=d-v,_=c-v,x.push(S(E(v+A%_,0))),d=C(A/_);x.push(S(E(d,0))),o=R(n,w,r==i),n=0,++r}++n,++t}return x.join("")}a={version:"1.4.1",ucs2:{decode:$,encode:T},decode:M,encode:L,toASCII:function(e){return x(e,(function(e){return y.test(e)?"xn--"+L(e):e}))},toUnicode:function(e){return x(e,(function(e){return v.test(e)?M(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return a}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(8)(e),n(6))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(228),t.encode=t.stringify=n(229)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var h,d,f,p,g=e[u].replace(a,"%20"),m=g.indexOf(n);m>=0?(h=g.substr(0,m),d=g.substr(m+1)):(h=g,d=""),f=decodeURIComponent(h),p=decodeURIComponent(d),r(s,f)?i(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(s(e),(function(s){var a=encodeURIComponent(r(s))+n;return i(e[s])?o(e[s],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[s]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(0),n(43)],void 0===(i=function(e,t){return e.factory("pdfHighlights",(function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.highlightsLayerDiv=t.highlights[0],this.highlightElements=[]}var n,r,i;return n=e,(r=[{key:"addHighlight",value:function(e,n,r,i,o){var s=e.convertToViewportRectangle([n,r,n+i,r+o]);s=t.Util.normalizeRect(s);var a=document.createElement("div");return a.style.left=Math.floor(s[0])+"px",a.style.top=Math.floor(s[1])+"px",a.style.width=Math.ceil(s[2]-s[0])+"px",a.style.height=Math.ceil(s[3]-s[1])+"px",this.highlightElements.push(a),this.highlightsLayerDiv.appendChild(a),a}},{key:"clearHighlights",value:function(){for(var e=0,t=Array.from(this.highlightElements);e<t.length;e++){var n=t[e];null!=n&&n.parentNode.removeChild(n)}return this.highlightElements=[]}}])&&o(n.prototype,r),i&&o(n,i),e}()}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function l(e,t){return null!=e?t(e):void 0}r=[n(0),n(43)],void 0===(i=function(e,t){return e.factory("PDFRenderer",["$q","$timeout","pdfAnnotations","pdfTextLayer","pdfSpinner",function(e,n,r,i,s){var c;return(c=function(){function c(n,r){var i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),this.url=n,this.options=r,this.scale=this.options.scale||1,i=l(null!=window.location?window.location.search:void 0,(function(e){return e.indexOf("disable-font-face=true")}))>=0,this.pdfjs=t.getDocument({url:this.url,cMapUrl:window.pdfCMapsPath,cMapPacked:!0,disableFontFace:i,rangeChunkSize:131072,disableAutoFetch:!!this.options.disableAutoFetch,disableStream:!!this.options.disableAutoFetch}),this.pdfjs.onProgress=this.options.progressCallback,this.document=e.when(this.pdfjs),this.navigateFn=this.options.navigateFn,this.spinner=new s,this.resetState(),this.document.then((function(e){return e.getDownloadInfo().then((function(){return o.options.loadedCallback()}))})),this.errorCallback=this.options.errorCallback,this.pageSizeChangeCallback=this.options.pageSizeChangeCallback,this.pdfjs.promise.catch((function(e){return o.errorCallback(e)}))}return a(c,null,[{key:"initClass",value:function(){this.prototype.JOB_QUEUE_INTERVAL=25,this.prototype.PAGE_LOAD_TIMEOUT=6e4,this.prototype.INDICATOR_DELAY1=100,this.prototype.INDICATOR_DELAY2=250,this.prototype.TEXTLAYER_TIMEOUT=100}}]),a(c,[{key:"resetState",value:function(){this.renderQueue=[],null!=this.queueTimer&&clearTimeout(this.queueTimer);for(var e=0,t=Array.from(this.spinTimer||[]);e<t.length;e++){var n=t[e];clearTimeout(n)}for(var r=0,i=Array.from(this.pageState||[]);r<i.length;r++){var o=i[r];l(null!=o?o.loadTask:void 0,(function(e){return e.cancel()})),l(null!=o?o.renderTask:void 0,(function(e){return e.cancel()}))}return this.pageState=[],this.spinTimer=[],this.spinTimerDone=[],this.jobs=0}},{key:"getNumPages",value:function(){return this.document.then((function(e){return e.numPages}))}},{key:"getPage",value:function(e){return this.document.then((function(t){return t.getPage(e)}))}},{key:"getPdfViewport",value:function(e,t){var n=this;return null==t&&(t=this.scale),this.document.then((function(r){return r.getPage(e).then((function(e){return e.getViewport(t)}),(function(e){return"function"==typeof n.errorCallback?n.errorCallback(e):void 0}))}))}},{key:"getDestinations",value:function(){return this.document.then((function(e){return e.getDestinations()}))}},{key:"getDestination",value:function(e){var t=this;return this.document.then((function(t){return t.getDestination(e)}),(function(e){return"function"==typeof t.errorCallback?t.errorCallback(e):void 0}))}},{key:"getPageIndex",value:function(e){var t=this;return this.document.then((function(n){return n.getPageIndex(e).then((function(e){return e}),(function(e){return"function"==typeof t.errorCallback?t.errorCallback(e):void 0}))}))}},{key:"getScale",value:function(){return this.scale}},{key:"setScale",value:function(e){return this.scale=e,this.resetState()}},{key:"triggerRenderQueue",value:function(e){var t=this;return null==e&&(e=this.JOB_QUEUE_INTERVAL),null!=this.queueTimer&&clearTimeout(this.queueTimer),this.queueTimer=setTimeout((function(){return t.queueTimer=null,t.processRenderQueue()}),e)}},{key:"removeCompletedJob",value:function(e){return this.jobs=this.jobs-1,this.triggerRenderQueue(0)}},{key:"renderPages",value:function(e){if(!this.shuttingDown)return this.renderQueue=Array.from(e).map((function(e){return{element:e.elementChildren,pagenum:e.pageNum}})),this.triggerRenderQueue()}},{key:"renderPage",value:function(e){if(!this.shuttingDown){var t={element:e.elementChildren,pagenum:e.pageNum};return this.renderQueue.push(t),this.processRenderQueue()}}},{key:"getPageDetails",value:function(e){return[e.element.canvas,e.pagenum]}},{key:"startIndicators",value:function(){var e=this;this.queuedPages=[];for(var t=0,n=Array.from(this.renderQueue);t<n.length;t++){var r=n[t];this.queuedPages[r.pagenum]=!0}for(var i in this.spinTimer)this.queuedPages[i]||(clearTimeout(this.spinTimer[i]),delete this.spinTimer[i]);return function(){for(var t=[],n=0,i=Array.from(e.renderQueue);n<i.length;n++)r=i[n],e.spinTimer[r.pagenum]||e.spinTimerDone[r.pagenum]||t.push(e.startIndicator(r));return t}()}},{key:"startIndicator",value:function(e){var t=this,n=o(Array.from(this.getPageDetails(e)),2),r=n[0],i=n[1];return r.addClass("pdfng-loading"),this.spinTimer[i]=setTimeout((function(){for(var e=0,n=Array.from(t.renderQueue);e<n.length;e++){var o=n[e];if(i===o.pagenum){t.spinner.add(r,{static:!0}),t.spinTimerDone[i]=!0;break}}return delete t.spinTimer[i]}),this.INDICATOR_DELAY1)}},{key:"updateIndicator",value:function(e){var t=this,n=o(Array.from(this.getPageDetails(e)),2),r=n[0],i=n[1];return this.spinTimerDone[i]?this.spinTimer[i]=setTimeout((function(){return t.spinner.start(r),delete t.spinTimer[i]}),this.INDICATOR_DELAY2):(clearTimeout(this.spinTimer[i]),this.spinTimer[i]=setTimeout((function(){return t.spinner.add(r,{static:!0}),t.spinTimerDone[i]=!0,t.spinTimer[i]=setTimeout((function(){return t.spinner.start(r),delete t.spinTimer[i]}),t.INDICATOR_DELAY2)}),this.INDICATOR_DELAY1))}},{key:"clearIndicator",value:function(e){var t=o(Array.from(this.getPageDetails(e)),2),n=t[0],r=t[1];return this.spinner.stop(n),clearTimeout(this.spinTimer[r]),delete this.spinTimer[r],this.spinTimerDone[r]=!0}},{key:"processRenderQueue",value:function(){var e,t=this;if(!(this.shuttingDown||(this.startIndicators(),this.jobs>0))){for(var r=this.renderQueue.shift();null!=r&&null!=this.pageState[r.pagenum];)r=this.renderQueue.shift();if(null!=r){var i=o(Array.from([r.element,r.pagenum]),2),s=i[0],a=i[1];this.jobs=this.jobs+1,this.updateIndicator(r);var l=n((function(){var e,n,i;if(!c.cancelled)return e=window.Raven,n="captureMessage",i=function(e){return e.captureMessage("pdfng page load timed out after ".concat(t.PAGE_LOAD_TIMEOUT,"ms"))},null!=e&&"function"==typeof e[n]&&i(e,n),t.clearIndicator(r),"function"==typeof t.errorCallback?t.errorCallback("timeout"):void 0}),this.PAGE_LOAD_TIMEOUT),c=this.getPage(a);return c.cancel=function(){return this.cancelled=!0},this.pageState[a]=e={loadTask:c},c.then((function(i){if(n.cancel(l),!c.cancelled)return e.renderTask=t.doRender(s,a,i),e.renderTask.then((function(){return t.clearIndicator(r),e.complete=!0,delete e.renderTask,t.removeCompletedJob(a)}),(function(){return e.complete=!1,delete e.renderTask,t.removeCompletedJob(a)}))})).catch((function(e){return n.cancel(l),t.clearIndicator(r)}))}}}},{key:"doRender",value:function(e,n,o){var s=this,a=this.scale;if(null!=a){var l=$('<canvas class="pdf-canvas pdfng-rendering"></canvas>');e.canvas.replaceWith(l);var c=o.getViewport(a),u=window.devicePixelRatio||1,h=l[0].getContext("2d"),d=u/(h.webkitBackingStorePixelRatio||h.mozBackingStorePixelRatio||h.msBackingStorePixelRatio||h.oBackingStorePixelRatio||h.backingStorePixelRatio||1),f=Math.floor(c.width)*d|0,p=Math.floor(c.height)*d|0,g=Math.floor(c.width),m=Math.floor(c.height);l[0].height=p,l[0].width=f,l.height(m+"px"),l.width(g+"px");var v=e.canvas.height(),y=e.canvas.width();m===v&&g===y||(e.canvas.height(m+"px"),e.canvas.width(g+"px"),e.container.height(m+"px"),e.container.width(g+"px"),"function"==typeof this.pageSizeChangeCallback&&this.pageSizeChangeCallback(n,m-v));var b=new i({textLayerDiv:e.text[0],viewport:c,renderer:t.renderTextLayer}),w=new r({annotations:e.annotations[0],viewport:c,navigateFn:this.navigateFn}),_=o.render({canvasContext:h,viewport:c,transform:[d,0,0,d,0,0]}),C=this.TEXTLAYER_TIMEOUT;return _.then((function(){return l.removeClass("pdfng-rendering"),o.getTextContent({normalizeWhitespace:!0}).then((function(e){return b.setTextContent(e),b.render(C)}),(function(e){return"function"==typeof s.errorCallback?s.errorCallback(e):void 0})),o.getAnnotations().then((function(e){return w.setAnnotations(e)}),(function(e){return"function"==typeof s.errorCallback?s.errorCallback(e):void 0}))})).catch((function(e){if("RenderingCancelledException"!==e.name)return"function"==typeof s.errorCallback?s.errorCallback(e):void 0})),_}}},{key:"destroy",value:function(){return this.shuttingDown=!0,this.resetState(),this.pdfjs.then((function(e){return e.cleanup(),e.destroy()}))}}]),c}()).initClass(),c}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("pdfPage",["$timeout","pdfHighlights","pdfSpinner",function(e,t,n){return{require:"^pdfViewer",template:'<div class="plv-page-view page-view">\n\t<div class="pdf-canvas pdfng-empty"></div>\n\t<div class="plv-text-layer text-layer"></div>\n\t<div class="plv-annotations-layer annotations-layer"></div>\n\t<div class="plv-highlights-layer highlights-layer"></div>\n</div>',link:function(n,r,i,o){var s=$(r).find(".pdf-canvas"),a=$(r).find(".text-layer"),l=$(r).find(".annotations-layer"),c=$(r).find(".highlights-layer"),u=function(e){var t=Math.floor(e[0]),i=Math.floor(e[1]);return r.height(t),r.width(i),s.height(t),s.width(i),n.page.sized=!0};if(n.page.element=r,n.page.elementChildren={canvas:s,text:a,annotations:l,highlights:c,container:r},!n.page.sized)if(null!=n.defaultPageSize)u(n.defaultPageSize);else var h=n.$watch("defaultPageSize",(function(e){if(null!=e)return u(e),h()}));n.page.current&&(n.document.renderPage(n.page),o.setPdfPosition(n.page,n.page.position)),r.on("dblclick",(function(e){var t=$(r).find(".pdf-canvas").offset(),i=e.pageX-t.left,o=e.pageY-t.top;return n.document.getPdfViewport(n.page.pageNum).then((function(e){var t=e.convertToPdfPoint(i,o),r={page:n.page.pageNum,x:t[0],y:e.viewBox[3]-t[1]};return n.$emit("pdfDoubleClick",r)}))}));var d=new t({highlights:c});return n.$on("pdf:highlights",(function(t,r){var i;if(null!=r&&r.length>0){n.timeoutHandler&&(e.cancel(n.timeoutHandler),d.clearHighlights(),n.timeoutHandler=null);var o=function(){for(var e=[],t=0,o=Array.from(r);t<o.length;t++)(i=o[t]).page===n.page.pageNum&&e.push(i);return e}();if(o.length)return n.document.getPdfViewport(n.page.pageNum).then((function(e){return function(){for(var t=[],n=0,r=Array.from(o);n<r.length;n++){var i=r[n],s=e.viewBox[3]-i.v;t.push(d.addHighlight(e,i.h,s,i.width,i.height))}return t}()})),n.timeoutHandler=e((function(){return d.clearHighlights(),n.timeoutHandler=null}),1e3)}})),n.$on("$destroy",(function(){if(null!=n.timeoutHandler)return e.cancel(n.timeoutHandler),d.clearHighlights()}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(0)],void 0===(i=function(e){return e.factory("pdfSpinner",(function(){return function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){var n=$('<div class="pdfng-spinner" style="position: absolute; top: 50%; left:50%; transform: translateX(-50%) translateY(-50%);"><i class="fa fa-spinner'.concat((null!=t?t.static:void 0)?"":" fa-spin",'" style="color: #999"></i></div>'));return n.css({"font-size":"64px"}),e.append(n)}},{key:"start",value:function(e){return e.find(".fa-spinner").addClass("fa-spin")}},{key:"stop",value:function(e){return e.find(".fa-spinner").removeClass("fa-spin")}},{key:"remove",value:function(e){return e.find(".fa-spinner").remove()}}])&&o(t.prototype,n),r&&o(t,r),e}()}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(235)],void 0===(i=function(){return function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$on("entity:selected",(function(e,t){if("track-changes"!==r.$scope.ui.view&&"file"===t.type)return r.openFile(t)}))}var t,n,r;return t=e,(n=[{key:"openFile",value:function(e){var t=this;return this.ide.fileTreeManager.selectEntity(e),this.$scope.ui.view="file",this.$scope.openFile=null,this.$scope.$apply(),window.setTimeout((function(){return t.$scope.openFile=e,t.$scope.$apply()}),0,this)}}])&&o(t.prototype,n),r&&o(t,r),e}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(2)],void 0===(i=function(e,t){return e.controller("BinaryFileController",["$scope","$rootScope","$http","$timeout","$element","ide","waitFor",function(e,t,n,r,i,o,s){var a,l,c=2097152,u=25-"...".length,h=["bib","tex","txt","cls","sty"],d=["png","jpg","jpeg","gif"],f=[],p=function(e){return e.name.split(".").pop().toLowerCase()};function g(){var t=i.find(".text-preview .scroll-container"),n=i.find(".binary-file-header"),r=i.height()-n.height()-14;t.css({"max-height":r}),e.textPreview.loading=!1}e.isTextFile=function(){return h.indexOf(p(e.openFile))>-1},e.isImageFile=function(){return d.indexOf(p(e.openFile))>-1},e.isPreviewableFile=function(){return f.indexOf(p(e.openFile))>-1},e.isUnpreviewableFile=function(){return!e.isTextFile()&&!e.isImageFile()&&!e.isPreviewableFile()},e.textPreview={loading:!1,shouldShowDots:!1,error:!1,data:null},e.refreshing=!1,e.refreshError=null,e.displayUrl=function(e){if(null!=e)return e.length>60?e.slice(0,35)+"..."+e.slice(e.length-u):e},e.refreshFile=function(t){e.refreshing=!0,e.refreshError=null,o.fileTreeManager.refreshLinkedFile(t).then((function(t){var n=t.data.new_file_id;r((function(){return s((function(){return o.fileTreeManager.findEntityById(n)}),5e3).then((function(e){return o.binaryFilesManager.openFile(e)})).catch((function(e){return console.warn(e)}))}),0),e.refreshError=null})).catch((function(t){return e.refreshError=t.data})).finally((function(){e.refreshing=!1;var n=t.linkedFileData.provider;("mendeley"===n||"zotero"===n||t.name.match(/^.*\.bib$/))&&o.$scope.$emit("references:should-reindex",{})}))},e.failedLoad=!1,window.sl_binaryFilePreviewError=function(){e.failedLoad=!0,e.$apply()},e.imgLoaded=!1,window.sl_binaryFilePreviewLoaded=function(){e.imgLoaded=!0,e.$apply()},e.isTextFile()&&(a="/project/".concat(window.project_id,"/file/").concat(e.openFile.id),l=!1,e.textPreview.data=null,e.textPreview.loading=!0,e.textPreview.shouldShowDots=!1,e.$apply(),function(e){return n.head(e).then((function(e){var t=parseInt(e.headers("Content-Length"),10);if(isNaN(t))throw new Error("Could not parse Content-Length header");return t}))}(a).then((function(e){var t={};return e>c&&(l=!0,t.maxSize=c),function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).maxSize;return null!=t&&(e+="?range=0-".concat(t)),n.get(e,{transformResponse:null}).then((function(e){return e.data}))}(a,t)})).then((function(t){!function(t,n){e.textPreview.error=!1,e.textPreview.data=t,e.textPreview.shouldShowDots=n,r(g,0)}(l?function(e){return e.replace(/\n.*$/,"")}(t):t,l)})).catch((function(t){console.error(t),e.textPreview.error=!0,e.textPreview.loading=!1})))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.$scope.$root._references=this.state={keys:[]},this.$scope.$on("document:closed",(function(e,t){var n,i,o;if(t.doc_id&&(n=r.ide.fileTreeManager.findEntityById(t.doc_id)),i=null!=n?n.name:void 0,o=function(e){return e.match(/.*\.bib$/)},null!=i?o(i):void 0)return r.indexReferences([t.doc_id],!0)})),this.$scope.$on("references:should-reindex",(function(e,t){return r.indexAllReferences(!0)})),this.inited=!1,this.$scope.$on("project:joined",(function(e){if(!r.inited)return r.inited=!0,r.indexAllReferences(!1)})),setTimeout((function(e){return e.ide.socket.on("references:keys:updated",(function(t){return e._storeReferencesKeys(t)}))}),1e3,this)}var t,n,r;return t=e,(n=[{key:"_storeReferencesKeys",value:function(e){var t=this.$scope.$root._references.keys;return this.$scope.$root._references.keys=_.union(t,e)}},{key:"indexReferences",value:function(e,t){var n=this,r={docIds:e,shouldBroadcast:t,_csrf:window.csrfToken};return this.ide.$http.post("/project/".concat(this.$scope.project_id,"/references/index"),r).then((function(e){return n._storeReferencesKeys(e.data.keys)}))}},{key:"indexAllReferences",value:function(e){var t=this,n={shouldBroadcast:e,_csrf:window.csrfToken};return this.ide.$http.post("/project/".concat(this.$scope.project_id,"/references/indexAll"),n).then((function(e){return t._storeReferencesKeys(e.data.keys)}))}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ide=t,this.$scope=n,this.metadata=r,this.ide.socket.on("broadcastDocMeta",(function(e){return i.metadata.onBroadcastDocMeta(e)})),this.$scope.$on("entity:deleted",this.metadata.onEntityDeleted),this.$scope.$on("file:upload:complete",this.metadata.fileUploadComplete)}var t,n,r;return t=e,(n=[{key:"loadProjectMetaFromServer",value:function(){return this.metadata.loadProjectMetaFromServer()}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(13),n(7),n(65)],void 0===(i=function(e,t,n,r){return e.controller("ReviewPanelController",["$scope","$element","ide","$timeout","$http","$modal","eventTracking","localStorage",function(e,i,o,s,a,l,c,u){var h,d=i.find("#review-panel"),f="member",p="guest",g="anonymous",m=function(){if(null==(null!=o.$scope.user?o.$scope.user.id:void 0))return g;var e=o.$scope.user.id,t=o.$scope.project;if((null!=t.owner?t.owner.id:void 0)===e)return f;for(var n=0,r=Array.from(t.members);n<r.length;n++){if(r[n]._id===e)return f}return p};e.SubViews={CUR_FILE:"cur_file",OVERVIEW:"overview"},e.UserTCSyncState=h={SYNCED:"synced",PENDING:"pending"},e.reviewPanel={trackChangesState:{},trackChangesOnForEveryone:!1,trackChangesOnForGuests:!1,trackChangesForGuestsAvailable:!1,entries:{},resolvedComments:{},hasEntries:!1,subView:e.SubViews.CUR_FILE,openSubView:e.SubViews.CUR_FILE,overview:{loading:!1,docsCollapsedState:JSON.parse(u("docs_collapsed_state:".concat(e.project_id)))||{}},dropdown:{loading:!1},commentThreads:{},resolvedThreadIds:{},rendererData:{},formattedProjectMembers:{},fullTCStateCollapsed:!0,loadingThreads:!1,selectedEntryIds:[],nVisibleSelectedChanges:0},window.addEventListener("beforeunload",(function(){var t={};for(var n in e.reviewPanel.overview.docsCollapsedState){var r=e.reviewPanel.overview.docsCollapsedState[n];r&&(t[n]=r)}var i=Object.keys(t).length>0?JSON.stringify(t):null;return u("docs_collapsed_state:".concat(e.project_id),i)})),e.$on("layout:pdf:linked",(function(t,n){return e.$broadcast("review-panel:layout")})),e.$on("layout:pdf:resize",(function(t,n){return e.$broadcast("review-panel:layout",!1)})),e.$on("expandable-text-area:resize",(function(t){return s((function(){return e.$broadcast("review-panel:layout")}))})),e.$on("review-panel:sizes",(function(t,n){return e.$broadcast("editor:set-scroll-size",n)})),e.$watch("project.features.trackChangesVisible",(function(t){if(null!=t)return t?void 0:e.ui.reviewPanelOpen=!1})),e.$watch("project.members",(function(t){if(e.reviewPanel.formattedProjectMembers={},null!=(null!=e.project?e.project.owner:void 0)&&(e.reviewPanel.formattedProjectMembers[e.project.owner._id]=X(e.project.owner)),null!=(null!=e.project?e.project.members:void 0))return function(){for(var n=[],r=0,i=Array.from(t);r<i.length;r++){var o=i[r];"readAndWrite"===o.privileges?n.push(e.reviewPanel.formattedProjectMembers[o._id]=X(o)):n.push(void 0)}return n}()})),e.commentState={adding:!1,content:""},e.users={},e.reviewPanelEventsBridge=new t,o.socket.on("new-comment",(function(t,n){var r=b(t);return delete r.submitting,r.messages.push(K(n)),e.$apply(),s((function(){return e.$broadcast("review-panel:layout")}))})),o.socket.on("accept-changes",(function(t,n){return t!==e.editor.open_doc_id?w(t).removeChangeIds(n):e.$broadcast("changes:accept",n),x(t),e.$apply((function(){}))})),o.socket.on("resolve-thread",(function(e,t){return R(e,t)})),o.socket.on("reopen-thread",(function(e){return M(e)})),o.socket.on("delete-thread",(function(t){return L(t),e.$apply((function(){}))})),o.socket.on("edit-message",(function(t,n,r){return P(t,n,r),e.$apply((function(){}))})),o.socket.on("delete-message",(function(t,n){return O(t,n),e.$apply((function(){}))}));var v={},y=function(t){return null==e.reviewPanel.entries[t]&&(e.reviewPanel.entries[t]={}),e.reviewPanel.entries[t]},b=function(t){return null==e.reviewPanel.commentThreads[t]&&(e.reviewPanel.commentThreads[t]={messages:[]}),e.reviewPanel.commentThreads[t]},w=function(t){return null==v[t]&&(v[t]=new r,v[t].resolvedThreadIds=e.reviewPanel.resolvedThreadIds),v[t]},_={};e.reviewPanelEventsBridge.on("aceScrollbarVisibilityChanged",(function(e,t){return _={isVisible:e,scrollbarWidth:t},C()}));var C=function(){return _.isVisible&&e.reviewPanel.subView===e.SubViews.CUR_FILE&&!e.editor.showRichText?d.css("right","".concat(_.scrollbarWidth,"px")):d.css("right","0")};e.$watch("!ui.reviewPanelOpen && reviewPanel.hasEntries",(function(t,n){if(null!=t)return e.ui.miniReviewPanelVisible=t,t!==n?s((function(){return e.$broadcast("review-panel:toggle")})):void 0})),e.$watch("ui.reviewPanelOpen",(function(t){if(null!=t)return t?e.reviewPanel.subView=e.reviewPanel.openSubView:(e.reviewPanel.openSubView=e.reviewPanel.subView,e.reviewPanel.subView=e.SubViews.CUR_FILE),s((function(){return e.$broadcast("review-panel:toggle"),e.$broadcast("review-panel:layout",!1)}))})),e.$watch("reviewPanel.subView",(function(t){if(null!=t)return C(),t===e.SubViews.OVERVIEW?A():void 0})),e.$watch("editor.sharejs_doc",(function(t,n){if(null!=t)return v[t.doc_id]=t.ranges,v[t.doc_id].resolvedThreadIds=e.reviewPanel.resolvedThreadIds,e.reviewPanel.rangesTracker=v[t.doc_id],null!=n&&n.off("flipped_pending_to_inflight"),t.on("flipped_pending_to_inflight",(function(){return S(t)})),S(t)})),e.$watch((function(){var t=e.reviewPanel.entries[e.editor.open_doc_id]||{},n={};for(var r in t){var i=t[r];["add-comment","bulk-actions"].includes(r)||(n[r]=i)}return Object.keys(n).length}),(function(t){return e.reviewPanel.hasEntries=t>0&&e.project.features.trackChangesVisible}));var S=function(e){var t=w(e.doc_id).getIdSeed(),n=r.generateIdSeed();return w(e.doc_id).setIdSeed(n),e.setTrackChangesIdSeeds({pending:n,inflight:t})},k=function(){return a.get("/project/".concat(e.project_id,"/ranges")).then((function(t){var n=t.data;return function(){for(var t=[],r=0,i=Array.from(n);r<i.length;r++){var o=i[r];if(null==e.reviewPanel.overview.docsCollapsedState[o.id]&&(e.reviewPanel.overview.docsCollapsedState[o.id]=!1),o.id!==e.editor.open_doc_id){var s=w(o.id);s.comments=(null!=o.ranges?o.ranges.comments:void 0)||[],s.changes=(null!=o.ranges?o.ranges.changes:void 0)||[]}t.push(x(o.id))}return t}()}))},A=function(){return e.reviewPanel.overview.loading=!0,k().then((function(){return e.reviewPanel.overview.loading=!1})).catch((function(){return e.reviewPanel.overview.loading=!1}))};e.refreshResolvedCommentsDropdown=function(){e.reviewPanel.dropdown.loading=!0;var t=k();return t.then((function(){return e.reviewPanel.dropdown.loading=!1})),t.catch((function(){return e.reviewPanel.dropdown.loading=!1})),t};var x=function(t){var n,r,i,o,s=w(t),a=y(t),l=function(t){return null==e.reviewPanel.resolvedComments[t]&&(e.reviewPanel.resolvedComments[t]={}),e.reviewPanel.resolvedComments[t]}(t),c=!1,u={};for(var h in a)if(n=a[h],!["add-comment","bulk-actions"].includes(h))for(var d=0,f=Array.from(n.entry_ids);d<f.length;d++)u[f[d]]=!0;for(h in l){n=l[h];for(var p=0,g=Array.from(n.entry_ids);p<g.length;p++)u[g[p]]=!0}for(var m=!1,v=null,b=0,_=Array.from(s.changes);b<_.length;b++){if(n=_[b],c=!0,m&&n.op.d&&n.op.p===v.op.p+v.op.i.length&&n.metadata.user_id===v.metadata.user_id)a[v.id].type="aggregate-change",a[v.id].metadata.replaced_content=n.op.d,a[v.id].entry_ids.push(n.id);else for(r in null==a[n.id]&&(a[n.id]={}),delete u[n.id],i={type:n.op.i?"insert":"delete",entry_ids:[n.id],content:n.op.i||n.op.d,offset:n.op.p,metadata:n.metadata})o=i[r],a[n.id][r]=o;n.op.i?(m=!0,v=n):(m=!1,v=null),null==e.users[n.metadata.user_id]&&V(n.metadata.user_id)}s.comments.length>0&&G();for(var C=0,S=Array.from(s.comments);C<S.length;C++){var k,A=S[C];for(r in c=!0,delete u[A.id],e.reviewPanel.resolvedThreadIds[A.op.t]?(k=null!=l[A.id]?l[A.id]:l[A.id]={},delete a[A.id]):(k=null!=a[A.id]?a[A.id]:a[A.id]={},delete l[A.id]),i={type:"comment",thread_id:A.op.t,entry_ids:[A.id],content:A.op.c,offset:A.op.p})o=i[r],k[r]=o}for(var x in u){u[x];c=!0,delete a[x],delete l[x]}if(c)return e.$broadcast("entries:changed")};e.$on("editor:track-changes:changed",(function(){var t=e.editor.open_doc_id;if(x(t),!e.editor.showRichText)return e.$broadcast("review-panel:recalculate-screen-positions"),e.$broadcast("review-panel:layout")})),e.$on("editor:track-changes:visibility_changed",(function(){return s((function(){return e.$broadcast("review-panel:layout",!1)}))})),e.$on("editor:focus:changed",(function(t,n,r,i){var o=e.editor.open_doc_id,s=y(o);for(var a in e.reviewPanel.selectedEntryIds=[],e.reviewPanel.nVisibleSelectedChanges=0,delete s["add-comment"],delete s["bulk-actions"],i&&(s["add-comment"]={type:"add-comment",offset:n,length:r-n},s["bulk-actions"]={type:"bulk-actions",offset:n,length:r-n}),s){var l=s[a],c=!1;if("comment"!==l.type||e.reviewPanel.resolvedThreadIds[l.thread_id]?"insert"===l.type?(c=l.offset>=n&&l.offset+l.content.length<=r,l.focused=l.offset<=n&&n<=l.offset+l.content.length):"delete"===l.type?(c=n<=l.offset&&l.offset<=r,l.focused=l.offset===n):"aggregate-change"===l.type?(c=l.offset>=n&&l.offset+l.content.length<=r,l.focused=l.offset<=n&&n<=l.offset+l.content.length):["add-comment","bulk-actions"].includes(l.type)&&i&&(l.focused=!0):l.focused=l.offset<=n&&n<=l.offset+l.content.length,c){for(var u=0,h=Array.from(l.entry_ids);u<h.length;u++){var d=h[u];e.reviewPanel.selectedEntryIds.push(d)}e.reviewPanel.nVisibleSelectedChanges++}}return e.$broadcast("review-panel:recalculate-screen-positions"),e.$broadcast("review-panel:layout")})),e.acceptChanges=function(t){return $(t),c.sendMB("rp-changes-accepted",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})},e.rejectChanges=function(t){return T(t),c.sendMB("rp-changes-rejected",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})};var $=function(t){return a.post("/project/".concat(e.project_id,"/doc/").concat(e.editor.open_doc_id,"/changes/accept"),{change_ids:t,_csrf:window.csrfToken}),e.$broadcast("changes:accept",t)},T=function(t){return e.$broadcast("changes:reject",t)};e.showBulkAcceptDialog=function(){return E(!0)},e.showBulkRejectDialog=function(){return E(!1)};var E=function(t){return l.open({templateUrl:"bulkActionsModalTemplate",controller:"BulkActionsModalController",resolve:{isAccept:function(){return t},nChanges:function(){return e.reviewPanel.nVisibleSelectedChanges}},scope:e.$new()}).result.then((function(t){return t?($(e.reviewPanel.selectedEntryIds.slice()),c.sendMB("rp-bulk-accept",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",nEntries:e.reviewPanel.nVisibleSelectedChanges})):(T(e.reviewPanel.selectedEntryIds.slice()),c.sendMB("rp-bulk-reject",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",nEntries:e.reviewPanel.nVisibleSelectedChanges}))}))};e.handleTogglerClick=function(t){return t.target.blur(),e.toggleReviewPanel()},e.addNewComment=function(){return e.$broadcast("comment:start_adding"),e.toggleReviewPanel()},e.addNewCommentFromKbdShortcut=function(){if(e.project.features.trackChangesVisible)return e.$broadcast("comment:select_line"),e.ui.reviewPanelOpen||e.toggleReviewPanel(),s((function(){return e.$broadcast("review-panel:layout"),e.$broadcast("comment:start_adding")}))},e.startNewComment=function(){return e.$broadcast("comment:select_line"),s((function(){return e.$broadcast("review-panel:layout")}))},e.submitNewComment=function(t){if(null!=t&&""!==t){var n=e.editor.open_doc_id,i=y(n);if(null!=i["add-comment"]){var l=i["add-comment"],u=l.offset,h=l.length,d=r.generateId();return b(d).submitting=!0,e.$broadcast("comment:add",d,u,h),a.post("/project/".concat(e.project_id,"/thread/").concat(d,"/messages"),{content:t,_csrf:window.csrfToken}).catch((function(){return o.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment")})),e.$broadcast("editor:clearSelection"),s((function(){return e.$broadcast("review-panel:layout")})),c.sendMB("rp-new-comment",{size:t.length})}}},e.cancelNewComment=function(t){return s((function(){return e.$broadcast("review-panel:layout")}))},e.startReply=function(t){return t.replying=!0,s((function(){return e.$broadcast("review-panel:layout")}))},e.submitReply=function(t,n){var r=t.thread_id,i=t.replyContent;a.post("/project/".concat(e.project_id,"/thread/").concat(r,"/messages"),{content:i,_csrf:window.csrfToken}).catch((function(){return o.showGenericMessageModal("Error submitting comment","Sorry, there was a problem submitting your comment")}));var l={view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini",size:t.replyContent.length,thread:r};return b(r).submitting=!0,t.replyContent="",t.replying=!1,s((function(){return e.$broadcast("review-panel:layout")})),c.sendMB("rp-comment-reply",l)},e.cancelReply=function(t){return t.replying=!1,t.replyContent="",e.$broadcast("review-panel:layout")},e.resolveComment=function(t,n){return t.focused=!1,a.post("/project/".concat(e.project_id,"/thread/").concat(t.thread_id,"/resolve"),{_csrf:window.csrfToken}),R(t.thread_id,o.$scope.user),c.sendMB("rp-comment-resolve",{view:e.ui.reviewPanelOpen?e.reviewPanel.subView:"mini"})},e.unresolveComment=function(t){return M(t),a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/reopen"),{_csrf:window.csrfToken}),c.sendMB("rp-comment-reopen")};var R=function(t,n){var r=b(t);if(null!=r)return r.resolved=!0,r.resolved_by_user=X(n),r.resolved_at=(new Date).toISOString(),e.reviewPanel.resolvedThreadIds[t]=!0,e.$broadcast("comment:resolve_threads",[t])},M=function(t){var n=b(t);if(null!=n)return delete n.resolved,delete n.resolved_by_user,delete n.resolved_at,delete e.reviewPanel.resolvedThreadIds[t],e.$broadcast("comment:unresolve_thread",t)},L=function(t){return delete e.reviewPanel.resolvedThreadIds[t],delete e.reviewPanel.commentThreads[t],e.$broadcast("comment:remove",t)},P=function(e,t,n){var r=b(e);if(null!=r){for(var i=0,o=Array.from(r.messages);i<o.length;i++){var s=o[i];s.id===t&&(s.content=n)}return x()}},O=function(e,t){var n=b(e);if(null!=n)return n.messages=n.messages.filter((function(e){return e.id!==t})),x()};e.deleteThread=function(t,n,r){return L(r),a({method:"DELETE",url:"/project/".concat(e.project_id,"/doc/").concat(n,"/thread/").concat(r),headers:{"X-CSRF-Token":window.csrfToken}}),c.sendMB("rp-comment-delete")},e.saveEdit=function(t,n){return a.post("/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(n.id,"/edit"),{content:n.content,_csrf:window.csrfToken}),s((function(){return e.$broadcast("review-panel:layout")}))},e.deleteComment=function(t,n){return O(t,n.id),a({method:"DELETE",url:"/project/".concat(e.project_id,"/thread/").concat(t,"/messages/").concat(n.id),headers:{"X-CSRF-Token":window.csrfToken}}),s((function(){return e.$broadcast("review-panel:layout")}))},e.setSubView=function(t){return e.reviewPanel.subView=t,c.sendMB("rp-subview-change",{subView:t})},e.gotoEntry=function(e,t){return o.editorManager.openDocId(e,{gotoOffset:t.offset})},e.toggleFullTCStateCollapse=function(){return e.project.features.trackChanges?e.reviewPanel.fullTCStateCollapsed=!e.reviewPanel.fullTCStateCollapsed:(D(),e.openTrackChangesUpgradeModal())};var D=function(){c.send("subscription-funnel","editor-click-feature","real-time-track-changes")},I=function(t,n,r){null==r&&(r=!1),null==e.reviewPanel.trackChangesState[t]&&(e.reviewPanel.trackChangesState[t]={});var i=e.reviewPanel.trackChangesState[t];if(null==i.syncState||i.syncState===h.SYNCED?(i.value=n,i.syncState=h.SYNCED):i.syncState===h.PENDING&&i.value===n?i.syncState=h.SYNCED:r&&(i.value=n,i.syncState=h.PENDING),t===o.$scope.user.id)return e.editor.wantTrackChanges=n},F=function(t,n){null==n&&(n=!1),e.reviewPanel.trackChangesOnForEveryone=t;for(var r=e.project,i=0,o=Array.from(r.members);i<o.length;i++){var s=o[i];I(s._id,t,n)}return j(t,n),I(r.owner._id,t,n)},j=function(t,n){if(null==n&&(n=!1),e.reviewPanel.trackChangesOnForGuests=t,m()===p||m()===g)return e.editor.wantTrackChanges=t},N=function(){var t={};if(e.reviewPanel.trackChangesOnForEveryone)t.on=!0;else{for(var n in t.on_for={},e.reviewPanel.trackChangesState){var r=e.reviewPanel.trackChangesState[n];t.on_for[n]=r.value}e.reviewPanel.trackChangesOnForGuests&&(t.on_for_guests=!0)}return t._csrf=window.csrfToken,a.post("/project/".concat(e.project_id,"/track_changes"),t)},B=function(t){if("boolean"==typeof t)return F(t),j(t);var n=e.project;e.reviewPanel.trackChangesOnForEveryone=!1,j(!0===t.__guests__);for(var r=0,i=Array.from(n.members);r<i.length;r++){var o=i[r];I(o._id,null!=t[o._id]&&t[o._id])}return I(e.project.owner._id,null!=t[e.project.owner._id]&&t[e.project.owner._id])};e.toggleTrackChangesForEveryone=function(e){return F(e,!0),j(e,!0),N()},e.toggleTrackChangesForGuests=function(e){return j(e,!0),N()},e.toggleTrackChangesForUser=function(e,t){return I(t,e,!0),N()},o.socket.on("toggle-track-changes",(function(t){return e.$apply((function(){return B(t)}))})),e.toggleTrackChangesFromKbdShortcut=function(){if(e.project.features.trackChangesVisible&&e.project.features.trackChanges)return e.toggleTrackChangesForUser(!e.reviewPanel.trackChangesState[o.$scope.user.id].value,o.$scope.user.id)};var H=function(t){return e.reviewPanel.trackChangesForGuestsAvailable="tokenBased"===t};e.$watch("project.publicAccesLevel",H),e.$watch("reviewPanel.trackChangesForGuestsAvailable",(function(t){if(null!=t)return function(t){if(!t&&e.reviewPanel.trackChangesOnForGuests&&!e.reviewPanel.trackChangesOnForEveryone)return e.toggleTrackChangesForGuests(!1)}(t)}));var z=!1;o.$scope.$on("project:joined",(function(){if(!z){var e=o.$scope.project;return e.features.trackChanges?(null==window.trackChangesState&&(window.trackChangesState=!1),B(window.trackChangesState)):B(!1),H(e.publicAccesLevel),z=!0}}));var W=!1,U={},V=function(t){if(null!=t){if(null!=U[t])return;U[t]=!0}if(!W)return W=!0,a.get("/project/".concat(e.project_id,"/changes/users")).then((function(t){var n=t.data;return W=!1,e.users={},null!=(null!=o.$scope.user?o.$scope.user.id:void 0)&&(e.users[o.$scope.user.id]=X(o.$scope.user)),function(){for(var t=[],r=0,i=Array.from(n);r<i.length;r++){var o=i[r];null!=o.id?t.push(e.users[o.id]=X(o)):t.push(void 0)}return t}()})).catch((function(){return W=!1}))},q=!1,G=function(){if(!q)return q=!0,e.reviewPanel.loadingThreads=!0,a.get("/project/".concat(e.project_id,"/threads")).then((function(t){var n=t.data;for(var r in e.reviewPanel.loadingThreads=!1,e.reviewPanel.resolvedThreadIds){e.reviewPanel.resolvedThreadIds[r];delete e.reviewPanel.resolvedThreadIds[r]}for(r in n){for(var i=n[r],o=0,a=Array.from(i.messages);o<a.length;o++){var l=a[o];K(l)}null!=i.resolved_by_user&&(i.resolved_by_user=X(i.resolved_by_user),e.reviewPanel.resolvedThreadIds[r]=!0,e.$broadcast("comment:resolve_threads",[r]))}return e.reviewPanel.commentThreads=n,s((function(){return e.$broadcast("review-panel:layout")}))}))},K=function(e){return e.user=X(e.user),e.timestamp=new Date(e.timestamp),e},X=function(e){var t,r,i=(null!=e?e._id:void 0)||(null!=e?e.id:void 0);return null==i?{email:null,name:"Anonymous",isSelf:!1,hue:n.ANONYMOUS_HUE,avatar_text:"A"}:(i===window.user_id?(r="You",t=!0):(""===(r=[e.first_name,e.last_name].filter((function(e){return null!=e&&""!==e})).join(" "))&&(r=(null!=e.email?e.email.split("@")[0]:void 0)||"Unknown"),t=!1),{id:i,email:e.email,name:r,isSelf:t,hue:n.getHueForUserId(i),avatar_text:[e.first_name,e.last_name].filter((function(e){return null!=e})).map((function(e){return e[0]})).join("")})};return e.openTrackChangesUpgradeModal=function(){return l.open({templateUrl:"trackChangesUpgradeModalTemplate",controller:"TrackChangesUpgradeModalController",scope:e.$new()})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("TrackChangesUpgradeModalController",["$scope","$modalInstance",function(e,t){return e.cancel=function(){return t.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("BulkActionsModalController",["$scope","$modalInstance","isAccept","nChanges",function(e,t,n,r){return e.isAccept=n,e.nChanges=r,e.cancel=function(){return t.dismiss()},e.confirm=function(){return t.close(n)}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("reviewPanelSorted",["$timeout",function(e){return{link:function(e,t,n){var r=0,i=function(n){var i,o,s,a,l,c,u,h,d;null==n&&(n=!0),n?t.removeClass("no-animate"):t.addClass("no-animate"),e.ui.reviewPanelOpen?(u=8,h=38,c=57):(u=4,h=4,c=0);for(var f=[],p=0,g=Array.from(t.find(".rp-entry-wrapper"));p<g.length;p++){var m=g[p];i={$indicator_el:$(m).find(".rp-entry-indicator"),$box_el:$(m).find(".rp-entry"),$callout_el:$(m).find(".rp-entry-callout"),scope:angular.element(m).scope()},e.ui.reviewPanelOpen?i.$layout_el=i.$box_el:i.$layout_el=i.$indicator_el,i.height=i.$layout_el.height(),f.push(i)}if(f.sort((function(e,t){return e.scope.entry.offset-t.scope.entry.offset})),0!==f.length){var v=e.reviewPanel.rendererData.lineHeight,y=Math.min(r,f.length-1);for(s=0;s<f.length;s++)if((i=f[s]).scope.entry.focused){y=s;break}var b=f.slice(y+1),w=f.slice(0,y),_=f[y];r=y,sl_console.log("focused_entry_index",y);var C=function(e,t,n){return t<=n?(e.removeClass("rp-entry-callout-inverted"),e.css({top:t+v-1,height:n-t})):(e.addClass("rp-entry-callout-inverted"),e.css({top:n+v,height:t-n}))},S=Math.max(_.scope.entry.screenPos.y,h);_.$box_el.css({top:S,visibility:"visible"}),_.$indicator_el.css({top:S}),C(_.$callout_el,_.scope.entry.screenPos.y,S);for(var k=S+_.$layout_el.height(),A=0,x=Array.from(b);A<x.length;A++){a=(i=x[A]).scope.entry.screenPos.y,o=i.height,k=(d=Math.max(a,k+u))+o,i.$box_el.css({top:d,visibility:"visible"}),i.$indicator_el.css({top:d}),C(i.$callout_el,a,d),sl_console.log("ENTRY",{entry:i.scope.entry,top:d})}var T=S;for(w.reverse(),s=0;s<w.length;s++){var E=(a=(i=w[s]).scope.entry.screenPos.y)+(o=i.height);T=d=Math.min(E,T-u)-o,i.$box_el.css({top:d,visibility:"visible"}),i.$indicator_el.css({top:d}),C(i.$callout_el,a,d),sl_console.log("ENTRY",{entry:i.scope.entry,top:d})}return l=d<h?-d+h:0,e.$emit("review-panel:sizes",{overflowTop:l,height:k+c})}};e.$applyAsync((function(){return i()})),e.$on("review-panel:layout",(function(t,n){return null==n&&(n=!0),e.$applyAsync((function(){return i(n)}))})),e.$watch("reviewPanel.rendererData.lineHeight",(function(){return i()}));var o=t,s=t.find(".rp-entry-list-inner");ace.require("ace/lib/event").addMouseWheelListener(o[0],(function(e){var t=e.wheelY,n=parseInt(s.css("top"));return l(-(n-4*t)),e.preventDefault()}));var a=!1,l=function(t){return e.reviewPanelEventsBridge.emit("externalScroll",t)};return e.reviewPanelEventsBridge.on("aceScroll",(function(e,t){if(a)return a=!1;return s.height(t),s.css({top:-e})})),e.$on("$destroy",(function(){return e.reviewPanelEventsBridge.off("aceScroll")})),e.reviewPanelEventsBridge.emit("refreshScrollPosition")}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("reviewPanelToggle",(function(){return{restrict:"E",scope:{onToggle:"&",ngModel:"=",valWhenUndefined:"=?",isDisabled:"=?",onDisabledClick:"&?",description:"@"},link:function(e){return null==e.disabled&&(e.disabled=!1),e.onChange=function(){return e.onToggle({isOn:e.localModel})},e.handleClick=function(){if(e.disabled&&null!=e.onDisabledClick)return e.onDisabledClick()},e.localModel=e.ngModel,e.$watch("ngModel",(function(t){return null!=e.valWhenUndefined&&null==t&&(t=e.valWhenUndefined),e.localModel=t}))},template:'<fieldset class="rp-toggle" ng-click="handleClick();">\n  <legend class="sr-only">{{description}}</legend>\n  <input id="rp-toggle-{{$id}}" ng-disabled="isDisabled" type="checkbox" class="rp-toggle-hidden-input" ng-model="localModel" ng-change="onChange()" />\n  <label for="rp-toggle-{{$id}}" class="rp-toggle-btn"></label>\n</fieldset>'}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("changeEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"changeEntryTemplate",scope:{entry:"=",user:"=",permissions:"=",onAccept:"&",onReject:"&",onIndicatorClick:"&",onBodyClick:"&"},link:function(t,n,r){return t.contentLimit=40,t.isCollapsed=!0,t.needsCollapsing=!1,n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-entry-description, .rp-entry-body, .rp-entry-action-icon i"))return t.onBodyClick()})),t.toggleCollapse=function(){return t.isCollapsed=!t.isCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.$watch("entry.content.length",(function(e){return t.needsCollapsing=e>t.contentLimit}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("aggregateChangeEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"aggregateChangeEntryTemplate",scope:{entry:"=",user:"=",permissions:"=",onAccept:"&",onReject:"&",onIndicatorClick:"&",onBodyClick:"&"},link:function(t,n,r){return t.contentLimit=17,t.isDeletionCollapsed=!0,t.isInsertionCollapsed=!0,t.deletionNeedsCollapsing=!1,t.insertionNeedsCollapsing=!1,n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-entry-description, .rp-entry-body, .rp-entry-action-icon i"))return t.onBodyClick()})),t.toggleDeletionCollapse=function(){return t.isDeletionCollapsed=!t.isDeletionCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.toggleInsertionCollapse=function(){return t.isInsertionCollapsed=!t.isInsertionCollapsed,e((function(){return t.$emit("review-panel:layout")}))},t.$watch("entry.metadata.replaced_content.length",(function(e){return t.deletionNeedsCollapsing=e>t.contentLimit})),t.$watch("entry.content.length",(function(e){return t.insertionNeedsCollapsing=e>t.contentLimit}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("commentEntry",["$timeout",function(e){return{restrict:"E",templateUrl:"commentEntryTemplate",scope:{entry:"=",threads:"=",permissions:"=",onResolve:"&",onReply:"&",onIndicatorClick:"&",onSaveEdit:"&",onDelete:"&",onBodyClick:"&"},link:function(t,n,r){return t.state={animating:!1},n.on("click",(function(e){if($(e.target).is(".rp-entry, .rp-comment-loaded, .rp-comment-content, .rp-comment-reply, .rp-entry-metadata"))return t.onBodyClick()})),t.handleCommentReplyKeyPress=function(e){if(13===e.keyCode&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey&&(e.preventDefault(),t.entry.replyContent.length>0))return e.target.blur(),t.onReply()},t.animateAndCallOnResolve=function(){return t.state.animating=!0,n.find(".rp-entry").css("top",0),e((function(){return t.onResolve()}),350),!0},t.startEditing=function(e){return e.editing=!0,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.saveEdit=function(e){return e.editing=!1,t.onSaveEdit({comment:e})},t.confirmDelete=function(e){return e.deleting=!0,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.cancelDelete=function(e){return e.deleting=!1,setTimeout((function(){return t.$emit("review-panel:layout")}))},t.doDelete=function(e){return e.deleting=!1,t.onDelete({comment:e})},t.saveEditOnEnter=function(e,n){if(13===e.keyCode&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey)return e.preventDefault(),t.saveEdit(n)}}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t="";e.directive("addCommentEntry",(function(){return{restrict:"E",templateUrl:"addCommentEntryTemplate",scope:{onStartNew:"&",onSubmit:"&",onCancel:"&"},link:function(e,n,r){e.state={isAdding:!1,content:t},e.$on("comment:start_adding",(function(){return e.startNewComment()})),e.$on("$destroy",(function(){t=e.state.content})),e.startNewComment=function(){e.state.isAdding=!0,e.onStartNew(),setTimeout((function(){return e.$broadcast("comment:new:open")}))},e.cancelNewComment=function(){e.state.isAdding=!1,e.state.content="",e.onCancel()},e.handleCommentKeyPress=function(t){13!==t.keyCode||t.shiftKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.state.content.length>0&&e.submitNewComment())},e.submitNewComment=function(n){e.onSubmit({content:e.state.content}),t=e.state.content,e.state.isAdding=!1,e.state.content=""}}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("bulkActionsEntry",(function(){return{restrict:"E",templateUrl:"bulkActionsEntryTemplate",scope:{onBulkAccept:"&",onBulkReject:"&",nEntries:"="},link:function(e,t,n){return e.bulkAccept=function(){return e.onBulkAccept()},e.bulkReject=function(){return e.onBulkReject()}}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("resolvedCommentEntry",(function(){return{restrict:"E",templateUrl:"resolvedCommentEntryTemplate",scope:{thread:"=",permissions:"=",onUnresolve:"&",onDelete:"&"},link:function(e,t,n){return e.contentLimit=40,e.needsCollapsing=!1,e.isCollapsed=!0,e.toggleCollapse=function(){return e.isCollapsed=!e.isCollapsed},e.$watch("thread.content.length",(function(t){return e.needsCollapsing=t>e.contentLimit}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("resolvedCommentsDropdown",["_",function(e){return{restrict:"E",templateUrl:"resolvedCommentsDropdownTemplate",scope:{entries:"=",threads:"=",resolvedIds:"=",docs:"=",permissions:"=",onOpen:"&",onUnresolve:"&",onDelete:"&",isLoading:"="},link:function(t,n,r){var i;t.state={isOpen:!1},t.toggleOpenState=function(){if(t.state.isOpen=!t.state.isOpen,t.state.isOpen)return t.onOpen().then((function(){return i()}))},t.resolvedComments=[],t.handleUnresolve=function(e){return t.onUnresolve({threadId:e}),t.resolvedComments=t.resolvedComments.filter((function(t){return t.threadId!==e}))},t.handleDelete=function(e,n,r){return t.onDelete({entryId:e,docId:n,threadId:r}),t.resolvedComments=t.resolvedComments.filter((function(e){return e.threadId!==r}))};var o=function(n){var r=e.find(t.docs,(function(e){return e.doc.id===n}));return null!=r?r.path:null};return i=function(){return t.resolvedComments=[],function(){var e=[];for(var n in t.entries){var r=t.entries[n];e.push(function(){var e=[];for(var i in r){var s=r[i];if("comment"===s.type&&null!=(null!=t.threads[s.thread_id]?t.threads[s.thread_id].resolved:void 0)){var a=angular.copy(t.threads[s.thread_id]);a.content=s.content,a.threadId=s.thread_id,a.entryId=i,a.docId=n,a.docName=o(n),e.push(t.resolvedComments.push(a))}else e.push(void 0)}return e}())}return e}()}}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("reviewPanelCollapseHeight",["$parse",function(e){return{restrict:"A",link:function(t,n,r){return t.$watch((function(){return e(r.reviewPanelCollapseHeight)(t)}),(function(e){var t=n.prop("scrollHeight");return t>0?e?n.animate({height:0},150):n.animate({height:t},150):e?n.height(0):void 0}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.filter("notEmpty",(function(){return function(e){return!angular.equals({},e)}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.filter("numKeys",(function(){return function(e){return null!=e?Object.keys(e).length:0}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.filter("orderOverviewEntries",(function(){return function(e){var t=[];for(var n in e){var r=e[n];r.entry_id=n,t.push(r)}return t.sort((function(e,t){return e.offset-t.offset})),t}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){return function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOverAce=!1,this.pdfDiv=null,this.aceDiv=null,this.handlePdfDivMouseLeave=function(){return n.pdfDiv.addEventListener("wheel",n.dispatchToAce)},this.handlePdfDivMouseEnter=function(){return n.pdfDiv.removeEventListener("wheel",n.dispatchToAce)},this.handleAceDivMouseLeave=function(){return n.isOverAce=!1},this.handleAceDivMouseEnter=function(){return n.isOverAce=!0},this.setListeners=function(){return n.isOverAce=!1,null!=n.pdfDiv&&(n.pdfDiv.removeEventListener(n.handlePdfDivMouseLeave),n.pdfDiv.removeEventListener(n.handlePdfDivMouseEnter)),null!=n.aceDiv&&(n.aceDiv.removeEventListener(n.handleAceDivMouseLeave),n.aceDiv.removeEventListener(n.handleAceDivMouseEnter)),n.pdfDiv=document.querySelector(".pdfjs-viewer"),n.aceDiv=document.querySelector(".ace_content"),n.pdfDiv.addEventListener("mouseleave",n.handlePdfDivMouseLeave),n.pdfDiv.addEventListener("mouseenter",n.handlePdfDivMouseEnter),n.aceDiv.addEventListener("mouseleave",n.handleAceDivMouseLeave),n.aceDiv.addEventListener("mouseenter",n.handleAceDivMouseEnter)},this.dispatchToAce=function(e){if(n.isOverAce)return window.setTimeout((function(){return n.aceDiv.dispatchEvent(e)}),1),e.preventDefault()},t.$on("loaded",(function(){return n.setListeners()}))}}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t=window.brandVariation;return e.factory("CobrandingDataService",(function(){return{isProjectCobranded:function(){return null!=t},getLogoImgUrl:function(){return null!=t?t.logo_url:void 0},getSubmitBtnHtml:function(){return null!=t?t.submit_button_html:void 0},getBrandVariationName:function(){return null!=t?t.name:void 0},getBrandVariationHomeUrl:function(){return null!=t?t.home_url:void 0},getPublishGuideHtml:function(){return null!=t?t.publish_guide_html:void 0},getPartner:function(){return null!=t?t.partner:void 0},hasBrandedMenu:function(){return null!=t?t.branded_menu:void 0},getBrandId:function(){return null!=t?t.brand_id:void 0},getBrandVariationId:function(){return null!=t?t.id:void 0}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(258),n(259),n(260)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("settings",["ide","eventTracking",function(e,t){return{saveSettings:function(n){for(var r=0,i=Array.from(Object.keys(n));r<i.length;r++){var o=i[r],s=o,a=n[o];t.sendMB("setting-changed",{changedSetting:s,changedSettingVal:a})}return n._csrf=window.csrfToken,e.$http.post("/user/settings",n)},saveProjectSettings:function(n){for(var r=0,i=Array.from(Object.keys(n));r<i.length;r++){var o=i[r],s=o,a=n[o];t.sendMB("project-setting-changed",{changedSetting:s,changedSettingVal:a})}return n._csrf=window.csrfToken,e.$http.post("/project/".concat(e.project_id,"/settings"),n)},saveProjectAdminSettings:function(n){for(var r=0,i=Array.from(Object.keys(n));r<i.length;r++){var o=i[r],s=o,a=n[o];t.sendMB("project-admin-setting-changed",{changedSetting:s,changedSettingVal:a})}return n._csrf=window.csrfToken,e.$http.post("/project/".concat(e.project_id,"/settings/admin"),n)}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("SettingsController",["$scope","ExposedSettings","settings","ide","_",function(e,t,n,r,i){var o=this,s=t.validRootDocExtensions,a=new RegExp("\\.(".concat(s.join("|"),")$"),"i");e.overallThemesList=window.overallThemes,e.ui={loadingStyleSheet:!1};return["default","vim","emacs"].includes(e.settings.mode)||(e.settings.mode="default"),["pdfjs","native"].includes(e.settings.pdfViewer)||(e.settings.pdfViewer="pdfjs"),null==e.settings.fontFamily||["monaco","lucida"].includes(e.settings.fontFamily)||delete e.settings.fontFamily,null==e.settings.lineHeight||["compact","normal","wide"].includes(e.settings.lineHeight)||delete e.settings.lineHeight,e.fontSizeAsStr=function(t){return null!=t&&(e.settings.fontSize=t),e.settings.fontSize.toString()},e.getValidMainDocs=function(){var t=[];return e.docs&&(t=e.docs.filter((function(t){return a.test(t.doc.name)||e.project.rootDoc_id===t.doc.id}))),t},e.$watch("settings.editorTheme",(function(e,t){if(e!==t)return n.saveSettings({editorTheme:e})})),e.$watch("settings.overallTheme",(function(t,r){if(t!==r){var o=i.find(e.overallThemesList,(function(e){return e.val===t}));if(null!=o)return function(t){e.ui.loadingStyleSheet=!0;var n=document.querySelector("head"),r=document.getElementById("main-stylesheet"),i=document.createElement("link");i.addEventListener("load",(function(t){return e.$applyAsync((function(){return e.ui.loadingStyleSheet=!1,n.removeChild(r)}))})),i.setAttribute("rel","stylesheet"),i.setAttribute("id","main-stylesheet"),i.setAttribute("href",t.path),n.appendChild(i)}(o),n.saveSettings({overallTheme:t})}})),e.$watch("settings.fontSize",(function(e,t){if(e!==t)return n.saveSettings({fontSize:parseInt(e,10)})})),e.$watch("settings.mode",(function(e,t){if(e!==t)return n.saveSettings({mode:e})})),e.$watch("settings.autoComplete",(function(e,t){if(e!==t)return n.saveSettings({autoComplete:e})})),e.$watch("settings.autoPairDelimiters",(function(e,t){if(e!==t)return n.saveSettings({autoPairDelimiters:e})})),e.$watch("settings.pdfViewer",(function(e,t){if(e!==t)return n.saveSettings({pdfViewer:e})})),e.$watch("settings.syntaxValidation",(function(e,t){if(e!==t)return n.saveSettings({syntaxValidation:e})})),e.$watch("settings.fontFamily",(function(e,t){if(e!==t)return n.saveSettings({fontFamily:e})})),e.$watch("settings.lineHeight",(function(e,t){if(e!==t)return n.saveSettings({lineHeight:e})})),e.$watch("project.spellCheckLanguage",(function(e,t){if(!o.ignoreUpdates)return null!=t&&e!==t?(n.saveProjectSettings({spellCheckLanguage:e}),n.saveSettings({spellCheckLanguage:e})):void 0})),e.$watch("project.compiler",(function(e,t){if(!o.ignoreUpdates)return null!=t&&e!==t?n.saveProjectSettings({compiler:e}):void 0})),e.$watch("project.imageName",(function(e,t){if(!o.ignoreUpdates)return null!=t&&e!==t?n.saveProjectSettings({imageName:e}):void 0})),e.$watch("project.rootDoc_id",(function(t,r){o.ignoreUpdates||void 0!==r&&t!==r&&n.saveProjectSettings({rootDocId:t}).catch((function(){e.project.rootDoc_id=r}))})),r.socket.on("compilerUpdated",(function(t){return o.ignoreUpdates=!0,e.$apply((function(){return e.project.compiler=t})),delete o.ignoreUpdates})),r.socket.on("imageNameUpdated",(function(t){return o.ignoreUpdates=!0,e.$apply((function(){return e.project.imageName=t})),delete o.ignoreUpdates})),r.socket.on("spellCheckLanguageUpdated",(function(t){return o.ignoreUpdates=!0,e.$apply((function(){return e.project.spellCheckLanguage=t})),delete o.ignoreUpdates}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("ProjectNameController",["$scope","$element","settings","ide",function(e,t,n,r){var i=t.find(".name")[0];return e.state={renaming:!1,overflowed:!1},e.inputs={},e.startRenaming=function(){return e.inputs.name=e.project.name,e.state.renaming=!0,e.$emit("project:rename:start")},e.finishRenaming=function(){e.state.renaming=!1;var t=e.inputs.name;if(e.project.name!==t){var i=e.project.name;return e.project.name=t,n.saveProjectSettings({name:e.project.name}).catch((function(t){var n=t.data,o=t.status;return e.project.name=i,400===o?r.showGenericMessageModal("Error renaming project",n):r.showGenericMessageModal("Error renaming project","Please try again in a moment")}))}},r.socket.on("projectNameUpdated",(function(t){return e.$apply((function(){return e.project.name=t}))})),e.$watch("project.name",(function(t){if(null!=t)return window.document.title=t+" - Online LaTeX Editor ".concat(ExposedSettings.appName),e.$applyAsync((function(){return e.state.overflowed=i.scrollWidth>i.clientWidth}))}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(262),n(263),n(264),n(265),n(266),n(267)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){e.controller("ShareController",["$scope","$modal","ide","projectInvites","projectMembers","eventTracking",function(e,t,n,r,i,o){e.openShareProjectModal=function(n){e.isAdmin=n,o.sendMBOnce("ide-open-share-modal-once"),t.open({templateUrl:"shareProjectModalTemplate",controller:"ShareProjectModalController",scope:e})},n.socket.on("project:tokens:changed",(function(t){null!=t.tokens&&(n.$scope.project.tokens=t.tokens,e.$digest())})),n.socket.on("project:membership:changed",(function(t){t.members&&i.getMembers().then((function(t){t.data.members&&(e.project.members=t.data.members)})).catch((function(){console.error("Error fetching members for project")})),t.invites&&r.getInvites().then((function(t){t.data.invites&&(e.project.invites=t.data.invites)})).catch((function(){console.error("Error fetching invites for project")}))}))}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}r=[n(0)],void 0===(i=function(e){e.controller("ShareProjectModalController",["$scope","$modalInstance","$timeout","projectMembers","projectInvites","$modal","$http","ide","validateCaptcha","validateCaptchaV3","settings","eventTracking",function(e,t,n,r,i,s,a,l,c,u,h,d){e.inputs={privileges:"readAndWrite",contacts:[]},e.state={error:null,errorReason:null,inflight:!1,startedFreeTrial:!1,invites:[]},t.opened.then((function(){return n((function(){return e.$broadcast("open")}),200)}));e.refreshCanAddCollaborators=function(){var t=e.project.features.collaborators;e.canAddCollaborators=e.project.members.length+e.project.invites.length<t||-1===t},e.refreshCanAddCollaborators(),e.$watch("canAddCollaborators",(function(){e.canAddCollaborators||d.send("subscription-funnel","editor-click-feature","projectMembers")})),e.$watch("(project.members.length + project.invites.length)",(function(t){return e.refreshCanAddCollaborators()})),e.autocompleteContacts=[],a.get("/user/contacts").then((function(t){var n=t.data;e.autocompleteContacts=n.contacts||[];var r=!0,i=!1,o=void 0;try{for(var s,a=e.autocompleteContacts[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var l=s.value;"user"===l.type?l.first_name!==l.email.split("@")[0]||l.last_name?(l.name="".concat(l.first_name," ").concat(l.last_name),l.display="".concat(l.name," <").concat(l.email,">")):l.display=l.email:l.display=l.name}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}}));var f=function(){return(e.project.members||[]).map((function(e){return e.email}))};e.filterAutocompleteUsers=function(t){var n=f();return e.autocompleteContacts.filter((function(e){if(null!=e.email&&n.includes(e.email))return!1;for(var r=0,i=[e.name,e.email];r<i.length;r++){var o=i[r];if(null!=o&&o.toLowerCase().indexOf(t.toLowerCase())>-1)return!0}return!1}))},e.addMembers=function(){n((function(){if(0!==e.inputs.contacts.length){var t=e.inputs.contacts;e.inputs.contacts=[],e.clearError(),e.state.inflight=!0,null==e.project.invites&&(e.project.invites=[]);var n=f(),r=(e.project.invites||[]).map((function(e){return e.email}));!function s(){var a;if(0===t.length||!e.canAddCollaborators)return e.state.inflight=!1,void e.$apply();var l=t.shift();a="user"===l.type?l.email:l.display;if(a=a.toLowerCase(),n.includes(a))return s();u("invite");var h=window.ExposedSettings;c((function(t){e.grecaptchaResponse=t;var n=e.project.invites||[],l=_.find(n,(function(e){return e.email===a}));(r.includes(a)&&l?i.resendInvite(l._id):i.sendInvite(a,e.inputs.privileges,e.grecaptchaResponse)).then((function(t){var n=t.data;if(n.error)e.setError(n.error),e.state.inflight=!1;else if(n.invite){var r=n.invite;e.project.invites.push(r)}else{var i,a=null!=n.users?n.users:null!=n.user?[n.user]:[];(i=e.project.members).push.apply(i,o(a))}setTimeout((function(){return s()}),0)})).catch((function(t){var n=t.data;e.state.inflight=!1,e.setError(n.errorReason)}))}),h.recaptchaDisabled.invite)}()}}),50)},e.removeMember=function(t){e.monitorRequest(r.removeMember(t).then((function(){var n=e.project.members.indexOf(t);-1!==n&&e.project.members.splice(n,1)})))},e.revokeInvite=function(t){e.monitorRequest(i.revokeInvite(t._id).then((function(){var n=e.project.invites.indexOf(t);-1!==n&&e.project.invites.splice(n,1)})))},e.resendInvite=function(t,n){e.monitorRequest(i.resendInvite(t._id).then((function(){n.target.blur()})).catch((function(){n.target.blur()})))},e.makeTokenBased=function(){e.project.publicAccesLevel="tokenBased",h.saveProjectAdminSettings({publicAccessLevel:"tokenBased"}),d.sendMB("project-make-token-based")},e.makePrivate=function(){e.project.publicAccesLevel="private",h.saveProjectAdminSettings({publicAccessLevel:"private"})},e.$watch("project.tokens.readAndWrite",(function(t){e.readAndWriteTokenLink=null!=t?"".concat(location.origin,"/").concat(t):null})),e.$watch("project.tokens.readOnly",(function(t){e.readOnlyTokenLink=null!=t?"".concat(location.origin,"/read/").concat(t):null})),e.done=function(){return t.close()},e.cancel=function(){return t.dismiss()},e.monitorRequest=function(t){return e.clearError(),e.state.inflight=!0,t.then((function(){e.state.inflight=!1,e.clearError()})).catch((function(t){e.state.inflight=!1,e.setError(t.data&&t.data.error)}))},e.clearError=function(){e.state.error=!1},e.setError=function(t){e.state.error=!0,e.state.errorReason=t}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){e.controller("ShareProjectModalMemberRowController",["$scope","$modal","projectMembers",function(e,t,n){e.form={privileges:e.member.privileges,isModified:function(){return this.privileges!==e.member.privileges},submit:function(){var r=e.member._id,i=e.form.privileges;"owner"===i?t.open({templateUrl:"ownershipTransferConfirmTemplate",controller:"OwnershipTransferConfirmModalController",scope:e}):function(t,r){e.monitorRequest(n.setMemberPrivilegeLevel(t,r).then((function(){e.member.privileges=r})))}(r,i)},reset:function(){this.privileges=e.member.privileges,e.clearError()}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){e.controller("OwnershipTransferConfirmModalController",["$scope","$window","$modalInstance","projectMembers",function(e,t,n,r){e.state={inflight:!1,error:!1},e.confirm=function(){!function(n){e.state.inflight=!0,e.state.error=!1,r.transferOwnership(n).then((function(){e.state.inflight=!1,e.state.error=!1,t.location.reload()})).catch((function(){e.state.inflight=!1,e.state.error=!0}))}(e.member._id)},e.cancel=function(){n.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){e.factory("projectMembers",["ide","$http",function(e,t){return{removeMember:function(n){return t({url:"/project/".concat(e.project_id,"/users/").concat(n._id),method:"DELETE",headers:{"X-Csrf-Token":window.csrfToken}})},addGroup:function(n,r){return t.post("/project/".concat(e.project_id,"/group"),{group_id:n,privileges:r,_csrf:window.csrfToken})},getMembers:function(){return t.get("/project/".concat(e.project_id,"/members"),{json:!0,headers:{"X-Csrf-Token":window.csrfToken}})},setMemberPrivilegeLevel:function(n,r){return t.put("/project/".concat(e.project_id,"/users/").concat(n),{privilegeLevel:r},{headers:{"X-Csrf-Token":window.csrfToken}})},transferOwnership:function(n){return t.post("/project/".concat(e.project_id,"/transfer-ownership"),{user_id:n,_csrf:window.csrfToken})}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("projectInvites",["ide","$http",function(e,t){return{sendInvite:function(n,r,i){return t.post("/project/".concat(e.project_id,"/invite"),{email:n,privileges:r,_csrf:window.csrfToken,"g-recaptcha-response":i})},revokeInvite:function(n){return t({url:"/project/".concat(e.project_id,"/invite/").concat(n),method:"DELETE",headers:{"X-Csrf-Token":window.csrfToken}})},resendInvite:function(n,r){return t.post("/project/".concat(e.project_id,"/invite/").concat(n,"/resend"),{_csrf:window.csrfToken})},getInvites:function(){return t.get("/project/".concat(e.project_id,"/invites"),{json:!0,headers:{"X-Csrf-Token":window.csrfToken}})}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(269),n(270),n(272),n(21),n(273)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("ChatButtonController",["$scope","ide",function(e,t){var n;e.toggleChat=function(){return e.ui.chatOpen=!e.ui.chatOpen,e.resetUnreadMessages()},e.unreadMessages=0,e.resetUnreadMessages=function(){return e.unreadMessages=0},e.$on("chat:resetUnreadMessages",(function(t){return e.resetUnreadMessages()})),e.$on("chat:newMessage",(function(n,r){if(null!=r&&(i=null!=r?r.user:void 0,o=function(e){return e.id},(null!=i?o(i):void 0)!==t.$scope.user.id))return e.ui.chatOpen||(e.unreadMessages+=1),s();var i,o}));var r=!0,i=null,o=null;$(window).on("focus",(function(){return n(),r=!0})),$(window).on("blur",(function(){return r=!1}));var s=function(){var e;if(!r&&null==i)return o||(o=window.document.title),(e=function(){return window.document.title===o?window.document.title="New Message":window.document.title=o,i=setTimeout(e,800)})()};return n=function(){if(clearTimeout(i),i=null,null!=o)return window.document.title=o}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(271)],void 0===(i=function(e){return e.controller("ChatController",["$scope","chatMessages","ide","$location",function(e,t,n,r){return e.chat=t.state,e.$watch("chat.messages",(function(t){if(null!=t)return e.$emit("updateScrollPosition")}),!0),e.$on("layout:chat:resize",(function(){return e.$emit("updateScrollPosition")})),e.$watch("chat.newMessage",(function(e){if(null!=e)return n.$scope.$broadcast("chat:newMessage",e)})),e.resetUnreadMessages=function(){return n.$scope.$broadcast("chat:resetUnreadMessages")},e.sendMessage=function(){var n=e.newMessageContent;return e.newMessageContent="",t.sendMessage(n)},e.loadMoreMessages=function(){return t.loadMoreMessages()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return null!=e?t(e):void 0}r=[n(0),n(9)],void 0===(i=function(e,t){return e.factory("chatMessages",["$http","ide",function(e,n){var r="/project/".concat(n.project_id,"/messages"),i=("/project/".concat(n.project_id,"/connected_users"),{state:{messages:[],loading:!1,atEnd:!1,errored:!1,nextBeforeTimestamp:null,newMessage:null}}),a=!1;n.socket.on("new-chat-message",(function(e){return s(null!=e?e.user:void 0,(function(e){return e.id}))===n.$scope.user.id&&a||n.$scope.$apply((function(){return c(e)})),a=!1})),i.sendMessage=function(t){var i={content:t,_csrf:window.csrfToken};return a=!0,c({user:n.$scope.user,content:t,timestamp:Date.now()}),e.post(r,i)},i.loadMoreMessages=function(){if(!i.state.atEnd&&!i.state.errored){var t=r+"?limit=".concat(50);return null!=i.state.nextBeforeTimestamp&&(t+="&before=".concat(i.state.nextBeforeTimestamp)),i.state.loading=!0,e.get(t).then((function(e){var t=null!=e.data?e.data:[];return i.state.loading=!1,t.length<50&&(i.state.atEnd=!0),null==t.reverse&&"undefined"!=typeof Raven&&null!==Raven&&Raven.captureException(new Error("messages has no reverse property ".concat(o(t)))),"function"!=typeof t.reverse?("undefined"!=typeof Raven&&null!==Raven&&Raven.captureException(new Error("messages.reverse not a function ".concat(o(t.reverse)," ").concat(o(t)))),i.state.errored=!0):(t.reverse(),l(t),i.state.nextBeforeTimestamp=null!=i.state.messages[0]?i.state.messages[0].timestamp:void 0)}))}};var l=function(e){return Array.from(e.slice(0).reverse()).map((function(e){return function(e){var t=i.state.messages[0];return null!=t&&t.user.id===s(null!=e?e.user:void 0,(function(e){return e.id}))&&t.timestamp-e.timestamp<3e5?(t.timestamp=e.timestamp,t.contents.unshift(e.content)):i.state.messages.unshift({user:u(e.user),timestamp:e.timestamp,contents:[e.content]})}(e)}))},c=function(e){i.state.newMessage=e;var t=i.state.messages[i.state.messages.length-1];return null!=t&&t.user.id===s(null!=e?e.user:void 0,(function(e){return e.id}))&&e.timestamp-t.timestamp<3e5?(t.timestamp=e.timestamp,t.contents.push(e.content)):i.state.messages.push({user:u(e.user),timestamp:e.timestamp,contents:[e.content]})},u=function(e){var n=t(e.email.toLowerCase());return e.gravatar_url="//www.gravatar.com/avatar/".concat(n),e};return i}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(7)],void 0===(i=function(e,t){return e.controller("ChatMessageController",["$scope","ide",function(e,n){var r={borderSaturation:(null!=window.uiConfig?window.uiConfig.chatMessageBorderSaturation:void 0)||"70%",borderLightness:(null!=window.uiConfig?window.uiConfig.chatMessageBorderLightness:void 0)||"70%",bgSaturation:(null!=window.uiConfig?window.uiConfig.chatMessageBgSaturation:void 0)||"60%",bgLightness:(null!=window.uiConfig?window.uiConfig.chatMessageBgLightness:void 0)||"97%"},i=function(e){return null==e?0:t.getHueForUserId(e.id)};return e.getMessageStyle=function(e){return{"border-color":"hsl(".concat(i(e),", ").concat(r.borderSaturation,", ").concat(r.borderLightness,")"),"background-color":"hsl(".concat(i(e),", ").concat(r.bgSaturation,", ").concat(r.bgLightness,")")}},e.getArrowStyle=function(e){return{"border-color":"hsl(".concat(i(e),", ").concat(r.borderSaturation,", ").concat(r.borderLightness,")")}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){var t=function(e,t,n){n=n||20;var r=e.split(" ");return Array.from(r).map((function(e){return(r=e,r.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)}))).length>=n?"<".concat(t,' class="break-word">').concat(e,"</").concat(t,">"):e;var r})).join(" ")};return e.filter("wrapLongWords",(function(){return function(e,n){return t(e,"span",n)}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(275),n(276)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("CloneProjectController",["$scope","$modal",function(e,t){return e.openCloneProjectModal=function(){return t.open({templateUrl:"cloneProjectModalTemplate",controller:"CloneProjectModalController"})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("CloneProjectModalController",["$scope","$modalInstance","$timeout","$http","ide",function(e,t,n,r,i){e.inputs={projectName:i.$scope.project.name+" (Copy)"},e.state={inflight:!1,error:!1},t.opened.then((function(){return n((function(){return e.$broadcast("open")}),200)}));return e.clone=function(){return e.state.inflight=!0,e.state.error=!1,(t=e.inputs.projectName,r.post("/project/".concat(i.$scope.project._id,"/clone"),{_csrf:window.csrfToken,projectName:t})).then((function(e){var t=e.data;return window.location="/project/".concat(t.project_id)})).catch((function(t){var n=t.data,r=t.status;return e.state.inflight=!1,e.state.error=400!==r||{message:n}}));var t},e.cancel=function(){return t.dismiss("cancel")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(278),n(279)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){var e=/INPUT|SELECT|TEXTAREA/i;return $(document).bind("keydown keypress",(function(t){if(8===t.which&&(!e.test(t.target.tagName)||t.target.disabled||t.target.readOnly))return t.preventDefault()}))}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(0),n(4)],void 0===(i=function(e){return e.controller("HotkeysController",["$scope","$modal","eventTracking",function(e,t,n){return e.openHotkeysModal=function(){return n.sendMB("ide-open-hotkeys-modal"),t.open({templateUrl:"hotkeysModalTemplate",controller:"HotkeysModalController",size:"lg",resolve:{trackChangesVisible:function(){return e.project.features.trackChangesVisible}}})}}]),e.controller("HotkeysModalController",["$scope","$modalInstance","trackChangesVisible",function(e,t,n){return e.trackChangesVisible=n,ace.require("ace/lib/useragent").isMac?e.ctrl="Cmd":e.ctrl="Ctrl",e.cancel=function(){return t.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(281),n(282)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("WordCountController",["$scope","$modal",function(e,t){return e.openWordCountModal=function(){return t.open({templateUrl:"wordCountModalTemplate",controller:"WordCountModalController"})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("WordCountModalController",["$scope","$modalInstance","ide","$http",function(e,t,n,r){return e.status={loading:!0},r({url:"/project/".concat(n.project_id,"/wordcount"),method:"GET",params:{clsiserverid:n.clsiServerId}}).then((function(t){var n=t.data;return e.status.loading=!1,e.data=n.texcount})).catch((function(){return e.status.error=!0})),e.cancel=function(){return t.dismiss("cancel")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(284),n(285)],void 0===(i=function(e){return e.directive("layout",["$parse","$compile","ide",function(e,t,n){return{compile:function(){return{pre:function(r,i,o){var s,a,l=o.layout,c=o.customTogglerPane,u=o.customTogglerMsgWhenOpen,h=o.customTogglerMsgWhenClosed,d=null!=c&&null!=u&&null!=h,f={spacing_open:null!=o.spacingOpen?parseInt(o.spacingOpen,10):window.uiConfig.defaultResizerSizeOpen,spacing_closed:null!=o.spacingClosed?parseInt(o.spacingClosed,10):window.uiConfig.defaultResizerSizeClosed,slidable:!1,enableCursorHotkey:!1,onopen:function(e){return S(e)},onclose:function(e){return k(e)},onresize:function(){return m()},maskIframesOnResize:r.$eval(o.maskIframesOnResize||"false"),east:{size:r.$eval(o.initialSizeEast),initClosed:r.$eval(o.initClosedEast)},west:{size:r.$eval(o.initialSizeEast),initClosed:r.$eval(o.initClosedWest)}};null!=(a=n.localStorage("layout.".concat(l)))&&(null!=a.east&&(null==o.minimumRestoreSizeEast||a.east.size>=o.minimumRestoreSizeEast&&!a.east.initClosed)&&(f.east=a.east),null!=a.west&&(null==o.minimumRestoreSizeWest||a.west.size>=o.minimumRestoreSizeWest&&!a.west.initClosed)&&(f.west=a.west)),null!=window.uiConfig.eastResizerCursor&&(f.east.resizerCursor=window.uiConfig.eastResizerCursor),null!=window.uiConfig.westResizerCursor&&(f.west.resizerCursor=window.uiConfig.westResizerCursor);var p=function(){if(null!=s){a=i.layout().readState();var e="east"===c?"right":"left",t=a[c];return null!=t?s.css(e,t.initClosed?0:t.size):void 0}},g=function(){if(a=i.layout().readState(),null!=o.openEast&&null!=a.east)return e(o.openEast).assign(r,!a.east.initClosed)},m=function(){return a=i.layout().readState(),r.$broadcast("layout:".concat(l,":resize"),a),function(){if(null!=(a=i.layout().readState()).east){var e=i.find("> .ui-layout-resizer-controls");a.east.initClosed?e.hide():(e.show(),e.css({right:a.east.size}))}}(),d&&p(),g()},v=i.width(),y=function(){if(null!=o.resizeProportionally&&r.$eval(o.resizeProportionally)){var e=i.layout().readState().east;if(null!=e){var t=e.size/v*i.width();return v=i.width(),void i.layout().sizePane("east",t)}}return i.layout().resizeAll()};if(i.layout(f),i.layout().resizeAll(),null!=o.resizeOn)for(var b=0,w=Array.from(o.resizeOn.split(","));b<w.length;b++){var _=w[b];r.$on(_,(function(){return y()}))}if(d){a=i.layout().readState();var C=r.$new();C.isOpen=!0,C.isVisible=!0,!0===(null!=a[c]?a[c].initClosed:void 0)&&(C.isOpen=!1),C.tooltipMsgWhenOpen=u,C.tooltipMsgWhenClosed=h,C.tooltipPlacement="east"===c?"left":"right",C.handleClick=function(){return i.layout().toggle(c),p()},s=t('<a href ng-show="isVisible" class="custom-toggler '.concat("custom-toggler-".concat(c),'" ng-class="isOpen ? \'custom-toggler-open\' : \'custom-toggler-closed\'" tooltip="{{ isOpen ? tooltipMsgWhenOpen : tooltipMsgWhenClosed }}" tooltip-placement="{{ tooltipPlacement }}" ng-click="handleClick()">'))(C),i.append(s)}var S=function(e){if(d||e===c)return s.scope().$applyAsync((function(){return s.scope().isOpen=!0}))},k=function(e){if(d||e===c)return s.scope().$applyAsync((function(){return s.scope().isOpen=!1}))};if($(window).unload((function(){return n.localStorage("layout.".concat(l),i.layout().readState())})),null!=o.openEast&&r.$watch(o.openEast,(function(e,t){return null!=e&&e!==t&&(e?i.layout().open("east"):i.layout().close("east")),setTimeout((function(){return r.$digest()}),0)})),null!=o.allowOverflowOn){var A=i.layout(),x=r.$eval(o.allowOverflowOn),T=A.panes[x];A.allowOverflow(x);var E=T.zIndex();T.css("z-index",E+1)}if(g(),m(),null!=o.layoutDisabled)return r.$watch(o.layoutDisabled,(function(e){if(e?i.layout().hide("east"):i.layout().show("east"),d)return s.scope().$applyAsync((function(){return s.scope().isOpen=!e,s.scope().isVisible=!e}))}))},post:function(e,t,n){var r=n.layout,i=t.layout().readState();return e.$broadcast("layout:".concat(r,":linked"),i)}}}}}])}.apply(t,r))||(e.exports=i)},function(module,exports){function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var uuid,removeData,eventType,orig;function _focusable(e,t){var n,r,i,o=e.nodeName.toLowerCase();return"area"===o?(r=(n=e.parentNode).name,!(!e.href||!r||"map"!==n.nodeName.toLowerCase())&&(!!(i=$("img[usemap='#"+r+"']")[0])&&visible(i))):(/^(input|select|textarea|button|object)$/.test(o)?!e.disabled:"a"===o&&e.href||t)&&visible(e)}function visible(e){return $.expr.filters.visible(e)&&!$(e).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.ui=$.ui||{},$.extend($.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),$.fn.extend({scrollParent:function(e){var t=this.css("position"),n="absolute"===t,r=e?/(auto|scroll|hidden)/:/(auto|scroll)/,i=this.parents().filter((function(){var e=$(this);return(!n||"static"!==e.css("position"))&&r.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==t&&i.length?i:$(this[0].ownerDocument||document)},uniqueId:(uuid=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++uuid)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")}))}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo((function(e){return function(t){return!!$.data(t,e)}})):function(e,t,n){return!!$.data(e,n[3])},focusable:function(e){return _focusable(e,!isNaN($.attr(e,"tabindex")))},tabbable:function(e){var t=$.attr(e,"tabindex"),n=isNaN(t);return(n||t>=0)&&_focusable(e,!n)}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],(function(e,t){var n="Width"===t?["Left","Right"]:["Top","Bottom"],r=t.toLowerCase(),i={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function o(e,t,r,i){return $.each(n,(function(){t-=parseFloat($.css(e,"padding"+this))||0,r&&(t-=parseFloat($.css(e,"border"+this+"Width"))||0),i&&(t-=parseFloat($.css(e,"margin"+this))||0)})),t}$.fn["inner"+t]=function(e){return void 0===e?i["inner"+t].call(this):this.each((function(){$(this).css(r,o(this,e)+"px")}))},$.fn["outer"+t]=function(e,n){return"number"!=typeof e?i["outer"+t].call(this,e):this.each((function(){$(this).css(r,o(this,e,!0,n)+"px")}))}})),$.fn.addBack||($.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),$("<a>").data("a-b","a").removeData("a-b").data("a-b")&&($.fn.removeData=(removeData=$.fn.removeData,function(e){return arguments.length?removeData.call(this,$.camelCase(e)):removeData.call(this)})),$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),$.fn.extend({focus:(orig=$.fn.focus,function(e,t){return"number"==typeof e?this.each((function(){var n=this;setTimeout((function(){$(n).focus(),t&&t.call(n)}),e)})):orig.apply(this,arguments)}),disableSelection:(eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.bind(eventType+".ui-disableSelection",(function(e){e.preventDefault()}))}),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var t,n,r=$(this[0]);r.length&&r[0]!==document;){if(("absolute"===(t=r.css("position"))||"relative"===t||"fixed"===t)&&(n=parseInt(r.css("zIndex"),10),!isNaN(n)&&0!==n))return n;r=r.parent()}return 0}}),$.ui.plugin={add:function(e,t,n){var r,i=$.ui[e].prototype;for(r in n)i.plugins[r]=i.plugins[r]||[],i.plugins[r].push([t,n[r]])},call:function(e,t,n,r){var i,o=e.plugins[t];if(o&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;i<o.length;i++)e.options[o[i][0]]&&o[i][1].apply(e.element,n)}};var widget_uuid=0,widget_slice=Array.prototype.slice;$.cleanData=function(e){return function(t){var n,r,i;for(i=0;null!=(r=t[i]);i++)try{(n=$._data(r,"events"))&&n.remove&&$(r).triggerHandler("remove")}catch(e){}e(t)}}($.cleanData),$.widget=function(e,t,n){var r,i,o,s,a={},l=e.split(".")[0];return e=e.split(".")[1],r=l+"-"+e,n||(n=t,t=$.Widget),$.expr[":"][r.toLowerCase()]=function(e){return!!$.data(e,r)},$[l]=$[l]||{},i=$[l][e],o=$[l][e]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},$.extend(o,i,{version:n.version,_proto:$.extend({},n),_childConstructors:[]}),(s=new t).options=$.widget.extend({},s.options),$.each(n,(function(e,n){var r,i;$.isFunction(n)?a[e]=(r=function(){return t.prototype[e].apply(this,arguments)},i=function(n){return t.prototype[e].apply(this,n)},function(){var e,t=this._super,o=this._superApply;return this._super=r,this._superApply=i,e=n.apply(this,arguments),this._super=t,this._superApply=o,e}):a[e]=n})),o.prototype=$.widget.extend(s,{widgetEventPrefix:i&&s.widgetEventPrefix||e},a,{constructor:o,namespace:l,widgetName:e,widgetFullName:r}),i?($.each(i._childConstructors,(function(e,t){var n=t.prototype;$.widget(n.namespace+"."+n.widgetName,o,t._proto)})),delete i._childConstructors):t._childConstructors.push(o),$.widget.bridge(e,o),o},$.widget.extend=function(e){for(var t,n,r=widget_slice.call(arguments,1),i=0,o=r.length;i<o;i++)for(t in r[i])n=r[i][t],r[i].hasOwnProperty(t)&&void 0!==n&&($.isPlainObject(n)?e[t]=$.isPlainObject(e[t])?$.widget.extend({},e[t],n):$.widget.extend({},n):e[t]=n);return e},$.widget.bridge=function(e,t){var n=t.prototype.widgetFullName||e;$.fn[e]=function(r){var i="string"==typeof r,o=widget_slice.call(arguments,1),s=this;return i?this.each((function(){var t,i=$.data(this,n);return"instance"===r?(s=i,!1):i?$.isFunction(i[r])&&"_"!==r.charAt(0)?(t=i[r].apply(i,o))!==i&&void 0!==t?(s=t&&t.jquery?s.pushStack(t.get()):t,!1):void 0:$.error("no such method '"+r+"' for "+e+" widget instance"):$.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+r+"'")})):(o.length&&(r=$.widget.extend.apply(null,[r].concat(o))),this.each((function(){var e=$.data(this,n);e?(e.option(r||{}),e._init&&e._init()):$.data(this,n,new t(r,this))}))),s}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,t){t=$(t||this.defaultElement||this)[0],this.element=$(t),this.uuid=widget_uuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),t!==this&&($.data(t,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===t&&this.destroy()}}),this.document=$(t.style?t.ownerDocument:t.document||t),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(e,t){var n,r,i,o=e;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(r=o[e]=$.widget.extend({},this.options[e]),i=0;i<n.length-1;i++)r[n[i]]=r[n[i]]||{},r=r[n[i]];if(e=n.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,t,n){var r,i=this;"boolean"!=typeof e&&(n=t,t=e,e=!1),n?(t=r=$(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element,r=this.widget()),$.each(n,(function(n,o){function s(){if(e||!0!==i.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof o?i[o]:o).apply(i,arguments)}"string"!=typeof o&&(s.guid=o.guid=o.guid||s.guid||$.guid++);var a=n.match(/^([\w:-]*)\s*(.*)$/),l=a[1]+i.eventNamespace,c=a[2];c?r.delegate(c,l,s):t.bind(l,s)}))},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t),this.bindings=$(this.bindings.not(e).get()),this.focusable=$(this.focusable.not(e).get()),this.hoverable=$(this.hoverable.not(e).get())},_delay:function(e,t){var n=this;return setTimeout((function(){return("string"==typeof e?n[e]:e).apply(n,arguments)}),t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){$(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){$(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){$(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){$(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,t,n){var r,i,o=this.options[e];if(n=n||{},(t=$.Event(t)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),t.target=this.element[0],i=t.originalEvent)for(r in i)r in t||(t[r]=i[r]);return this.element.trigger(t,n),!($.isFunction(o)&&!1===o.apply(this.element[0],[t].concat(n))||t.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},(function(e,t){$.Widget.prototype["_"+e]=function(n,r,i){"string"==typeof r&&(r={effect:r});var o,s=r?!0===r||"number"==typeof r?t:r.effect||t:e;"number"==typeof(r=r||{})&&(r={duration:r}),o=!$.isEmptyObject(r),r.complete=i,r.delay&&n.delay(r.delay),o&&$.effects&&$.effects.effect[s]?n[e](r):s!==e&&n[s]?n[s](r.duration,r.easing,i):n.queue((function(t){$(this)[e](),i&&i.call(n[0]),t()}))}}));var widget=$.widget,mouseHandled=!1;$(document).mouseup((function(){mouseHandled=!1}));var mouse=$.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).bind("click."+this.widgetName,(function(t){if(!0===$.data(t.target,e.widgetName+".preventClickEvent"))return $.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var t=this,n=1===e.which,r=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&$(e.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){t.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===$.data(e.target,this.widgetName+".preventClickEvent")&&$.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return t._mouseMove(e)},this._mouseUpDelegate=function(e){return t._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&$.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),mouseHandled=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});$.widget("ui.draggable",$.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return this._blurActiveElement(e),!(this.helper||t.disabled||$(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map((function(){var e=$(this);return $("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=this.document[0];if(this.handleElement.is(e.target))try{t.activeElement&&"body"!==t.activeElement.nodeName.toLowerCase()&&$(t.activeElement).blur()}catch(e){}},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===$(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!t.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,t){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!t){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var t=this,n=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(n=$.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==t._trigger("stop",e)&&t._clear()})):!1!==this._trigger("stop",e)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),$.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!$(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var t=this.options,n=$.isFunction(t.helper),r=n?$(t.helper.apply(this.element[0],[e])):"clone"===t.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===t.appendTo?this.element[0].parentNode:t.appendTo),n&&r[0]===this.element[0]&&this._setPositionRelative(),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),$.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,n,r=this.options,i=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),(n=(t=$(r.containment))[0])&&(e=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=r.containment:this.containment=[0,0,$(i).width()-this.helperProportions.width-this.margins.left,($(i).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,i,o,s=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(r=this.relativeContainer.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),s.grid&&(i=s.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,c=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-s.grid[1]:i+s.grid[1]:i,o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o),"y"===s.axis&&(l=this.originalPageX),"x"===s.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,t,n){return n=n||this._uiHash(),$.ui.plugin.call(this,e,[t,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,e,t,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,n){var r=$.extend({},t,{item:n.element});n.sortables=[],$(n.options.connectToSortable).each((function(){var t=$(this).sortable("instance");t&&!t.options.disabled&&(n.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,r))}))},stop:function(e,t,n){var r=$.extend({},t,{item:n.element});n.cancelHelperRemoval=!1,$.each(n.sortables,(function(){this.isOver?(this.isOver=0,n.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(e),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",e,r))}))},drag:function(e,t,n){$.each(n.sortables,(function(){var r=!1,i=this;i.positionAbs=n.positionAbs,i.helperProportions=n.helperProportions,i.offset.click=n.offset.click,i._intersectsWith(i.containerCache)&&(r=!0,$.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==i&&this._intersectsWith(this.containerCache)&&$.contains(i.element[0],this.element[0])&&(r=!1),r}))),r?(i.isOver||(i.isOver=1,n._parent=t.helper.parent(),i.currentItem=t.helper.appendTo(i.element).data("ui-sortable-item",!0),i.options._helper=i.options.helper,i.options.helper=function(){return t.helper[0]},e.target=i.currentItem[0],i._mouseCapture(e,!0),i._mouseStart(e,!0,!0),i.offset.click.top=n.offset.click.top,i.offset.click.left=n.offset.click.left,i.offset.parent.left-=n.offset.parent.left-i.offset.parent.left,i.offset.parent.top-=n.offset.parent.top-i.offset.parent.top,n._trigger("toSortable",e),n.dropped=i.element,$.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,i.fromOutside=n),i.currentItem&&(i._mouseDrag(e),t.position=i.position)):i.isOver&&(i.isOver=0,i.cancelHelperRemoval=!0,i.options._revert=i.options.revert,i.options.revert=!1,i._trigger("out",e,i._uiHash(i)),i._mouseStop(e,!0),i.options.revert=i.options._revert,i.options.helper=i.options._helper,i.placeholder&&i.placeholder.remove(),t.helper.appendTo(n._parent),n._refreshOffsets(e),t.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,$.each(n.sortables,(function(){this.refreshPositions()})))}))}}),$.ui.plugin.add("draggable","cursor",{start:function(e,t,n){var r=$("body"),i=n.options;r.css("cursor")&&(i._cursor=r.css("cursor")),r.css("cursor",i.cursor)},stop:function(e,t,n){var r=n.options;r._cursor&&$("body").css("cursor",r._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(e,t,n){var r=$(t.helper),i=n.options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(e,t,n){var r=n.options;r._opacity&&$(t.helper).css("opacity",r._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParentNotHidden||(n.scrollParentNotHidden=n.helper.scrollParent(!1)),n.scrollParentNotHidden[0]!==n.document[0]&&"HTML"!==n.scrollParentNotHidden[0].tagName&&(n.overflowOffset=n.scrollParentNotHidden.offset())},drag:function(e,t,n){var r=n.options,i=!1,o=n.scrollParentNotHidden[0],s=n.document[0];o!==s&&"HTML"!==o.tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+o.offsetHeight-e.pageY<r.scrollSensitivity?o.scrollTop=i=o.scrollTop+r.scrollSpeed:e.pageY-n.overflowOffset.top<r.scrollSensitivity&&(o.scrollTop=i=o.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+o.offsetWidth-e.pageX<r.scrollSensitivity?o.scrollLeft=i=o.scrollLeft+r.scrollSpeed:e.pageX-n.overflowOffset.left<r.scrollSensitivity&&(o.scrollLeft=i=o.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-$(s).scrollTop()<r.scrollSensitivity?i=$(s).scrollTop($(s).scrollTop()-r.scrollSpeed):$(window).height()-(e.pageY-$(s).scrollTop())<r.scrollSensitivity&&(i=$(s).scrollTop($(s).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-$(s).scrollLeft()<r.scrollSensitivity?i=$(s).scrollLeft($(s).scrollLeft()-r.scrollSpeed):$(window).width()-(e.pageX-$(s).scrollLeft())<r.scrollSensitivity&&(i=$(s).scrollLeft($(s).scrollLeft()+r.scrollSpeed)))),!1!==i&&$.ui.ddmanager&&!r.dropBehaviour&&$.ui.ddmanager.prepareOffsets(n,e)}}),$.ui.plugin.add("draggable","snap",{start:function(e,t,n){var r=n.options;n.snapElements=[],$(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each((function(){var e=$(this),t=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})}))},drag:function(e,t,n){var r,i,o,s,a,l,c,u,h,d,f=n.options,p=f.snapTolerance,g=t.offset.left,m=g+n.helperProportions.width,v=t.offset.top,y=v+n.helperProportions.height;for(h=n.snapElements.length-1;h>=0;h--)l=(a=n.snapElements[h].left-n.margins.left)+n.snapElements[h].width,u=(c=n.snapElements[h].top-n.margins.top)+n.snapElements[h].height,m<a-p||g>l+p||y<c-p||v>u+p||!$.contains(n.snapElements[h].item.ownerDocument,n.snapElements[h].item)?(n.snapElements[h].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=!1):("inner"!==f.snapMode&&(r=Math.abs(c-y)<=p,i=Math.abs(u-v)<=p,o=Math.abs(a-m)<=p,s=Math.abs(l-g)<=p,r&&(t.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),i&&(t.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),o&&(t.position.left=n._convertPositionTo("relative",{top:0,left:a-n.helperProportions.width}).left),s&&(t.position.left=n._convertPositionTo("relative",{top:0,left:l}).left)),d=r||i||o||s,"outer"!==f.snapMode&&(r=Math.abs(c-v)<=p,i=Math.abs(u-y)<=p,o=Math.abs(a-g)<=p,s=Math.abs(l-m)<=p,r&&(t.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),i&&(t.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),o&&(t.position.left=n._convertPositionTo("relative",{top:0,left:a}).left),s&&(t.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left)),!n.snapElements[h].snapping&&(r||i||o||s||d)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,$.extend(n._uiHash(),{snapItem:n.snapElements[h].item})),n.snapElements[h].snapping=r||i||o||s||d)}}),$.ui.plugin.add("draggable","stack",{start:function(e,t,n){var r,i=n.options,o=$.makeArray($(i.stack)).sort((function(e,t){return(parseInt($(e).css("zIndex"),10)||0)-(parseInt($(t).css("zIndex"),10)||0)}));o.length&&(r=parseInt($(o[0]).css("zIndex"),10)||0,$(o).each((function(e){$(this).css("zIndex",r+e)})),this.css("zIndex",r+o.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(e,t,n){var r=$(t.helper),i=n.options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(e,t,n){var r=n.options;r._zIndex&&$(t.helper).css("zIndex",r._zIndex)}});var draggable=$.ui.draggable;$.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,n=t.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){$.ui.ddmanager.droppables[e]=$.ui.ddmanager.droppables[e]||[],$.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=$.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,t){if("accept"===e)this.accept=$.isFunction(t)?t:function(e){return e.is(t)};else if("scope"===e){var n=$.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=$.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=$.ui.ddmanager.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var n=t||$.ui.ddmanager.current,r=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var t=$(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&t.options.scope===n.options.scope&&t.accept.call(t.element[0],n.currentItem||n.element)&&$.ui.intersect(n,$.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return r=!0,!1})),!r&&(!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),$.ui.intersect=function(){function e(e,t,n){return e>=t&&e<t+n}return function(t,n,r,i){if(!n.offset)return!1;var o=(t.positionAbs||t.position.absolute).left+t.margins.left,s=(t.positionAbs||t.position.absolute).top+t.margins.top,a=o+t.helperProportions.width,l=s+t.helperProportions.height,c=n.offset.left,u=n.offset.top,h=c+n.proportions().width,d=u+n.proportions().height;switch(r){case"fit":return c<=o&&a<=h&&u<=s&&l<=d;case"intersect":return c<o+t.helperProportions.width/2&&a-t.helperProportions.width/2<h&&u<s+t.helperProportions.height/2&&l-t.helperProportions.height/2<d;case"pointer":return e(i.pageY,u,n.proportions().height)&&e(i.pageX,c,n.proportions().width);case"touch":return(s>=u&&s<=d||l>=u&&l<=d||s<u&&l>d)&&(o>=c&&o<=h||a>=c&&a<=h||o<c&&a>h);default:return!1}}}(),$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var n,r,i=$.ui.ddmanager.droppables[e.options.scope]||[],o=t?t.type:null,s=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<i.length;n++)if(!(i[n].options.disabled||e&&!i[n].accept.call(i[n].element[0],e.currentItem||e.element))){for(r=0;r<s.length;r++)if(s[r]===i[n].element[0]){i[n].proportions().height=0;continue e}i[n].visible="none"!==i[n].element.css("display"),i[n].visible&&("mousedown"===o&&i[n]._activate.call(i[n],t),i[n].offset=i[n].element.offset(),i[n].proportions({width:i[n].element[0].offsetWidth,height:i[n].element[0].offsetHeight}))}},drop:function(e,t){var n=!1;return $.each(($.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&$.ui.intersect(e,this,this.options.tolerance,t)&&(n=this._drop.call(this,t)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))})),n},dragStart:function(e,t){e.element.parentsUntil("body").bind("scroll.droppable",(function(){e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}))},drag:function(e,t){e.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(e,t);var n=$.ui.ddmanager.droppables[e.options.scope]||[];$.each(n,(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,r,i,o=$.ui.intersect(e,this,this.options.tolerance,t),s=!o&&this.isover?"isout":o&&!this.isover?"isover":null;s&&(this.options.greedy&&(r=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter((function(){return $(this).droppable("instance").options.scope===r}))).length&&((n=$(i[0]).droppable("instance")).enteredGreedyChild=n.enteredGreedyChild||"isover"===s,n.leftGreedyChild=n.leftGreedyChild||"isout"===s)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this.c=s)}})),$.each(n,(function(){this.enteredGreedyChild&&(this.greedyChild=!0,this.isover=!1,this.isout=!0,this.c="isout"),this.leftGreedyChild&&!this.enteredGreedyChild&&(this.greedyChild=!1,this.isover=!0,this.isout=!1,this.c="isover"),this.c&&(this["isover"===this.c?"_over":"_out"].call(this,t),this.leftGreedyChild=!1,this.enteredGreedyChild=!1,this.c=null)}))},dragStop:function(e,t){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||$.ui.ddmanager.prepareOffsets(e,t)}};var droppable=$.ui.droppable;!function($){var min=Math.min,max=Math.max,round=Math.floor,isStr=function(e){return"string"===$.type(e)},runPluginCallbacks=function runPluginCallbacks(Instance,a_fn){if($.isArray(a_fn))for(var i=0,c=a_fn.length;i<c;i++){var fn=a_fn[i];try{isStr(fn)&&(fn=eval(fn)),$.isFunction(fn)&&g(fn)(Instance)}catch(e){}}function g(e){return e}};$.layout={version:"1.3.rc30.79",revision:.033007,browser:{},effects:{slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}},blind:{},clip:{},explode:{},fade:{},fold:{},puff:{},size:{all:{easing:"swing"}}},config:{optionRootKeys:"effects,panes,north,south,west,east,center".split(","),allPanes:"north,south,west,east,center".split(","),borderPanes:"north,south,west,east".split(","),oppositeEdge:{north:"south",south:"north",east:"west",west:"east"},offscreenCSS:{left:"-99999px",right:"auto"},offscreenReset:"offscreenReset",hidden:{visibility:"hidden"},visible:{visibility:"visible"},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"}},south:{side:"bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"}},east:{side:"right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"}},west:{side:"left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"}},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},callbacks:{},getParentPaneElem:function(e){var t=$(e),n=t.data("layout")||t.data("parentLayout");if(n){var r=n.container;if(r.data("layoutPane"))return r;var i=r.closest("."+$.layout.defaults.panes.paneClass);if(i.data("layoutPane"))return i}return null},getParentPaneInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("layoutPane"):null},getParentLayoutInstance:function(e){var t=$.layout.getParentPaneElem(e);return t?t.data("parentLayout"):null},getEventObject:function(e){return"object"===_typeof(e)&&e.stopPropagation?e:null},parsePaneName:function(e){var t=$.layout.getEventObject(e),n=e;return t&&(t.stopPropagation(),n=$(this).data("layoutEdge")),n&&!/^(west|east|north|south|center)$/.test(n)&&($.layout.msg('LAYOUT ERROR - Invalid pane-name: "'+n+'"'),n="error"),n},plugins:{draggable:!!$.fn.draggable,effects:{core:!!$.effects,slide:$.effects&&($.effects.slide||$.effects.effect&&$.effects.effect.slide)}},onCreate:[],onLoad:[],onReady:[],onDestroy:[],onUnload:[],afterOpen:[],afterClose:[],scrollbarWidth:function(){return window.scrollbarWidth||$.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||$.layout.getScrollbarSize("height")},getScrollbarSize:function(e){var t=$('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),n={width:t.css("width")-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),window.scrollbarWidth=n.width,window.scrollbarHeight=n.height,e.match(/^(width|height)$/)?n[e]:n},showInvisibly:function(e,t){if(e&&e.length&&(t||"none"===e.css("display"))){var n=e[0].style,r={display:n.display||"",visibility:n.visibility||""};return e.css({display:"block",visibility:"hidden"}),r}return{}},getElementDimensions:function(e,t){var n,r,i,o={css:{},inset:{}},s=o.css,a={bottom:0},l=$.layout.cssNum,c=e.offset();return o.offsetLeft=c.left,o.offsetTop=c.top,t||(t={}),$.each("Left,Right,Top,Bottom".split(","),(function(l,c){n=s["border"+c]=$.layout.borderWidth(e,c),r=s["padding"+c]=$.layout.cssNum(e,"padding"+c),i=c.toLowerCase(),o.inset[i]=t[i]>=0?t[i]:r,a[i]=o.inset[i]+n})),s.width=e.width(),s.height=e.height(),s.top=l(e,"top",!0),s.bottom=l(e,"bottom",!0),s.left=l(e,"left",!0),s.right=l(e,"right",!0),o.outerWidth=e.outerWidth(),o.outerHeight=e.outerHeight(),o.innerWidth=max(0,o.outerWidth-a.left-a.right),o.innerHeight=max(0,o.outerHeight-a.top-a.bottom),o.layoutWidth=e.innerWidth(),o.layoutHeight=e.innerHeight(),o},getElementStyles:function(e,t){var n,r,i,o,s,a,l={},c=e[0].style,u=t.split(","),h="Top,Bottom,Left,Right".split(","),d="Color,Style,Width".split(",");for(o=0;o<u.length;o++)if((n=u[o]).match(/(border|padding|margin)$/))for(s=0;s<4;s++)if(r=h[s],"border"===n)for(a=0;a<3;a++)l[n+r+(i=d[a])]=c[n+r+i];else l[n+r]=c[n+r];else l[n]=c[n];return l},cssWidth:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,i=$.layout.cssNum,o=t;return"border-box"!==n&&(o-=r(e,"Left")+r(e,"Right")),"content-box"===n&&(o-=i(e,"paddingLeft")+i(e,"paddingRight")),max(0,o)},cssHeight:function(e,t){if(t<=0)return 0;var n=$.layout.browser.boxModel?$.support.boxSizing?e.css("boxSizing"):"content-box":"border-box",r=$.layout.borderWidth,i=$.layout.cssNum,o=t;return"border-box"!==n&&(o-=r(e,"Top")+r(e,"Bottom")),"content-box"===n&&(o-=i(e,"paddingTop")+i(e,"paddingBottom")),max(0,o)},cssNum:function(e,t,n){e.jquery||(e=$(e));var r=$.layout.showInvisibly(e),i=$.css(e[0],t,!0),o=n&&"auto"==i?i:Math.round(parseFloat(i)||0);return e.css(r),o},borderWidth:function(e,t){e.jquery&&(e=e[0]);var n="border"+t.substr(0,1).toUpperCase()+t.substr(1);return"none"===$.css(e,n+"Style",!0)?0:Math.round(parseFloat($.css(e,n+"Width",!0))||0)},isMouseOverElem:function(e,t){var n=$(t||this),r=n.offset(),i=r.top,o=r.left,s=o+n.outerWidth(),a=i+n.outerHeight(),l=e.pageX,c=e.pageY;return $.layout.browser.msie&&l<0&&c<0||l>=o&&l<=s&&c>=i&&c<=a},msg:function(e,t,n,r){if($.isPlainObject(e)&&window.debugData){"string"==typeof t?(r=n,n=t):"object"===_typeof(n)&&(r=n,n=null);var i=n||"log( <object> )",o=$.extend({sort:!1,returnHTML:!1,display:!1},r);!0===t||o.display?debugData(e,i,o):window.console&&console.log(debugData(e,i,o))}else if(t)alert(e);else if(window.console)console.log(e);else{var s=$("#layoutLogger");s.length||(s=function(){var e=$.support.fixedPosition?"fixed":"absolute",t=$('<div id="layoutLogger" style="position: '+e+'; top: 5px; z-index: 999999; max-width: 25%; overflow: hidden; border: 1px solid #000; border-radius: 5px; background: #FBFBFB; box-shadow: 0 2px 10px rgba(0,0,0,0.3);"><div style="font-size: 13px; font-weight: bold; padding: 5px 10px; background: #F6F6F6; border-radius: 5px 5px 0 0; cursor: move;"><span style="float: right; padding-left: 7px; cursor: pointer;" title="Remove Console" onclick="$(this).closest(\'#layoutLogger\').remove()">X</span>Layout console.log</div><ul style="font-size: 13px; font-weight: none; list-style: none; margin: 0; padding: 0 0 2px;"></ul></div>').appendTo("body");t.css("left",$(window).width()-t.outerWidth()-5),$.ui.draggable&&t.draggable({handle:":first-child"});return t}()),s.children("ul").append('<li style="padding: 4px 10px; margin: 0; border-top: 1px solid #CCC;">'+e.replace(/\</g,"&lt;").replace(/\>/g,"&gt;")+"</li>")}}};var u=navigator.userAgent.toLowerCase(),m=/(chrome)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(u)||[],b=m[1]||"",v=m[2]||0,ie="msie"===b;$.layout.browser={version:v,safari:"webkit"===b,webkit:"chrome"===b,msie:ie,isIE6:ie&&6==v,boxModel:!ie||!1!==$.support.boxModel},b&&($.layout.browser[b]=!0),ie&&$((function(){$.layout.browser.boxModel=$.support.boxModel})),$.layout.defaults={name:"",containerClass:"ui-layout-container",inset:null,scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,maskPanesEarly:!1,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,initPanes:!0,showErrorMessages:!0,showDebugMessages:!1,zIndex:null,zIndexes:{pane_normal:0,content_mask:1,resizer_normal:2,pane_sliding:100,pane_animate:1e3,resizer_drag:1e4},errors:{pane:"pane",selector:"selector",addButtonError:"Error Adding Button\nInvalid ",containerMissing:"UI Layout Initialization Error\nThe specified layout-container does not exist.",centerPaneMissing:"UI Layout Initialization Error\nThe center-pane element does not exist.\nThe center-pane is a required element.",noContainerHeight:"UI Layout Initialization Warning\nThe layout-container \"CONTAINER\" has no height.\nTherefore the layout is 0-height and hence 'invisible'!",callbackError:"UI Layout Callback Error\nThe EVENT callback is not a valid function."},panes:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskContents:!1,maskObjects:!1,maskZindex:null,resizingGrid:!1,livePaneResizing:!1,liveContentResizing:!1,liveResizingTolerance:1,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:$.layout.browser.webkit,preventPrematureSlideClose:!1,tips:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpen:"Not enough room to show this panel.",minSizeWarning:"Panel has reached its minimum size",maxSizeWarning:"Panel has reached its maximum size"},showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,animatePaneSizing:!1,children:null,containerSelector:"",initChildren:!0,destroyChildren:!0,resizeChildren:!0,triggerEventsOnLoad:!1,triggerEventsDuringLiveResize:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0}},$.layout.optionsMap={layout:"name,instanceKey,stateManagement,effects,inset,zIndexes,errors,zIndex,scrollToBookmarkOnLoad,showErrorMessages,maskPanesEarly,outset,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end".split(","),center:"paneClass,contentSelector,contentIgnoreSelector,findNestedContent,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,maskContents,maskObjects,liveContentResizing,containerSelector,children,initChildren,resizeChildren,destroyChildren,onresize,onresize_start,onresize_end,onsizecontent,onsizecontent_start,onsizecontent_end".split(","),noDefault:"paneSelector,resizerCursor,customHotkey".split(",")},$.layout.transformData=function(e,t){var n,r,i,o,s,a,l,c=t?{panes:{},center:{}}:{};if("object"!==_typeof(e))return c;for(r in e)for(n=c,s=e[r],l=(i=r.split("__")).length-1,a=0;a<=l;a++)o=i[a],a===l?$.isPlainObject(s)?n[o]=$.layout.transformData(s):n[o]=s:(n[o]||(n[o]={}),n=n[o]);return c},$.layout.backwardCompatibility={map:{applyDefaultStyles:"applyDemoStyles",childOptions:"children",initChildLayout:"initChildren",destroyChildLayout:"destroyChildren",resizeChildLayout:"resizeChildren",resizeNestedLayout:"resizeChildren",resizeWhileDragging:"livePaneResizing",resizeContentWhileDragging:"liveContentResizing",triggerEventsWhileDragging:"triggerEventsDuringLiveResize",maskIframesOnResize:"maskContents",useStateCookie:"stateManagement.enabled","cookie.autoLoad":"stateManagement.autoLoad","cookie.autoSave":"stateManagement.autoSave","cookie.keys":"stateManagement.stateKeys","cookie.name":"stateManagement.cookie.name","cookie.domain":"stateManagement.cookie.domain","cookie.path":"stateManagement.cookie.path","cookie.expires":"stateManagement.cookie.expires","cookie.secure":"stateManagement.cookie.secure",noRoomToOpenTip:"tips.noRoomToOpen",togglerTip_open:"tips.Close",togglerTip_closed:"tips.Open",resizerTip:"tips.Resize",sliderTip:"tips.Slide"},renameOptions:function(e){var t,n,r,i=$.layout.backwardCompatibility.map;for(var o in i)void 0!==(r=(t=s(o)).branch[t.key])&&((n=s(i[o],!0)).branch[n.key]=r,delete t.branch[t.key]);function s(t,n){for(var r,i=t.split("."),o=i.length-1,s={branch:e,key:i[o]},a=0;a<o;a++)r=i[a],null==s.branch[r]?s.branch=n?s.branch[r]={}:{}:s.branch=s.branch[r];return s}},renameAllOptions:function(e){var t=$.layout.backwardCompatibility.renameOptions;return t(e),e.defaults&&("object"!==_typeof(e.panes)&&(e.panes={}),$.extend(!0,e.panes,e.defaults),delete e.defaults),e.panes&&t(e.panes),$.each($.layout.config.allPanes,(function(n,r){e[r]&&t(e[r])})),e}},$.fn.layout=function(opts){var browser=$.layout.browser,_c=$.layout.config,cssW=$.layout.cssWidth,cssH=$.layout.cssHeight,elDims=$.layout.getElementDimensions,styles=$.layout.getElementStyles,evtObj=$.layout.getEventObject,evtPane=$.layout.parsePaneName,options=$.extend(!0,{},$.layout.defaults),effects=options.effects=$.extend(!0,{},$.layout.effects),state={id:"layout"+$.now(),initialized:!1,paneResizing:!1,panesSliding:{},container:{innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0,layoutWidth:0,layoutHeight:0},north:{childIdx:0},south:{childIdx:0},east:{childIdx:0},west:{childIdx:0},center:{childIdx:0}},children={north:null,south:null,east:null,west:null,center:null},timer={data:{},set:function(e,t,n){timer.clear(e),timer.data[e]=setTimeout(t,n)},clear:function(e){var t=timer.data;t[e]&&(clearTimeout(t[e]),delete t[e])}},_log=function(e,t,n){var r=options;return(r.showErrorMessages&&!n||n&&r.showDebugMessages)&&$.layout.msg(r.name+" / "+e,!1!==t),!1},_runCallbacks=function _runCallbacks(evtName,pane,skipBoundEvents){var hasPane=pane&&isStr(pane),s=hasPane?state[pane]:state,o=hasPane?options[pane]:options,lName=options.name,lng=evtName+(evtName.match(/_/)?"":"_end"),shrt=lng.match(/_end$/)?lng.substr(0,lng.length-4):"",fn=o[lng]||o[shrt],retVal="NC",args=[],$P;return hasPane||"boolean"!==$.type(pane)||(skipBoundEvents=pane,pane=""),fn&&(isStr(fn)&&(fn.match(/,/)?(args=fn.split(","),fn=eval(args[0])):fn=eval(fn)),$.isFunction(fn)&&(retVal=args.length?g(fn)(args[1]):hasPane?g(fn)(pane,$Ps[pane],s,o,lName):g(fn)(Instance,s,o,lName))),skipBoundEvents||!1===retVal||(hasPane?($P=$Ps[pane],o=options[pane],s=state[pane],$P.triggerHandler("layoutpane"+lng,[pane,$P,s,o,lName]),shrt&&$P.triggerHandler("layoutpane"+shrt,[pane,$P,s,o,lName])):($N.triggerHandler("layout"+lng,[Instance,s,o,lName]),shrt&&$N.triggerHandler("layout"+shrt,[Instance,s,o,lName]))),hasPane&&"onresize_end"===evtName&&resizeChildren(pane+"",!0),retVal;function g(e){return e}},_fixIframe=function(e){if(!browser.mozilla){var t=$Ps[e];"IFRAME"===state[e].tagName?t.css(_c.hidden).css(_c.visible):t.find("IFRAME").css(_c.hidden).css(_c.visible)}},cssSize=function(e,t){return("horz"==_c[e].dir?cssH:cssW)($Ps[e],t)},cssMinDims=function(e){var t=$Ps[e],n=_c[e].dir,r={minWidth:1001-cssW(t,1e3),minHeight:1001-cssH(t,1e3)};return"horz"===n&&(r.minSize=r.minHeight),"vert"===n&&(r.minSize=r.minWidth),r},setOuterWidth=function(e,t,n){var r,i=e;isStr(e)?i=$Ps[e]:e.jquery||(i=$(e)),r=cssW(i,t),i.css({width:r}),r>0?n&&i.data("autoHidden")&&i.innerHeight()>0&&(i.show().data("autoHidden",!1),browser.mozilla||i.css(_c.hidden).css(_c.visible)):n&&!i.data("autoHidden")&&i.hide().data("autoHidden",!0)},setOuterHeight=function(e,t,n){var r,i=e;isStr(e)?i=$Ps[e]:e.jquery||(i=$(e)),r=cssH(i,t),i.css({height:r,visibility:"visible"}),r>0&&i.innerWidth()>0?n&&i.data("autoHidden")&&(i.show().data("autoHidden",!1),browser.mozilla||i.css(_c.hidden).css(_c.visible)):n&&!i.data("autoHidden")&&i.hide().data("autoHidden",!0)},_parseSize=function(e,t,n){if(n||(n=_c[e].dir),isStr(t)&&t.match(/%/)&&(t="100%"===t?-1:parseInt(t,10)/100),0===t)return 0;if(t>=1)return parseInt(t,10);var r=options,i=0;if("horz"==n?i=sC.innerHeight-($Ps.north?r.north.spacing_open:0)-($Ps.south?r.south.spacing_open:0):"vert"==n&&(i=sC.innerWidth-($Ps.west?r.west.spacing_open:0)-($Ps.east?r.east.spacing_open:0)),-1===t)return i;if(t>0)return round(i*t);if("center"==e)return 0;var o="horz"===n?"height":"width",s=$Ps[e],a="height"===o&&$Cs[e],l=$.layout.showInvisibly(s),c=s.css(o),u=a?a.css(o):0;return s.css(o,"auto"),a&&a.css(o,"auto"),t="height"===o?s.outerHeight():s.outerWidth(),s.css(o,c).css(l),a&&a.css(o,u),t},getPaneSize=function(e,t){var n=$Ps[e],r=options[e],i=state[e],o=t?r.spacing_open:0,s=t?r.spacing_closed:0;return!n||i.isHidden?0:i.isClosed||i.isSliding&&t?s:"horz"===_c[e].dir?n.outerHeight()+o:n.outerWidth()+o},setSizeLimits=function(e,t){if(isInitialized()){var n=options[e],r=state[e],i=_c[e],o=i.dir,s=(i.sizeType.toLowerCase(),null!=t?t:r.isSliding),a=($Ps[e],n.spacing_open),l=_c.oppositeEdge[e],c=state[l],u=$Ps[l],h=!u||!1===c.isVisible||c.isSliding?0:"horz"==o?u.outerHeight():u.outerWidth(),d=(!u||c.isHidden?0:options[l][!1!==c.isClosed?"spacing_closed":"spacing_open"])||0,f="horz"==o?sC.innerHeight:sC.innerWidth,p=cssMinDims("center"),g="horz"==o?max(options.center.minHeight,p.minHeight):max(options.center.minWidth,p.minWidth),m=f-a-(s?0:_parseSize("center",g,o)+h+d),v=r.minSize=max(_parseSize(e,n.minSize),cssMinDims(e).minSize),y=r.maxSize=min(n.maxSize?_parseSize(e,n.maxSize):1e5,m),b=r.resizerPosition={},w=sC.inset.top,_=sC.inset.left,C=sC.innerWidth,S=sC.innerHeight,k=n.spacing_open;switch(e){case"north":b.min=w+v,b.max=w+y;break;case"west":b.min=_+v,b.max=_+y;break;case"south":b.min=w+S-y-k,b.max=w+S-v-k;break;case"east":b.min=_+C-y-k,b.max=_+C-v-k}}},calcNewCenterPaneDims=function(){var e={top:getPaneSize("north",!0),bottom:getPaneSize("south",!0),left:getPaneSize("west",!0),right:getPaneSize("east",!0),width:0,height:0};return e.width=sC.innerWidth-e.left-e.right,e.height=sC.innerHeight-e.bottom-e.top,e.top+=sC.inset.top,e.bottom+=sC.inset.bottom,e.left+=sC.inset.left,e.right+=sC.inset.right,e},getHoverClasses=function(e,t){var n=$(e),r=n.data("layoutRole"),i=n.data("layoutEdge"),o=options[i][r+"Class"],s="-"+i,a="-hover ",l=n.hasClass(o+"-closed")?"-closed":"-open",c="-closed"===l?"-open":"-closed",u=o+a+(o+s+a)+(o+l+a)+(o+s+l+a);return t&&(u+=o+c+a+(o+s+c+a)),"resizer"==r&&n.hasClass(o+"-sliding")&&(u+=o+"-sliding"+a+(o+s)+"-sliding"+a),$.trim(u)},addHover=function(e,t){var n=$(t||this);e&&"toggler"===n.data("layoutRole")&&e.stopPropagation(),n.addClass(getHoverClasses(n))},removeHover=function(e,t){var n=$(t||this);n.removeClass(getHoverClasses(n,!0))},onResizerEnter=function(e){var t=$(this).data("layoutEdge"),n=state[t];n.isClosed||n.isResizing||state.paneResizing||($.fn.disableSelection&&$("body").disableSelection(),options.maskPanesEarly&&showMasks(t,{resizing:!0}))},onResizerLeave=function e(t,n){var r=n||this,i=$(r).data("layoutEdge"),o=i+"ResizerLeave";timer.clear(i+"_openSlider"),timer.clear(o),n?state.paneResizing||($.fn.enableSelection&&$("body").enableSelection(),options.maskPanesEarly&&hideMasks()):timer.set(o,(function(){e(t,r)}),200)},_create=function(){initOptions();var e=options,t=state;return t.creatingLayout=!0,runPluginCallbacks(Instance,$.layout.onCreate),!1===_runCallbacks("onload_start")?"cancel":(_initContainer(),initHotkeys(),$(window).bind("unload."+sID,unload),runPluginCallbacks(Instance,$.layout.onLoad),e.initPanes&&_initLayoutElements(),delete t.creatingLayout,state.initialized)},isInitialized=function(){return!(!state.initialized&&!state.creatingLayout)||_initLayoutElements()},_initLayoutElements=function e(t){var n=options;if(!$N.is(":visible"))return!t&&browser.webkit&&"BODY"===$N[0].tagName&&setTimeout((function(){e(!0)}),50),!1;if(!getPane("center").length)return _log(n.errors.centerPaneMissing);if(state.creatingLayout=!0,$.extend(sC,elDims($N,n.inset)),initPanes(),n.scrollToBookmarkOnLoad){var r=self.location;r.hash&&r.replace(r.hash)}return Instance.hasParentLayout?n.resizeWithWindow=!1:n.resizeWithWindow&&$(window).bind("resize."+sID,windowResize),delete state.creatingLayout,state.initialized=!0,runPluginCallbacks(Instance,$.layout.onReady),_runCallbacks("onload_end"),!0},createChildren=function(e,t){var n=evtPane.call(this,e),r=$Ps[n];if(r){var i=$Cs[n],o=state[n],s=options[n],a=options.stateManagement||{},l=t?s.children=t:s.children;if($.isPlainObject(l))l=[l];else if(!l||!$.isArray(l))return;$.each(l,(function(e,t){$.isPlainObject(t)&&(t.containerSelector?r.find(t.containerSelector):i||r).each((function(){var e=$(this),r=e.data("layout");if(!r){if(setInstanceKey({container:e,options:t},o),a.includeChildren&&state.stateData[n]){var i=(state.stateData[n].children||{})[t.instanceKey],s=t.stateManagement||(t.stateManagement={autoLoad:!0});!0===s.autoLoad&&i&&(s.autoSave=!1,s.includeChildren=!0,s.autoLoad=$.extend(!0,{},i))}(r=e.layout(t))&&refreshChildren(n,r)}}))}))}},setInstanceKey=function(e,t){var n=e.container,r=e.options,i=r.stateManagement,o=r.instanceKey||n.data("layoutInstanceKey");return o||(o=(i&&i.cookie?i.cookie.name:"")||r.name),o=o?o.replace(/[^\w-]/gi,"_").replace(/_{2,}/g,"_"):"layout"+ ++t.childIdx,r.instanceKey=o,n.data("layoutInstanceKey",o),o},refreshChildren=function(e,t){var n,r=$Ps[e],i=children[e],o=state[e];$.isPlainObject(i)&&($.each(i,(function(e,t){t.destroyed&&delete i[e]})),$.isEmptyObject(i)&&(i=children[e]=null)),t||i||(t=r.data("layout")),t&&(t.hasParentLayout=!0,n=t.options,setInstanceKey(t,o),i||(i=children[e]={}),i[n.instanceKey]=t.container.data("layout")),Instance[e].children=children[e],t||createChildren(e)},windowResize=function(){var e=options,t=Number(e.resizeWithWindowDelay);t<10&&(t=100),timer.clear("winResize"),timer.set("winResize",(function(){timer.clear("winResize"),timer.clear("winResizeRepeater");var t=elDims($N,e.inset);t.innerWidth===sC.innerWidth&&t.innerHeight===sC.innerHeight||resizeAll()}),t),timer.data.winResizeRepeater||setWindowResizeRepeater()},setWindowResizeRepeater=function e(){var t=Number(options.resizeWithWindowMaxDelay);t>0&&timer.set("winResizeRepeater",(function(){e(),resizeAll()}),t)},unload=function(){_runCallbacks("onunload_start"),runPluginCallbacks(Instance,$.layout.onUnload),_runCallbacks("onunload_end")},_initContainer=function(){var e,t,n=$N[0],r=$("html"),i=sC.tagName=n.tagName,o=sC.id=n.id,s=sC.className=n.className,a=options,l=a.name,c="position,margin,padding,border",u="layoutCSS",h={},d="hidden",f=$N.data("parentLayout"),p=$N.data("layoutEdge"),g=f&&p,m=$.layout.cssNum;sC.selector=$N.selector.split(".slice")[0],sC.ref=(a.name?a.name+" layout / ":"")+i+(o?"#"+o:s?".["+s+"]":""),sC.isBody="BODY"===i,g||sC.isBody||(f=(e=$N.closest("."+$.layout.defaults.panes.paneClass)).data("parentLayout"),p=e.data("layoutEdge"),g=f&&p),$N.data({layout:Instance,layoutContainer:sID}).addClass(a.containerClass);var v={destroy:"",initPanes:"",resizeAll:"resizeAll",resize:"resizeAll"};for(l in v)$N.bind("layout"+l.toLowerCase()+"."+sID,Instance[v[l]||l]);g&&(Instance.hasParentLayout=!0,f.refreshChildren(p,Instance)),$N.data(u)||(sC.isBody?($N.data(u,$.extend(styles($N,c),{height:$N.css("height"),overflow:$N.css("overflow"),overflowX:$N.css("overflowX"),overflowY:$N.css("overflowY")})),r.data(u,$.extend(styles(r,"padding"),{height:"auto",overflow:r.css("overflow"),overflowX:r.css("overflowX"),overflowY:r.css("overflowY")}))):$N.data(u,styles($N,c+",top,bottom,left,right,width,height,overflow,overflowX,overflowY")));try{if(h={overflow:d,overflowX:d,overflowY:d},$N.css(h),a.inset&&!$.isPlainObject(a.inset)&&(t=parseInt(a.inset,10)||0,a.inset={top:t,bottom:t,left:t,right:t}),sC.isBody)a.outset?$.isPlainObject(a.outset)||(t=parseInt(a.outset,10)||0,a.outset={top:t,bottom:t,left:t,right:t}):a.outset={top:m(r,"paddingTop"),bottom:m(r,"paddingBottom"),left:m(r,"paddingLeft"),right:m(r,"paddingRight")},r.css(h).css({height:"100%",border:"none",padding:0,margin:0}),browser.isIE6?($N.css({width:"100%",height:"100%",border:"none",padding:0,margin:0,position:"relative"}),a.inset||(a.inset=elDims($N).inset)):($N.css({width:"auto",height:"auto",margin:0,position:"absolute"}),$N.css(a.outset)),$.extend(sC,elDims($N,a.inset));else{var y=$N.css("position");y&&y.match(/(fixed|absolute|relative)/)||$N.css("position","relative"),$N.is(":visible")&&($.extend(sC,elDims($N,a.inset)),sC.innerHeight<1&&_log(a.errors.noContainerHeight.replace(/CONTAINER/,sC.ref)))}m($N,"minWidth")&&$N.parent().css("overflowX","auto"),m($N,"minHeight")&&$N.parent().css("overflowY","auto")}catch(e){}},initHotkeys=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=options[t];if(n.enableCursorHotkey||n.customHotkey)return $(document).bind("keydown."+sID,keyDown),!1}))},initOptions=function(){var e,t,n,r,i,o,s;if(opts=$.layout.transformData(opts,!0),opts=$.layout.backwardCompatibility.renameAllOptions(opts),!$.isEmptyObject(opts.panes)){for(e=$.layout.optionsMap.noDefault,i=0,o=e.length;i<o;i++)n=e[i],delete opts.panes[n];for(e=$.layout.optionsMap.layout,i=0,o=e.length;i<o;i++)n=e[i],delete opts.panes[n]}e=$.layout.optionsMap.layout;var a=$.layout.config.optionRootKeys;for(n in opts)r=opts[n],$.inArray(n,a)<0&&$.inArray(n,e)<0&&(opts.panes[n]||(opts.panes[n]=$.isPlainObject(r)?$.extend(!0,{},r):r),delete opts[n]);$.extend(!0,options,opts),$.each(_c.allPanes,(function(r,i){if(_c[i]=$.extend(!0,{},_c.panes,_c[i]),t=options.panes,s=options[i],"center"===i)for(e=$.layout.optionsMap.center,r=0,o=e.length;r<o;r++)n=e[r],opts.center[n]||!opts.panes[n]&&s[n]||(s[n]=t[n]);else s=options[i]=$.extend(!0,{},t,s),function(e){var t=options[e],n=options.panes;t.fxSettings||(t.fxSettings={});n.fxSettings||(n.fxSettings={});$.each(["_open","_close","_size"],(function(r,i){var o="fxName"+i,s="fxSpeed"+i,a="fxSettings"+i,l=t[o]=t[o]||n[o]||t.fxName||n.fxName||"none",c=$.effects&&($.effects[l]||$.effects.effect&&$.effects.effect[l]);"none"!==l&&options.effects[l]&&c||(l=t[o]="none");var u=options.effects[l]||{},h=u.all||null,d=u[e]||null;t[s]=t[s]||n[s]||t.fxSpeed||n.fxSpeed||null,t[a]=$.extend(!0,{},h,d,n.fxSettings,t.fxSettings,n[a],t[a])})),delete t.fxName,delete t.fxSpeed,delete t.fxSettings}(i),s.resizerClass||(s.resizerClass="ui-layout-resizer"),s.togglerClass||(s.togglerClass="ui-layout-toggler");s.paneClass||(s.paneClass="ui-layout-pane")}));var l=opts.zIndex,c=options.zIndexes;l>0&&(c.pane_normal=l,c.content_mask=max(l+1,c.content_mask),c.resizer_normal=max(l+2,c.resizer_normal)),delete options.panes},getPane=function(e){var t=options[e].paneSelector;if("#"===t.substr(0,1))return $N.find(t).eq(0);var n=$N.children(t).eq(0);return n.length?n:$N.children("form:first").children(t).eq(0)},initPanes=function(e){evtPane(e),$.each(_c.allPanes,(function(e,t){addPane(t,!0)})),initHandles(),$.each(_c.borderPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&(setSizeLimits(t),makePaneFit(t))})),sizeMidPanes("center"),$.each(_c.allPanes,(function(e,t){afterInitPane(t)}))},addPane=function(e,t){if(t||isInitialized()){var n,r,i,o=options[e],s=state[e],a=_c[e],l=a.dir,c=(s.fx,o.spacing_open,"center"===e),u={},h=$Ps[e];if(h?removePane(e,!1,!0,!1):$Cs[e]=!1,(h=$Ps[e]=getPane(e)).length){if(!h.data("layoutCSS")){h.data("layoutCSS",styles(h,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"))}Instance[e]={name:e,pane:$Ps[e],content:$Cs[e],options:options[e],state:state[e],children:children[e]},h.data({parentLayout:Instance,layoutPane:Instance[e],layoutEdge:e,layoutRole:"pane"}).css(a.cssReq).css("zIndex",options.zIndexes.pane_normal).css(o.applyDemoStyles?a.cssDemo:{}).addClass(o.paneClass+" "+o.paneClass+"-"+e).bind("mouseenter."+sID,addHover).bind("mouseleave."+sID,removeHover);var d,f={hide:"",show:"",toggle:"",close:"",open:"",slideOpen:"",slideClose:"",slideToggle:"",size:"sizePane",sizePane:"sizePane",sizeContent:"",sizeHandles:"",enableClosable:"",disableClosable:"",enableSlideable:"",disableSlideable:"",enableResizable:"",disableResizable:"",swapPanes:"swapPanes",swap:"swapPanes",move:"swapPanes",removePane:"removePane",remove:"removePane",createChildren:"",resizeChildren:"",resizeAll:"resizeAll",resizeLayout:"resizeAll"};for(d in f)h.bind("layoutpane"+d.toLowerCase()+"."+sID,Instance[f[d]||d]);initContent(e,!1),c||(n=s.size=_parseSize(e,o.size),r=_parseSize(e,o.minSize)||1,i=_parseSize(e,o.maxSize)||1e5,n>0&&(n=max(min(n,i),r)),s.autoResize=o.autoResize,s.isClosed=!1,s.isSliding=!1,s.isResizing=!1,s.isHidden=!1,s.pins||(s.pins=[])),s.tagName=h[0].tagName,s.edge=e,s.noRoom=!1,s.isVisible=!0,setPanePosition(e),"horz"===l?u.height=cssH(h,n):"vert"===l&&(u.width=cssW(h,n)),h.css(u),"horz"!=l&&sizeMidPanes(e,!0),state.initialized&&(initHandles(e),initHotkeys(e)),o.initClosed&&o.closable&&!o.initHidden?close(e,!0,!0):o.initHidden||o.initClosed?hide(e):s.noRoom||h.css("display","block"),h.css("visibility","visible"),o.showOverflowOnHover&&h.hover(allowOverflow,resetOverflow),state.initialized&&afterInitPane(e)}else $Ps[e]=!1}},afterInitPane=function(e){var t=$Ps[e],n=state[e],r=options[e];t&&(t.data("layout")&&refreshChildren(e,t.data("layout")),n.isVisible&&(state.initialized?resizeAll():sizeContent(e),r.triggerEventsOnLoad?_runCallbacks("onresize_end",e):resizeChildren(e,!0)),r.initChildren&&r.children&&createChildren(e))},setPanePosition=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t],r=$Rs[t],i=(options[t],state[t]),o=_c[t].side,s={};if(n){switch(t){case"north":s.top=sC.inset.top,s.left=sC.inset.left,s.right=sC.inset.right;break;case"south":s.bottom=sC.inset.bottom,s.left=sC.inset.left,s.right=sC.inset.right;break;case"west":s.left=sC.inset.left;break;case"east":s.right=sC.inset.right}n.css(s),r&&i.isClosed?r.css(o,sC.inset[o]):r&&!i.isHidden&&r.css(o,sC.inset[o]+getPaneSize(t))}}))},initHandles=function(e){e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,t){var n=$Ps[t];if($Rs[t]=!1,$Ts[t]=!1,n){var r=options[t],i=state[t],o=(_c[t],"#"===r.paneSelector.substr(0,1)?r.paneSelector.substr(1):""),s=r.resizerClass,a=r.togglerClass,l=(i.isVisible?r.spacing_open:r.spacing_closed,"-"+t),c=(i.isVisible,Instance[t]),u=c.resizer=$Rs[t]=$("<div></div>"),h=c.toggler=!!r.closable&&($Ts[t]=$("<div></div>"));!i.isVisible&&r.slidable&&u.attr("title",r.tips.Slide).css("cursor",r.sliderCursor),u.attr("id",o?o+"-resizer":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"resizer"}).css(_c.resizers.cssReq).css("zIndex",options.zIndexes.resizer_normal).css(r.applyDemoStyles?_c.resizers.cssDemo:{}).addClass(s+" "+s+l).hover(addHover,removeHover).hover(onResizerEnter,onResizerLeave).appendTo($N),r.resizerDblClickToggle&&u.bind("dblclick."+sID,toggle),h&&(h.attr("id",o?o+"-toggler":"").data({parentLayout:Instance,layoutPane:Instance[t],layoutEdge:t,layoutRole:"toggler"}).css(_c.togglers.cssReq).css(r.applyDemoStyles?_c.togglers.cssDemo:{}).addClass(a+" "+a+l).hover(addHover,removeHover).bind("mouseenter",onResizerEnter).appendTo(u),r.togglerContent_open&&$("<span>"+r.togglerContent_open+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).data("layoutRole","togglerContent").data("layoutEdge",t).addClass("content content-open").css("display","none").appendTo(h),r.togglerContent_closed&&$("<span>"+r.togglerContent_closed+"</span>").data({layoutEdge:t,layoutRole:"togglerContent"}).addClass("content content-closed").css("display","none").appendTo(h),enableClosable(t)),initResizable(t),i.isVisible?setAsOpen(t):(setAsClosed(t),bindStartSlidingEvents(t,!0))}})),sizeHandles()},initContent=function(e,t){if(isInitialized()){var n,r=options[e],i=r.contentSelector,o=Instance[e],s=$Ps[e];i&&(n=o.content=$Cs[e]=r.findNestedContent?s.find(i).eq(0):s.children(i).eq(0)),n&&n.length?(n.data("layoutRole","content"),n.data("layoutCSS")||n.data("layoutCSS",styles(n,"height")),n.css(_c.content.cssReq),r.applyDemoStyles&&(n.css(_c.content.cssDemo),s.css(_c.content.cssDemoPane)),s.css("overflowX").match(/(scroll|auto)/)&&s.css("overflow","hidden"),state[e].content={},!1!==t&&sizeContent(e)):o.content=$Cs[e]=!1}},initResizable=function(e){var t=$.layout.plugins.draggable;e=e?e.split(","):_c.borderPanes,$.each(e,(function(e,r){var i=options[r];if(!t||!$Ps[r]||!i.resizable)return i.resizable=!1,!0;var o,s,a=state[r],l=options.zIndexes,c=_c[r],u="horz"==c.dir?"top":"left",h=($Ps[r],$Rs[r]),d=i.resizerClass,f=0,p=d+"-drag",g=d+"-"+r+"-drag",m=d+"-dragging",v=d+"-"+r+"-dragging",y=d+"-dragging-limit",b=d+"-"+r+"-dragging-limit",w=!1;a.isClosed||h.attr("title",i.tips.Resize).css("cursor",i.resizerCursor),h.draggable({containment:$N[0],axis:"horz"==c.dir?"y":"x",delay:0,distance:1,grid:i.resizingGrid,helper:"clone",opacity:i.resizerDragOpacity,addClasses:!1,zIndex:l.resizer_drag,start:function(e,t){if(i=options[r],a=state[r],s=i.livePaneResizing,!1===_runCallbacks("ondrag_start",r))return!1;a.isResizing=!0,state.paneResizing=r,timer.clear(r+"_closeSlider"),setSizeLimits(r),o=a.resizerPosition,f=t.position[u],h.addClass(p+" "+g),w=!1,$("body").disableSelection(),showMasks(r,{resizing:!0})},drag:function(e,t){w||(t.helper.addClass(m+" "+v).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),w=!0,a.isSliding&&$Ps[r].css("zIndex",l.pane_sliding));var c=0;t.position[u]<o.min?(t.position[u]=o.min,c=-1):t.position[u]>o.max&&(t.position[u]=o.max,c=1),c?(t.helper.addClass(y+" "+b),window.defaultStatus=c>0&&r.match(/(north|west)/)||c<0&&r.match(/(south|east)/)?i.tips.maxSizeWarning:i.tips.minSizeWarning):(t.helper.removeClass(y+" "+b),window.defaultStatus=""),s&&Math.abs(t.position[u]-f)>=i.liveResizingTolerance&&(f=t.position[u],n(e,t,r))},stop:function(e,t){$("body").enableSelection(),window.defaultStatus="",h.removeClass(p+" "+g),a.isResizing=!1,state.paneResizing=!1,n(e,t,r,!0)}})}));var n=function(e,t,n,r){var i,o=t.position,s=_c[n],a=options[n],l=state[n];switch(n){case"north":i=o.top;break;case"west":i=o.left;break;case"south":i=sC.layoutHeight-o.top-a.spacing_open;break;case"east":i=sC.layoutWidth-o.left-a.spacing_open}var c=i-sC.inset[s.side];if(r)!1!==_runCallbacks("ondrag_end",n)&&manualSizePane(n,c,!1,!0),hideMasks(!0),l.isSliding&&showMasks(n,{resizing:!0});else{if(Math.abs(c-l.size)<a.liveResizingTolerance)return;manualSizePane(n,c,!1,!0),sizeMasks()}}},sizeMask=function(){var e=$(this),t=e.data("layoutMask"),n=state[t];"IFRAME"==n.tagName&&n.isVisible&&e.css({top:n.offsetTop,left:n.offsetLeft,width:n.outerWidth,height:n.outerHeight})},sizeMasks=function(){$Ms.each(sizeMask)},showMasks=function(e,t){var n,r,i=_c[e],o=["center"],s=options.zIndexes,a=$.extend({objectsOnly:!1,animation:!1,resizing:!0,sliding:state[e].isSliding},t);a.resizing&&o.push(e),a.sliding&&o.push(_c.oppositeEdge[e]),"horz"===i.dir&&(o.push("west"),o.push("east")),$.each(o,(function(e,t){r=state[t],n=options[t],r.isVisible&&(n.maskObjects||!a.objectsOnly&&n.maskContents)&&getMasks(t).each((function(){sizeMask.call(this),this.style.zIndex=r.isSliding?s.pane_sliding+1:s.pane_normal+1,this.style.display="block"}))}))},hideMasks=function(e){if(e||!state.paneResizing)$Ms.hide();else if(!e&&!$.isEmptyObject(state.panesSliding))for(var t,n,r=$Ms.length-1;r>=0;r--)t=(n=$Ms.eq(r)).data("layoutMask"),options[t].maskObjects||n.hide()},getMasks=function(e){for(var t,n=$([]),r=0,i=$Ms.length;r<i;r++)(t=$Ms.eq(r)).data("layoutMask")===e&&(n=n.add(t));return n.length?n:createMasks(e)},createMasks=function(e){var t,n,r,i,o,s=$Ps[e],a=state[e],l=options[e],c=options.zIndexes,u=$([]);if(!l.maskContents&&!l.maskObjects)return u;for(o=0;o<(l.maskObjects?2:1);o++)t=l.maskObjects&&0==o,n=document.createElement(t?"iframe":"div"),r=$(n).data("layoutMask",e),n.className="ui-layout-mask ui-layout-mask-"+e,(i=n.style).display="block",i.position="absolute",i.background="#FFF",t&&(n.frameborder=0,n.src="about:blank",i.opacity=0,i.filter="Alpha(Opacity='0')",i.border=0),"IFRAME"==a.tagName?(i.zIndex=c.pane_normal+1,$N.append(n)):(r.addClass("ui-layout-mask-inside-pane"),i.zIndex=l.maskZindex||c.content_mask,i.top=0,i.left=0,i.width="100%",i.height="100%",s.append(n)),u=u.add(n),$Ms=$Ms.add(n);return u},destroy=function(e,t){$(window).unbind("."+sID),$(document).unbind("."+sID),"object"===_typeof(e)?evtPane(e):t=e,$N.clearQueue().removeData("layout").removeData("layoutContainer").removeClass(options.containerClass).unbind("."+sID),$Ms.remove(),$.each(_c.allPanes,(function(e,n){removePane(n,!1,!0,t)}));var n="layoutCSS";for(var r in $N.data(n)&&!$N.data("layoutRole")&&$N.css($N.data(n)).removeData(n),"BODY"===sC.tagName&&($N=$("html")).data(n)&&$N.css($N.data(n)).removeData(n),runPluginCallbacks(Instance,$.layout.onDestroy),unload(),Instance)r.match(/^(container|options)$/)||delete Instance[r];return Instance.destroyed=!0,Instance},removePane=function(e,t,n,r){if(isInitialized()){var i=evtPane.call(this,e),o=$Ps[i],s=$Cs[i],a=$Rs[i],l=$Ts[i];o&&$.isEmptyObject(o.data())&&(o=!1),s&&$.isEmptyObject(s.data())&&(s=!1),a&&$.isEmptyObject(a.data())&&(a=!1),l&&$.isEmptyObject(l.data())&&(l=!1),o&&o.stop(!0,!0);var c=options[i],u=(state[i],"layoutCSS"),h=children[i],d=$.isPlainObject(h)&&!$.isEmptyObject(h),f=void 0!==r?r:c.destroyChildren;if(d&&f&&($.each(h,(function(e,t){t.destroyed||t.destroy(!0),t.destroyed&&delete h[e]})),$.isEmptyObject(h)&&(h=children[i]=null,d=!1)),o&&t&&!d)o.remove();else if(o&&o[0]){var p=c.paneClass,g=p+"-"+i,m=[p,p+"-open",p+"-closed",p+"-sliding",g,g+"-open",g+"-closed",g+"-sliding"];$.merge(m,getHoverClasses(o,!0)),o.removeClass(m.join(" ")).removeData("parentLayout").removeData("layoutPane").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+sID),d&&s?(s.width(s.width()),$.each(h,(function(e,t){t.resizeAll()}))):s&&s.css(s.data(u)).removeData(u).removeData("layoutRole"),o.data("layout")||o.css(o.data(u)).removeData(u)}l&&l.remove(),a&&a.remove(),Instance[i]=$Ps[i]=$Cs[i]=$Rs[i]=$Ts[i]=!1,{removed:!0},n||resizeAll()}},_hidePane=function(e){var t=$Ps[e],n=options[e],r=t[0].style;n.useOffscreenClose?(t.data(_c.offscreenReset)||t.data(_c.offscreenReset,{left:r.left,right:r.right}),t.css(_c.offscreenCSS)):t.hide().removeData(_c.offscreenReset)},_showPane=function(e){var t=$Ps[e],n=options[e],r=_c.offscreenCSS,i=t.data(_c.offscreenReset),o=t[0].style;t.show().removeData(_c.offscreenReset),n.useOffscreenClose&&i&&(o.left==r.left&&(o.left=i.left),o.right==r.right&&(o.right=i.right))},hide=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=options[n],i=state[n],o=$Ps[n],s=$Rs[n];o&&!i.isHidden&&(state.initialized&&!1===_runCallbacks("onhide_start",n)||(i.isSliding=!1,delete state.panesSliding[n],s&&s.hide(),!state.initialized||i.isClosed?(i.isClosed=!0,i.isHidden=!0,i.isVisible=!1,state.initialized||_hidePane(n),sizeMidPanes("horz"===_c[n].dir?"":"center"),(state.initialized||r.triggerEventsOnLoad)&&_runCallbacks("onhide_end",n)):(i.isHiding=!0,close(n,!1,t))))}},show=function(e,t,n,r){if(isInitialized()){var i=evtPane.call(this,e),o=(options[i],state[i]),s=$Ps[i];$Rs[i];s&&o.isHidden&&!1!==_runCallbacks("onshow_start",i)&&(o.isShowing=!0,o.isSliding=!1,delete state.panesSliding[i],!1===t?close(i,!0):open(i,!1,n,r))}},toggle=function(e,t){if(isInitialized()){var n=evtObj(e),r=evtPane.call(this,e),i=state[r];n&&n.stopImmediatePropagation(),i.isHidden?show(r):i.isClosed?open(r,!!t):close(r)}},_closePane=function(e,t){$Ps[e];var n=state[e];_hidePane(e),n.isClosed=!0,n.isVisible=!1,t&&setAsClosed(e)},close=function(e,t,n,r){var i=evtPane.call(this,e);if(state.initialized||!$Ps[i]){if(isInitialized()){var o,s,a,l=$Ps[i],c=($Rs[i],$Ts[i],options[i]),u=state[i];_c[i];$N.queue((function(e){if(!l||!c.closable&&!u.isShowing&&!u.isHiding||!t&&u.isClosed&&!u.isShowing)return e();var r=!u.isShowing&&!1===_runCallbacks("onclose_start",i);if(s=u.isShowing,a=u.isHiding,u.isSliding,delete u.isShowing,delete u.isHiding,r)return e();o=!n&&!u.isClosed&&"none"!=c.fxName_close,u.isMoving=!0,u.isClosed=!0,u.isVisible=!1,a?u.isHidden=!0:s&&(u.isHidden=!1),u.isSliding?bindStopSlidingEvents(i,!1):sizeMidPanes("horz"===_c[i].dir?"":"center",!1),setAsClosed(i),o?(lockPaneForFX(i,!0),l.hide(c.fxName_close,c.fxSettings_close,c.fxSpeed_close,(function(){lockPaneForFX(i,!1),u.isClosed&&h(),e()}))):(_hidePane(i),h(),e())}))}}else _closePane(i,!0);function h(){u.isMoving=!1,bindStartSlidingEvents(i,!0);var e=_c.oppositeEdge[i];state[e].noRoom&&(setSizeLimits(e),makePaneFit(e)),r||!state.initialized&&!c.triggerEventsOnLoad||(s||_runCallbacks("onclose_end",i),s&&_runCallbacks("onshow_end",i),a&&_runCallbacks("onhide_end",i))}},setAsClosed=function(e){if($Rs[e]){$Ps[e];var t=$Rs[e],n=$Ts[e],r=options[e],i=(state[e],_c[e].side),o=r.resizerClass,s=r.togglerClass,a="-"+e;t.css(i,sC.inset[i]).removeClass(o+"-open "+o+a+"-open").removeClass(o+"-sliding "+o+a+"-sliding").addClass(o+"-closed "+o+a+"-closed"),r.resizable&&$.layout.plugins.draggable&&t.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title",""),n&&(n.removeClass(s+"-open "+s+a+"-open").addClass(s+"-closed "+s+a+"-closed").attr("title",r.tips.Open),n.children(".content-open").hide(),n.children(".content-closed").css("display","block")),syncPinBtns(e,!1),state.initialized&&sizeHandles()}},open=function(e,t,n,r){if(isInitialized()){var i,o,s=evtPane.call(this,e),a=$Ps[s],l=($Rs[s],$Ts[s],options[s]),c=state[s];_c[s];$N.queue((function(e){if(!a||!l.resizable&&!l.closable&&!c.isShowing||c.isVisible&&!c.isSliding)return e();if(c.isHidden&&!c.isShowing)return e(),void show(s,!0);c.autoResize&&c.size!=l.size?sizePane(s,l.size,!0,!0,!0):setSizeLimits(s,t);var h=_runCallbacks("onopen_start",s);return"abort"===h?e():("NC"!==h&&setSizeLimits(s,t),c.minSize>c.maxSize?(syncPinBtns(s,!1),!r&&l.tips.noRoomToOpen&&alert(l.tips.noRoomToOpen),e()):(t?bindStopSlidingEvents(s,!0):c.isSliding?bindStopSlidingEvents(s,!1):l.slidable&&bindStartSlidingEvents(s,!1),c.noRoom=!1,makePaneFit(s),o=c.isShowing,delete c.isShowing,i=!n&&c.isClosed&&"none"!=l.fxName_open,c.isMoving=!0,c.isVisible=!0,c.isClosed=!1,o&&(c.isHidden=!1),void(i?(lockPaneForFX(s,!0),a.show(l.fxName_open,l.fxSettings_open,l.fxSpeed_open,(function(){lockPaneForFX(s,!1),c.isVisible&&u(),e()}))):(_showPane(s),u(),e()))))}))}function u(){c.isMoving=!1,_fixIframe(s),c.isSliding||sizeMidPanes("vert"==_c[s].dir?"center":"",!1),setAsOpen(s)}},setAsOpen=function(e,t){var n=$Ps[e],r=$Rs[e],i=$Ts[e],o=options[e],s=state[e],a=_c[e].side,l=o.resizerClass,c=o.togglerClass,u="-"+e;r.css(a,sC.inset[a]+getPaneSize(e)).removeClass(l+"-closed "+l+u+"-closed").addClass(l+"-open "+l+u+"-open"),s.isSliding?r.addClass(l+"-sliding "+l+u+"-sliding"):r.removeClass(l+"-sliding "+l+u+"-sliding"),removeHover(0,r),o.resizable&&$.layout.plugins.draggable?r.draggable("enable").css("cursor",o.resizerCursor).attr("title",o.tips.Resize):s.isSliding||r.css("cursor","default"),i&&(i.removeClass(c+"-closed "+c+u+"-closed").addClass(c+"-open "+c+u+"-open").attr("title",o.tips.Close),removeHover(0,i),i.children(".content-closed").hide(),i.children(".content-open").css("display","block")),syncPinBtns(e,!s.isSliding),$.extend(s,elDims(n)),state.initialized&&(sizeHandles(),sizeContent(e,!0)),!t&&(state.initialized||o.triggerEventsOnLoad)&&n.is(":visible")&&(_runCallbacks("onopen_end",e),s.isShowing&&_runCallbacks("onshow_end",e),state.initialized&&_runCallbacks("onresize_end",e))},slideOpen=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=state[n],i=options[n].slideDelay_open;t&&t.stopImmediatePropagation(),r.isClosed&&t&&"mouseenter"===t.type&&i>0?timer.set(n+"_openSlider",o,i):o()}function o(){r.isClosed?r.isMoving||open(n,!0):bindStopSlidingEvents(n,!0)}},slideClose=function(e){if(isInitialized()){var t=evtObj(e),n=evtPane.call(this,e),r=options[n],i=state[n],o=i.isMoving?1e3:300;if(!i.isClosed&&!i.isResizing)if("click"===r.slideTrigger_close)s();else{if(r.preventQuickSlideClose&&i.isMoving)return;if(r.preventPrematureSlideClose&&t&&$.layout.isMouseOverElem(t,$Ps[n]))return;t?timer.set(n+"_closeSlider",s,max(r.slideDelay_close,o)):s()}}function s(){i.isClosed?bindStopSlidingEvents(n,!1):i.isMoving||close(n)}},slideToggle=function(e){var t=evtPane.call(this,e);toggle(t,!0)},lockPaneForFX=function(e,t){var n=$Ps[e],r=state[e],i=options[e],o=options.zIndexes;t?(showMasks(e,{animation:!0,objectsOnly:!0}),n.css({zIndex:o.pane_animate}),"south"==e?n.css({top:sC.inset.top+sC.innerHeight-n.outerHeight()}):"east"==e&&n.css({left:sC.inset.left+sC.innerWidth-n.outerWidth()})):(hideMasks(),n.css({zIndex:r.isSliding?o.pane_sliding:o.pane_normal}),"south"==e?n.css({top:"auto"}):"east"!=e||n.css("left").match(/\-99999/)||n.css({left:"auto"}),browser.msie&&i.fxOpacityFix&&"slide"!=i.fxName_open&&n.css("filter")&&1==n.css("opacity")&&n[0].style.removeAttribute("filter"))},bindStartSlidingEvents=function(e,t){var n=options[e],r=($Ps[e],$Rs[e]),i=n.slideTrigger_open.toLowerCase();!r||t&&!n.slidable||(i.match(/mouseover/)?i=n.slideTrigger_open="mouseenter":i.match(/(click|dblclick|mouseenter)/)||(i=n.slideTrigger_open="click"),n.resizerDblClickToggle&&i.match(/click/)&&r[t?"unbind":"bind"]("dblclick."+sID,toggle),r[t?"bind":"unbind"](i+"."+sID,slideOpen).css("cursor",t?n.sliderCursor:"default").attr("title",t?n.tips.Slide:""))},bindStopSlidingEvents=function(e,t){var n=options[e],r=state[e],i=(_c[e],options.zIndexes),o=n.slideTrigger_close.toLowerCase(),s=t?"bind":"unbind",a=$Ps[e],l=$Rs[e];function c(t){timer.clear(e+"_closeSlider"),t.stopPropagation()}timer.clear(e+"_closeSlider"),t?(r.isSliding=!0,state.panesSliding[e]=!0,bindStartSlidingEvents(e,!1)):(r.isSliding=!1,delete state.panesSliding[e]),a.css("zIndex",t?i.pane_sliding:i.pane_normal),l.css("zIndex",t?i.pane_sliding+2:i.resizer_normal),o.match(/(click|mouseleave)/)||(o=n.slideTrigger_close="mouseleave"),l[s](o,slideClose),"mouseleave"===o&&(a[s]("mouseleave."+sID,slideClose),l[s]("mouseenter."+sID,c),a[s]("mouseenter."+sID,c)),t?"click"!==o||n.resizable||(l.css("cursor",t?n.sliderCursor:"default"),l.attr("title",t?n.tips.Close:"")):timer.clear(e+"_closeSlider")},makePaneFit=function(e,t,n,r){var i=options[e],o=state[e],s=_c[e],a=$Ps[e],l=$Rs[e],c="vert"===s.dir,u=!1;if(("center"===e||c&&o.noVerticalRoom)&&((u=o.maxHeight>=0)&&o.noRoom?(_showPane(e),l&&l.show(),o.isVisible=!0,o.noRoom=!1,c&&(o.noVerticalRoom=!1),_fixIframe(e)):u||o.noRoom||(_hidePane(e),l&&l.hide(),o.isVisible=!1,o.noRoom=!0)),"center"===e);else if(o.minSize<=o.maxSize){if(u=!0,o.size>o.maxSize)sizePane(e,o.maxSize,n,!0,r);else if(o.size<o.minSize)sizePane(e,o.minSize,n,!0,r);else if(l&&o.isVisible&&a.is(":visible")){var h=o.size+sC.inset[s.side];$.layout.cssNum(l,s.side)!=h&&l.css(s.side,h)}o.noRoom&&(o.wasOpen&&i.closable?i.autoReopen?open(e,!1,!0,!0):o.noRoom=!1:show(e,o.wasOpen,!0,!0))}else o.noRoom||(o.noRoom=!0,o.wasOpen=!o.isClosed&&!o.isSliding,o.isClosed||(i.closable?close(e,!0,!0):hide(e,!0)))},manualSizePane=function(e,t,n,r,i){if(isInitialized()){var o=evtPane.call(this,e),s=options[o],a=state[o],l=i||s.livePaneResizing&&!a.isResizing;a.autoResize=!1,sizePane(o,t,n,r,l)}},sizePane=function(e,t,n,r,i){if(isInitialized()){var o,s,a=evtPane.call(this,e),l=options[a],c=state[a],u=$Ps[a],h=$Rs[a],d=_c[a].side,f=_c[a].sizeType.toLowerCase(),p=c.isResizing&&!l.triggerEventsDuringLiveResize,g=!0!==r&&l.animatePaneSizing;$N.queue((function(e){if(setSizeLimits(a),o=c.size,t=_parseSize(a,t),t=max(t,_parseSize(a,l.minSize)),(t=min(t,c.maxSize))<c.minSize)return e(),void makePaneFit(a,!1,n);if(!i&&t===o)return e();if(c.newSize=t,!n&&state.initialized&&c.isVisible&&_runCallbacks("onresize_start",a),s=cssSize(a,t),g&&u.is(":visible")){var r=$.layout.effects.size[a]||$.layout.effects.size.all,h=l.fxSettings_size.easing||r.easing,d=options.zIndexes,p={};p[f]=s+"px",c.isMoving=!0,u.css({zIndex:d.pane_animate}).show().animate(p,l.fxSpeed_size,h,(function(){u.css({zIndex:c.isSliding?d.pane_sliding:d.pane_normal}),c.isMoving=!1,delete c.newSize,m(),e()}))}else u.css(f,s),delete c.newSize,u.is(":visible")?m():(c.size=t,$.extend(c,elDims(u))),e()}))}function m(){for(var e="width"===f?u.outerWidth():u.outerHeight(),r=[{pane:a,count:1,target:t,actual:e,correct:t===e,attempt:t,cssSize:s}],l=r[0],g={},m="Inaccurate size after resizing the "+a+"-pane.";!(l.correct||(g={pane:a,count:l.count+1,target:t},l.actual>t?g.attempt=max(0,l.attempt-(l.actual-t)):g.attempt=max(0,l.attempt+(t-l.actual)),g.cssSize=cssSize(a,g.attempt),u.css(f,g.cssSize),g.actual="width"==f?u.outerWidth():u.outerHeight(),g.correct=t===g.actual,1===r.length&&(_log(m,!1,!0),_log(l,!1,!0)),_log(g,!1,!0),r.length>3));)r.push(g),l=r[r.length-1];c.size=t,$.extend(c,elDims(u)),c.isVisible&&u.is(":visible")&&(h&&h.css(d,t+sC.inset[d]),sizeContent(a)),!n&&!p&&state.initialized&&c.isVisible&&_runCallbacks("onresize_end",a),n||(c.isSliding||sizeMidPanes("horz"==_c[a].dir?"":"center",p,i),sizeHandles());var v=_c.oppositeEdge[a];t<o&&state[v].noRoom&&(setSizeLimits(v),makePaneFit(v,!1,n)),r.length>1&&_log(m+"\nSee the Error Console for details.",!0,!0)}},sizeMidPanes=function e(t,n,r){t=(t||"east,west,center").split(","),$.each(t,(function(t,i){if($Ps[i]){var o=options[i],s=state[i],a=$Ps[i],l=($Rs[i],!0),c={},u=$.layout.showInvisibly(a),h=calcNewCenterPaneDims();if($.extend(s,elDims(a)),"center"===i){if(!r&&s.isVisible&&h.width===s.outerWidth&&h.height===s.outerHeight)return a.css(u),!0;if($.extend(s,cssMinDims(i),{maxWidth:h.width,maxHeight:h.height}),c=h,s.newWidth=c.width,s.newHeight=c.height,c.width=cssW(a,c.width),c.height=cssH(a,c.height),l=c.width>=0&&c.height>=0,!state.initialized&&o.minWidth>h.width){var d=o.minWidth-s.outerWidth,f=options.east.minSize||0,p=options.west.minSize||0,g=state.east.size,m=state.west.size,v=g,y=m;if(d>0&&state.east.isVisible&&g>f&&(d-=g-(v=max(g-f,g-d))),d>0&&state.west.isVisible&&m>p&&(d-=m-(y=max(m-p,m-d))),0===d)return g&&g!=f&&sizePane("east",v,!0,!0,r),m&&m!=p&&sizePane("west",y,!0,!0,r),e("center",n,r),void a.css(u)}}else{if(s.isVisible&&!s.noVerticalRoom&&$.extend(s,elDims(a),cssMinDims(i)),!r&&!s.noVerticalRoom&&h.height===s.outerHeight)return a.css(u),!0;c.top=h.top,c.bottom=h.bottom,s.newSize=h.height,c.height=cssH(a,h.height),s.maxHeight=c.height,(l=s.maxHeight>=0)||(s.noVerticalRoom=!0)}if(l?(!n&&state.initialized&&_runCallbacks("onresize_start",i),a.css(c),"center"!==i&&sizeHandles(i),!s.noRoom||s.isClosed||s.isHidden||makePaneFit(i),s.isVisible&&($.extend(s,elDims(a)),state.initialized&&sizeContent(i))):!s.noRoom&&s.isVisible&&makePaneFit(i),a.css(u),delete s.newSize,delete s.newWidth,delete s.newHeight,!s.isVisible)return!0;if("center"===i){var b=browser.isIE6||!browser.boxModel;$Ps.north&&(b||"IFRAME"==state.north.tagName)&&$Ps.north.css("width",cssW($Ps.north,sC.innerWidth)),$Ps.south&&(b||"IFRAME"==state.south.tagName)&&$Ps.south.css("width",cssW($Ps.south,sC.innerWidth))}!n&&state.initialized&&_runCallbacks("onresize_end",i)}}))},resizeAll=function(e){var t=sC.innerWidth,n=sC.innerHeight;if(evtPane(e),$N.is(":visible"))if(state.initialized){if(!0===e&&$.isPlainObject(options.outset)&&$N.css(options.outset),$.extend(sC,elDims($N,options.inset)),sC.outerHeight){if(!0===e&&setPanePosition(),!1===_runCallbacks("onresizeall_start"))return!1;var r,i;sC.innerHeight,sC.innerWidth;$.each(["south","north","east","west"],(function(e,t){$Ps[t]&&(r=options[t],(i=state[t]).autoResize&&i.size!=r.size?sizePane(t,r.size,!0,!0,!0):(setSizeLimits(t),makePaneFit(t,!1,!0,!0)))})),sizeMidPanes("",!0,!0),sizeHandles(),$.each(_c.allPanes,(function(e,t){$Ps[t]&&state[t].isVisible&&_runCallbacks("onresize_end",t)})),_runCallbacks("onresizeall_end")}}else _initLayoutElements()},resizeChildren=function(e,t){var n=evtPane.call(this,e);if(options[n].resizeChildren){t||refreshChildren(n);var r=children[n];$.isPlainObject(r)&&$.each(r,(function(e,t){t.destroyed||t.resizeAll()}))}},sizeContent=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);n=n?n.split(","):_c.allPanes,$.each(n,(function(e,n){var r=$Ps[n],i=$Cs[n],o=options[n],s=state[n],a=s.content;if(!r||!i||!r.is(":visible"))return!0;if((i.length||(initContent(n,!1),i))&&!1!==_runCallbacks("onsizecontent_start",n)){(!s.isMoving&&!s.isResizing||o.liveContentResizing||t||null==a.top)&&(u(),a.hiddenFooters>0&&"hidden"===r.css("overflow")&&(r.css("overflow","visible"),u(),r.css("overflow","hidden")));var l=s.innerHeight-(a.spaceAbove-s.css.paddingTop)-(a.spaceBelow-s.css.paddingBottom);i.is(":visible")&&a.height==l||(setOuterHeight(i,l,!0),a.height=l),state.initialized&&_runCallbacks("onsizecontent_end",n)}function c(e){return max(s.css.paddingBottom,parseInt(e.css("marginBottom"),10)||0)}function u(){var e=options[n].contentIgnoreSelector,t=i.nextAll().not(".ui-layout-mask").not(e||":lt(0)"),r=t.filter(":visible"),o=r.filter(":last");(a={top:i[0].offsetTop,height:i.outerHeight(),numFooters:t.length,hiddenFooters:t.length-r.length,spaceBelow:0}).spaceAbove=a.top,a.bottom=a.top+a.height,o.length?a.spaceBelow=o[0].offsetTop+o.outerHeight()-a.bottom+c(o):a.spaceBelow=c(i)}}))}},sizeHandles=function(e){var t=evtPane.call(this,e);t=t?t.split(","):_c.borderPanes,$.each(t,(function(e,t){var n,r=options[t],i=state[t],o=$Ps[t],s=$Rs[t],a=$Ts[t];if(o&&s){var l,c,u,h=_c[t].dir,d=i.isClosed?"_closed":"_open",f=r["spacing"+d],p=r["togglerAlign"+d],g=r["togglerLength"+d];if(0!==f){if(i.noRoom||i.isHidden||s.show(),"horz"===h?(l=sC.innerWidth,i.resizerLength=l,c=$.layout.cssNum(o,"left"),s.css({width:cssW(s,l),height:cssH(s,f),left:c>-9999?c:sC.inset.left})):(l=o.outerHeight(),i.resizerLength=l,s.css({height:cssH(s,l),width:cssW(s,f),top:sC.inset.top+getPaneSize("north",!0)})),removeHover(r,s),a){if(0===g||i.isSliding&&r.hideTogglerOnSlide)return void a.hide();if(a.show(),!(g>0)||"100%"===g||g>l)g=l,u=0;else if(isStr(p))switch(p){case"top":case"left":u=0;break;case"bottom":case"right":u=l-g;break;case"middle":case"center":default:u=round((l-g)/2)}else{var m=parseInt(p,10);u=p>=0?m:l-g+m}if("horz"===h){var v=cssW(a,g);a.css({width:v,height:cssH(a,f),left:u,top:0}),a.children(".content").each((function(){(n=$(this)).css("marginLeft",round((v-n.outerWidth())/2))}))}else{var y=cssH(a,g);a.css({height:y,width:cssW(a,f),top:u,left:0}),a.children(".content").each((function(){(n=$(this)).css("marginTop",round((y-n.outerHeight())/2))}))}removeHover(0,a)}state.initialized||!r.initHidden&&!i.isHidden||(s.hide(),a&&a.hide())}else s.hide()}}))},enableClosable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Ts[t],r=options[t];n&&(r.closable=!0,n.bind("click."+sID,(function(e){e.stopPropagation(),toggle(t)})).css("visibility","visible").css("cursor","pointer").attr("title",state[t].isClosed?r.tips.Open:r.tips.Close).show())}},disableClosable=function(e,t){if(isInitialized()){var n=evtPane.call(this,e),r=$Ts[n];r&&(options[n].closable=!1,state[n].isClosed&&open(n,!1,!0),r.unbind("."+sID).css("visibility",t?"hidden":"visible").css("cursor","default").attr("title",""))}},enableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].slidable=!0,state[t].isClosed&&bindStartSlidingEvents(t,!0))}},disableSlidable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&(options[t].slidable=!1,state[t].isSliding?close(t,!1,!0):(bindStartSlidingEvents(t,!1),n.css("cursor","default").attr("title",""),removeHover(null,n[0])))}},enableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t],r=options[t];n&&n.data("draggable")&&(r.resizable=!0,n.draggable("enable"),state[t].isClosed||n.css("cursor",r.resizerCursor).attr("title",r.tips.Resize))}},disableResizable=function(e){if(isInitialized()){var t=evtPane.call(this,e),n=$Rs[t];n&&n.data("draggable")&&(options[t].resizable=!1,n.draggable("disable").css("cursor","default").attr("title",""),removeHover(null,n[0]))}},swapPanes=function(e,t){if(isInitialized()){var n=evtPane.call(this,e);if(state[n].edge=t,state[t].edge=n,!1===_runCallbacks("onswap_start",n)||!1===_runCallbacks("onswap_start",t))return state[n].edge=n,void(state[t].edge=t);var r=s(n),i=s(t),o={};return o[n]=r?r.state.size:0,o[t]=i?i.state.size:0,$Ps[n]=!1,$Ps[t]=!1,state[n]={},state[t]={},$Ts[n]&&$Ts[n].remove(),$Ts[t]&&$Ts[t].remove(),$Rs[n]&&$Rs[n].remove(),$Rs[t]&&$Rs[t].remove(),$Rs[n]=$Rs[t]=$Ts[n]=$Ts[t]=!1,a(r,t),a(i,n),r=i=o=null,$Ps[n]&&$Ps[n].css(_c.visible),$Ps[t]&&$Ps[t].css(_c.visible),resizeAll(),_runCallbacks("onswap_end",n),void _runCallbacks("onswap_end",t)}function s(e){var t=$Ps[e],n=$Cs[e];return!!t&&{pane:e,P:!!t&&t[0],C:!!n&&n[0],state:$.extend(!0,{},state[e]),options:$.extend(!0,{},options[e])}}function a(e,t){if(e){var n,r,i=e.P,s=e.C,a=e.pane,l=_c[t],c=$.extend(!0,{},state[t]),u=options[t],h={resizerCursor:u.resizerCursor};$.each("fxName,fxSpeed,fxSettings".split(","),(function(e,t){h[t+"_open"]=u[t+"_open"],h[t+"_close"]=u[t+"_close"],h[t+"_size"]=u[t+"_size"]})),$Ps[t]=$(i).data({layoutPane:Instance[t],layoutEdge:t}).css(_c.hidden).css(l.cssReq),$Cs[t]=!!s&&$(s),options[t]=$.extend(!0,{},e.options,h),state[t]=$.extend(!0,{},e.state),n=new RegExp(u.paneClass+"-"+a,"g"),i.className=i.className.replace(n,u.paneClass+"-"+t),initHandles(t),l.dir!=_c[a].dir?(r=o[t]||0,setSizeLimits(t),r=max(r,state[t].minSize),manualSizePane(t,r,!0,!0)):$Rs[t].css(l.side,sC.inset[l.side]+(state[t].isVisible?getPaneSize(t):0)),e.state.isVisible&&!c.isVisible?setAsOpen(t,!0):(setAsClosed(t),bindStartSlidingEvents(t,!0)),e=null}}},syncPinBtns=function(e,t){$.layout.plugins.buttons&&$.each(state[e].pins,(function(n,r){$.layout.buttons.setPinState(Instance,$(r),e,t)}))};function keyDown(e){if(!e)return!0;var t=e.keyCode;if(t<33)return!0;var n,r,i,o,s={38:"north",40:"south",37:"west",39:"east"},a=(e.altKey,e.shiftKey),l=e.ctrlKey;return l&&t>=37&&t<=40&&options[s[t]].enableCursorHotkey?o=s[t]:(l||a)&&$.each(_c.borderPanes,(function(e,s){if(n=options[s],r=n.customHotkey,i=n.customHotkeyModifier,(a&&"SHIFT"==i||l&&"CTRL"==i||l&&a)&&r&&t===(isNaN(r)||r<=9?r.toUpperCase().charCodeAt(0):r))return o=s,!1})),!(o&&$Ps[o]&&options[o].closable&&!state[o].isHidden)||(toggle(o),e.stopPropagation(),e.returnValue=!1,!1)}function allowOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n];if(r.cssSaved&&resetOverflow(n),r.isSliding||r.isResizing||r.isClosed)r.cssSaved=!1;else{var i={zIndex:options.zIndexes.resizer_normal+1},o={},s=t.css("overflow"),a=t.css("overflowX"),l=t.css("overflowY");"visible"!=s&&(o.overflow=s,i.overflow="visible"),a&&!a.match(/(visible|auto)/)&&(o.overflowX=a,i.overflowX="visible"),l&&!l.match(/(visible|auto)/)&&(o.overflowY=a,i.overflowY="visible"),r.cssSaved=o,t.css(i),$.each(_c.allPanes,(function(e,t){t!=n&&resetOverflow(t)}))}}}function resetOverflow(e){var t;if(isInitialized()&&(this&&this.tagName&&(e=this),isStr(e)?t=$Ps[e]:$(e).data("layoutRole")?t=$(e):$(e).parents().each((function(){if($(this).data("layoutRole"))return t=$(this),!1})),t&&t.length)){var n=t.data("layoutEdge"),r=state[n],i=r.cssSaved||{};r.isSliding||r.isResizing||t.css("zIndex",options.zIndexes.pane_normal),t.css(i),r.cssSaved=!1}}try{var $N=$(this).eq(0);if(!$N.length)return _log(options.errors.containerMissing);if($N.data("layoutContainer")&&$N.data("layout"))return $N.data("layout")}catch(e){console.log("eeeee",e)}var $Ps={},$Cs={},$Rs={},$Ts={},$Ms=$([]),sC=state.container,sID=state.id,Instance={options:options,state:state,container:$N,panes:$Ps,contents:$Cs,resizers:$Rs,togglers:$Ts,hide:hide,show:show,toggle:toggle,open:open,close:close,slideOpen:slideOpen,slideClose:slideClose,slideToggle:slideToggle,setSizeLimits:setSizeLimits,_sizePane:sizePane,sizePane:manualSizePane,sizeContent:sizeContent,swapPanes:swapPanes,showMasks:showMasks,hideMasks:hideMasks,initContent:initContent,addPane:addPane,removePane:removePane,createChildren:createChildren,refreshChildren:refreshChildren,enableClosable:enableClosable,disableClosable:disableClosable,enableSlidable:enableSlidable,disableSlidable:disableSlidable,enableResizable:enableResizable,disableResizable:disableResizable,allowOverflow:allowOverflow,resetOverflow:resetOverflow,destroy:destroy,initPanes:isInitialized,resizeAll:resizeAll,runCallbacks:_runCallbacks,hasParentLayout:!1,children:children,north:!1,south:!1,west:!1,east:!1,center:!1};return"cancel"===_create()?null:Instance}}(jQuery),function(e){e.ui||(e.ui={}),e.ui.cookie={acceptsCookies:!!navigator.cookieEnabled,read:function(t){for(var n,r=document.cookie,i=r?r.split(";"):[],o=0,s=i.length;o<s;o++)if((n=e.trim(i[o]).split("="))[0]==t)return decodeURIComponent(n[1]);return null},write:function(t,n,r){var i="",o="",s=!1,a=r||{},l=a.expires||null,c=e.type(l);"date"===c?o=l:"string"===c&&l>0&&(l=parseInt(l,10),c="number"),"number"===c&&(o=new Date,l>0?o.setDate(o.getDate()+l):(o.setFullYear(1970),s=!0)),o&&(i+=";expires="+o.toUTCString()),a.path&&(i+=";path="+a.path),a.domain&&(i+=";domain="+a.domain),a.secure&&(i+=";secure"),document.cookie=t+"="+(s?"":encodeURIComponent(n))+i},clear:function(t){e.ui.cookie.write(t,"",{expires:-1})}},e.cookie||(e.cookie=function(t,n,r){var i=e.ui.cookie;if(null===n)i.clear(t);else{if(void 0===n)return i.read(t);i.write(t,n,r)}}),e.layout.plugins.stateManagement=!0,e.layout.config.optionRootKeys.push("stateManagement"),e.layout.defaults.stateManagement={enabled:!1,autoSave:!0,autoLoad:!0,animateLoad:!0,includeChildren:!0,stateKeys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden",cookie:{name:"",domain:"",path:"",expires:"",secure:!1}},e.layout.optionsMap.layout.push("stateManagement"),e.layout.state={saveCookie:function(t,n,r){var i=t.options,o=i.stateManagement,s=e.extend(!0,{},o.cookie,r||null),a=t.state.stateData=t.readState(n||o.stateKeys);return e.ui.cookie.write(s.name||i.name||"Layout",e.layout.state.encodeJSON(a),s),e.extend(!0,{},a)},deleteCookie:function(t){var n=t.options;e.ui.cookie.clear(n.stateManagement.cookie.name||n.name||"Layout")},readCookie:function(t){var n=t.options,r=e.ui.cookie.read(n.stateManagement.cookie.name||n.name||"Layout");return r?e.layout.state.decodeJSON(r):{}},loadCookie:function(t){var n=e.layout.state.readCookie(t);return n&&(t.state.stateData=e.extend(!0,{},n),t.loadState(n)),n},loadState:function(t,n,r){if(e.isPlainObject(n)&&!e.isEmptyObject(n)){n=t.state.stateData=e.layout.transformData(n);var i=t.options.stateManagement;if(r=e.extend({animateLoad:!1,includeChildren:i.includeChildren},r),t.state.initialized){var o,a,l,c,u,h,d=!r.animateLoad;if(e.each(e.layout.config.borderPanes,(function(r,i){f=n[i],e.isPlainObject(f)&&(s=f.size,o=f.initClosed,a=f.initHidden,ar=f.autoResize,l=t.state[i],c=l.isVisible,ar&&(l.autoResize=ar),c||t._sizePane(i,s,!1,!1,!1),!0===a?t.hide(i,d):!0===o?t.close(i,!1,d):!1===o?t.open(i,!1,d):!1===a&&t.show(i,!1,d),c&&t._sizePane(i,s,!1,!1,d))})),r.includeChildren)e.each(t.children,(function(t,r){(u=n[t]?n[t].children:0)&&r&&e.each(r,(function(e,t){h=u[e],t&&h&&t.loadState(h)}))}))}else{var f=e.extend(!0,{},n);e.each(e.layout.config.allPanes,(function(e,t){f[t]&&delete f[t].children})),e.extend(!0,t.options,f)}}},readState:function(t,n){"string"===e.type(n)&&(n={keys:n}),n||(n={});var r,i,o,s,a,l,c,u=t.options.stateManagement,h=n.includeChildren,d=void 0!==h?h:u.includeChildren,f=n.stateKeys||u.stateKeys,p={isClosed:"initClosed",isHidden:"initHidden"},g=t.state,m=e.layout.config.allPanes,v={};e.isArray(f)&&(f=f.join(","));for(var y=0,b=(f=f.replace(/__/g,".").split(",")).length;y<b;y++)i=(r=f[y].split("."))[0],o=r[1],e.inArray(i,m)<0||null!=(s=g[i][o])&&("isClosed"==o&&g[i].isSliding&&(s=!0),(v[i]||(v[i]={}))[p[o]?p[o]:o]=s);return d&&e.each(m,(function(n,r){l=t.children[r],a=g.stateData[r],e.isPlainObject(l)&&!e.isEmptyObject(l)&&((c=v[r]||(v[r]={})).children||(c.children={}),e.each(l,(function(t,n){n.state.initialized?c.children[t]=e.layout.state.readState(n):a&&a.children&&a.children[t]&&(c.children[t]=e.extend(!0,{},a.children[t]))})))})),v},encodeJSON:function(t){return function t(n){var r,i,o,s=[],a=0,l=e.isArray(n);for(r in n)i=n[r],"string"==(o=_typeof(i))?i='"'+i+'"':"object"==o&&(i=t(i)),s[a++]=(l?"":'"'+r+'":')+i;return(l?"[":"{")+s.join(",")+(l?"]":"}")}(t)},decodeJSON:function(t){try{return e.parseJSON?e.parseJSON(t):window.eval("("+t+")")||{}}catch(e){return{}}},_create:function(t){var n=e.layout.state,r=t.options.stateManagement;if(e.extend(t,{readCookie:function(){return n.readCookie(t)},deleteCookie:function(){n.deleteCookie(t)},saveCookie:function(e,r){return n.saveCookie(t,e,r)},loadCookie:function(){return n.loadCookie(t)},loadState:function(e,r){n.loadState(t,e,r)},readState:function(e){return n.readState(t,e)},encodeJSON:n.encodeJSON,decodeJSON:n.decodeJSON}),t.state.stateData={},r.autoLoad)if(e.isPlainObject(r.autoLoad))e.isEmptyObject(r.autoLoad)||t.loadState(r.autoLoad);else if(r.enabled)if(e.isFunction(r.autoLoad)){var i={};try{i=r.autoLoad(t,t.state,t.options,t.options.name||"")}catch(e){}i&&e.isPlainObject(i)&&!e.isEmptyObject(i)&&t.loadState(i)}else t.loadCookie()},_unload:function(t){var n=t.options.stateManagement;if(n.enabled&&n.autoSave)if(e.isFunction(n.autoSave))try{n.autoSave(t,t.state,t.options,t.options.name||"")}catch(e){}else t.saveCookie()}},e.layout.onCreate.push(e.layout.state._create),e.layout.onUnload.push(e.layout.state._unload),e.layout.plugins.buttons=!0,e.layout.defaults.autoBindCustomButtons=!1,e.layout.optionsMap.layout.push("autoBindCustomButtons"),e.layout.buttons={init:function(t){var n,r=t.options.name||"";e.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),(function(i,o){e.each(e.layout.config.borderPanes,(function(i,s){e(".ui-layout-button-"+o+"-"+s).each((function(){null!=(n=e(this).data("layoutName")||e(this).attr("layoutName"))&&n!==r||t.bindButton(this,o,s)}))}))}))},get:function(t,n,r,i){var o=e(n),s=t.options,a=s.errors.addButtonError;if(o.length)if(e.inArray(r,e.layout.config.borderPanes)<0)e.layout.msg(a+" "+s.errors.pane+": "+r,!0),o=e("");else{var l=s[r].buttonClass+"-"+i;o.addClass(l+" "+l+"-"+r).data("layoutName",s.name)}else e.layout.msg(a+" "+s.errors.selector+": "+n,!0);return o},bind:function(t,n,r,i){var o=e.layout.buttons;switch(r.toLowerCase()){case"toggle":o.addToggle(t,n,i);break;case"open":o.addOpen(t,n,i);break;case"close":o.addClose(t,n,i);break;case"pin":o.addPin(t,n,i);break;case"toggle-slide":o.addToggle(t,n,i,!0);break;case"open-slide":o.addOpen(t,n,i,!0)}return t},addToggle:function(t,n,r,i){return e.layout.buttons.get(t,n,r,"toggle").click((function(e){t.toggle(r,!!i),e.stopPropagation()})),t},addOpen:function(t,n,r,i){return e.layout.buttons.get(t,n,r,"open").attr("title",t.options[r].tips.Open).click((function(e){t.open(r,!!i),e.stopPropagation()})),t},addClose:function(t,n,r){return e.layout.buttons.get(t,n,r,"close").attr("title",t.options[r].tips.Close).click((function(e){t.close(r),e.stopPropagation()})),t},addPin:function(t,n,r){var i=e.layout.buttons,o=i.get(t,n,r,"pin");if(o.length){var s=t.state[r];o.click((function(n){i.setPinState(t,e(this),r,s.isSliding||s.isClosed),s.isSliding||s.isClosed?t.open(r):t.close(r),n.stopPropagation()})),i.setPinState(t,o,r,!s.isClosed&&!s.isSliding),s.pins.push(n)}return t},setPinState:function(e,t,n,r){var i=t.attr("pin");if(!i||r!==("down"==i)){var o=e.options[n],s=o.buttonClass+"-pin",a=s+"-"+n,l=s+"-up "+a+"-up",c=s+"-down "+a+"-down";t.attr("pin",r?"down":"up").attr("title",r?o.tips.Unpin:o.tips.Pin).removeClass(r?l:c).addClass(r?c:l)}},syncPinBtns:function(t,n,r){e.each(t.state[n].pins,(function(i,o){e.layout.buttons.setPinState(t,e(o),n,r)}))},_load:function(t){var n=e.layout.buttons;e.extend(t,{bindButton:function(e,r,i){return n.bind(t,e,r,i)},addToggleBtn:function(e,r,i){return n.addToggle(t,e,r,i)},addOpenBtn:function(e,r,i){return n.addOpen(t,e,r,i)},addCloseBtn:function(e,r){return n.addClose(t,e,r)},addPinBtn:function(e,r){return n.addPin(t,e,r)}});for(var r=0;r<4;r++){var i=e.layout.config.borderPanes[r];t.state[i].pins=[]}t.options.autoBindCustomButtons&&n.init(t)},_unload:function(e){}},e.layout.onLoad.push(e.layout.buttons._load),e.layout.plugins.browserZoom=!0,e.layout.defaults.browserZoomCheckInterval=1e3,e.layout.optionsMap.layout.push("browserZoomCheckInterval"),e.layout.browserZoom={_init:function(t){!1!==e.layout.browserZoom.ratio()&&e.layout.browserZoom._setTimer(t)},_setTimer:function(t){if(!t.destroyed){var n=t.options,r=t.state,i=t.hasParentLayout?5e3:Math.max(n.browserZoomCheckInterval,100);setTimeout((function(){if(!t.destroyed&&n.resizeWithWindow){var i=e.layout.browserZoom.ratio();i!==r.browserZoom&&(r.browserZoom=i,t.resizeAll()),e.layout.browserZoom._setTimer(t)}}),i)}},ratio:function(){var t,n,r,i=window,o=screen,s=document,a=s.documentElement||s.body,l=e.layout.browser,c=l.version;return!(l.msie&&c>8||!l.msie)&&(o.deviceXDPI&&o.systemXDPI?u(o.deviceXDPI,o.systemXDPI):l.webkit&&(t=s.body.getBoundingClientRect)?u(t.left-t.right,s.body.offsetWidth):l.webkit&&(n=i.outerWidth)?u(n,i.innerWidth):!(!(n=o.width)||!(r=a.clientWidth))&&u(n,r));function u(e,t){return(parseInt(e,10)/parseInt(t,10)*100).toFixed()}}},e.layout.onReady.push(e.layout.browserZoom._init)}(jQuery)},function(e,t){!function(e){if(e.support.touch="ontouchend"in document,e.support.touch){var t,n=e.ui.mouse.prototype,r=n._mouseInit,i=n._mouseDestroy;n._touchStart=function(e){!t&&this._mouseCapture(e.originalEvent.changedTouches[0])&&(t=!0,this._touchMoved=!1,o(e,"mouseover"),o(e,"mousemove"),o(e,"mousedown"))},n._touchMove=function(e){t&&(this._touchMoved=!0,o(e,"mousemove"))},n._touchEnd=function(e){t&&(o(e,"mouseup"),o(e,"mouseout"),this._touchMoved||o(e,"click"),t=!1)},n._mouseInit=function(){this.element.bind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),r.call(this)},n._mouseDestroy=function(){this.element.unbind({touchstart:e.proxy(this,"_touchStart"),touchmove:e.proxy(this,"_touchMove"),touchend:e.proxy(this,"_touchEnd")}),i.call(this)}}function o(e,t){if(!(e.originalEvent.touches.length>1)){e.preventDefault();var n=e.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}}}(jQuery)},function(e,t,n){var r,i;r=[n(0),n(287)],void 0===(i=function(e,t){return e.directive("validFile",(function(){return{require:"ngModel",link:function(e,n,r,i){return i.$validators.validFile=function(e){return t.isCleanFilename(e)}}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i,o,s=function(){var e,t=new RegExp("[\\/\\\\\\*\\u0000-\\u001F\\u007F\\u0080-\\u009F\\uD800-\\uDFFF]","g"),n=new RegExp("(^\\.$)|(^\\.\\.$)|(^\\s+)|(\\s+$)","g"),r=new RegExp("^(prototype|constructor|toString|toLocaleString|valueOf|hasOwnProperty|isPrototypeOf|propertyIsEnumerable|__defineGetter__|__lookupGetter__|__defineSetter__|__lookupSetter__|__proto__)$");return e={clean:function(e){return e=(e=(e=e.replace(t,"_")).replace(n,(function(e){return new Array(e.length+1).join("_")}))).replace(r,"@$1")},isCleanFilename:function(r){return e.isAllowedLength(r)&&!t.test(r)&&!n.test(r)},isAllowedLength:function(e){return e.length>0&&e.length<=1024}}};null!==n(23)?(i=[],void 0===(o="function"==typeof(r=s)?r.apply(t,i):r)||(e.exports=o)):e.exports=s()},function(e,t,n){var r,i;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){return e.factory("ide",["$http","queuedHttp","$modal","$q","$filter","$timeout",function(e,t,n,r,i,a){var l=this,c={};return c.$http=e,c.queuedHttp=t,c.$q=r,c.$filter=i,c.$timeout=a,this.recentEvents=[],c.pushEvent=function(e,t){if(null==t&&(t={}),sl_console.log("event",e,t),l.recentEvents.push({type:e,meta:t,date:new Date}),l.recentEvents.length>100)return l.recentEvents.shift()},c.reportError=function(t,n){null==n&&(n={}),n.client_id=s(null!=l.socket?l.socket.socket:void 0,(function(e){return e.sessionid})),n.transport=s(s(null!=l.socket?l.socket.socket:void 0,(function(e){return e.transport})),(function(e){return e.name})),n.client_now=new Date,n.recent_events=l.recentEvents;var r={};if("object"===o(t))for(var i=0,a=Array.from(Object.getOwnPropertyNames(t));i<a.length;i++){var c=a[i];r[c]=t[c]}else"string"==typeof t&&(r.message=t);return e.post("/error/client",{error:r,meta:n,_csrf:window.csrfToken})},c.showGenericMessageModal=function(e,t){return n.open({templateUrl:"genericMessageModalTemplate",controller:"GenericMessageModalController",resolve:{title:function(){return e},message:function(){return t}}})},c.showLockEditorMessageModal=function(e,t){return n.open({templateUrl:"lockEditorModalTemplate",controller:"GenericMessageModalController",backdrop:"static",keyboard:!1,resolve:{title:function(){return e},message:function(){return t}},windowClass:"lock-editor-modal"})},c}]),e.controller("GenericMessageModalController",["$scope","$modalInstance","title","message",function(e,t,n,r){return e.title=n,e.message=r,e.done=function(){return t.close()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("updateScrollBottomOn",["$timeout",function(e){return{restrict:"A",link:function(t,n,r,i){var o=0;return n.on("scroll",(function(e){return o=n[0].scrollHeight-n[0].scrollTop-n[0].clientHeight})),t.$on(r.updateScrollBottomOn,(function(){return e((function(){return n.scrollTop(n[0].scrollHeight-n[0].clientHeight-o)}),0)}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("rightClick",(function(){return{restrict:"A",link:function(e,t,n){return t.bind("contextmenu",(function(t){return t.preventDefault(),t.stopPropagation(),e.$eval(n.rightClick)}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("expandableTextArea",(function(){return{restrict:"A",link:function(e,t){return e.$watch((function(){return t.val()}),(function(){var n=t.outerHeight(),r=t.prop("scrollHeight");""===t.val()?t.css("height","unset"):r>n&&(e.$emit("expandable-text-area:resize"),t.css("height",r))}))}}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("videoPlayState",["$parse",function(e){return{restrict:"A",link:function(t,n,r){var i=n[0];return t.$watch((function(){return e(r.videoPlayState)(t)}),(function(e){return e?(i.currentTime=0,i.play()):i.pause()}))}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.factory("waitFor",["$q",function(e){return function(t,n,r){null==r&&(r=500);var i=Math.floor(n/r),o=0;return e((function(e,s){var a;return(a=function(){if(o>i)return s(new Error("waiting too long, ".concat(JSON.stringify({timeout:n,pollInterval:r}))));o+=1;var l=t();return null!=l?e(l):setTimeout(a,r)})()}))}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(295),n(297),n(300),n(305),n(306),n(308),n(311),n(321),n(322),n(324)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(296)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(42)],void 0===(i=function(e,t){var n={gotLinkStatus:!1,startedLinkProcess:!1,userIsLinkedToDropbox:!1,hasDropboxFeature:!1};return e.controller("DropboxController",["$scope","$modal","ide","eventTracking",function(e,t,n,r){e.openDropboxModal=function(){t.open({templateUrl:"dropboxModalTemplate",controller:"DropboxModalController",scope:e}),e.user.features.dropbox||r.send("subscription-funnel","editor-click-feature","dropbox")}}]),e.controller("DropboxModalController",["$scope","$modalInstance","ide","$timeout","$http",function(e,t,r,i,o){var s=r.$scope.user.id;e.dbState=n,e.dbState.hasDropboxFeature=e.user.features.dropbox,o.get("/dropbox/status").then((function(t){var r=t.data;if(e.dbState.gotLinkStatus=!0,r.registered)return e.dbState.userIsLinkedToDropbox=!0,n=e.dbState})),e.linkToDropbox=function(){return window.open("/user/settings#dropboxSettings"),e.startedLinkProcess=!0},e.cancel=function(){return t.dismiss()},e.isProjectMember=function(){var e=r.$scope.project.members.map((function(e){return e._id}));return r.$scope.project.owner._id===s||e.includes(s)}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(298),n(299)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("GitBridgeController",["$scope","$modal","eventTracking","ide",function(e,t,n,r){e.openGitBridgeModal=function(){t.open({templateUrl:"gitBridgeModalTemplate",controller:"GitBridgeModalController",size:"lg",scope:e}),e.project.features.gitBridge||e.user.features.gitBridge||n.send("subscription-funnel","editor-click-feature","gitBridge")},r.gitBridgeManager={openGitBridgeModal:function(){return e.openGitBridgeModal()}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("GitBridgeModalController",["$scope","$modalInstance","$window","ide",function(e,t,n,r){e.gitUrl="".concat(n.gitBridgePublicBaseUrl,"/").concat(r.$scope.project_id),e.hasGitBridgeFeature=e.project.features.gitBridge||e.user.features.gitBridge,e.userIsProjectOwner=e.user.id===e.project.owner._id,e.cancel=function(){return t.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(301),n(302),n(303),n(304)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("GithubSyncController",["$scope","$modal","ide",function(e,t,n){e.openGithubSyncModal=function(){return t.open({templateUrl:"githubSyncModalTemplate",controller:"GithubSyncModalController",scope:e})},n.githubSyncManager={openGithubSyncModal:function(){return e.openGithubSyncModal()}},e.isProjectMember=function(){return n.$scope.permissions.write}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){return e.controller("GithubSyncModalController",["$scope","$modalInstance","$http","$modal","$window","$interval","ide",function(e,t,n,r,i,s,a){return e.cancel=function(){return t.dismiss()},e.openExportToGithubModal=function(){return t.dismiss(),r.open({templateUrl:"githubSyncExportModalTemplate",controller:"GithubSyncExportModalController"})},e.openMergeModal=function(e){var n;return null==e&&(e=!1),t.dismiss(),n=e?"githubSyncPullFromGithubModalTemplate":"githubSyncPushToGithubModalTemplate",r.open({templateUrl:n,controller:"GithubSyncMergeModalController",resolve:{mergeImmediately:function(){return e}}})},e.linkAccount=function(){var t=i.open("/github-sync/beginAuth","github-sync-auth","width=700,height=500"),n=s((function(){try{o(null!=t?t.location:void 0,(function(e){return e.pathname}))}catch(e){null}if("/github-sync/linked"===o(null!=t?t.location:void 0,(function(e){return e.pathname})))return t.close(),e.loadStatus(),s.cancel(n)}),1e3);return!0},(e.loadStatus=function(){return e.status={loading:!0,error:!1,user:{enabled:null},project:{enabled:null},commits:{loading:!0,commits:[]}},n.get("/user/github-sync/status",{disableAutoLoginRedirect:!0}).then((function(t){var r=t.data,i=r;return e.status.user=i,n.get("/project/".concat(a.project_id,"/github-sync/status"),{disableAutoLoginRedirect:!0}).then((function(t){var i=t.data;if(e.status.project=i,e.status.loading=!1,e.status.project.enabled)return n.get("/project/".concat(a.project_id,"/github-sync/commits/unmerged"),{disableAutoLoginRedirect:!0}).then((function(t){var n=t.data;e.status.commits.commits=n,e.status.commits.loading=!1})).catch((function(t){var n;r=t.data,n=t.status,e.status.error=null==n||{statusCode:n}}))})).catch((function(t){var n;r=t.data,n=t.status,e.status.error=null==n||{status:n}}))})).catch((function(t){t.data;var n=t.status;e.status.error=null==n||{status:n}}))})()}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("GithubSyncExportModalController",["$scope","$modalInstance","$http","ide",function(e,t,n,r){e.cancel=function(){return t.dismiss()},e.status={loading:!0,error:!1},e.form={org:null,name:r.$scope.project.name,private:"false",description:""},n.get("/user/github-sync/orgs",{disableAutoLoginRedirect:!0}).then((function(t){var n=t.data;e.status.user=n.user,e.status.orgs=n.orgs,e.status.loading=!1,e.form.org=e.status.user.login})).catch((function(t){var n=t.data,r=t.status;e.status.error={message:null!=n?n.error:void 0,statusCode:r}})),e.create=function(){e.status.inflight=!0;var i={_csrf:window.csrfToken,name:e.form.name,description:e.form.description,private:"true"===e.form.private};return null!=e.form.org&&e.form.org!==e.status.user.login&&(i.org=e.form.org),n.post("/project/".concat(r.project_id,"/github-sync/export"),i).then((function(){return e.status.inflight=!1,t.dismiss(),r.githubSyncManager.openGithubSyncModal()})).catch((function(t){var n=t.data;e.form.error=n.error,e.status.inflight=!1}))}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("GithubSyncMergeModalController",["$scope","$modalInstance","$http","ide","mergeImmediately",function(e,t,n,r,i){e.cancel=function(){return t.dismiss()},e.status={},e.form={message:""},e.merge=function(){r.editorManager.startIgnoringExternalUpdates(),e.status.inflight=!0;var i={_csrf:window.csrfToken,message:e.form.message};return n.post("/project/".concat(r.project_id,"/github-sync/merge"),i).then((function(){e.status.inflight=!1,t.dismiss(),r.githubSyncManager.openGithubSyncModal(),r.editorManager.stopIgnoringExternalUpdates()})).catch((function(t){var n=t.data;e.form.error=n.error,e.status.inflight=!1,r.editorManager.stopIgnoringExternalUpdates()}))},i&&e.merge()}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;void 0===(r=function(){}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;r=[n(307)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){"use strict";n.r(t);var r=n(0);n.n(r).a.controller("PublishController",["$scope","$modal","CobrandingDataService",function(e,t,r){e.openPublishProjectModal=function(){t.open({templateUrl:"publishProjectModalTemplate",scope:e,size:"lg"}),Promise.all([n.e(1),n.e(11),n.e(7)]).then(n.bind(null,349)).then((function(t){var n;e.pdf.url&&(n=e.pdf.downloadUrl);var i={projectId:e.project_id,pdfUrl:n,logs:e.pdf.logEntries,uncompiled:e.pdf.uncompiled,hasFolders:window._ide.fileTreeManager.projectContainsFolder(),rootDocOverridden:function(){var t=e.project.rootDoc_id;if(window._ide.editorManager.getCurrentDocId()===t)return!1;var n=window._ide.editorManager.getCurrentDocValue();if(null==n)return!1;var r=!0,i=!1,o=void 0;try{for(var s,a=n.split("\n")[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var l=s.value;if(/^[^%]*\\documentclass/.test(l))return!0}}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return!1}(),firstName:e.user.first_name,lastName:e.user.last_name,title:e.project.name},o={isBranded:r.isProjectCobranded()&&(null!=r.getPublishGuideHtml()&&""!==r.getPublishGuideHtml()||null!=r.getPartner()),brandedMenu:r.hasBrandedMenu(),brandId:r.getBrandId(),brandVariationId:r.getBrandVariationId(),partner:r.getPartner()},s=document.getElementsByClassName("modal-body-publish")[0];t.init(s,i,o)}))}}])},function(e,t,n){var r,i;r=[n(309),n(310)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0),n(4)],void 0===(i=function(e){var t=ace.require("ace/range").Range;return e.controller("ReferencesSearchController",["$scope","$modal","ide","$timeout","eventTracking","$rootScope",function(e,n,r,i,s,a){if(e.searchFeatureEnabled=function(){return!0},e.searchFeatureEnabled()){e.searchEnabled=!1,e.isCursorAtCitation=function(e){var n=e.getCursorPosition(),r=new t(n.row,0,n.row,n.column),i=function(e){var t;return(t=e.match(/(\\[^\\]+)$/))?t[1]:null}(e.getSession().getTextRange(r));if(i&&i.match(/^~?\\([a-z]*cite[a-z]*(?:\[.*])?){([^}]*, *)?(\w*)/))return!0;return!1},e._hintNode=null,e._buildHintNode=function(){s.sendMBOnce("bib-search-hint-shown-once");var e=$(".sl_references_search_hint")[0];if(e)return e.style.display="block",e.style.visibility="visible",e;console.log("Error: could not find .sl_references_search_hint node in dom")},e.updateHintNode=function(t){if(!0===o(o(null!=t?t.completer:void 0,(function(e){return e.popup})),(function(e){return e.isOpen}))&&!e._hintNode&&e.isCursorAtCitation(t)){var n=e._buildHintNode(),r=o(o(o(null!=t?t.completer:void 0,(function(e){return e.popup})),(function(e){return e.renderer})),(function(e){return e.container}));if(!r)return void console.log("Error attaching search hint: could not find popup container");r.style.overflow="visible",$(r).append(n),e._hintNode=n;var s=t.completer.popup;if(!s.hide._sl_patched){var a=s.hide.bind(s);s.hide=function(){return i((function(){if(!e.isCursorAtCitation(t))return e._hideHint()}),0),a()},s.hide._sl_patched=!0}}if(e._hintNode)return e.isCursorAtCitation(t)?e._showHint():e._hideHint()},e._showHint=function(){if(e._hintNode)return e._hintNode.style.visibility="visible"},e._hideHint=function(){if(e._hintNode)return e._hintNode.style.visibility="hidden"},e._inited=!1,e.setup=function(){if(!1!==e.settings.autoComplete&&!e._inited)if(null!=l){var t=o(o(null!=l?l.commands:void 0,(function(e){return e.commands})),(function(e){return e.startAutocomplete}));if(t){if(!t._sl_patched){var n=t.exec;t.exec=function(t,r,o,s,a){return i((function(){return e.updateHintNode(t)}),0),n(t)},t._sl_patched=!0;var a=function(n){i((function(){return e.updateHintNode(n)}),0);var a=e.isCursorAtCitation(n);return!0===o(o(null!=n?n.completer:void 0,(function(e){return e.popup})),(function(e){return e.isOpen}))&&!0===a?(s.sendMB("bib-search-modal-opened"),e.searchEnabled=!0===o(o(o(null!=r?r.$scope:void 0,(function(e){return e.project})),(function(e){return e.features})),(function(e){return e.referencesSearch})),e.openReferencesSearchModal()):t.exec(n)};return e.handleOpenSearch=function(){return a(l)},r.browserIsSafari?document.querySelector("#editor").onkeyup=function(e){if(e.ctrlKey&&32===e.keyCode)return a(l)}:l.commands.addCommand({name:"triggerReferencesSearchPopup",exec:a,bindKey:t.bindKey}),e._inited=!0}}else console.log("could not find startAutocomplete command")}else console.log("no editor found")};var l=null;return a.$on("editor:inited",(function(t,n){return l=n,setTimeout(e.setup)})),e.insertKeyAtCursor=function(e){if(null!=l){var n=l.getCursorPosition(),r=l.getSession(),i=l.getSession().getTextRange(new t(n.row,0,n.row,n.column)),o=!l.getSession().getTextRange(new t(n.row,n.column,n.row,99999)).match(/^[^{]*}/),s=Math.max(i.lastIndexOf("{"),i.lastIndexOf(","),i.lastIndexOf(" "));return s<n.column-1?(r.remove(new t(n.row,s+1,n.row,n.column)),n=l.getCursorPosition(),r.insert(n,e)):r.insert(n,e),o?r.insert(l.getCursorPosition(),"}"):void 0}console.log("no editor found")},e.openReferencesSearchModal=function(){var t=n.open({templateUrl:"referencesSearchModalTemplate",controller:"ReferencesSearchModalController",scope:e,size:"lg",animation:!1,backdrop:!0,backdropClass:"references-search-modal-backdrop",keyboard:!0});return e.searchEnabled||s.send("subscription-funnel","editor-click-feature","references-search"),t.result.then((function(t){return e.insertKeyAtCursor(t)}))},r.referencesSearchManager={openReferencesModal:function(t){return e.openReferencesSearchModal(t)}}}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("ReferencesSearchModalController",["$scope","$modalInstance","$window","$timeout","ide","eventTracking",function(e,t,n,r,i,o){if(e.searchFeatureEnabled())return e.state={queryText:"",searchResults:null,selectedIndex:null,currentlySearching:!1,error:!1},e.handleInputKeyDown=function(t){return 40===t.keyCode?(t.preventDefault(),void e.moveSelectionForward()):38===t.keyCode?(t.preventDefault(),void e.moveSelectionBackward()):9===t.keyCode?(t.preventDefault(),void(t.shiftKey?e.moveSelectionBackward():e.moveSelectionForward())):13===t.keyCode?(t.preventDefault(),void e.acceptSelectedSearchResult()):[37,39].includes(t.keyCode)?void(e.state.selectedIndex=null):[8].includes(t.keyCode)?(e.state.selectedIndex=null,void r(e.doAutoSearch,0)):void(16===t.keyCode||t.altKey||t.ctrlKey||t.metaKey||r(e.doAutoSearch,0))},e.doAutoSearch=function(){var t=e.state;if(t.queryText&&t.queryText.length>=3)return e.doSearch()},e.moveSelectionForward=function(){if(null===e.state.selectedIndex){if(e.state.searchResults&&e.state.searchResults.length>0)return e.state.selectedIndex=0}else if(e.state.searchResults&&e.state.searchResults.length>0){e.state.selectedIndex++;var t=e.state.searchResults.length-1;if(e.state.selectedIndex>t)return e.state.selectedIndex=t}},e.moveSelectionBackward=function(){if(null===e.state.selectedIndex);else if(e.state.searchResults&&e.state.searchResults.length>0&&(e.state.selectedIndex--,e.state.selectedIndex<0))return e.state.selectedIndex=null},e.doSearch=function(){if(""!==e.state.queryText){e.state.queryText,window.csrfToken;return e.state.currentlySearching=!0,i.$http.post("/project/".concat(e.project_id,"/references/search"),{query:e.state.queryText,_csrf:window.csrfToken}).then((function(t){return e.state.searchResults=t.data.hits,e.state.selectedIndex=null,e.state.currentlySearching=!1,e.state.error=!1}),(function(t){return console.error(">> error searching references",t),e.state.selectedIndex=null,e.state.currentlySearching=!1,e.state.error=!0})),r((function(){return e.state.currentlySearching=!1}),3e4)}},e.selectIndex=function(t){if(e.state.searchResults)return e.state.selectedIndex=t},e.acceptSelectedSearchResult=function(){if(e.state.searchResults&&null!==e.state.selectedIndex){o.sendMB("bib-search-result-inserted");var n=e.state.searchResults[e.state.selectedIndex];return t.close(n._source.EntryKey)}},e.cancel=function(){return t.dismiss("cancel")}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(312),n(318),n(319),n(320)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0),n(313),n(69),n(314),n(315),n(70),n(316),n(71),n(317)],void 0===(i=function(e,t,n,r,i,s,a,l,c){return e.directive("cmEditor",["ide","metadata","localStorage","$cacheFactory","$http","$q",function(e,u,h,d,f,p){return{scope:{bundle:"=",formattingEvents:"=",initCodeMirror:"=",sharejsDoc:"=",readOnly:"=",spellCheck:"=",spellCheckLanguage:"=",trackChanges:"=",autoComplete:"=",autoCloseBrackets:"=",fontSize:"=",lineHeight:"=",docId:"=",onSave:"="},link:function(g,m,v){var y=m.find(".cm-editor-body"),b=null,w=null,C=new i(g,u,g.$root._references),S={triggerRecompile:g.onSave,triggerSyncToPdf:j};g.name="editor";var k=function(e,t){if(e!==t)return null!=t&&(g.$broadcast("beforeChangeDocument"),M(t)),null!=e&&R(e),null!=e&&null!=t?g.$broadcast("afterChangeDocument"):void 0};g.$watch("sharejsDoc",k),g.$watch("readOnly",(function(e){if(null!=e)return b.setReadOnly(e)}));var A=function(){return g.formattingEvents.on("section",(function(){return b.wrapSection()})),g.formattingEvents.on("subsection",(function(){return b.wrapSubsection()})),g.formattingEvents.on("bold",(function(){return b.wrapBold()})),g.formattingEvents.on("italic",(function(){return b.wrapItalic()})),g.formattingEvents.on("inlineMath",(function(){return b.wrapInlineMath()})),g.formattingEvents.on("displayMath",(function(){return b.wrapDisplayMath()})),g.formattingEvents.on("numberedList",(function(){return b.wrapNumberedList()})),g.formattingEvents.on("bulletList",(function(){return b.wrapBulletList()}))},x=/[\0\uD800-\uDFFF]/g,T=function(e,t){if(t.update){var n=t.text.join("\n");if(x.test(n)){for(var r=[],i=0;i<t.text.length;i++){var o=t.text[i].replace(x,"�");r.push(o)}t.update(t.from,t.to,r)}}},E=_.once((function(){return g.$broadcast("editorInit")})),R=function(e){return g.$applyAsync((function(){return b.openDoc(e.getSnapshot()),e.attachToCM(b.getCodeMirror()),b.enable(),e.on("remoteop.richtext",(function(){return b.update()})),b.getCodeMirror().clearHistory(),b.getCodeMirror().on("beforeChange",T),E(),g.readOnly||P(),D(),N()}))},M=function(e){return O(),I(),B(),b.getCodeMirror().off("beforeChange",T),e.detachFromCM(),e.off("remoteop.richtext")},L=function(e,t){return this.spellCheckManager.onChange(t)},P=function(){var e=d.get("spellCheck-".concat(g.name))||d("spellCheck-".concat(g.name),{capacity:1e3});this.spellCheckManager=new n(g,e,f,p,new r(b)),this.spellCheckManager.init();var t=b.getCodeMirror();return t.on("change",L),$(t.getWrapperElement()).on("contextmenu",this.spellCheckManager.onContextMenu),t.on("scroll",this.spellCheckManager.onScroll)},O=function(){var e=b.getCodeMirror();e.off("change",L),this.spellCheckManager&&($(e.getWrapperElement()).off("contextmenu",this.spellCheckManager.onContextMenu),e.off("scroll",this.spellCheckManager.onScroll))},D=function(){var e=b.getCodeMirror();this.trackChangesManager=new l(g,null,m,new c(b)),this.trackChangesManager.rangesTracker=g.sharejsDoc.ranges,this.trackChangesManager.onChangeSession(),e.on("swapDoc",this.trackChangesManager.onChangeSession)},I=function(){var e=b.getCodeMirror();this.trackChangesManager.tearDown(),e.off("swapDoc",this.trackChangesManager.onChangeSession)},F=function(){return w=new s(g,new a(b),h),b.getCodeMirror().on("cursorActivity",w.onCursorChange),$(window).on("unload",w.onUnload)},j=function(){return w.onSyncToPdf()},N=function(){return b.getCodeMirror().on("change",C.onChange)},B=function(){return b.getCodeMirror().off("change",C.onChange)},H=function(e){return g[e]};if(g.$on("$destroy",(function(){return g.$broadcast("changeEditor"),O(),b.getCodeMirror().off("cursorActivity",w.onCursorChange),$(window).off("unload",w.onUnload),g.formattingEvents.off("section"),g.formattingEvents.off("subsection"),g.formattingEvents.off("bold"),g.formattingEvents.off("italic"),g.formattingEvents.off("inlineMath"),g.formattingEvents.off("displayMath"),g.formattingEvents.off("numberedList"),g.formattingEvents.off("bulletList"),B(),M(g.sharejsDoc),b.disable()})),b=new g.bundle.Editor(y[0],new t(e.fileTreeManager),C,S,H),F(),k(g.sharejsDoc),A(),null!=v.resizeOn)for(var z=0,W=Array.from(v.resizeOn.split(","));z<W.length;z++){var U=W[z];g.$on(U,(function(){return o(null!=b?b.getCodeMirror():void 0,(function(e){return e.refresh()}))}))}return g.$watch("fontSize",(function(e){return y.css({"font-size":"".concat(e,"px")}),o(null!=b?b.getCodeMirror():void 0,(function(e){return e.refresh()}))})),g.$watch("lineHeight",(function(e){var t;if(e){switch(e){case"compact":t=1.33;break;case"normal":t=1.6;break;case"wide":t=2;break;default:t=1.6}return y.css({"line-height":t}),o(null!=b?b.getCodeMirror():void 0,(function(e){return e.refresh()}))}}))},template:'<div class="cm-editor-wrapper rich-text">\n  <div class="cm-editor-body"></div>\n  <spell-menu\n    open="spellMenu.open"\n    top="spellMenu.top"\n    left="spellMenu.left"\n    layout-from-bottom="spellMenu.layoutFromBottom"\n    highlight="spellMenu.highlight"\n    replace-word="replaceWord(highlight, suggestion)"\n    learn-word="learnWord(highlight)"\n  ></spell-menu>\n</div>'}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fileTreeManager=t}var t,n,r;return t=e,(n=[{key:"fileExistsForPath",value:function(e){return!!this.fileTreeManager.findEntityByPath(e)}},{key:"getEntityForPath",value:function(e){for(var t,n=0,r=["",".png",".pdf",".jpg",".jpeg",".eps"];n<r.length;n++){var i=r[n];if(t=this.fileTreeManager.findEntityByPath("".concat(e).concat(i)))break}return t}},{key:"getPreviewUrlForEntity",value:function(e){return"/project/".concat(window.project_id,"/file/").concat(e.id)}},{key:"isPreviewableEntity",value:function(e){return!["eps","pdf"].includes(function(e){if(e&&e.name){var t=e.name.split(".").pop();return t?t.toLowerCase():null}return null}(e))}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.replaceWord=this.replaceWord.bind(this),this.editor=t,this.highlightedWordManager=this.editor.highlightedWordManager}var t,n,r;return t=e,(n=[{key:"getLines",value:function(){return this.editor.getCodeMirror().getValue().split("\n")}},{key:"normalizeChangeEvent",value:function(e){return{start:{row:e.from.line},end:{row:e.to.line},action:null!=e.removed?"remove":"insert"}}},{key:"getCoordsFromContextMenuEvent",value:function(e){return e.stopPropagation(),{x:e.pageX,y:e.pageY}}},{key:"isContextMenuEventOnBottomHalf",value:function(e){var t=e.clientY,n=e.currentTarget.getBoundingClientRect();return(t-n.top)/n.height>.5}},{key:"preventContextMenuEventDefault",value:function(e){return e.preventDefault()}},{key:"getHighlightFromCoords",value:function(e){var t=this.editor.getCodeMirror().coordsChar({left:e.x,top:e.y});return this.highlightedWordManager.findHighlightAtPosition(t)}},{key:"selectHighlightedWord",value:function(e){var t=e.marker.find();return this.editor.getCodeMirror().setSelection(t.from,t.to)}},{key:"replaceWord",value:function(e,t){var n=this.editor.getCodeMirror();return n.replaceSelection(t),n.focus()}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(66),n(67)],void 0===(i=function(e,t){return function(){function n(e,t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.onChange=this.onChange.bind(this),this.$scope=e,this.metadata=t,this.bibtexReferences=r,this.debouncer={}}var r,i,s;return r=n,(i=[{key:"getCommandCompletions",value:function(t){return[].concat(e,this.getCommandCompletionsFromMetadata()).map((function(e){return{text:e.caption,displayText:e.caption,hint:t}}))}},{key:"getCommandCompletionsFromMetadata",value:function(){return _.flatten(this.metadata.getAllPackages())}},{key:"getBeginCommandArguments",value:function(){return t.all}},{key:"getBibtexArguments",value:function(){return this.bibtexReferences}},{key:"getReferenceArguments",value:function(){return this.metadata.getAllLabels()}},{key:"onChange",value:function(e){var t=e.getCursor().line,n=e.getLine(t);if(!(n.length>1e4))return/\\(usepackage|RequirePackage|label)(\[.*])?({.*})?/.test(n)?this.metadata.scheduleLoadDocMetaFromServer(this.$scope.docId):void 0}}])&&o(r.prototype,i),s&&o(r,s),n}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r;function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}void 0===(r=function(){return function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.getCursor=this.getCursor.bind(this),this.editor=t}var t,n,r;return t=e,(n=[{key:"convertToAcePos",value:function(e){return{row:e.line,column:e.ch}}},{key:"convertFromAcePos",value:function(e){return{line:e.row,ch:e.column}}},{key:"getCursor",value:function(){return this.convertToAcePos(this.editor.getCodeMirror().getCursor())}},{key:"getEditorScrollPosition",value:function(){return this.editor.getCodeMirror().getViewport().from+10}},{key:"setCursor",value:function(e){return e=e.cursorPosition||{row:0,column:0},this.editor.getCodeMirror().setCursor(this.convertFromAcePos(e))}},{key:"setEditorScrollPosition",value:function(e){e=e.firstVisibleLine||0;var t=this.editor.getCodeMirror(),n=t.heightAtLine(e,"local");return t.scrollTo(null,n)}},{key:"clearSelection",value:function(){}},{key:"gotoLine",value:function(e,t){var n=this.editor.getCodeMirror();return n.setCursor({line:e,ch:t}),n.focus()}},{key:"gotoOffset",value:function(){}}])&&i(t.prototype,n),r&&i(t,r),e}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){var r,i;function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}r=[n(24)],void 0===(i=function(e){return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.findTrackChangesMarker=this.findTrackChangesMarker.bind(this),this.getTrackChangesMarkers=this.getTrackChangesMarkers.bind(this),this.onInsertAdded=this.onInsertAdded.bind(this),this.shareJsOffsetToRowColumn=this.shareJsOffsetToRowColumn.bind(this),this.onDeleteAdded=this.onDeleteAdded.bind(this),this.onChangeMoved=this.onChangeMoved.bind(this),this.editor=e,this.cm=this.editor.getCodeMirror()}var n,r,i;return n=t,(r=[{key:"getTrackChangesMarkers",value:function(){return this.cm.doc.getAllMarks().filter((function(e){var t=e.className&&-1!==e.className.indexOf("track-changes-marker"),n="bookmark"===e.type&&e.replacedWith&&-1!==e.replacedWith.className.indexOf("track-changes-marker");return t||n}))}},{key:"findTrackChangesMarker",value:function(e){return this.getTrackChangesMarkers().find((function(t){return t.id===e}))}},{key:"clearAnnotations",value:function(){this.getTrackChangesMarkers().forEach((function(e){return e.clear()})),this.changeIdToMarkerIdMap={}}},{key:"tearDown",value:function(){this.changeIdToMarkerIdMap={}}},{key:"onInsertAdded",value:function(e){var t,n,r;t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length),r=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-added-marker"}),this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onDeleteAdded",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=document.createElement("span");n.className="track-changes-marker track-changes-deleted-marker";var r=this.cm.setBookmark({line:t.row,ch:t.column},{widget:n,insertLeft:!0});this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onInsertRemoved",value:function(e){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}},{key:"onDeleteRemoved",value:function(e){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}},{key:"onChangeMoved",value:function(e){var t,n=this.shareJsOffsetToRowColumn(e.op.p);t=null!=e.op.i?this.shareJsOffsetToRowColumn(e.op.p+e.op.i.length):n,this.updateMarker(e,n,t)}},{key:"onCommentAdded",value:function(e){var t,n,r;t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length),r=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-comment-marker"}),this.changeIdToMarkerIdMap[e.id]=r.id}},{key:"onCommentMoved",value:function(e){var t=this.shareJsOffsetToRowColumn(e.op.p),n=this.shareJsOffsetToRowColumn(e.op.p+e.op.c.length);this.updateMarker(e,t,n)}},{key:"onCommentRemoved",value:function(e){if(this.changeIdToMarkerIdMap[e.id]){var t=this.changeIdToMarkerIdMap[e.id];delete this.changeIdToMarkerIdMap[e.id];var n=this.findTrackChangesMarker(t);n&&n.clear()}}},{key:"updateMarker",value:function(e,t,n){var r=this.changeIdToMarkerIdMap[e.id];if(e.op.i||e.op.c){var i=this.findTrackChangesMarker(r);if(!i)return;i.clear();var o=e.op.i?"added":"comment",s=this.cm.doc.markText({line:t.row,ch:t.column},{line:n.row,ch:n.column},{className:"track-changes-marker track-changes-".concat(o,"-marker")});this.changeIdToMarkerIdMap[e.id]=s.id}}},{key:"shareJsOffsetToRowColumn",value:function(t){var n=this.cm.doc.getValue().split("\n");return e.shareJsOffsetToRowColumn(t,n)}}])&&o(n.prototype,r),i&&o(n,i),t}()}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.directive("formattingButtons",(function(){return{scope:{buttons:"=",opening:"=",isFullscreenEditor:"="},link:function(e,t,n){e.showMore=!1,e.shownButtons=[],e.overflowedButtons=[];var r=e.$watch("opening",(function(e){if(!e)return i(),a(),r()})),i=function(){var n=t.width(),r=Math.floor(n/33);return r<e.buttons.length?(e.showMore=!0,n-=70,r=Math.floor(n/33),o(r)):(e.showMore=!1,o(r))},o=function(t){return e.$applyAsync((function(){return e.shownButtons=e.buttons.slice(0,t),e.overflowedButtons=e.buttons.slice(t)}))},s=_.debounce(i,300),a=function(){if($(window).on("resize",s),null!=n.resizeOn)return Array.from(n.resizeOn.split(",")).map((function(t){return e.$on(t,s)}))};return e.$watch("$destroy",(function(){return $(window).off("resize",s)})),e.$watch("isFullscreenEditor",(function(e,t){if(e!==t)return s()}))},templateUrl:"formattingButtonsTpl"}}))}.apply(t,r))||(e.exports=i)},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(13),s=n.n(o);i.a.controller("EditorLoaderController",["$scope","localStorage",function(e,t){e.richText={bundle:null,formattingEvents:new s.a},e.$watch("editor.showRichText",(function(r){t("editor.mode.".concat(e.project_id),!0===r?"rich-text":"source"),r&&!e.richText.bundle&&Promise.all([n.e(1),n.e(12),n.e(8)]).then(n.bind(null,348)).then((function(t){return e.$applyAsync((function(){return e.richText.bundle=t}))}))}))}])},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("EditorToolbarController",["$scope","ide",function(e,t){return e.buttons=[{iconText:"§",iconClass:"formatting-icon",title:"Insert Section Heading",handleClick:function(){return e.richText.formattingEvents.trigger("section")}},{iconText:"§",iconClass:"formatting-icon formatting-icon--small",title:"Insert Subsection Heading",handleClick:function(){return e.richText.formattingEvents.trigger("subsection")}},{iconClass:"formatting-icon fa fa-bold",title:"Format Bold",handleClick:function(){return e.richText.formattingEvents.trigger("bold")}},{iconClass:"formatting-icon fa fa-italic",title:"Format Italic",handleClick:function(){return e.richText.formattingEvents.trigger("italic")}},{iconText:"π",iconClass:"formatting-icon formatting-icon--serif",title:"Insert Inline Math",handleClick:function(){return e.richText.formattingEvents.trigger("inlineMath")}},{iconText:"Σ",iconClass:"formatting-icon formatting-icon--serif",title:"Insert Math on its own line",handleClick:function(){return e.richText.formattingEvents.trigger("displayMath")}},{iconClass:"formatting-icon fa fa-list-ol",title:"Insert Numbered List",handleClick:function(){return e.richText.formattingEvents.trigger("numberedList")}},{iconClass:"formatting-icon fa fa-list-ul",title:"Insert Bullet Point List",handleClick:function(){return e.richText.formattingEvents.trigger("bulletList")}}]}])}.apply(t,r))||(e.exports=i)},function(e,t,n){n(41)},function(e,t,n){var r,i;r=[n(323)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0),n(42),n(2)],void 0===(i=function(e,t,n){return e.controller("TemplatesController",["$scope","$modal","ide",function(e,t,n){return e.openPublishTemplateModal=function(){var n=function(){return e.problemTalkingToTemplateApi=!1};return n(),t.open({templateUrl:"publishProjectAsTemplateModalTemplate",controller:"PublishProjectAsTemplateModalController",scope:e}).result.then(n,n)}}]),e.controller("PublishProjectAsTemplateModalController",["$scope","$modalInstance","ide","$http",function(e,t,r,i){r.$scope.user.id;e.templateDetails={exists:!1},e.state={publishInflight:!1,unpublishInflight:!1};var o=function(){return e.problemTalkingToTemplateApi=!0},s=function(){return i.get("/project/".concat(r.project_id,"/template")).then((function(t){var r=t.data;return e.templateDetails=r,e.templateDetails.publishedDate=n(r.publishedDate).format("Do MMM YYYY, h:mm a"),e.templateDetails.description=r.description})).catch((function(){return o()}))};e.$watch(e.problemTalkingToTemplateApi,(function(e){if(null!=e)return s()}));var a=function(){return i.post("/project/".concat(r.project_id,"/template/description"),{description:e.templateDetails.description,_csrf:window.csrfToken})};return t.result.finally((function(){return a()})),e.publishTemplate=function(){return e.state.publishInflight=!0,a().then((function(){return i.post("/project/".concat(r.project_id,"/template/publish"),{_csrf:window.csrfToken}).then((function(){return s(),e.state.publishInflight=!1})).catch((function(){return o()}))})).catch((function(){return o()}))},e.unpublishTemplate=function(){return e.state.unpublishInflight=!0,i.post("/project/".concat(r.project_id,"/template/unpublish"),{_csrf:window.csrfToken}).then((function(){return s(),e.state.unpublishInflight=!1})).catch((function(){return o()}))},e.cancel=function(){return t.dismiss()}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(325),n(326)],void 0===(i=function(){}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;r=[n(0)],void 0===(i=function(e){return e.controller("ReferencesController",["$scope","$modal","ide","$http",function(e,t,n,r){var i=n.$scope.user,o=null!=i?i.features:void 0;return e.thirdPartyReferencesEnabled=(null!=o?o.mendeley:void 0)||(null!=o?o.references:void 0),e.openNewDocModal=function(){return t.open({templateUrl:"newFileModalTemplate",controller:"NewFileModalController",size:"lg",resolve:{parent_folder:function(){return null},type:function(){return"mendeley"}}})}}])}.apply(t,r))||(e.exports=i)},function(e,t,n){var r,i;function o(e,t){return null!=e?t(e):void 0}r=[n(0)],void 0===(i=function(e){var t=function(e,t){return["$scope","ide","$timeout","$window","$interval","eventTracking",function(n,r,i,s,a,l){var c=null!=r.$scope.user?r.$scope.user.features:void 0;n.userHasProviderFeature=(null!=c?c[e]:void 0)||(null!=c?c.references:void 0),n.userHasProviderLink=o(null!=r.$scope.user?r.$scope.user.refProviders:void 0,(function(t){return t[e]})),n.canLoadBibtex=function(){return n.userHasProviderFeature&&n.userHasProviderLink},n.state.fetchingGroups=!1,n.state.inflight=!1,n.state.error=!1,n.state.errorType="default",n.data={isInitialized:!1,groups:null,selectedGroupId:null,format:"bibtex",name:"references.bib"};var u=function(e){"already exists"===e.data?h({error:"name-exists"}):401===e.status?h({error:"expired"}):403===e.status?h({error:"forbidden"}):400===e.status?h({error:"default"}):h({error:!0})},h=function(e){null==e&&(e={}),n.state.fetchingGroups=!1,n.state.fetchingBibtexPreview=!1,n.state.inflight=!1,null!=e.error?(n.state.error=!0,!0===e.error?n.state.errorType="default":n.state.errorType=e.error):n.state.error=!1};n.hasGroups=function(){return null!=n.data.groups&&n.data.groups.length>0},n.supportsGroups=function(){if(n.canLoadBibtex())return h(),n.state.fetchingGroups=!0,r.$http.get("/".concat(e,"/groups"),{disableAutoLoginRedirect:!0}).then((function(e){var t=e.data;return n.data.groups=t.groups,n.data.selectedGroup=null,n.data.isInitialized=!0,n.$applyAsync((function(){return n.$broadcast("open")})),h()})).catch((function(e){return console.warn(e),u(e)}))};var d=function(){var e=n.data,t=e.name,r=e.isInitialized;null==t||0===t.length?n.state.valid=!1:n.state.valid=null!=r};n.$watch("data.name",d),d(),n.$on("create",(function(){if(n.data.isInitialized&&n.data.isInitialized&&n.data.name){var t={};return"mendeley"===e&&n.hasGroups()&&n.data.selectedGroupId&&(t.group_id=n.data.selectedGroupId),"zotero"===e&&(t.format=n.data.format),l.send("references-".concat(e),"modal","import-bibtex"),n.state.inflight=!0,r.fileTreeManager.createLinkedFile(n.data.name,n.parent_folder,e,t).then((function(){return n.$emit("done",{name:n.data.name,shouldReindexReferences:!0}),h()})).catch((function(e){return u(e)}))}}));n.canLoadBibtex()&&(t?(n.state.fetchingGroups=!0,i((function(){return n.supportsGroups()}),500)):n.data.isInitialized=!0),n.linkAccount=function(){var t=s.open("/".concat(e,"/oauth"),"reference-auth","width=700,height=500");l.send("references-".concat(e),"modal","start-link-account");var c=a((function(){var s;try{s=o(null!=t?t.location:void 0,(function(e){return e.pathname}))}catch(e){s=null}"/user/settings"===s&&(t.close(),l.send("references-".concat(e),"modal","end-link-account"),n.userHasProviderLink=!0,r.$scope.user.refProviders[e]=!0,i(n.supportsGroups(),500),a.cancel(c))}),1e3);return!0},window._S=n}]};e.controller("MendeleyLinkedFileModalController",t("mendeley",!0)),e.controller("ZoteroLinkedFileModalController",t("zotero",!1))}.apply(t,r))||(e.exports=i)}])}));
//# sourceMappingURL=ide-df07f0bc2a3baee8360a.js.map